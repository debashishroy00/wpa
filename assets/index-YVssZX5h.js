import{j as e}from"./ui-vendor-DMbdaL9f.js";import{a as mi,g as ar,R as xe,r as w,B as ui}from"./react-vendor-0rrTAdsD.js";import{a as hi,c as rr,u as ot,b as ct,d as dt,Q as xi,e as gi}from"./data-vendor-BoI28nm6.js";import{r as we,c as jt}from"./chart-vendor-D2RL595h.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();var Oa={},Ar=mi;Oa.createRoot=Ar.createRoot,Oa.hydrateRoot=Ar.hydrateRoot;var pi=typeof Element<"u",fi=typeof Map=="function",yi=typeof Set=="function",bi=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function Zs(s,t){if(s===t)return!0;if(s&&t&&typeof s=="object"&&typeof t=="object"){if(s.constructor!==t.constructor)return!1;var a,r,n;if(Array.isArray(s)){if(a=s.length,a!=t.length)return!1;for(r=a;r--!==0;)if(!Zs(s[r],t[r]))return!1;return!0}var i;if(fi&&s instanceof Map&&t instanceof Map){if(s.size!==t.size)return!1;for(i=s.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;for(i=s.entries();!(r=i.next()).done;)if(!Zs(r.value[1],t.get(r.value[0])))return!1;return!0}if(yi&&s instanceof Set&&t instanceof Set){if(s.size!==t.size)return!1;for(i=s.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(bi&&ArrayBuffer.isView(s)&&ArrayBuffer.isView(t)){if(a=s.length,a!=t.length)return!1;for(r=a;r--!==0;)if(s[r]!==t[r])return!1;return!0}if(s.constructor===RegExp)return s.source===t.source&&s.flags===t.flags;if(s.valueOf!==Object.prototype.valueOf&&typeof s.valueOf=="function"&&typeof t.valueOf=="function")return s.valueOf()===t.valueOf();if(s.toString!==Object.prototype.toString&&typeof s.toString=="function"&&typeof t.toString=="function")return s.toString()===t.toString();if(n=Object.keys(s),a=n.length,a!==Object.keys(t).length)return!1;for(r=a;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;if(pi&&s instanceof Element)return!1;for(r=a;r--!==0;)if(!((n[r]==="_owner"||n[r]==="__v"||n[r]==="__o")&&s.$$typeof)&&!Zs(s[n[r]],t[n[r]]))return!1;return!0}return s!==s&&t!==t}var vi=function(t,a){try{return Zs(t,a)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}};const ji=ar(vi);var Ni=function(s,t,a,r,n,i,l,o){if(!s){var c;if(t===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[a,r,n,i,l,o],h=0;c=new Error(t.replace(/%s/g,function(){return u[h++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}},_i=Ni;const Tr=ar(_i);var wi=function(t,a,r,n){var i=r?r.call(n,t,a):void 0;if(i!==void 0)return!!i;if(t===a)return!0;if(typeof t!="object"||!t||typeof a!="object"||!a)return!1;var l=Object.keys(t),o=Object.keys(a);if(l.length!==o.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(a),u=0;u<l.length;u++){var h=l[u];if(!c(h))return!1;var f=t[h],d=a[h];if(i=r?r.call(n,f,d,h):void 0,i===!1||i===void 0&&f!==d)return!1}return!0};const ki=ar(wi);function Be(){return Be=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s},Be.apply(this,arguments)}function nr(s,t){s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Ba(s,t)}function Ba(s,t){return Ba=Object.setPrototypeOf||function(a,r){return a.__proto__=r,a},Ba(s,t)}function Ir(s,t){if(s==null)return{};var a,r,n={},i=Object.keys(s);for(r=0;r<i.length;r++)t.indexOf(a=i[r])>=0||(n[a]=s[a]);return n}var ue={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title",FRAGMENT:"Symbol(react.fragment)"},Si={rel:["amphtml","canonical","alternate"]},Ci={type:["application/ld+json"]},Ai={charset:"",name:["robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},Er=Object.keys(ue).map(function(s){return ue[s]}),ea={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Ti=Object.keys(ea).reduce(function(s,t){return s[ea[t]]=t,s},{}),hs=function(s,t){for(var a=s.length-1;a>=0;a-=1){var r=s[a];if(Object.prototype.hasOwnProperty.call(r,t))return r[t]}return null},Ii=function(s){var t=hs(s,ue.TITLE),a=hs(s,"titleTemplate");if(Array.isArray(t)&&(t=t.join("")),a&&t)return a.replace(/%s/g,function(){return t});var r=hs(s,"defaultTitle");return t||r||void 0},Ei=function(s){return hs(s,"onChangeClientState")||function(){}},va=function(s,t){return t.filter(function(a){return a[s]!==void 0}).map(function(a){return a[s]}).reduce(function(a,r){return Be({},a,r)},{})},Ri=function(s,t){return t.filter(function(a){return a[ue.BASE]!==void 0}).map(function(a){return a[ue.BASE]}).reverse().reduce(function(a,r){if(!a.length)for(var n=Object.keys(r),i=0;i<n.length;i+=1){var l=n[i].toLowerCase();if(s.indexOf(l)!==-1&&r[l])return a.concat(r)}return a},[])},Cs=function(s,t,a){var r={};return a.filter(function(n){return!!Array.isArray(n[s])||(n[s]!==void 0&&console&&typeof console.warn=="function"&&console.warn("Helmet: "+s+' should be of type "Array". Instead found type "'+typeof n[s]+'"'),!1)}).map(function(n){return n[s]}).reverse().reduce(function(n,i){var l={};i.filter(function(f){for(var d,x=Object.keys(f),b=0;b<x.length;b+=1){var m=x[b],p=m.toLowerCase();t.indexOf(p)===-1||d==="rel"&&f[d].toLowerCase()==="canonical"||p==="rel"&&f[p].toLowerCase()==="stylesheet"||(d=p),t.indexOf(m)===-1||m!=="innerHTML"&&m!=="cssText"&&m!=="itemprop"||(d=m)}if(!d||!f[d])return!1;var N=f[d].toLowerCase();return r[d]||(r[d]={}),l[d]||(l[d]={}),!r[d][N]&&(l[d][N]=!0,!0)}).reverse().forEach(function(f){return n.push(f)});for(var o=Object.keys(l),c=0;c<o.length;c+=1){var u=o[c],h=Be({},r[u],l[u]);r[u]=h}return n},[]).reverse()},Pi=function(s,t){if(Array.isArray(s)&&s.length){for(var a=0;a<s.length;a+=1)if(s[a][t])return!0}return!1},kn=function(s){return Array.isArray(s)?s.join(""):s},ja=function(s,t){return Array.isArray(s)?s.reduce(function(a,r){return function(n,i){for(var l=Object.keys(n),o=0;o<l.length;o+=1)if(i[l[o]]&&i[l[o]].includes(n[l[o]]))return!0;return!1}(r,t)?a.priority.push(r):a.default.push(r),a},{priority:[],default:[]}):{default:s}},Rr=function(s,t){var a;return Be({},s,((a={})[t]=void 0,a))},Li=[ue.NOSCRIPT,ue.SCRIPT,ue.STYLE],Na=function(s,t){return t===void 0&&(t=!0),t===!1?String(s):String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},Pr=function(s){return Object.keys(s).reduce(function(t,a){var r=s[a]!==void 0?a+'="'+s[a]+'"':""+a;return t?t+" "+r:r},"")},Lr=function(s,t){return t===void 0&&(t={}),Object.keys(s).reduce(function(a,r){return a[ea[r]||r]=s[r],a},t)},Ks=function(s,t){return t.map(function(a,r){var n,i=((n={key:r})["data-rh"]=!0,n);return Object.keys(a).forEach(function(l){var o=ea[l]||l;o==="innerHTML"||o==="cssText"?i.dangerouslySetInnerHTML={__html:a.innerHTML||a.cssText}:i[o]=a[l]}),xe.createElement(s,i)})},xt=function(s,t,a){switch(s){case ue.TITLE:return{toComponent:function(){return n=t.titleAttributes,(i={key:r=t.title})["data-rh"]=!0,l=Lr(n,i),[xe.createElement(ue.TITLE,l,r)];var r,n,i,l},toString:function(){return function(r,n,i,l){var o=Pr(i),c=kn(n);return o?"<"+r+' data-rh="true" '+o+">"+Na(c,l)+"</"+r+">":"<"+r+' data-rh="true">'+Na(c,l)+"</"+r+">"}(s,t.title,t.titleAttributes,a)}};case"bodyAttributes":case"htmlAttributes":return{toComponent:function(){return Lr(t)},toString:function(){return Pr(t)}};default:return{toComponent:function(){return Ks(s,t)},toString:function(){return function(r,n,i){return n.reduce(function(l,o){var c=Object.keys(o).filter(function(f){return!(f==="innerHTML"||f==="cssText")}).reduce(function(f,d){var x=o[d]===void 0?d:d+'="'+Na(o[d],i)+'"';return f?f+" "+x:x},""),u=o.innerHTML||o.cssText||"",h=Li.indexOf(r)===-1;return l+"<"+r+' data-rh="true" '+c+(h?"/>":">"+u+"</"+r+">")},"")}(s,t,a)}}}},za=function(s){var t=s.baseTag,a=s.bodyAttributes,r=s.encode,n=s.htmlAttributes,i=s.noscriptTags,l=s.styleTags,o=s.title,c=o===void 0?"":o,u=s.titleAttributes,h=s.linkTags,f=s.metaTags,d=s.scriptTags,x={toComponent:function(){},toString:function(){return""}};if(s.prioritizeSeoTags){var b=function(m){var p=m.linkTags,N=m.scriptTags,g=m.encode,S=ja(m.metaTags,Ai),T=ja(p,Si),v=ja(N,Ci);return{priorityMethods:{toComponent:function(){return[].concat(Ks(ue.META,S.priority),Ks(ue.LINK,T.priority),Ks(ue.SCRIPT,v.priority))},toString:function(){return xt(ue.META,S.priority,g)+" "+xt(ue.LINK,T.priority,g)+" "+xt(ue.SCRIPT,v.priority,g)}},metaTags:S.default,linkTags:T.default,scriptTags:v.default}}(s);x=b.priorityMethods,h=b.linkTags,f=b.metaTags,d=b.scriptTags}return{priority:x,base:xt(ue.BASE,t,r),bodyAttributes:xt("bodyAttributes",a,r),htmlAttributes:xt("htmlAttributes",n,r),link:xt(ue.LINK,h,r),meta:xt(ue.META,f,r),noscript:xt(ue.NOSCRIPT,i,r),script:xt(ue.SCRIPT,d,r),style:xt(ue.STYLE,l,r),title:xt(ue.TITLE,{title:c,titleAttributes:u},r)}},Ws=[],Ua=function(s,t){var a=this;t===void 0&&(t=typeof document<"u"),this.instances=[],this.value={setHelmet:function(r){a.context.helmet=r},helmetInstances:{get:function(){return a.canUseDOM?Ws:a.instances},add:function(r){(a.canUseDOM?Ws:a.instances).push(r)},remove:function(r){var n=(a.canUseDOM?Ws:a.instances).indexOf(r);(a.canUseDOM?Ws:a.instances).splice(n,1)}}},this.context=s,this.canUseDOM=t,t||(s.helmet=za({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))},Sn=xe.createContext({}),Fi=we.shape({setHelmet:we.func,helmetInstances:we.shape({get:we.func,add:we.func,remove:we.func})}),Mi=typeof document<"u",ms=function(s){function t(a){var r;return(r=s.call(this,a)||this).helmetData=new Ua(r.props.context,t.canUseDOM),r}return nr(t,s),t.prototype.render=function(){return xe.createElement(Sn.Provider,{value:this.helmetData.value},this.props.children)},t}(w.Component);ms.canUseDOM=Mi,ms.propTypes={context:we.shape({helmet:we.shape()}),children:we.node.isRequired},ms.defaultProps={context:{}},ms.displayName="HelmetProvider";var os=function(s,t){var a,r=document.head||document.querySelector(ue.HEAD),n=r.querySelectorAll(s+"[data-rh]"),i=[].slice.call(n),l=[];return t&&t.length&&t.forEach(function(o){var c=document.createElement(s);for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(u==="innerHTML"?c.innerHTML=o.innerHTML:u==="cssText"?c.styleSheet?c.styleSheet.cssText=o.cssText:c.appendChild(document.createTextNode(o.cssText)):c.setAttribute(u,o[u]===void 0?"":o[u]));c.setAttribute("data-rh","true"),i.some(function(h,f){return a=f,c.isEqualNode(h)})?i.splice(a,1):l.push(c)}),i.forEach(function(o){return o.parentNode.removeChild(o)}),l.forEach(function(o){return r.appendChild(o)}),{oldTags:i,newTags:l}},_a=function(s,t){var a=document.getElementsByTagName(s)[0];if(a){for(var r=a.getAttribute("data-rh"),n=r?r.split(","):[],i=[].concat(n),l=Object.keys(t),o=0;o<l.length;o+=1){var c=l[o],u=t[c]||"";a.getAttribute(c)!==u&&a.setAttribute(c,u),n.indexOf(c)===-1&&n.push(c);var h=i.indexOf(c);h!==-1&&i.splice(h,1)}for(var f=i.length-1;f>=0;f-=1)a.removeAttribute(i[f]);n.length===i.length?a.removeAttribute("data-rh"):a.getAttribute("data-rh")!==l.join(",")&&a.setAttribute("data-rh",l.join(","))}},Fr=function(s,t){var a=s.baseTag,r=s.htmlAttributes,n=s.linkTags,i=s.metaTags,l=s.noscriptTags,o=s.onChangeClientState,c=s.scriptTags,u=s.styleTags,h=s.title,f=s.titleAttributes;_a(ue.BODY,s.bodyAttributes),_a(ue.HTML,r),function(m,p){m!==void 0&&document.title!==m&&(document.title=kn(m)),_a(ue.TITLE,p)}(h,f);var d={baseTag:os(ue.BASE,a),linkTags:os(ue.LINK,n),metaTags:os(ue.META,i),noscriptTags:os(ue.NOSCRIPT,l),scriptTags:os(ue.SCRIPT,c),styleTags:os(ue.STYLE,u)},x={},b={};Object.keys(d).forEach(function(m){var p=d[m],N=p.newTags,g=p.oldTags;N.length&&(x[m]=N),g.length&&(b[m]=d[m].oldTags)}),t&&t(),o(s,x,b)},As=null,ta=function(s){function t(){for(var r,n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return(r=s.call.apply(s,[this].concat(i))||this).rendered=!1,r}nr(t,s);var a=t.prototype;return a.shouldComponentUpdate=function(r){return!ki(r,this.props)},a.componentDidUpdate=function(){this.emitChange()},a.componentWillUnmount=function(){this.props.context.helmetInstances.remove(this),this.emitChange()},a.emitChange=function(){var r,n,i=this.props.context,l=i.setHelmet,o=null,c=(r=i.helmetInstances.get().map(function(u){var h=Be({},u.props);return delete h.context,h}),{baseTag:Ri(["href"],r),bodyAttributes:va("bodyAttributes",r),defer:hs(r,"defer"),encode:hs(r,"encodeSpecialCharacters"),htmlAttributes:va("htmlAttributes",r),linkTags:Cs(ue.LINK,["rel","href"],r),metaTags:Cs(ue.META,["name","charset","http-equiv","property","itemprop"],r),noscriptTags:Cs(ue.NOSCRIPT,["innerHTML"],r),onChangeClientState:Ei(r),scriptTags:Cs(ue.SCRIPT,["src","innerHTML"],r),styleTags:Cs(ue.STYLE,["cssText"],r),title:Ii(r),titleAttributes:va("titleAttributes",r),prioritizeSeoTags:Pi(r,"prioritizeSeoTags")});ms.canUseDOM?(n=c,As&&cancelAnimationFrame(As),n.defer?As=requestAnimationFrame(function(){Fr(n,function(){As=null})}):(Fr(n),As=null)):za&&(o=za(c)),l(o)},a.init=function(){this.rendered||(this.rendered=!0,this.props.context.helmetInstances.add(this),this.emitChange())},a.render=function(){return this.init(),null},t}(w.Component);ta.propTypes={context:Fi.isRequired},ta.displayName="HelmetDispatcher";var $i=["children"],Di=["children"],Qs=function(s){function t(){return s.apply(this,arguments)||this}nr(t,s);var a=t.prototype;return a.shouldComponentUpdate=function(r){return!ji(Rr(this.props,"helmetData"),Rr(r,"helmetData"))},a.mapNestedChildrenToProps=function(r,n){if(!n)return null;switch(r.type){case ue.SCRIPT:case ue.NOSCRIPT:return{innerHTML:n};case ue.STYLE:return{cssText:n};default:throw new Error("<"+r.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")}},a.flattenArrayTypeChildren=function(r){var n,i=r.child,l=r.arrayTypeChildren;return Be({},l,((n={})[i.type]=[].concat(l[i.type]||[],[Be({},r.newChildProps,this.mapNestedChildrenToProps(i,r.nestedChildren))]),n))},a.mapObjectTypeChildren=function(r){var n,i,l=r.child,o=r.newProps,c=r.newChildProps,u=r.nestedChildren;switch(l.type){case ue.TITLE:return Be({},o,((n={})[l.type]=u,n.titleAttributes=Be({},c),n));case ue.BODY:return Be({},o,{bodyAttributes:Be({},c)});case ue.HTML:return Be({},o,{htmlAttributes:Be({},c)});default:return Be({},o,((i={})[l.type]=Be({},c),i))}},a.mapArrayTypeChildrenToProps=function(r,n){var i=Be({},n);return Object.keys(r).forEach(function(l){var o;i=Be({},i,((o={})[l]=r[l],o))}),i},a.warnOnInvalidChildren=function(r,n){return Tr(Er.some(function(i){return r.type===i}),typeof r.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":"Only elements types "+Er.join(", ")+" are allowed. Helmet does not support rendering <"+r.type+"> elements. Refer to our API for more information."),Tr(!n||typeof n=="string"||Array.isArray(n)&&!n.some(function(i){return typeof i!="string"}),"Helmet expects a string as a child of <"+r.type+">. Did you forget to wrap your children in braces? ( <"+r.type+">{``}</"+r.type+"> ) Refer to our API for more information."),!0},a.mapChildrenToProps=function(r,n){var i=this,l={};return xe.Children.forEach(r,function(o){if(o&&o.props){var c=o.props,u=c.children,h=Ir(c,$i),f=Object.keys(h).reduce(function(x,b){return x[Ti[b]||b]=h[b],x},{}),d=o.type;switch(typeof d=="symbol"?d=d.toString():i.warnOnInvalidChildren(o,u),d){case ue.FRAGMENT:n=i.mapChildrenToProps(u,n);break;case ue.LINK:case ue.META:case ue.NOSCRIPT:case ue.SCRIPT:case ue.STYLE:l=i.flattenArrayTypeChildren({child:o,arrayTypeChildren:l,newChildProps:f,nestedChildren:u});break;default:n=i.mapObjectTypeChildren({child:o,newProps:n,newChildProps:f,nestedChildren:u})}}}),this.mapArrayTypeChildrenToProps(l,n)},a.render=function(){var r=this.props,n=r.children,i=Ir(r,Di),l=Be({},i),o=i.helmetData;return n&&(l=this.mapChildrenToProps(n,l)),!o||o instanceof Ua||(o=new Ua(o.context,o.instances)),o?xe.createElement(ta,Be({},l,{context:o.value,helmetData:void 0})):xe.createElement(Sn.Consumer,null,function(c){return xe.createElement(ta,Be({},l,{context:c}))})},t}(w.Component);Qs.propTypes={base:we.object,bodyAttributes:we.object,children:we.oneOfType([we.arrayOf(we.node),we.node]),defaultTitle:we.string,defer:we.bool,encodeSpecialCharacters:we.bool,htmlAttributes:we.object,link:we.arrayOf(we.object),meta:we.arrayOf(we.object),noscript:we.arrayOf(we.object),onChangeClientState:we.func,script:we.arrayOf(we.object),style:we.arrayOf(we.object),title:we.string,titleAttributes:we.object,titleTemplate:we.string,prioritizeSeoTags:we.bool,helmetData:we.object},Qs.defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1},Qs.displayName="Helmet";const qa=()=>{const s=window.location.hostname,t="https://wealthpath-backend.onrender.com",a="production",r=!0;return s!=="localhost"&&s!=="127.0.0.1"?(console.log("🔗 PRODUCTION MODE - Using render backend:",s),"https://wealthpath-backend.onrender.com"):(console.log("🔍 Environment detection v2:",{hostname:s,envVar:t,mode:a,prod:r,url:t}),s==="localhost"||s==="127.0.0.1"?(console.log("Using ENV variable for localhost:",t),t):s==="localhost"||s==="127.0.0.1"?(console.log("Detected localhost - using local backend"),"http://localhost:8000"):(console.log("⚠️ Fallback to production backend"),"https://wealthpath-backend.onrender.com"))};class Oi{constructor(){const t=qa();console.log("🔗 API connected to (SIMPLIFIED):",t),this.client=hi.create({baseURL:t,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.setupSimpleInterceptors()}setupSimpleInterceptors(){this.client.interceptors.request.use(t=>{var r;const a=localStorage.getItem("access_token")||((r=this.tokens)==null?void 0:r.access_token);return a&&(t.headers.Authorization=`Bearer ${a}`),t},t=>Promise.reject(t)),this.client.interceptors.response.use(t=>t,t=>{var a;return((a=t.response)==null?void 0:a.status)===401&&console.log("401 error - auth required (no auto-refresh)"),Promise.reject(t)})}setTokens(t){this.tokens=t,localStorage.setItem("auth_tokens",JSON.stringify(t)),localStorage.setItem("access_token",t.access_token)}clearTokens(){this.tokens=void 0,localStorage.removeItem("auth_tokens"),localStorage.removeItem("access_token")}loadTokensFromStorage(){const t=localStorage.getItem("auth_tokens");if(t)try{this.tokens=JSON.parse(t)}catch(a){console.error("Failed to parse stored tokens:",a),this.clearTokens()}}async get(t,a){return(await this.client.get(t,a)).data}async post(t,a,r){return(await this.client.post(t,a,r)).data}async put(t,a,r){return(await this.client.put(t,a,r)).data}async patch(t,a,r){return(await this.client.patch(t,a,r)).data}async delete(t,a){return(await this.client.delete(t,a)).data}async healthCheck(){return this.get("/health")}}const G=new Oi;G.loadTokensFromStorage();if(typeof window<"u"){window.quickLogin=async(t,a)=>{if(!t||!a){console.log('Usage: window.quickLogin("your-email@domain.com", "your-password")'),console.log('Example: window.quickLogin("your-email@example.com", "your-password")');return}try{console.log("🔄 Attempting login with provided credentials...");const r=qa(),i=await(await fetch(`${r}/api/v1/auth/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:t,password:a})})).json();i.access_token?(localStorage.setItem("access_token",i.access_token),i.refresh_token&&(localStorage.setItem("refresh_token",i.refresh_token),G.setTokens(i)),console.log("✅ Logged in! Refreshing..."),window.location.reload()):console.error("❌ Login failed:",i)}catch(r){console.error("❌ Login failed:",r)}},window.clearAndLogin=async(t,a)=>{if(!t||!a){console.log('Usage: window.clearAndLogin("your-email@domain.com", "your-password")'),console.log('Example: window.clearAndLogin("your-email@example.com", "your-password")');return}console.log("🧹 Clearing old tokens..."),localStorage.clear(),sessionStorage.clear(),console.log("🔐 Logging in with provided credentials...");try{const r=qa(),n=await fetch(`${r}/api/v1/auth/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:t,password:a})}),i=await n.json();n.ok&&i.access_token?(localStorage.setItem("access_token",i.access_token),i.refresh_token&&(localStorage.setItem("refresh_token",i.refresh_token),G.setTokens(i)),console.log("✅ Fresh login successful! Refreshing..."),window.location.reload()):console.error("❌ Login failed:",i)}catch(r){console.error("❌ Login error:",r)}},console.log('🛠️ Usage: window.quickLogin("email", "password")'),console.log('💡 Usage: window.clearAndLogin("email", "password") - clears old tokens first');const s=new URLSearchParams(window.location.search);(s.get("clear")||s.get("reset")||s.get("clearAuth"))&&(console.log("🧹 Auto-clearing all tokens..."),localStorage.clear(),sessionStorage.clear(),window.history.replaceState({},document.title,window.location.pathname),setTimeout(()=>window.location.reload(),100))}const Js={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"https://wealthpath-backend.onrender.com",VITE_ENVIRONMENT:"development"},Va=new Map,Gs=s=>{const t=Va.get(s);return t?Object.fromEntries(Object.entries(t.stores).map(([a,r])=>[a,r.getState()])):{}},Bi=(s,t,a)=>{if(s===void 0)return{type:"untracked",connection:t.connect(a)};const r=Va.get(a.name);if(r)return{type:"tracked",store:s,...r};const n={connection:t.connect(a),stores:{}};return Va.set(a.name,n),{type:"tracked",store:s,...n}},zi=(s,t={})=>(a,r,n)=>{const{enabled:i,anonymousActionType:l,store:o,...c}=t;let u;try{u=(i??(Js?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return(Js?"production":void 0)!=="production"&&i&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),s(a,r,n);const{connection:h,...f}=Bi(o,u,c);let d=!0;n.setState=(m,p,N)=>{const g=a(m,p);if(!d)return g;const S=N===void 0?{type:l||"anonymous"}:typeof N=="string"?{type:N}:N;return o===void 0?(h==null||h.send(S,r()),g):(h==null||h.send({...S,type:`${o}/${S.type}`},{...Gs(c.name),[o]:n.getState()}),g)};const x=(...m)=>{const p=d;d=!1,a(...m),d=p},b=s(n.setState,r,n);if(f.type==="untracked"?h==null||h.init(b):(f.stores[f.store]=n,h==null||h.init(Object.fromEntries(Object.entries(f.stores).map(([m,p])=>[m,m===f.store?b:p.getState()])))),n.dispatchFromDevtools&&typeof n.dispatch=="function"){let m=!1;const p=n.dispatch;n.dispatch=(...N)=>{(Js?"production":void 0)!=="production"&&N[0].type==="__setState"&&!m&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),m=!0),p(...N)}}return h.subscribe(m=>{var p;switch(m.type){case"ACTION":if(typeof m.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return wa(m.payload,N=>{if(N.type==="__setState"){if(o===void 0){x(N.state);return}Object.keys(N.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const g=N.state[o];if(g==null)return;JSON.stringify(n.getState())!==JSON.stringify(g)&&x(g);return}n.dispatchFromDevtools&&typeof n.dispatch=="function"&&n.dispatch(N)});case"DISPATCH":switch(m.payload.type){case"RESET":return x(b),o===void 0?h==null?void 0:h.init(n.getState()):h==null?void 0:h.init(Gs(c.name));case"COMMIT":if(o===void 0){h==null||h.init(n.getState());return}return h==null?void 0:h.init(Gs(c.name));case"ROLLBACK":return wa(m.state,N=>{if(o===void 0){x(N),h==null||h.init(n.getState());return}x(N[o]),h==null||h.init(Gs(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return wa(m.state,N=>{if(o===void 0){x(N);return}JSON.stringify(n.getState())!==JSON.stringify(N[o])&&x(N[o])});case"IMPORT_STATE":{const{nextLiftedState:N}=m.payload,g=(p=N.computedStates.slice(-1)[0])==null?void 0:p.state;if(!g)return;x(o===void 0?g:g[o]),h==null||h.send(null,N);return}case"PAUSE_RECORDING":return d=!d}return}}),b},Cn=zi,wa=(s,t)=>{let a;try{a=JSON.parse(s)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}a!==void 0&&t(a)};function Ui(s,t){let a;try{a=s()}catch{return}return{getItem:n=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),o=(i=a.getItem(n))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(n,i)=>a.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>a.removeItem(n)}}const Fs=s=>t=>{try{const a=s(t);return a instanceof Promise?a:{then(r){return Fs(r)(a)},catch(r){return this}}}catch(a){return{then(r){return this},catch(r){return Fs(r)(a)}}}},qi=(s,t)=>(a,r,n)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:p=>p,version:0,merge:(p,N)=>({...N,...p}),...t},l=!1;const o=new Set,c=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return s((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),a(...p)},r,n);const h=Fs(i.serialize),f=()=>{const p=i.partialize({...r()});let N;const g=h({state:p,version:i.version}).then(S=>u.setItem(i.name,S)).catch(S=>{N=S});if(N)throw N;return g},d=n.setState;n.setState=(p,N)=>{d(p,N),f()};const x=s((...p)=>{a(...p),f()},r,n);let b;const m=()=>{var p;if(!u)return;l=!1,o.forEach(g=>g(r()));const N=((p=i.onRehydrateStorage)==null?void 0:p.call(i,r()))||void 0;return Fs(u.getItem.bind(u))(i.name).then(g=>{if(g)return i.deserialize(g)}).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==i.version){if(i.migrate)return i.migrate(g.state,g.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return g.state}).then(g=>{var S;return b=i.merge(g,(S=r())!=null?S:x),a(b,!0),f()}).then(()=>{N==null||N(b,void 0),l=!0,c.forEach(g=>g(b))}).catch(g=>{N==null||N(void 0,g)})};return n.persist={setOptions:p=>{i={...i,...p},p.getStorage&&(u=p.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>m(),hasHydrated:()=>l,onHydrate:p=>(o.add(p),()=>{o.delete(p)}),onFinishHydration:p=>(c.add(p),()=>{c.delete(p)})},m(),b||x},Vi=(s,t)=>(a,r,n)=>{let i={storage:Ui(()=>localStorage),partialize:m=>m,version:0,merge:(m,p)=>({...p,...m}),...t},l=!1;const o=new Set,c=new Set;let u=i.storage;if(!u)return s((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),a(...m)},r,n);const h=()=>{const m=i.partialize({...r()});return u.setItem(i.name,{state:m,version:i.version})},f=n.setState;n.setState=(m,p)=>{f(m,p),h()};const d=s((...m)=>{a(...m),h()},r,n);n.getInitialState=()=>d;let x;const b=()=>{var m,p;if(!u)return;l=!1,o.forEach(g=>{var S;return g((S=r())!=null?S:d)});const N=((p=i.onRehydrateStorage)==null?void 0:p.call(i,(m=r())!=null?m:d))||void 0;return Fs(u.getItem.bind(u))(i.name).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==i.version){if(i.migrate)return[!0,i.migrate(g.state,g.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,g.state];return[!1,void 0]}).then(g=>{var S;const[T,v]=g;if(x=i.merge(v,(S=r())!=null?S:d),a(x,!0),T)return h()}).then(()=>{N==null||N(x,void 0),x=r(),l=!0,c.forEach(g=>g(x))}).catch(g=>{N==null||N(void 0,g)})};return n.persist={setOptions:m=>{i={...i,...m},m.storage&&(u=m.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>l,onHydrate:m=>(o.add(m),()=>{o.delete(m)}),onFinishHydration:m=>(c.add(m),()=>{c.delete(m)})},i.skipHydration||b(),x||d},Wi=(s,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Js?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),qi(s,t)):Vi(s,t),Gi=Wi,ka="wpa-unified-auth",Sa={getItem:s=>{try{const t=sessionStorage.getItem(s);return t?JSON.parse(t):null}catch(t){return console.warn("Failed to read from sessionStorage:",t),null}},setItem:(s,t)=>{try{sessionStorage.setItem(s,JSON.stringify(t))}catch(a){console.warn("Failed to write to sessionStorage:",a)}},removeItem:s=>{try{sessionStorage.removeItem(s)}catch(t){console.warn("Failed to remove from sessionStorage:",t)}}},Ca=s=>{try{return JSON.parse(atob(s.split(".")[1]))}catch(t){return console.warn("Failed to decode token:",t),null}},Ft=rr()(Cn((s,t)=>({...(()=>{const r=Sa.getItem(ka);if(r&&r.tokens&&r.user){const n=Ca(r.tokens.access_token);if(n&&n.exp>Math.floor(Date.now()/1e3))return{user:r.user,profile:r.profile||null,tokens:r.tokens,isAuthenticated:!0,isLoading:!1,error:null}}return{user:null,profile:null,tokens:null,isAuthenticated:!1,isLoading:!1,error:null}})(),setAuth:(r,n,i)=>{const l={tokens:r,user:n,profile:i||null,isAuthenticated:!0,isLoading:!1,error:null};Sa.setItem(ka,l),s(l,!1,"setAuth"),console.log("✅ Auth set in unified store for user:",n.email)},clearAuth:()=>{const r={user:null,profile:null,tokens:null,isAuthenticated:!1,isLoading:!1,error:null};Sa.removeItem(ka),["access_token","auth_tokens","refresh_token"].forEach(i=>{try{localStorage.removeItem(i)}catch(l){console.warn(`Failed to clear legacy key ${i}:`,l)}}),s(r,!1,"clearAuth"),console.log("🗑️ Auth cleared from unified store")},setLoading:r=>s({isLoading:r},!1,"setLoading"),setError:r=>s({error:r},!1,"setError"),getAccessToken:()=>{const{tokens:r,isAuthenticated:n}=t();return n&&r?r.access_token:null},getRefreshToken:()=>{const{tokens:r,isAuthenticated:n}=t();return n&&r?r.refresh_token:null},isTokenExpired:()=>{const{tokens:r}=t();if(!r)return!0;const n=Ca(r.access_token);if(!n)return!0;const i=Math.floor(Date.now()/1e3);return n.exp<i},getFullName:()=>{const{user:r}=t();return r?`${r.first_name||""} ${r.last_name||""}`.trim()||r.email:"Guest"},migrateFromLegacy:()=>{console.log("🔄 Migrating from legacy auth systems...");let r=null,n=null;try{const i=localStorage.getItem("auth_tokens");if(i){const l=JSON.parse(i);l.access_token&&l.user&&(r={access_token:l.access_token,refresh_token:l.refresh_token||"",token_type:l.token_type||"bearer",expires_in:l.expires_in||900},n=l.user)}if(!r){const l=localStorage.getItem("access_token");if(l){const o=Ca(l);o&&o.exp>Math.floor(Date.now()/1e3)&&(r={access_token:l,refresh_token:localStorage.getItem("refresh_token")||"",token_type:"bearer",expires_in:900},n={id:parseInt(o.sub||"0"),email:o.email||"unknown@example.com",first_name:o.first_name||"Unknown",last_name:o.last_name||"User",is_active:!0,status:"active",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}}if(!r){const l=localStorage.getItem("wealthpath-auth-store");if(l){const o=JSON.parse(l);o.state&&o.state.tokens&&o.state.user&&(r=o.state.tokens,n=o.state.user)}}return r&&n?(t().setAuth(r,n),console.log("✅ Successfully migrated auth for user:",n.email),["access_token","auth_tokens","refresh_token","wealthpath-auth-store"].forEach(o=>{try{localStorage.removeItem(o)}catch(c){console.warn(`Failed to clear legacy key ${o}:`,c)}}),!0):(console.log("📝 No valid legacy auth found to migrate"),!1)}catch(i){return console.error("❌ Failed to migrate legacy auth:",i),!1}}}),{name:"unified-auth-store"}));console.log("🏪 Unified Auth Store initialized");const et=()=>{const s=window.location.hostname;return s!=="localhost"&&s!=="127.0.0.1"?(console.log("🔗 PRODUCTION MODE (Utility) - Using render backend:",s),"https://wealthpath-backend.onrender.com"):(console.log("🔍 Localhost detected (Utility) - using local backend"),"http://localhost:8000")},Hi=et();console.log("🔗 API Base URL:",Hi);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Yi={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),te=(s,t)=>{const a=w.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:o="",children:c,...u},h)=>w.createElement("svg",{ref:h,...Yi,width:n,height:n,stroke:r,strokeWidth:l?Number(i)*24/Number(n):i,className:["lucide",`lucide-${Zi(s)}`,o].join(" "),...u},[...t.map(([f,d])=>w.createElement(f,d)),...Array.isArray(c)?c:[c]]));return a.displayName=`${s}`,a};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=te("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=te("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=te("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=te("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=te("Bitcoin",[["path",{d:"M11.767 19.089c4.924.868 6.14-6.025 1.216-6.894m-1.216 6.894L5.86 18.047m5.908 1.042-.347 1.97m1.563-8.864c4.924.869 6.14-6.025 1.215-6.893m-1.215 6.893-3.94-.694m5.155-6.2L8.29 4.26m5.908 1.042.348-1.97M7.48 20.364l3.126-17.727",key:"yr8idg"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=te("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=te("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=te("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=te("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=te("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=te("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=te("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=te("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=te("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=te("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=te("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=te("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=te("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=te("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=te("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ji=te("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=te("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=te("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=te("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=te("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=te("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=te("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=te("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=te("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=te("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=te("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=te("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=te("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=te("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=te("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=te("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=te("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=te("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=te("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=te("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=te("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=te("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=te("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=te("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=te("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=te("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z",key:"uf6l00"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h0",key:"k2aug8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=te("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=te("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=te("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=te("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=te("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=te("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=te("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=te("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=te("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=te("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=te("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cl=te("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=te("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=te("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=te("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=te("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=te("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=te("Umbrella",[["path",{d:"M22 12a10.06 10.06 1 0 0-20 0Z",key:"1teyop"}],["path",{d:"M12 12v8a2 2 0 0 0 4 0",key:"ulpmoc"}],["path",{d:"M12 2v1",key:"11qlp1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=te("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=te("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=te("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=te("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=te("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),$=({children:s,variant:t="primary",size:a="md",isLoading:r=!1,leftIcon:n,rightIcon:i,fullWidth:l=!1,className:o,disabled:c,...u})=>{const h="inline-flex items-center justify-center font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",f={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-transparent hover:bg-gray-50 focus:ring-blue-500",ghost:"bg-transparent hover:bg-gray-100 focus:ring-blue-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"},d={sm:"px-3 py-1.5 text-sm rounded-md",md:"px-4 py-2 text-sm rounded-md",lg:"px-6 py-3 text-base rounded-lg"};return e.jsxs("button",{className:jt(h,f[t],d[a],l&&"w-full",o),disabled:c||r,...u,children:[r?e.jsx(Ms,{className:"w-4 h-4 mr-2 animate-spin"}):n?e.jsx("span",{className:"mr-2",children:n}):null,s,i&&!r&&e.jsx("span",{className:"ml-2",children:i})]})},_=({children:s,className:t,padding:a="md",shadow:r="md",hover:n=!1})=>{const i={none:"",sm:"p-3",md:"p-4",lg:"p-6"},l={none:"",sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg"};return e.jsx("div",{className:jt("bg-gray-800 rounded-lg border border-gray-700 text-gray-100",i[a],l[r],n&&"transition-shadow hover:shadow-lg",t),children:s})},dl=({children:s,className:t})=>e.jsx("div",{className:jt("mb-4",t),children:s}),ml=({children:s,className:t})=>e.jsx("h3",{className:jt("text-lg font-semibold text-gray-100",t),children:s}),ul=({children:s,className:t})=>e.jsx("div",{className:t,children:s}),hl=({children:s,className:t})=>e.jsx("div",{className:t,children:s});_.Header=dl;_.Title=ml;_.Content=ul;_.Body=hl;const xl="modulepreload",gl=function(s){return"/"+s},Br={},Mn=function(t,a,r){let n=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=Promise.allSettled(a.map(c=>{if(c=gl(c),c in Br)return;Br[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":xl,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((d,x)=>{f.addEventListener("load",d),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return n.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},ke=({children:s,variant:t="default",size:a="md",className:r})=>{const n="inline-flex items-center font-medium rounded-full",i={default:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800"},l={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-sm",lg:"px-3 py-1 text-sm"};return e.jsx("span",{className:jt(n,i[t],l[a],r),children:s})};var q=(s=>(s.ASSETS="assets",s.LIABILITIES="liabilities",s.INCOME="income",s.EXPENSES="expenses",s.PROFILE="profile",s.BENEFITS="benefits",s.TAX_INFO="tax_info",s))(q||{}),be=(s=>(s.ONE_TIME="one_time",s.DAILY="daily",s.WEEKLY="weekly",s.MONTHLY="monthly",s.QUARTERLY="quarterly",s.ANNUALLY="annually",s))(be||{});class pl{constructor(){this.baseUrl="/api/v1/financial"}async getFinancialSummary(){return G.get(`${this.baseUrl}/summary`)}async getFinancialEntries(t){const a=new URLSearchParams;t!=null&&t.category&&a.append("category",t.category),t!=null&&t.data_quality&&a.append("data_quality",t.data_quality),t!=null&&t.limit&&a.append("limit",t.limit.toString()),t!=null&&t.offset&&a.append("offset",t.offset.toString());const r=a.toString()?`?${a.toString()}`:"";return G.get(`${this.baseUrl}/entries${r}`)}async getCategorizedEntries(){const t=await G.get(`${this.baseUrl}/entries/categorized`);return console.log("Categorized entries data received:",t),t}async createFinancialEntry(t){return G.post(`${this.baseUrl}/entries`,t)}async updateFinancialEntry(t,a){return G.put(`${this.baseUrl}/entries/${t}`,a)}async deleteFinancialEntry(t){return G.delete(`${this.baseUrl}/entries/${t}`)}async getFinancialAccounts(){return G.get(`${this.baseUrl}/accounts`)}async getDataQualityBreakdown(){return G.get(`${this.baseUrl}/data-quality`)}async getNetWorthHistory(t){const a=new URLSearchParams;t!=null&&t.days&&a.append("days",t.days.toString());const r=a.toString()?`?${a.toString()}`:"";return G.get(`${this.baseUrl}/net-worth/history${r}`)}async createNetWorthSnapshot(){return G.post(`${this.baseUrl}/net-worth/snapshot`)}async getPortfolioAllocation(){return G.get(`${this.baseUrl}/portfolio-allocation`)}async triggerDataSync(){return G.post(`${this.baseUrl}/sync`)}}const qs=new pl,fa=rr()(Cn(Gi((s,t)=>({summary:void 0,entries:[],accounts:[],netWorthHistory:[],dataQualityBreakdown:void 0,isLoading:!1,error:void 0,selectedEntry:void 0,isCreateModalOpen:!1,isEditModalOpen:!1,filters:{},loading:{},errors:{},setSelectedEntry:a=>s({selectedEntry:a},!1,"setSelectedEntry"),setCreateModalOpen:a=>s({isCreateModalOpen:a},!1,"setCreateModalOpen"),setEditModalOpen:a=>s({isEditModalOpen:a},!1,"setEditModalOpen"),setFilters:a=>s(r=>({filters:{...r.filters,...a}}),!1,"setFilters"),clearError:a=>s(r=>({errors:{...r.errors,[a]:null}}),!1,"clearError"),clearAllErrors:()=>s({errors:{}},!1,"clearAllErrors"),setSummary:a=>s({summary:a},!1,"setSummary"),setEntries:a=>s({entries:a},!1,"setEntries"),addEntry:a=>s(r=>({entries:[a,...r.entries]}),!1,"addEntry"),updateEntry:(a,r)=>s(n=>({entries:n.entries.map(i=>i.id===a?{...i,...r}:i)}),!1,"updateEntry"),removeEntry:a=>s(r=>({entries:r.entries.filter(n=>n.id!==a)}),!1,"removeEntry"),setAccounts:a=>s({accounts:a},!1,"setAccounts"),setNetWorthHistory:a=>s({netWorthHistory:a},!1,"setNetWorthHistory"),setDataQualityBreakdown:a=>s({dataQualityBreakdown:a},!1,"setDataQualityBreakdown"),setLoading:(a,r)=>s(n=>({loading:{...n.loading,[a]:r},isLoading:r}),!1,"setLoading"),setError:(a,r)=>s(n=>({errors:{...n.errors,[a]:r},error:r||void 0}),!1,"setError"),getTotalAssets:()=>{const{summary:a}=t();return(a==null?void 0:a.total_assets)||0},getTotalLiabilities:()=>{const{summary:a}=t();return(a==null?void 0:a.total_liabilities)||0},getNetWorth:()=>{const{summary:a}=t();return(a==null?void 0:a.net_worth)||0},getEntriesByCategory:a=>{const{entries:r}=t();return r.filter(n=>n.category===a)},getLatestNetWorthSnapshot:()=>{const{netWorthHistory:a}=t();return a.length>0?a[0]:void 0},getEntriesCount:()=>{const{entries:a}=t();return a.length},getConnectedAccountsCount:()=>{const{accounts:a}=t();return a.filter(r=>r.is_active&&!r.is_manual).length}}),{name:"wealthpath-financial-store",partialize:s=>({summary:s.summary,entries:s.entries,accounts:s.accounts,filters:s.filters})}),{name:"financial-store"})),at={all:["financial"],summary:()=>[...at.all,"summary"],entries:s=>[...at.all,"entries",s],categorizedEntries:()=>[...at.all,"entries","categorized"],accounts:()=>[...at.all,"accounts"],dataQuality:()=>[...at.all,"data-quality"],netWorthHistory:s=>[...at.all,"net-worth-history",s],portfolioAllocation:()=>[...at.all,"portfolio-allocation"]},$n=()=>ot({queryKey:at.categorizedEntries(),queryFn:()=>qs.getCategorizedEntries(),staleTime:2*60*1e3,retry:3,retryDelay:s=>Math.min(1e3*2**s,3e4)}),Dn=()=>{const s=ct(),{addEntry:t,setLoading:a,setError:r,filters:n}=fa();return dt({mutationFn:i=>qs.createFinancialEntry(i),onSuccess:i=>{t(i),s.invalidateQueries({queryKey:at.entries(n)}),s.invalidateQueries({queryKey:at.summary()}),s.invalidateQueries({queryKey:at.dataQuality()})}})},fl=()=>{const s=ct(),{updateEntry:t,setLoading:a,setError:r,filters:n}=fa();return dt({mutationFn:({id:i,update:l})=>qs.updateFinancialEntry(i,l),onSuccess:i=>{t(i.id,i),s.invalidateQueries({queryKey:at.entries(n)}),s.invalidateQueries({queryKey:at.summary()})}})},yl=()=>{const s=ct(),{removeEntry:t,setLoading:a,setError:r,filters:n}=fa();return dt({mutationFn:i=>qs.deleteFinancialEntry(i),onSuccess:(i,l)=>{t(l.toString()),s.invalidateQueries({queryKey:at.entries(n)}),s.invalidateQueries({queryKey:at.summary()})}})},bl=()=>ot({queryKey:at.portfolioAllocation(),queryFn:()=>qs.getPortfolioAllocation(),staleTime:2*60*1e3,retry:3,retryDelay:s=>Math.min(1e3*2**s,3e4)}),vl=[{name:"Cash & Bank Accounts",icon:ge,color:"green",subcategories:["Checking Account","Savings Account","Money Market Account","Certificate of Deposit","Checking Offshore"]},{name:"Investment Accounts",icon:Te,color:"purple",subcategories:["Brokerage Account","Individual Stocks","Mutual Funds","ETFs","Bonds","Cryptocurrency"]},{name:"Retirement Accounts",icon:De,color:"blue",subcategories:["401k Account","Traditional IRA","Roth IRA","SEP-IRA","Pension","403b"]},{name:"Real Estate",icon:Gt,color:"emerald",subcategories:["Primary Residence","Rental Property","Vacation Home","Land","REITs"]},{name:"Personal Property",icon:Mt,color:"pink",subcategories:["Jewelry","Art & Collectibles","Vehicles","Electronics","Furniture","Other Valuables"]},{name:"Business Assets",icon:ir,color:"indigo",subcategories:["Business Checking","Business Equipment","Business Real Estate","Business Investments","Inventory","Accounts Receivable"]},{name:"Other Assets",icon:Pn,color:"gray",subcategories:["Other Investment","Miscellaneous Assets","Digital Assets","Intellectual Property"]}],jl=[{name:"Mortgage & Real Estate",icon:Gt,color:"red",subcategories:["Primary Mortgage","Investment Property Loan","HELOC","Home Equity Loan"]},{name:"Credit Cards",icon:Wa,color:"orange",subcategories:["Personal Credit Cards","Business Credit Cards","Store Cards"]},{name:"Loans",icon:lr,color:"yellow",subcategories:["Auto Loan","Personal Loan","Student Loans","Business Loans"]}],Nl=[{name:"Employment Income",icon:ir,color:"blue",subcategories:["Salary","Hourly Wages","Bonus","Commission","Stock Options","Benefits"]},{name:"Investment Income",icon:Te,color:"green",subcategories:["Dividends","Interest","Capital Gains","Rental Income","Crypto Gains"]},{name:"Business Income",icon:ge,color:"purple",subcategories:["Self-Employment","Consulting","Side Hustle","Passive Income"]}],_l=[{name:"Housing",icon:Gt,color:"blue",subcategories:["Rent","Mortgage","Property Tax","HOA","Home Insurance","Maintenance","Repairs"]},{name:"Utilities",icon:pa,color:"yellow",subcategories:["Electricity","Gas","Water","Internet","Phone","Trash","Sewer"]},{name:"Transportation",icon:lr,color:"green",subcategories:["Car Payment","Gas","Car Insurance","Maintenance","Public Transit","Uber/Lyft"]},{name:"Food & Dining",icon:Ji,color:"orange",subcategories:["Groceries","Restaurants","Coffee","Meal Delivery","Work Meals"]},{name:"Healthcare",icon:Mt,color:"red",subcategories:["Health Insurance","Doctor Visits","Medications","Dental","Vision","Mental Health"]},{name:"Personal",icon:ol,color:"purple",subcategories:["Shopping","Clothing","Personal Care","Subscriptions","Entertainment","Travel"]}],wl=({onAddEntry:s,onEditEntry:t})=>{var S,T,v,L,P,z,C,j,E,A,y,R,k,F,O,J,U,D,V,he,ye,Ie,de,Oe,Fe,se,ve;const[a,r]=w.useState(q.ASSETS),[n,i]=w.useState(new Set),{data:l,isLoading:o,refetch:c}=$n(),u=yl();console.log("🏗️ StructuredEntrySystem - Categorized Data:",l),console.log("🏗️ StructuredEntrySystem - Asset Categories:",(S=l==null?void 0:l.categories)==null?void 0:S.assets);const h=l!=null&&l.categories?[...((T=l.categories.assets)==null?void 0:T.cash_bank_accounts)||[],...((v=l.categories.assets)==null?void 0:v.investment_accounts)||[],...((L=l.categories.assets)==null?void 0:L.retirement_accounts)||[],...((P=l.categories.assets)==null?void 0:P.real_estate)||[],...((z=l.categories.assets)==null?void 0:z.personal_property)||[],...((C=l.categories.assets)==null?void 0:C.business_assets)||[],...((j=l.categories.assets)==null?void 0:j.other_assets)||[],...((E=l.categories.liabilities)==null?void 0:E.mortgage_real_estate)||[],...((A=l.categories.liabilities)==null?void 0:A.credit_cards)||[],...((y=l.categories.liabilities)==null?void 0:y.auto_loans)||[],...((R=l.categories.liabilities)==null?void 0:R.student_loans)||[],...((k=l.categories.liabilities)==null?void 0:k.personal_loans)||[],...((F=l.categories.liabilities)==null?void 0:F.other_debt)||[],...((O=l.categories.income)==null?void 0:O.employment_income)||[],...((J=l.categories.income)==null?void 0:J.business_income)||[],...((U=l.categories.income)==null?void 0:U.investment_income)||[],...((D=l.categories.income)==null?void 0:D.rental_income)||[],...((V=l.categories.income)==null?void 0:V.passive_income)||[],...((he=l.categories.income)==null?void 0:he.other_income)||[],...((ye=l.categories.expenses)==null?void 0:ye.housing)||[],...((Ie=l.categories.expenses)==null?void 0:Ie.utilities)||[],...((de=l.categories.expenses)==null?void 0:de.transportation)||[],...((Oe=l.categories.expenses)==null?void 0:Oe.food)||[],...((Fe=l.categories.expenses)==null?void 0:Fe.healthcare)||[],...((se=l.categories.expenses)==null?void 0:se.personal)||[],...((ve=l.categories.expenses)==null?void 0:ve.other_expenses)||[]]:[];w.useMemo(()=>{const ie={};return h.forEach(X=>{const ce=X.subcategory||"Other";ie[ce]||(ie[ce]={});const ae=X.subcategory||"General";ie[ce][ae]||(ie[ce][ae]=[]),ie[ce][ae].push(X)}),ie},[h]);const f=ie=>{if(!(l!=null&&l.categories))return{total:0,count:0};let X=[];switch(ie){case q.ASSETS:const ae=l.categories.assets;X=[...ae.cash_bank_accounts||[],...ae.investment_accounts||[],...ae.retirement_accounts||[],...ae.real_estate||[],...ae.personal_property||[],...ae.business_assets||[],...ae.other_assets||[]];break;case q.LIABILITIES:const Ve=l.categories.liabilities;X=[...Ve.mortgage_real_estate||[],...Ve.credit_cards||[],...Ve.auto_loans||[],...Ve.student_loans||[],...Ve.personal_loans||[],...Ve.other_debt||[]];break;case q.INCOME:const ne=l.categories.income;X=[...ne.employment_income||[],...ne.business_income||[],...ne.investment_income||[],...ne.rental_income||[],...ne.passive_income||[],...ne.other_income||[]];break;case q.EXPENSES:const Xe=l.categories.expenses;X=[...Xe.housing||[],...Xe.utilities||[],...Xe.transportation||[],...Xe.food||[],...Xe.healthcare||[],...Xe.personal||[],...Xe.other_expenses||[]];break}return{total:X.reduce((ae,Ve)=>ae+Ve.amount,0),count:X.length}},d=ie=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(ie),x=async ie=>{const{profileApi:X}=await Mn(async()=>{const{profileApi:ae}=await Promise.resolve().then(()=>On);return{profileApi:ae}},void 0);let ce={};switch(ie.id){case"profile-age":ce.age=null;break;case"profile-state":ce.state=null;break;case"profile-notes":ce.notes=null;break;case"profile-marital":ce.marital_status=null;break;case"profile-employment":ce.employment_status=null;break;case"profile-occupation":ce.occupation=null;break;case"profile-gender":ce.gender=null;break;case"profile-phone":ce.phone=null;break;case"profile-city":ce.city=null;break;case"profile-risk":ce.risk_tolerance=null;break;default:throw new Error(`Unknown profile field: ${ie.id}`)}return console.log("🔄 Clearing profile field:",ie.id,"with data:",ce),X.updateProfile(ce)},b=async ie=>{if(console.log("🗑️ Delete button clicked for entry:",ie),console.log("🗑️ Entry ID:",ie.id,"Type:",typeof ie.id),typeof ie.id=="string"&&ie.id.startsWith("profile-")){if(console.log("🗑️ Handling profile entry deletion/clearing"),window.confirm(`Are you sure you want to clear "${ie.description}" from your profile?`))try{await x(ie),console.log("✅ Profile field cleared successfully"),c()}catch(X){console.error("❌ Failed to clear profile field:",X),alert("Failed to clear profile field. Please try again.")}return}if(window.confirm(`Are you sure you want to delete "${ie.description}"?`))try{console.log("🗑️ Deleting entry with ID:",ie.id);const X=localStorage.getItem("auth_tokens");console.log("🔐 Auth tokens present:",!!X);const ce=parseInt(ie.id);if(isNaN(ce))throw new Error(`Invalid entry ID: ${ie.id}`);const ae=await u.mutateAsync(ce);console.log("✅ Delete successful:",ae),c()}catch(X){console.error("❌ Failed to delete entry:",X);let ce="Failed to delete entry: ";(X==null?void 0:X.status_code)===401?ce+="Not authenticated. Please log in again.":(X==null?void 0:X.status_code)===404?(ce+="Entry not found. It may have already been deleted.",c()):X!=null&&X.detail?ce+=X.detail:X instanceof Error?ce+=X.message:ce+="Unknown error",alert(ce)}},m=ie=>{const X=new Set(n);X.has(ie)?X.delete(ie):X.add(ie),i(X)},p=(ie,X)=>{const ce=f(X);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-gray-800 to-gray-700 p-6 rounded-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[X.charAt(0).toUpperCase()+X.slice(1)," Overview"]}),e.jsxs($,{onClick:()=>s==null?void 0:s(X),size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Add ",X===q.PROFILE?"Profile":X===q.BENEFITS?"Benefit":X===q.TAX_INFO?"Tax Info":X===q.ASSETS?"Asset":X===q.LIABILITIES?"Liability":X===q.INCOME?"Income":X===q.EXPENSES?"Expense":X.slice(0,-1)]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:`text-2xl font-bold ${X===q.ASSETS||X===q.INCOME?"text-green-400":"text-red-400"}`,children:d(ce.total)}),e.jsx("div",{className:"text-sm text-gray-200 font-medium",children:"Total Value"})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:ce.count}),e.jsx("div",{className:"text-sm text-gray-200 font-medium",children:"Entries"})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:ie.length}),e.jsx("div",{className:"text-sm text-gray-200 font-medium",children:"Categories"})]})]})]}),e.jsx("div",{className:"space-y-4",children:ie.map(ae=>{var Ot,yt,I,M,B,K,Z,H,le,_e,Ce,Ke,kt,nt,Zt,Me,mt,Kt,Qt,ls,Jt,wr,kr,Sr,Cr;const Ve=ae.icon;let ne=[];if(l!=null&&l.categories)switch(X){case q.ASSETS:ae.name==="Cash & Bank Accounts"?ne=((Ot=l.categories.assets)==null?void 0:Ot.cash_bank_accounts)||[]:ae.name==="Investment Accounts"?ne=((yt=l.categories.assets)==null?void 0:yt.investment_accounts)||[]:ae.name==="Retirement Accounts"?ne=((I=l.categories.assets)==null?void 0:I.retirement_accounts)||[]:ae.name==="Real Estate"?ne=((M=l.categories.assets)==null?void 0:M.real_estate)||[]:ae.name==="Personal Property"?ne=((B=l.categories.assets)==null?void 0:B.personal_property)||[]:ae.name==="Business Assets"?ne=((K=l.categories.assets)==null?void 0:K.business_assets)||[]:ae.name==="Other Assets"?ne=((Z=l.categories.assets)==null?void 0:Z.other_assets)||[]:ne=((H=l.categories.assets)==null?void 0:H.other_assets)||[];break;case q.EXPENSES:ae.name==="Housing"?ne=((le=l.categories.expenses)==null?void 0:le.housing)||[]:ae.name==="Utilities"?ne=((_e=l.categories.expenses)==null?void 0:_e.utilities)||[]:ae.name==="Transportation"?ne=((Ce=l.categories.expenses)==null?void 0:Ce.transportation)||[]:ae.name==="Food & Dining"?ne=((Ke=l.categories.expenses)==null?void 0:Ke.food)||[]:ae.name==="Healthcare"?ne=((kt=l.categories.expenses)==null?void 0:kt.healthcare)||[]:ae.name==="Personal"?ne=((nt=l.categories.expenses)==null?void 0:nt.personal)||[]:ne=((Zt=l.categories.expenses)==null?void 0:Zt.other_expenses)||[];break;case q.LIABILITIES:ae.name==="Mortgage & Real Estate"?ne=((Me=l.categories.liabilities)==null?void 0:Me.mortgage_real_estate)||[]:ae.name==="Credit Cards"?ne=((mt=l.categories.liabilities)==null?void 0:mt.credit_cards)||[]:ae.name==="Loans"?ne=[...((Kt=l.categories.liabilities)==null?void 0:Kt.auto_loans)||[],...((Qt=l.categories.liabilities)==null?void 0:Qt.student_loans)||[],...((ls=l.categories.liabilities)==null?void 0:ls.personal_loans)||[]]:ne=((Jt=l.categories.liabilities)==null?void 0:Jt.other_debt)||[];break;case q.INCOME:ae.name==="Employment Income"?ne=((wr=l.categories.income)==null?void 0:wr.employment_income)||[]:ae.name==="Investment Income"?ne=((kr=l.categories.income)==null?void 0:kr.investment_income)||[]:ae.name==="Business Income"?ne=((Sr=l.categories.income)==null?void 0:Sr.business_income)||[]:ne=((Cr=l.categories.income)==null?void 0:Cr.other_income)||[];break;case q.PROFILE:if(profileData!=null&&profileData.profile){const me=profileData.profile;if(ne=[],ae.name==="Personal Information")me.age&&ne.push({id:"profile-age",description:"Age",amount:0,notes:me.age.toString(),frequency:"one_time"}),me.gender&&ne.push({id:"profile-gender",description:"Gender",amount:0,notes:me.gender,frequency:"one_time"}),me.marital_status&&ne.push({id:"profile-marital",description:"Marital Status",amount:0,notes:me.marital_status,frequency:"one_time"}),me.notes&&ne.push({id:"profile-notes",description:"Name",amount:0,notes:me.notes.replace("Name: ",""),frequency:"one_time"});else if(ae.name==="Contact & Location")me.state&&ne.push({id:"profile-state",description:"State",amount:0,notes:me.state,frequency:"one_time"}),me.city&&ne.push({id:"profile-city",description:"City",amount:0,notes:me.city,frequency:"one_time"}),me.phone&&ne.push({id:"profile-phone",description:"Phone",amount:0,notes:me.phone,frequency:"one_time"});else if(ae.name==="Employment")me.employment_status&&ne.push({id:"profile-employment",description:"Employment Status",amount:0,notes:me.employment_status,frequency:"one_time"}),me.occupation&&ne.push({id:"profile-occupation",description:"Occupation",amount:0,notes:me.occupation,frequency:"one_time"});else if(ae.name==="Investment Profile")me.risk_tolerance&&ne.push({id:"profile-risk",description:"Risk Tolerance",amount:0,notes:me.risk_tolerance,frequency:"one_time"});else if(ae.name==="Spouse/Partner")if(console.log("🏗️ Building spouse entries, familyData:",familyData),familyData&&Array.isArray(familyData)){const Xt=familyData.filter(We=>We.relationship_type==="spouse"||We.relationship_type==="partner");console.log("🏗️ Found spouses:",Xt),ne=Xt.map(We=>({id:`family-${We.id}`,description:We.name||"Spouse",amount:We.income||0,notes:We.age?`Age: ${We.age}`:We.notes||"No details",frequency:"annual"})),console.log("🏗️ Spouse entries created:",ne)}else console.log("🏗️ No family data available for spouse section");else if(ae.name==="Dependents")if(console.log("🏗️ Building dependent entries, familyData:",familyData),familyData&&Array.isArray(familyData)){const Xt=familyData.filter(We=>We.relationship_type==="child"||We.relationship_type==="dependent"||We.relationship_type==="other_dependent");console.log("🏗️ Found dependents:",Xt),ne=Xt.map(We=>({id:`family-${We.id}`,description:We.name||"Dependent",amount:We.education_fund_target||0,notes:We.age?`Age: ${We.age}`:We.notes||"No details",frequency:"one_time"})),console.log("🏗️ Dependent entries created:",ne)}else console.log("🏗️ No family data available for dependents section")}break;case q.BENEFITS:benefitsData&&Array.isArray(benefitsData)&&(ne=benefitsData.map(me=>({id:`benefit-${me.id}`,description:me.benefit_name||me.benefit_type,amount:me.estimated_monthly_benefit||0,notes:me.notes||"",frequency:"monthly"})));break;case q.TAX_INFO:taxData&&Array.isArray(taxData)&&(ne=taxData.map(me=>({id:`tax-${me.id}`,description:`Tax Year ${me.tax_year}`,amount:me.adjusted_gross_income||0,notes:`${me.federal_tax_bracket||0}% tax bracket`,frequency:"annually"})));break;default:ne=[]}const Xe=ne.reduce((me,Xt)=>me+Xt.amount,0),Ze=n.has(ae.name);return e.jsxs(_,{className:"overflow-hidden",children:[e.jsx("div",{className:`p-4 bg-${ae.color}-900/10 border-b border-gray-700 cursor-pointer hover:bg-${ae.color}-900/20 transition-colors`,onClick:()=>m(ae.name),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Ze?e.jsx(zt,{className:"w-5 h-5 text-gray-300"}):e.jsx(or,{className:"w-5 h-5 text-gray-300"}),e.jsx(Ve,{className:`w-6 h-6 text-${ae.color}-500`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg text-gray-100",children:ae.name}),e.jsxs("span",{className:"text-sm text-gray-200 font-medium",children:[ne.length," entries"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-xl font-bold ${X===q.ASSETS||X===q.INCOME?"text-green-500":"text-red-500"}`,children:d(Xe)}),e.jsx($,{size:"sm",variant:"ghost",onClick:me=>{me.stopPropagation(),s==null||s(X,ae.name)},className:"text-xs",children:"+ Add"})]})]})}),Ze&&e.jsx("div",{className:"p-4 bg-gray-800",children:ne.length>0?e.jsx("div",{className:"space-y-3",children:ne.map(me=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-base",style:{color:"white !important"},children:me.description}),e.jsxs("div",{className:"text-sm font-medium",style:{color:"#f3f4f6 !important"},children:[me.frequency!==be.ONE_TIME&&e.jsx("span",{className:"mr-2",style:{color:"#f3f4f6 !important"},children:me.frequency}),me.notes&&e.jsx("span",{className:"italic",style:{color:"#f3f4f6 !important"},children:me.notes})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`text-xl font-bold ${X===q.PROFILE||X===q.BENEFITS||X===q.TAX_INFO?"!text-blue-200":X===q.ASSETS||X===q.INCOME?"!text-green-200":"!text-red-200"}`,children:X===q.PROFILE?me.notes:d(me.amount)}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{variant:"ghost",size:"sm",onClick:()=>{console.log("✏️ Edit button clicked in StructuredEntrySystem"),t==null||t(me)},className:"p-1",children:e.jsx(ga,{className:"w-4 h-4"})}),e.jsx($,{variant:"ghost",size:"sm",onClick:()=>{console.log("🗑️ Delete button clicked in StructuredEntrySystem"),b(me)},className:"p-1 text-red-600 hover:text-red-700",children:e.jsx(ws,{className:"w-4 h-4"})})]})]})]},me.id))}):e.jsxs("div",{className:"text-center py-6 !text-gray-100",children:[e.jsxs("div",{className:"mb-2 font-medium !text-white",children:["No ",ae.name.toLowerCase()," entries yet"]}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:ae.subcategories.slice(0,3).map(me=>e.jsxs($,{size:"sm",variant:"outline",onClick:()=>s==null?void 0:s(X,me),className:"text-xs",children:["+ ",me]},me))})]})})]},ae.name)})})]})};if(o)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const N=[{id:q.ASSETS,label:"Assets",icon:"📈",color:"green"},{id:q.LIABILITIES,label:"Liabilities",icon:"📉",color:"red"},{id:q.INCOME,label:"Income",icon:"💰",color:"blue"},{id:q.EXPENSES,label:"Expenses",icon:"💸",color:"orange"}],g=ie=>{switch(ie){case q.ASSETS:return vl;case q.LIABILITIES:return jl;case q.INCOME:return Nl;case q.EXPENSES:return _l;default:return[]}};return e.jsxs("div",{className:"structured-entry-system",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Financial Data Entry"}),e.jsx("p",{className:"text-gray-300",children:"Organize and manage your financial information by category"})]}),e.jsx("div",{className:"border-b border-gray-700 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:N.map(ie=>{const X=f(ie.id);return e.jsxs("button",{onClick:()=>r(ie.id),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${a===ie.id?"border-blue-500 text-blue-400":"border-transparent text-gray-200 hover:text-gray-100 hover:border-gray-500"}`,children:[e.jsx("span",{className:"text-lg",children:ie.icon}),ie.label,e.jsx(ke,{variant:a===ie.id?"default":"secondary",size:"sm",children:X.count})]},ie.id)})})}),e.jsx("div",{className:"tab-content",children:p(g(a),a)})]})},W=xe.forwardRef(({label:s,error:t,helperText:a,leftIcon:r,rightIcon:n,fullWidth:i=!0,className:l,id:o,...c},u)=>{const h=o||`input-${Math.random().toString(36).substr(2,9)}`;return e.jsxs("div",{className:jt("flex flex-col",i?"w-full":"w-auto"),children:[s&&e.jsx("label",{htmlFor:h,className:"block text-sm font-medium text-gray-200 mb-1",children:s}),e.jsxs("div",{className:"relative",children:[r&&e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:r}),e.jsx("input",{id:h,ref:u,className:jt("block w-full rounded-md border-gray-300 bg-white text-gray-900 shadow-sm transition-colors","focus:border-blue-500 focus:ring-blue-500 focus:ring-2","placeholder:text-gray-500",r&&"pl-10",n&&"pr-10",t&&"border-red-500 focus:border-red-500 focus:ring-red-500","disabled:bg-gray-600 disabled:text-gray-400",l),...c}),n&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:n})]}),(t||a)&&e.jsx("p",{className:jt("mt-1 text-xs",t?"text-red-400":"text-gray-300"),children:t||a})]})});W.displayName="Input";const $e=xe.forwardRef(({label:s,error:t,helperText:a,options:r,placeholder:n,fullWidth:i=!0,className:l,id:o,...c},u)=>{const h=o||`select-${Math.random().toString(36).substr(2,9)}`;return e.jsxs("div",{className:jt("flex flex-col",i?"w-full":"w-auto"),children:[s&&e.jsx("label",{htmlFor:h,className:"block text-sm font-medium text-gray-200 mb-1",children:s}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:h,ref:u,className:jt("block w-full rounded-md border-gray-300 bg-white text-gray-900 shadow-sm transition-colors appearance-none","focus:border-blue-500 focus:ring-blue-500 focus:ring-2","pr-10 py-2 pl-3",t&&"border-red-500 focus:border-red-500 focus:ring-red-500","disabled:bg-gray-600 disabled:text-gray-400",l),...c,children:[n&&e.jsx("option",{value:"",disabled:!0,children:n}),r.map(f=>e.jsx("option",{value:f.value,disabled:f.disabled,children:f.label},f.value))]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:e.jsx(zt,{className:"w-4 h-4"})})]}),(t||a)&&e.jsx("p",{className:jt("mt-1 text-xs",t?"text-red-400":"text-gray-300"),children:t||a})]})});$e.displayName="Select";const Qe={getProfile:async()=>{try{const s=await G.get("/api/v1/profile/profile");return console.log("📱 Profile API response:",s),s||null}catch(s){return console.error("❌ Profile API error:",s),null}},createOrUpdateProfile:async s=>{try{return await G.post("/api/v1/profile/profile",s)||null}catch(t){throw console.error("❌ Create profile error:",t),t}},updateProfile:async s=>{try{return await G.patch("/api/v1/profile/profile",s)||null}catch(t){throw console.error("❌ Update profile error:",t),t}},getFamilyMembers:async()=>{try{return await G.get("/api/v1/profile/family")||[]}catch(s){return console.error("❌ Family members API error:",s),[]}},addFamilyMember:async s=>await G.post("/api/v1/profile/family",s),updateFamilyMember:async(s,t)=>await G.patch(`/api/v1/profile/family/${s}`,t),deleteFamilyMember:async s=>await G.delete(`/api/v1/profile/family/${s}`),getBenefits:async()=>await G.get("/api/v1/profile/benefits"),addBenefit:async s=>await G.post("/api/v1/profile/benefits",s),updateBenefit:async(s,t)=>await G.patch(`/api/v1/profile/benefits/${s}`,t),deleteBenefit:async s=>await G.delete(`/api/v1/profile/benefits/${s}`),getTaxInfo:async s=>{const t=s?{tax_year:s}:{};return await G.get("/api/v1/profile/tax-info",{params:t})},addTaxInfo:async s=>await G.post("/api/v1/profile/tax-info",s),updateTaxInfo:async(s,t)=>await G.patch(`/api/v1/profile/tax-info/${s}`,t),deleteTaxInfo:async s=>await G.delete(`/api/v1/profile/tax-info/${s}`),getCompleteProfile:async()=>await G.get("/api/v1/profile/complete-profile"),createEntry:async s=>{const{category:t,subcategory:a,description:r,notes:n}=s;switch(console.log("🔍 PROFILE API DEBUG - Entry data received:",{category:t,subcategory:a,description:r,notes:n,fullData:s}),t){case"profile":const i=n||"";if(console.log("🔍 Checking spouse routing conditions:"),console.log('  - subcategory === "Spouse/Partner":',a==="Spouse/Partner"),console.log('  - subcategory includes "Spouse":',a&&a.toLowerCase().includes("spouse")),console.log('  - description includes "spouse":',r.toLowerCase().includes("spouse")),a==="Spouse/Partner"||a&&a.toLowerCase().includes("spouse")||r.toLowerCase().includes("spouse")||a==="Dependents"||a&&a.toLowerCase().includes("dependent")||r.toLowerCase().includes("child")||r.toLowerCase().includes("dependent")){console.log("✅ ROUTING TO FAMILY MEMBER API - Family entry detected"),console.log("🔍 Entry type determined by:",{subcategory:a,description:r});let u="spouse";(a==="Dependents"||a&&a.toLowerCase().includes("dependent")||r.toLowerCase().includes("child")||r.toLowerCase().includes("dependent"))&&(u="child");let h={relationship_type:u,name:r.toLowerCase().includes("spouse")?"Spouse":r.toLowerCase().includes("child")?"Child":void 0};if(r.toLowerCase().includes("name")&&r.toLowerCase().includes("age")){console.log("🔍 Parsing combined name and age entry:",i);const f=i.split(/[,\s]+/).filter(d=>d.trim());for(const d of f){const x=d.trim(),b=parseInt(x);!isNaN(b)&&b>0&&b<120?(h.age=b,console.log("📝 Extracted spouse age:",b)):x&&isNaN(parseInt(x))&&(h.name=x,console.log("📝 Extracted spouse name:",x))}!h.age&&!h.name&&(h.notes=`${r}: ${i}`)}else if(r.toLowerCase().includes("age")){const f=parseInt(i);isNaN(f)||(h.age=f)}else if(r.toLowerCase().includes("name"))h.name=i;else if(r.toLowerCase().includes("income")){const f=parseFloat(i);isNaN(f)||(h.income=f)}else if(r.toLowerCase().includes("retirement")||r.toLowerCase().includes("savings")){const f=parseFloat(i);isNaN(f)||(h.retirement_savings=f)}else h.notes=`${r}: ${i}`;return console.log("📤 Creating family member with data:",h),Qe.addFamilyMember(h)}let l={};switch(a){case"Personal Information":if(r.toLowerCase().includes("age")){const u=parseInt(i);isNaN(u)||(l.age=u)}else r.toLowerCase().includes("state")?l.state=i:r.toLowerCase().includes("marital")?l.marital_status=i:r.toLowerCase().includes("employment")?l.employment_status=i:r.toLowerCase().includes("occupation")?l.occupation=i:r.toLowerCase().includes("risk")?l.risk_tolerance=i:r.toLowerCase().includes("gender")?l.gender=i:r.toLowerCase().includes("name")?l={notes:`${r}: ${i}`}:l={notes:`${r}: ${i}`};break;case"Contact & Location":r.toLowerCase().includes("phone")?l.phone=i:r.toLowerCase().includes("address")?l.address=i:r.toLowerCase().includes("city")?l.city=i:r.toLowerCase().includes("zip")?l.zip_code=i:r.toLowerCase().includes("emergency")&&(l.emergency_contact=i);break;default:l={notes:`${r}: ${i}`}}return Qe.createOrUpdateProfile(l);case"benefits":return Qe.addBenefit({benefit_type:a||"other",benefit_name:r,estimated_monthly_benefit:parseFloat(n)||void 0,notes:n});case"tax_info":let o={tax_year:new Date().getFullYear(),notes:`${r}: ${n}`};const c=parseFloat(n);return isNaN(c)||(r.toLowerCase().includes("bracket")?o.federal_tax_bracket=c:r.toLowerCase().includes("rate")?o.effective_tax_rate=c:r.toLowerCase().includes("income")&&(o.adjusted_gross_income=c)),Qe.addTaxInfo(o);default:throw new Error(`Unsupported category: ${t}`)}}},On=Object.freeze(Object.defineProperty({__proto__:null,profileApi:Qe},Symbol.toStringTag,{value:"Module"})),kl={all:["profile"]},Sl=()=>{const s=ct();return dt({mutationFn:t=>Qe.createEntry(t),onSuccess:()=>{s.invalidateQueries({queryKey:kl.all})}})};var Vs=s=>s.type==="checkbox",ts=s=>s instanceof Date,rt=s=>s==null;const Bn=s=>typeof s=="object";var Ue=s=>!rt(s)&&!Array.isArray(s)&&Bn(s)&&!ts(s),zn=s=>Ue(s)&&s.target?Vs(s.target)?s.target.checked:s.target.value:s,Cl=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,Un=(s,t)=>s.has(Cl(t)),Al=s=>{const t=s.constructor&&s.constructor.prototype;return Ue(t)&&t.hasOwnProperty("isPrototypeOf")},mr=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ye(s){let t;const a=Array.isArray(s),r=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)t=new Date(s);else if(!(mr&&(s instanceof Blob||r))&&(a||Ue(s)))if(t=a?[]:Object.create(Object.getPrototypeOf(s)),!a&&!Al(s))t=s;else for(const n in s)s.hasOwnProperty(n)&&(t[n]=Ye(s[n]));else return s;return t}var ya=s=>/^\w*$/.test(s),ze=s=>s===void 0,ur=s=>Array.isArray(s)?s.filter(Boolean):[],hr=s=>ur(s.replace(/["|']|\]/g,"").split(/\.|\[/)),Q=(s,t,a)=>{if(!t||!Ue(s))return a;const r=(ya(t)?[t]:hr(t)).reduce((n,i)=>rt(n)?n:n[i],s);return ze(r)||r===s?ze(s[t])?a:s[t]:r},ut=s=>typeof s=="boolean",Ee=(s,t,a)=>{let r=-1;const n=ya(t)?[t]:hr(t),i=n.length,l=i-1;for(;++r<i;){const o=n[r];let c=a;if(r!==l){const u=s[o];c=Ue(u)||Array.isArray(u)?u:isNaN(+n[r+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;s[o]=c,s=s[o]}};const na={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},bt={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Et={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},qn=xe.createContext(null);qn.displayName="HookFormContext";const xr=()=>xe.useContext(qn);var Vn=(s,t,a,r=!0)=>{const n={defaultValues:t._defaultValues};for(const i in s)Object.defineProperty(n,i,{get:()=>{const l=i;return t._proxyFormState[l]!==bt.all&&(t._proxyFormState[l]=!r||bt.all),a&&(a[l]=!0),s[l]}});return n};const gr=typeof window<"u"?xe.useLayoutEffect:xe.useEffect;function Tl(s){const t=xr(),{control:a=t.control,disabled:r,name:n,exact:i}=s||{},[l,o]=xe.useState(a._formState),c=xe.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return gr(()=>a._subscribe({name:n,formState:c.current,exact:i,callback:u=>{!r&&o({...a._formState,...u})}}),[n,r,i]),xe.useEffect(()=>{c.current.isValid&&a._setValid(!0)},[a]),xe.useMemo(()=>Vn(l,a,c.current,!1),[l,a])}var Ct=s=>typeof s=="string",Wn=(s,t,a,r,n)=>Ct(s)?(r&&t.watch.add(s),Q(a,s,n)):Array.isArray(s)?s.map(i=>(r&&t.watch.add(i),Q(a,i))):(r&&(t.watchAll=!0),a),Ga=s=>rt(s)||!Bn(s);function Pt(s,t,a=new WeakSet){if(Ga(s)||Ga(t))return s===t;if(ts(s)&&ts(t))return s.getTime()===t.getTime();const r=Object.keys(s),n=Object.keys(t);if(r.length!==n.length)return!1;if(a.has(s)||a.has(t))return!0;a.add(s),a.add(t);for(const i of r){const l=s[i];if(!n.includes(i))return!1;if(i!=="ref"){const o=t[i];if(ts(l)&&ts(o)||Ue(l)&&Ue(o)||Array.isArray(l)&&Array.isArray(o)?!Pt(l,o,a):l!==o)return!1}}return!0}function Il(s){const t=xr(),{control:a=t.control,name:r,defaultValue:n,disabled:i,exact:l,compute:o}=s||{},c=xe.useRef(n),u=xe.useRef(o),h=xe.useRef(void 0);u.current=o;const f=xe.useMemo(()=>a._getWatch(r,c.current),[a,r]),[d,x]=xe.useState(u.current?u.current(f):f);return gr(()=>a._subscribe({name:r,formState:{values:!0},exact:l,callback:b=>{if(!i){const m=Wn(r,a._names,b.values||a._formValues,!1,c.current);if(u.current){const p=u.current(m);Pt(p,h.current)||(x(p),h.current=p)}else x(m)}}}),[a,i,r,l]),xe.useEffect(()=>a._removeUnmounted()),d}function El(s){const t=xr(),{name:a,disabled:r,control:n=t.control,shouldUnregister:i,defaultValue:l}=s,o=Un(n._names.array,a),c=xe.useMemo(()=>Q(n._formValues,a,Q(n._defaultValues,a,l)),[n,a,l]),u=Il({control:n,name:a,defaultValue:c,exact:!0}),h=Tl({control:n,name:a,exact:!0}),f=xe.useRef(s),d=xe.useRef(n.register(a,{...s.rules,value:u,...ut(s.disabled)?{disabled:s.disabled}:{}}));f.current=s;const x=xe.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Q(h.errors,a)},isDirty:{enumerable:!0,get:()=>!!Q(h.dirtyFields,a)},isTouched:{enumerable:!0,get:()=>!!Q(h.touchedFields,a)},isValidating:{enumerable:!0,get:()=>!!Q(h.validatingFields,a)},error:{enumerable:!0,get:()=>Q(h.errors,a)}}),[h,a]),b=xe.useCallback(g=>d.current.onChange({target:{value:zn(g),name:a},type:na.CHANGE}),[a]),m=xe.useCallback(()=>d.current.onBlur({target:{value:Q(n._formValues,a),name:a},type:na.BLUR}),[a,n._formValues]),p=xe.useCallback(g=>{const S=Q(n._fields,a);S&&g&&(S._f.ref={focus:()=>g.focus&&g.focus(),select:()=>g.select&&g.select(),setCustomValidity:T=>g.setCustomValidity(T),reportValidity:()=>g.reportValidity()})},[n._fields,a]),N=xe.useMemo(()=>({name:a,value:u,...ut(r)||h.disabled?{disabled:h.disabled||r}:{},onChange:b,onBlur:m,ref:p}),[a,r,h.disabled,b,m,p,u]);return xe.useEffect(()=>{const g=n._options.shouldUnregister||i;n.register(a,{...f.current.rules,...ut(f.current.disabled)?{disabled:f.current.disabled}:{}});const S=(T,v)=>{const L=Q(n._fields,T);L&&L._f&&(L._f.mount=v)};if(S(a,!0),g){const T=Ye(Q(n._options.defaultValues,a));Ee(n._defaultValues,a,T),ze(Q(n._formValues,a))&&Ee(n._formValues,a,T)}return!o&&n.register(a),()=>{(o?g&&!n._state.action:g)?n.unregister(a):S(a,!1)}},[a,n,o,i]),xe.useEffect(()=>{n._setDisabledField({disabled:r,name:a})},[r,a,n]),xe.useMemo(()=>({field:N,formState:h,fieldState:x}),[N,h,x])}const gt=s=>s.render(El(s));var Gn=(s,t,a,r,n)=>t?{...a[s],types:{...a[s]&&a[s].types?a[s].types:{},[r]:n||!0}}:{},Ps=s=>Array.isArray(s)?s:[s],zr=()=>{let s=[];return{get observers(){return s},next:n=>{for(const i of s)i.next&&i.next(n)},subscribe:n=>(s.push(n),{unsubscribe:()=>{s=s.filter(i=>i!==n)}}),unsubscribe:()=>{s=[]}}},it=s=>Ue(s)&&!Object.keys(s).length,pr=s=>s.type==="file",vt=s=>typeof s=="function",ia=s=>{if(!mr)return!1;const t=s?s.ownerDocument:0;return s instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Hn=s=>s.type==="select-multiple",fr=s=>s.type==="radio",Rl=s=>fr(s)||Vs(s),Ia=s=>ia(s)&&s.isConnected;function Pl(s,t){const a=t.slice(0,-1).length;let r=0;for(;r<a;)s=ze(s)?r++:s[t[r++]];return s}function Ll(s){for(const t in s)if(s.hasOwnProperty(t)&&!ze(s[t]))return!1;return!0}function Ge(s,t){const a=Array.isArray(t)?t:ya(t)?[t]:hr(t),r=a.length===1?s:Pl(s,a),n=a.length-1,i=a[n];return r&&delete r[i],n!==0&&(Ue(r)&&it(r)||Array.isArray(r)&&Ll(r))&&Ge(s,a.slice(0,-1)),s}var Yn=s=>{for(const t in s)if(vt(s[t]))return!0;return!1};function la(s,t={}){const a=Array.isArray(s);if(Ue(s)||a)for(const r in s)Array.isArray(s[r])||Ue(s[r])&&!Yn(s[r])?(t[r]=Array.isArray(s[r])?[]:{},la(s[r],t[r])):rt(s[r])||(t[r]=!0);return t}function Zn(s,t,a){const r=Array.isArray(s);if(Ue(s)||r)for(const n in s)Array.isArray(s[n])||Ue(s[n])&&!Yn(s[n])?ze(t)||Ga(a[n])?a[n]=Array.isArray(s[n])?la(s[n],[]):{...la(s[n])}:Zn(s[n],rt(t)?{}:t[n],a[n]):a[n]=!Pt(s[n],t[n]);return a}var Ts=(s,t)=>Zn(s,t,la(t));const Ur={value:!1,isValid:!1},qr={value:!0,isValid:!0};var Kn=s=>{if(Array.isArray(s)){if(s.length>1){const t=s.filter(a=>a&&a.checked&&!a.disabled).map(a=>a.value);return{value:t,isValid:!!t.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!ze(s[0].attributes.value)?ze(s[0].value)||s[0].value===""?qr:{value:s[0].value,isValid:!0}:qr:Ur}return Ur},Qn=(s,{valueAsNumber:t,valueAsDate:a,setValueAs:r})=>ze(s)?s:t?s===""?NaN:s&&+s:a&&Ct(s)?new Date(s):r?r(s):s;const Vr={isValid:!1,value:null};var Jn=s=>Array.isArray(s)?s.reduce((t,a)=>a&&a.checked&&!a.disabled?{isValid:!0,value:a.value}:t,Vr):Vr;function Wr(s){const t=s.ref;return pr(t)?t.files:fr(t)?Jn(s.refs).value:Hn(t)?[...t.selectedOptions].map(({value:a})=>a):Vs(t)?Kn(s.refs).value:Qn(ze(t.value)?s.ref.value:t.value,s)}var Fl=(s,t,a,r)=>{const n={};for(const i of s){const l=Q(t,i);l&&Ee(n,i,l._f)}return{criteriaMode:a,names:[...s],fields:n,shouldUseNativeValidation:r}},oa=s=>s instanceof RegExp,Is=s=>ze(s)?s:oa(s)?s.source:Ue(s)?oa(s.value)?s.value.source:s.value:s,Gr=s=>({isOnSubmit:!s||s===bt.onSubmit,isOnBlur:s===bt.onBlur,isOnChange:s===bt.onChange,isOnAll:s===bt.all,isOnTouch:s===bt.onTouched});const Hr="AsyncFunction";var Ml=s=>!!s&&!!s.validate&&!!(vt(s.validate)&&s.validate.constructor.name===Hr||Ue(s.validate)&&Object.values(s.validate).find(t=>t.constructor.name===Hr)),$l=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),Yr=(s,t,a)=>!a&&(t.watchAll||t.watch.has(s)||[...t.watch].some(r=>s.startsWith(r)&&/^\.\w+/.test(s.slice(r.length))));const Ls=(s,t,a,r)=>{for(const n of a||Object.keys(s)){const i=Q(s,n);if(i){const{_f:l,...o}=i;if(l){if(l.refs&&l.refs[0]&&t(l.refs[0],n)&&!r)return!0;if(l.ref&&t(l.ref,l.name)&&!r)return!0;if(Ls(o,t))break}else if(Ue(o)&&Ls(o,t))break}}};function Zr(s,t,a){const r=Q(s,a);if(r||ya(a))return{error:r,name:a};const n=a.split(".");for(;n.length;){const i=n.join("."),l=Q(t,i),o=Q(s,i);if(l&&!Array.isArray(l)&&a!==i)return{name:a};if(o&&o.type)return{name:i,error:o};if(o&&o.root&&o.root.type)return{name:`${i}.root`,error:o.root};n.pop()}return{name:a}}var Dl=(s,t,a,r)=>{a(s);const{name:n,...i}=s;return it(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(l=>t[l]===(!r||bt.all))},Ol=(s,t,a)=>!s||!t||s===t||Ps(s).some(r=>r&&(a?r===t:r.startsWith(t)||t.startsWith(r))),Bl=(s,t,a,r,n)=>n.isOnAll?!1:!a&&n.isOnTouch?!(t||s):(a?r.isOnBlur:n.isOnBlur)?!s:(a?r.isOnChange:n.isOnChange)?s:!0,zl=(s,t)=>!ur(Q(s,t)).length&&Ge(s,t),Ul=(s,t,a)=>{const r=Ps(Q(s,a));return Ee(r,"root",t[a]),Ee(s,a,r),s},Xs=s=>Ct(s);function Kr(s,t,a="validate"){if(Xs(s)||Array.isArray(s)&&s.every(Xs)||ut(s)&&!s)return{type:a,message:Xs(s)?s:"",ref:t}}var cs=s=>Ue(s)&&!oa(s)?s:{value:s,message:""},Qr=async(s,t,a,r,n,i)=>{const{ref:l,refs:o,required:c,maxLength:u,minLength:h,min:f,max:d,pattern:x,validate:b,name:m,valueAsNumber:p,mount:N}=s._f,g=Q(a,m);if(!N||t.has(m))return{};const S=o?o[0]:l,T=A=>{n&&S.reportValidity&&(S.setCustomValidity(ut(A)?"":A||""),S.reportValidity())},v={},L=fr(l),P=Vs(l),z=L||P,C=(p||pr(l))&&ze(l.value)&&ze(g)||ia(l)&&l.value===""||g===""||Array.isArray(g)&&!g.length,j=Gn.bind(null,m,r,v),E=(A,y,R,k=Et.maxLength,F=Et.minLength)=>{const O=A?y:R;v[m]={type:A?k:F,message:O,ref:l,...j(A?k:F,O)}};if(i?!Array.isArray(g)||!g.length:c&&(!z&&(C||rt(g))||ut(g)&&!g||P&&!Kn(o).isValid||L&&!Jn(o).isValid)){const{value:A,message:y}=Xs(c)?{value:!!c,message:c}:cs(c);if(A&&(v[m]={type:Et.required,message:y,ref:S,...j(Et.required,y)},!r))return T(y),v}if(!C&&(!rt(f)||!rt(d))){let A,y;const R=cs(d),k=cs(f);if(!rt(g)&&!isNaN(g)){const F=l.valueAsNumber||g&&+g;rt(R.value)||(A=F>R.value),rt(k.value)||(y=F<k.value)}else{const F=l.valueAsDate||new Date(g),O=D=>new Date(new Date().toDateString()+" "+D),J=l.type=="time",U=l.type=="week";Ct(R.value)&&g&&(A=J?O(g)>O(R.value):U?g>R.value:F>new Date(R.value)),Ct(k.value)&&g&&(y=J?O(g)<O(k.value):U?g<k.value:F<new Date(k.value))}if((A||y)&&(E(!!A,R.message,k.message,Et.max,Et.min),!r))return T(v[m].message),v}if((u||h)&&!C&&(Ct(g)||i&&Array.isArray(g))){const A=cs(u),y=cs(h),R=!rt(A.value)&&g.length>+A.value,k=!rt(y.value)&&g.length<+y.value;if((R||k)&&(E(R,A.message,y.message),!r))return T(v[m].message),v}if(x&&!C&&Ct(g)){const{value:A,message:y}=cs(x);if(oa(A)&&!g.match(A)&&(v[m]={type:Et.pattern,message:y,ref:l,...j(Et.pattern,y)},!r))return T(y),v}if(b){if(vt(b)){const A=await b(g,a),y=Kr(A,S);if(y&&(v[m]={...y,...j(Et.validate,y.message)},!r))return T(y.message),v}else if(Ue(b)){let A={};for(const y in b){if(!it(A)&&!r)break;const R=Kr(await b[y](g,a),S,y);R&&(A={...R,...j(y,R.message)},T(R.message),r&&(v[m]=A))}if(!it(A)&&(v[m]={ref:S,...A},!r))return v}}return T(!0),v};const ql={mode:bt.onSubmit,reValidateMode:bt.onChange,shouldFocusError:!0};function Vl(s={}){let t={...ql,...s},a={submitCount:0,isDirty:!1,isReady:!1,isLoading:vt(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},n=Ue(t.defaultValues)||Ue(t.values)?Ye(t.defaultValues||t.values)||{}:{},i=t.shouldUnregister?{}:Ye(n),l={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...h};const d={array:zr(),state:zr()},x=t.criteriaMode===bt.all,b=I=>M=>{clearTimeout(u),u=setTimeout(I,M)},m=async I=>{if(!t.disabled&&(h.isValid||f.isValid||I)){const M=t.resolver?it((await P()).errors):await C(r,!0);M!==a.isValid&&d.state.next({isValid:M})}},p=(I,M)=>{!t.disabled&&(h.isValidating||h.validatingFields||f.isValidating||f.validatingFields)&&((I||Array.from(o.mount)).forEach(B=>{B&&(M?Ee(a.validatingFields,B,M):Ge(a.validatingFields,B))}),d.state.next({validatingFields:a.validatingFields,isValidating:!it(a.validatingFields)}))},N=(I,M=[],B,K,Z=!0,H=!0)=>{if(K&&B&&!t.disabled){if(l.action=!0,H&&Array.isArray(Q(r,I))){const le=B(Q(r,I),K.argA,K.argB);Z&&Ee(r,I,le)}if(H&&Array.isArray(Q(a.errors,I))){const le=B(Q(a.errors,I),K.argA,K.argB);Z&&Ee(a.errors,I,le),zl(a.errors,I)}if((h.touchedFields||f.touchedFields)&&H&&Array.isArray(Q(a.touchedFields,I))){const le=B(Q(a.touchedFields,I),K.argA,K.argB);Z&&Ee(a.touchedFields,I,le)}(h.dirtyFields||f.dirtyFields)&&(a.dirtyFields=Ts(n,i)),d.state.next({name:I,isDirty:E(I,M),dirtyFields:a.dirtyFields,errors:a.errors,isValid:a.isValid})}else Ee(i,I,M)},g=(I,M)=>{Ee(a.errors,I,M),d.state.next({errors:a.errors})},S=I=>{a.errors=I,d.state.next({errors:a.errors,isValid:!1})},T=(I,M,B,K)=>{const Z=Q(r,I);if(Z){const H=Q(i,I,ze(B)?Q(n,I):B);ze(H)||K&&K.defaultChecked||M?Ee(i,I,M?H:Wr(Z._f)):R(I,H),l.mount&&m()}},v=(I,M,B,K,Z)=>{let H=!1,le=!1;const _e={name:I};if(!t.disabled){if(!B||K){(h.isDirty||f.isDirty)&&(le=a.isDirty,a.isDirty=_e.isDirty=E(),H=le!==_e.isDirty);const Ce=Pt(Q(n,I),M);le=!!Q(a.dirtyFields,I),Ce?Ge(a.dirtyFields,I):Ee(a.dirtyFields,I,!0),_e.dirtyFields=a.dirtyFields,H=H||(h.dirtyFields||f.dirtyFields)&&le!==!Ce}if(B){const Ce=Q(a.touchedFields,I);Ce||(Ee(a.touchedFields,I,B),_e.touchedFields=a.touchedFields,H=H||(h.touchedFields||f.touchedFields)&&Ce!==B)}H&&Z&&d.state.next(_e)}return H?_e:{}},L=(I,M,B,K)=>{const Z=Q(a.errors,I),H=(h.isValid||f.isValid)&&ut(M)&&a.isValid!==M;if(t.delayError&&B?(c=b(()=>g(I,B)),c(t.delayError)):(clearTimeout(u),c=null,B?Ee(a.errors,I,B):Ge(a.errors,I)),(B?!Pt(Z,B):Z)||!it(K)||H){const le={...K,...H&&ut(M)?{isValid:M}:{},errors:a.errors,name:I};a={...a,...le},d.state.next(le)}},P=async I=>{p(I,!0);const M=await t.resolver(i,t.context,Fl(I||o.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return p(I),M},z=async I=>{const{errors:M}=await P(I);if(I)for(const B of I){const K=Q(M,B);K?Ee(a.errors,B,K):Ge(a.errors,B)}else a.errors=M;return M},C=async(I,M,B={valid:!0})=>{for(const K in I){const Z=I[K];if(Z){const{_f:H,...le}=Z;if(H){const _e=o.array.has(H.name),Ce=Z._f&&Ml(Z._f);Ce&&h.validatingFields&&p([K],!0);const Ke=await Qr(Z,o.disabled,i,x,t.shouldUseNativeValidation&&!M,_e);if(Ce&&h.validatingFields&&p([K]),Ke[H.name]&&(B.valid=!1,M))break;!M&&(Q(Ke,H.name)?_e?Ul(a.errors,Ke,H.name):Ee(a.errors,H.name,Ke[H.name]):Ge(a.errors,H.name))}!it(le)&&await C(le,M,B)}}return B.valid},j=()=>{for(const I of o.unMount){const M=Q(r,I);M&&(M._f.refs?M._f.refs.every(B=>!Ia(B)):!Ia(M._f.ref))&&Fe(I)}o.unMount=new Set},E=(I,M)=>!t.disabled&&(I&&M&&Ee(i,I,M),!Pt(D(),n)),A=(I,M,B)=>Wn(I,o,{...l.mount?i:ze(M)?n:Ct(I)?{[I]:M}:M},B,M),y=I=>ur(Q(l.mount?i:n,I,t.shouldUnregister?Q(n,I,[]):[])),R=(I,M,B={})=>{const K=Q(r,I);let Z=M;if(K){const H=K._f;H&&(!H.disabled&&Ee(i,I,Qn(M,H)),Z=ia(H.ref)&&rt(M)?"":M,Hn(H.ref)?[...H.ref.options].forEach(le=>le.selected=Z.includes(le.value)):H.refs?Vs(H.ref)?H.refs.forEach(le=>{(!le.defaultChecked||!le.disabled)&&(Array.isArray(Z)?le.checked=!!Z.find(_e=>_e===le.value):le.checked=Z===le.value||!!Z)}):H.refs.forEach(le=>le.checked=le.value===Z):pr(H.ref)?H.ref.value="":(H.ref.value=Z,H.ref.type||d.state.next({name:I,values:Ye(i)})))}(B.shouldDirty||B.shouldTouch)&&v(I,Z,B.shouldTouch,B.shouldDirty,!0),B.shouldValidate&&U(I)},k=(I,M,B)=>{for(const K in M){if(!M.hasOwnProperty(K))return;const Z=M[K],H=I+"."+K,le=Q(r,H);(o.array.has(I)||Ue(Z)||le&&!le._f)&&!ts(Z)?k(H,Z,B):R(H,Z,B)}},F=(I,M,B={})=>{const K=Q(r,I),Z=o.array.has(I),H=Ye(M);Ee(i,I,H),Z?(d.array.next({name:I,values:Ye(i)}),(h.isDirty||h.dirtyFields||f.isDirty||f.dirtyFields)&&B.shouldDirty&&d.state.next({name:I,dirtyFields:Ts(n,i),isDirty:E(I,H)})):K&&!K._f&&!rt(H)?k(I,H,B):R(I,H,B),Yr(I,o)&&d.state.next({...a,name:I}),d.state.next({name:l.mount?I:void 0,values:Ye(i)})},O=async I=>{l.mount=!0;const M=I.target;let B=M.name,K=!0;const Z=Q(r,B),H=Ce=>{K=Number.isNaN(Ce)||ts(Ce)&&isNaN(Ce.getTime())||Pt(Ce,Q(i,B,Ce))},le=Gr(t.mode),_e=Gr(t.reValidateMode);if(Z){let Ce,Ke;const kt=M.type?Wr(Z._f):zn(I),nt=I.type===na.BLUR||I.type===na.FOCUS_OUT,Zt=!$l(Z._f)&&!t.resolver&&!Q(a.errors,B)&&!Z._f.deps||Bl(nt,Q(a.touchedFields,B),a.isSubmitted,_e,le),Me=Yr(B,o,nt);Ee(i,B,kt),nt?(!M||!M.readOnly)&&(Z._f.onBlur&&Z._f.onBlur(I),c&&c(0)):Z._f.onChange&&Z._f.onChange(I);const mt=v(B,kt,nt),Kt=!it(mt)||Me;if(!nt&&d.state.next({name:B,type:I.type,values:Ye(i)}),Zt)return(h.isValid||f.isValid)&&(t.mode==="onBlur"?nt&&m():nt||m()),Kt&&d.state.next({name:B,...Me?{}:mt});if(!nt&&Me&&d.state.next({...a}),t.resolver){const{errors:Qt}=await P([B]);if(H(kt),K){const ls=Zr(a.errors,r,B),Jt=Zr(Qt,r,ls.name||B);Ce=Jt.error,B=Jt.name,Ke=it(Qt)}}else p([B],!0),Ce=(await Qr(Z,o.disabled,i,x,t.shouldUseNativeValidation))[B],p([B]),H(kt),K&&(Ce?Ke=!1:(h.isValid||f.isValid)&&(Ke=await C(r,!0)));K&&(Z._f.deps&&U(Z._f.deps),L(B,Ke,Ce,mt))}},J=(I,M)=>{if(Q(a.errors,M)&&I.focus)return I.focus(),1},U=async(I,M={})=>{let B,K;const Z=Ps(I);if(t.resolver){const H=await z(ze(I)?I:Z);B=it(H),K=I?!Z.some(le=>Q(H,le)):B}else I?(K=(await Promise.all(Z.map(async H=>{const le=Q(r,H);return await C(le&&le._f?{[H]:le}:le)}))).every(Boolean),!(!K&&!a.isValid)&&m()):K=B=await C(r);return d.state.next({...!Ct(I)||(h.isValid||f.isValid)&&B!==a.isValid?{}:{name:I},...t.resolver||!I?{isValid:B}:{},errors:a.errors}),M.shouldFocus&&!K&&Ls(r,J,I?Z:o.mount),K},D=I=>{const M={...l.mount?i:n};return ze(I)?M:Ct(I)?Q(M,I):I.map(B=>Q(M,B))},V=(I,M)=>({invalid:!!Q((M||a).errors,I),isDirty:!!Q((M||a).dirtyFields,I),error:Q((M||a).errors,I),isValidating:!!Q(a.validatingFields,I),isTouched:!!Q((M||a).touchedFields,I)}),he=I=>{I&&Ps(I).forEach(M=>Ge(a.errors,M)),d.state.next({errors:I?a.errors:{}})},ye=(I,M,B)=>{const K=(Q(r,I,{_f:{}})._f||{}).ref,Z=Q(a.errors,I)||{},{ref:H,message:le,type:_e,...Ce}=Z;Ee(a.errors,I,{...Ce,...M,ref:K}),d.state.next({name:I,errors:a.errors,isValid:!1}),B&&B.shouldFocus&&K&&K.focus&&K.focus()},Ie=(I,M)=>vt(I)?d.state.subscribe({next:B=>"values"in B&&I(A(void 0,M),B)}):A(I,M,!0),de=I=>d.state.subscribe({next:M=>{Ol(I.name,M.name,I.exact)&&Dl(M,I.formState||h,Ze,I.reRenderRoot)&&I.callback({values:{...i},...a,...M,defaultValues:n})}}).unsubscribe,Oe=I=>(l.mount=!0,f={...f,...I.formState},de({...I,formState:f})),Fe=(I,M={})=>{for(const B of I?Ps(I):o.mount)o.mount.delete(B),o.array.delete(B),M.keepValue||(Ge(r,B),Ge(i,B)),!M.keepError&&Ge(a.errors,B),!M.keepDirty&&Ge(a.dirtyFields,B),!M.keepTouched&&Ge(a.touchedFields,B),!M.keepIsValidating&&Ge(a.validatingFields,B),!t.shouldUnregister&&!M.keepDefaultValue&&Ge(n,B);d.state.next({values:Ye(i)}),d.state.next({...a,...M.keepDirty?{isDirty:E()}:{}}),!M.keepIsValid&&m()},se=({disabled:I,name:M})=>{(ut(I)&&l.mount||I||o.disabled.has(M))&&(I?o.disabled.add(M):o.disabled.delete(M))},ve=(I,M={})=>{let B=Q(r,I);const K=ut(M.disabled)||ut(t.disabled);return Ee(r,I,{...B||{},_f:{...B&&B._f?B._f:{ref:{name:I}},name:I,mount:!0,...M}}),o.mount.add(I),B?se({disabled:ut(M.disabled)?M.disabled:t.disabled,name:I}):T(I,!0,M.value),{...K?{disabled:M.disabled||t.disabled}:{},...t.progressive?{required:!!M.required,min:Is(M.min),max:Is(M.max),minLength:Is(M.minLength),maxLength:Is(M.maxLength),pattern:Is(M.pattern)}:{},name:I,onChange:O,onBlur:O,ref:Z=>{if(Z){ve(I,M),B=Q(r,I);const H=ze(Z.value)&&Z.querySelectorAll&&Z.querySelectorAll("input,select,textarea")[0]||Z,le=Rl(H),_e=B._f.refs||[];if(le?_e.find(Ce=>Ce===H):H===B._f.ref)return;Ee(r,I,{_f:{...B._f,...le?{refs:[..._e.filter(Ia),H,...Array.isArray(Q(n,I))?[{}]:[]],ref:{type:H.type,name:I}}:{ref:H}}}),T(I,!1,void 0,H)}else B=Q(r,I,{}),B._f&&(B._f.mount=!1),(t.shouldUnregister||M.shouldUnregister)&&!(Un(o.array,I)&&l.action)&&o.unMount.add(I)}}},ie=()=>t.shouldFocusError&&Ls(r,J,o.mount),X=I=>{ut(I)&&(d.state.next({disabled:I}),Ls(r,(M,B)=>{const K=Q(r,B);K&&(M.disabled=K._f.disabled||I,Array.isArray(K._f.refs)&&K._f.refs.forEach(Z=>{Z.disabled=K._f.disabled||I}))},0,!1))},ce=(I,M)=>async B=>{let K;B&&(B.preventDefault&&B.preventDefault(),B.persist&&B.persist());let Z=Ye(i);if(d.state.next({isSubmitting:!0}),t.resolver){const{errors:H,values:le}=await P();a.errors=H,Z=Ye(le)}else await C(r);if(o.disabled.size)for(const H of o.disabled)Ge(Z,H);if(Ge(a.errors,"root"),it(a.errors)){d.state.next({errors:{}});try{await I(Z,B)}catch(H){K=H}}else M&&await M({...a.errors},B),ie(),setTimeout(ie);if(d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:it(a.errors)&&!K,submitCount:a.submitCount+1,errors:a.errors}),K)throw K},ae=(I,M={})=>{Q(r,I)&&(ze(M.defaultValue)?F(I,Ye(Q(n,I))):(F(I,M.defaultValue),Ee(n,I,Ye(M.defaultValue))),M.keepTouched||Ge(a.touchedFields,I),M.keepDirty||(Ge(a.dirtyFields,I),a.isDirty=M.defaultValue?E(I,Ye(Q(n,I))):E()),M.keepError||(Ge(a.errors,I),h.isValid&&m()),d.state.next({...a}))},Ve=(I,M={})=>{const B=I?Ye(I):n,K=Ye(B),Z=it(I),H=Z?n:K;if(M.keepDefaultValues||(n=B),!M.keepValues){if(M.keepDirtyValues){const le=new Set([...o.mount,...Object.keys(Ts(n,i))]);for(const _e of Array.from(le))Q(a.dirtyFields,_e)?Ee(H,_e,Q(i,_e)):F(_e,Q(H,_e))}else{if(mr&&ze(I))for(const le of o.mount){const _e=Q(r,le);if(_e&&_e._f){const Ce=Array.isArray(_e._f.refs)?_e._f.refs[0]:_e._f.ref;if(ia(Ce)){const Ke=Ce.closest("form");if(Ke){Ke.reset();break}}}}if(M.keepFieldsRef)for(const le of o.mount)F(le,Q(H,le));else r={}}i=t.shouldUnregister?M.keepDefaultValues?Ye(n):{}:Ye(H),d.array.next({values:{...H}}),d.state.next({values:{...H}})}o={mount:M.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!h.isValid||!!M.keepIsValid||!!M.keepDirtyValues,l.watch=!!t.shouldUnregister,d.state.next({submitCount:M.keepSubmitCount?a.submitCount:0,isDirty:Z?!1:M.keepDirty?a.isDirty:!!(M.keepDefaultValues&&!Pt(I,n)),isSubmitted:M.keepIsSubmitted?a.isSubmitted:!1,dirtyFields:Z?{}:M.keepDirtyValues?M.keepDefaultValues&&i?Ts(n,i):a.dirtyFields:M.keepDefaultValues&&I?Ts(n,I):M.keepDirty?a.dirtyFields:{},touchedFields:M.keepTouched?a.touchedFields:{},errors:M.keepErrors?a.errors:{},isSubmitSuccessful:M.keepIsSubmitSuccessful?a.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:n})},ne=(I,M)=>Ve(vt(I)?I(i):I,M),Xe=(I,M={})=>{const B=Q(r,I),K=B&&B._f;if(K){const Z=K.refs?K.refs[0]:K.ref;Z.focus&&(Z.focus(),M.shouldSelect&&vt(Z.select)&&Z.select())}},Ze=I=>{a={...a,...I}},yt={control:{register:ve,unregister:Fe,getFieldState:V,handleSubmit:ce,setError:ye,_subscribe:de,_runSchema:P,_focusError:ie,_getWatch:A,_getDirty:E,_setValid:m,_setFieldArray:N,_setDisabledField:se,_setErrors:S,_getFieldArray:y,_reset:Ve,_resetDefaultValues:()=>vt(t.defaultValues)&&t.defaultValues().then(I=>{ne(I,t.resetOptions),d.state.next({isLoading:!1})}),_removeUnmounted:j,_disableForm:X,_subjects:d,_proxyFormState:h,get _fields(){return r},get _formValues(){return i},get _state(){return l},set _state(I){l=I},get _defaultValues(){return n},get _names(){return o},set _names(I){o=I},get _formState(){return a},get _options(){return t},set _options(I){t={...t,...I}}},subscribe:Oe,trigger:U,register:ve,handleSubmit:ce,watch:Ie,setValue:F,getValues:D,reset:ne,resetField:ae,clearErrors:he,unregister:Fe,setError:ye,setFocus:Xe,getFieldState:V};return{...yt,formControl:yt}}function Xn(s={}){const t=xe.useRef(void 0),a=xe.useRef(void 0),[r,n]=xe.useState({isDirty:!1,isValidating:!1,isLoading:vt(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:vt(s.defaultValues)?void 0:s.defaultValues});if(!t.current)if(s.formControl)t.current={...s.formControl,formState:r},s.defaultValues&&!vt(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:l,...o}=Vl(s);t.current={...o,formState:r}}const i=t.current.control;return i._options=s,gr(()=>{const l=i._subscribe({formState:i._proxyFormState,callback:()=>n({...i._formState}),reRenderRoot:!0});return n(o=>({...o,isReady:!0})),i._formState.isReady=!0,l},[i]),xe.useEffect(()=>i._disableForm(s.disabled),[i,s.disabled]),xe.useEffect(()=>{s.mode&&(i._options.mode=s.mode),s.reValidateMode&&(i._options.reValidateMode=s.reValidateMode)},[i,s.mode,s.reValidateMode]),xe.useEffect(()=>{s.errors&&(i._setErrors(s.errors),i._focusError())},[i,s.errors]),xe.useEffect(()=>{s.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,s.shouldUnregister]),xe.useEffect(()=>{if(i._proxyFormState.isDirty){const l=i._getDirty();l!==r.isDirty&&i._subjects.state.next({isDirty:l})}},[i,r.isDirty]),xe.useEffect(()=>{s.values&&!Pt(s.values,a.current)?(i._reset(s.values,{keepFieldsRef:!0,...i._options.resetOptions}),a.current=s.values,n(l=>({...l}))):i._resetDefaultValues()},[i,s.values]),xe.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=Vn(r,i),t.current}const Jr=(s,t,a)=>{if(s&&"reportValidity"in s){const r=Q(a,t);s.setCustomValidity(r&&r.message||""),s.reportValidity()}},ei=(s,t)=>{for(const a in t.fields){const r=t.fields[a];r&&r.ref&&"reportValidity"in r.ref?Jr(r.ref,a,s):r.refs&&r.refs.forEach(n=>Jr(n,a,s))}},Wl=(s,t)=>{t.shouldUseNativeValidation&&ei(s,t);const a={};for(const r in s){const n=Q(t.fields,r),i=Object.assign(s[r]||{},{ref:n&&n.ref});if(Gl(t.names||Object.keys(s),r)){const l=Object.assign({},Q(a,r));Ee(l,"root",i),Ee(a,r,l)}else Ee(a,r,i)}return a},Gl=(s,t)=>s.some(a=>a.startsWith(t+"."));var Hl=function(s,t){for(var a={};s.length;){var r=s[0],n=r.code,i=r.message,l=r.path.join(".");if(!a[l])if("unionErrors"in r){var o=r.unionErrors[0].errors[0];a[l]={message:o.message,type:o.code}}else a[l]={message:i,type:n};if("unionErrors"in r&&r.unionErrors.forEach(function(h){return h.errors.forEach(function(f){return s.push(f)})}),t){var c=a[l].types,u=c&&c[r.code];a[l]=Gn(l,t,a,n,u?[].concat(u,r.message):r.message)}s.shift()}return a},ti=function(s,t,a){return a===void 0&&(a={}),function(r,n,i){try{return Promise.resolve(function(l,o){try{var c=Promise.resolve(s[a.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(u){return i.shouldUseNativeValidation&&ei({},i),{errors:{},values:a.raw?r:u}})}catch(u){return o(u)}return c&&c.then?c.then(void 0,o):c}(0,function(l){if(function(o){return Array.isArray(o==null?void 0:o.errors)}(l))return{values:{},errors:Wl(Hl(l.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw l}))}catch(l){return Promise.reject(l)}}},Ae;(function(s){s.assertEqual=n=>{};function t(n){}s.assertIs=t;function a(n){throw new Error}s.assertNever=a,s.arrayToEnum=n=>{const i={};for(const l of n)i[l]=l;return i},s.getValidEnumValues=n=>{const i=s.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),l={};for(const o of i)l[o]=n[o];return s.objectValues(l)},s.objectValues=n=>s.objectKeys(n).map(function(i){return n[i]}),s.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const l in n)Object.prototype.hasOwnProperty.call(n,l)&&i.push(l);return i},s.find=(n,i)=>{for(const l of n)if(i(l))return l},s.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function r(n,i=" | "){return n.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}s.joinValues=r,s.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(Ae||(Ae={}));var Xr;(function(s){s.mergeShapes=(t,a)=>({...t,...a})})(Xr||(Xr={}));const re=Ae.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Bt=s=>{switch(typeof s){case"undefined":return re.undefined;case"string":return re.string;case"number":return Number.isNaN(s)?re.nan:re.number;case"boolean":return re.boolean;case"function":return re.function;case"bigint":return re.bigint;case"symbol":return re.symbol;case"object":return Array.isArray(s)?re.array:s===null?re.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?re.promise:typeof Map<"u"&&s instanceof Map?re.map:typeof Set<"u"&&s instanceof Set?re.set:typeof Date<"u"&&s instanceof Date?re.date:re.object;default:return re.unknown}},Y=Ae.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class $t extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=t}format(t){const a=t||function(i){return i.message},r={_errors:[]},n=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(n);else if(l.code==="invalid_return_type")n(l.returnTypeError);else if(l.code==="invalid_arguments")n(l.argumentsError);else if(l.path.length===0)r._errors.push(a(l));else{let o=r,c=0;for(;c<l.path.length;){const u=l.path[c];c===l.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(a(l))):o[u]=o[u]||{_errors:[]},o=o[u],c++}}};return n(this),r}static assert(t){if(!(t instanceof $t))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ae.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=a=>a.message){const a={},r=[];for(const n of this.issues)if(n.path.length>0){const i=n.path[0];a[i]=a[i]||[],a[i].push(t(n))}else r.push(t(n));return{formErrors:r,fieldErrors:a}}get formErrors(){return this.flatten()}}$t.create=s=>new $t(s);const Ha=(s,t)=>{let a;switch(s.code){case Y.invalid_type:s.received===re.undefined?a="Required":a=`Expected ${s.expected}, received ${s.received}`;break;case Y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(s.expected,Ae.jsonStringifyReplacer)}`;break;case Y.unrecognized_keys:a=`Unrecognized key(s) in object: ${Ae.joinValues(s.keys,", ")}`;break;case Y.invalid_union:a="Invalid input";break;case Y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${Ae.joinValues(s.options)}`;break;case Y.invalid_enum_value:a=`Invalid enum value. Expected ${Ae.joinValues(s.options)}, received '${s.received}'`;break;case Y.invalid_arguments:a="Invalid function arguments";break;case Y.invalid_return_type:a="Invalid function return type";break;case Y.invalid_date:a="Invalid date";break;case Y.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(a=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?a=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?a=`Invalid input: must end with "${s.validation.endsWith}"`:Ae.assertNever(s.validation):s.validation!=="regex"?a=`Invalid ${s.validation}`:a="Invalid";break;case Y.too_small:s.type==="array"?a=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?a=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?a=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?a=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?a=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:a="Invalid input";break;case Y.too_big:s.type==="array"?a=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?a=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?a=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?a=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?a=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:a="Invalid input";break;case Y.custom:a="Invalid input";break;case Y.invalid_intersection_types:a="Intersection results could not be merged";break;case Y.not_multiple_of:a=`Number must be a multiple of ${s.multipleOf}`;break;case Y.not_finite:a="Number must be finite";break;default:a=t.defaultError,Ae.assertNever(s)}return{message:a}};let Yl=Ha;function Zl(){return Yl}const Kl=s=>{const{data:t,path:a,errorMaps:r,issueData:n}=s,i=[...a,...n.path||[]],l={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let o="";const c=r.filter(u=>!!u).slice().reverse();for(const u of c)o=u(l,{data:t,defaultError:o}).message;return{...n,path:i,message:o}};function ee(s,t){const a=Zl(),r=Kl({issueData:t,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,a,a===Ha?void 0:Ha].filter(n=>!!n)});s.common.issues.push(r)}class ht{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,a){const r=[];for(const n of a){if(n.status==="aborted")return pe;n.status==="dirty"&&t.dirty(),r.push(n.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,a){const r=[];for(const n of a){const i=await n.key,l=await n.value;r.push({key:i,value:l})}return ht.mergeObjectSync(t,r)}static mergeObjectSync(t,a){const r={};for(const n of a){const{key:i,value:l}=n;if(i.status==="aborted"||l.status==="aborted")return pe;i.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||n.alwaysSet)&&(r[i.value]=l.value)}return{status:t.value,value:r}}}const pe=Object.freeze({status:"aborted"}),Rs=s=>({status:"dirty",value:s}),pt=s=>({status:"valid",value:s}),en=s=>s.status==="aborted",tn=s=>s.status==="dirty",ps=s=>s.status==="valid",ca=s=>typeof Promise<"u"&&s instanceof Promise;var oe;(function(s){s.errToObj=t=>typeof t=="string"?{message:t}:t||{},s.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(oe||(oe={}));class Ht{constructor(t,a,r,n){this._cachedPath=[],this.parent=t,this.data=a,this._path=r,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const sn=(s,t)=>{if(ps(t))return{success:!0,data:t.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const a=new $t(s.common.issues);return this._error=a,this._error}}};function Ne(s){if(!s)return{};const{errorMap:t,invalid_type_error:a,required_error:r,description:n}=s;if(t&&(a||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(l,o)=>{const{message:c}=s;return l.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:c??r??o.defaultError}:l.code!=="invalid_type"?{message:o.defaultError}:{message:c??a??o.defaultError}},description:n}}class Se{get description(){return this._def.description}_getType(t){return Bt(t.data)}_getOrReturnCtx(t,a){return a||{common:t.parent.common,data:t.data,parsedType:Bt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ht,ctx:{common:t.parent.common,data:t.data,parsedType:Bt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const a=this._parse(t);if(ca(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(t){const a=this._parse(t);return Promise.resolve(a)}parse(t,a){const r=this.safeParse(t,a);if(r.success)return r.data;throw r.error}safeParse(t,a){const r={common:{issues:[],async:(a==null?void 0:a.async)??!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bt(t)},n=this._parseSync({data:t,path:r.path,parent:r});return sn(r,n)}"~validate"(t){var r,n;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bt(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:a});return ps(i)?{value:i.value}:{issues:a.common.issues}}catch(i){(n=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:a}).then(i=>ps(i)?{value:i.value}:{issues:a.common.issues})}async parseAsync(t,a){const r=await this.safeParseAsync(t,a);if(r.success)return r.data;throw r.error}async safeParseAsync(t,a){const r={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bt(t)},n=this._parse({data:t,path:r.path,parent:r}),i=await(ca(n)?n:Promise.resolve(n));return sn(r,i)}refine(t,a){const r=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,i)=>{const l=t(n),o=()=>i.addIssue({code:Y.custom,...r(n)});return typeof Promise<"u"&&l instanceof Promise?l.then(c=>c?!0:(o(),!1)):l?!0:(o(),!1)})}refinement(t,a){return this._refinement((r,n)=>t(r)?!0:(n.addIssue(typeof a=="function"?a(r,n):a),!1))}_refinement(t){return new bs({schema:this,typeName:fe.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Wt.create(this,this._def)}nullable(){return vs.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return At.create(this)}promise(){return ha.create(this,this._def)}or(t){return ma.create([this,t],this._def)}and(t){return ua.create(this,t,this._def)}transform(t){return new bs({...Ne(this._def),schema:this,typeName:fe.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const a=typeof t=="function"?t:()=>t;return new Qa({...Ne(this._def),innerType:this,defaultValue:a,typeName:fe.ZodDefault})}brand(){return new vo({typeName:fe.ZodBranded,type:this,...Ne(this._def)})}catch(t){const a=typeof t=="function"?t:()=>t;return new Ja({...Ne(this._def),innerType:this,catchValue:a,typeName:fe.ZodCatch})}describe(t){const a=this.constructor;return new a({...this._def,description:t})}pipe(t){return yr.create(this,t)}readonly(){return Xa.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Ql=/^c[^\s-]{8,}$/i,Jl=/^[0-9a-z]+$/,Xl=/^[0-9A-HJKMNP-TV-Z]{26}$/i,eo=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,to=/^[a-z0-9_-]{21}$/i,so=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ao=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ro=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,no="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ea;const io=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,lo=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,oo=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,co=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,mo=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,uo=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,si="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ho=new RegExp(`^${si}$`);function ai(s){let t="[0-5]\\d";s.precision?t=`${t}\\.\\d{${s.precision}}`:s.precision==null&&(t=`${t}(\\.\\d+)?`);const a=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${a}`}function xo(s){return new RegExp(`^${ai(s)}$`)}function go(s){let t=`${si}T${ai(s)}`;const a=[];return a.push(s.local?"Z?":"Z"),s.offset&&a.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${a.join("|")})`,new RegExp(`^${t}$`)}function po(s,t){return!!((t==="v4"||!t)&&io.test(s)||(t==="v6"||!t)&&oo.test(s))}function fo(s,t){if(!so.test(s))return!1;try{const[a]=s.split(".");if(!a)return!1;const r=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),n=JSON.parse(atob(r));return!(typeof n!="object"||n===null||"typ"in n&&(n==null?void 0:n.typ)!=="JWT"||!n.alg||t&&n.alg!==t)}catch{return!1}}function yo(s,t){return!!((t==="v4"||!t)&&lo.test(s)||(t==="v6"||!t)&&co.test(s))}class Ut extends Se{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==re.string){const i=this._getOrReturnCtx(t);return ee(i,{code:Y.invalid_type,expected:re.string,received:i.parsedType}),pe}const r=new ht;let n;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const l=t.data.length>i.value,o=t.data.length<i.value;(l||o)&&(n=this._getOrReturnCtx(t,n),l?ee(n,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&ee(n,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")ro.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"email",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Ea||(Ea=new RegExp(no,"u")),Ea.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"emoji",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")eo.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"uuid",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")to.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"nanoid",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Ql.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"cuid",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Jl.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"cuid2",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Xl.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"ulid",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),ee(n,{validation:"url",code:Y.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"regex",code:Y.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?go(i).test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?ho.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?xo(i).test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?ao.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"duration",code:Y.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?po(t.data,i.version)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"ip",code:Y.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?fo(t.data,i.alg)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"jwt",code:Y.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?yo(t.data,i.version)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"cidr",code:Y.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?mo.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"base64",code:Y.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?uo.test(t.data)||(n=this._getOrReturnCtx(t,n),ee(n,{validation:"base64url",code:Y.invalid_string,message:i.message}),r.dirty()):Ae.assertNever(i);return{status:r.value,value:t.data}}_regex(t,a,r){return this.refinement(n=>t.test(n),{validation:a,code:Y.invalid_string,...oe.errToObj(r)})}_addCheck(t){return new Ut({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...oe.errToObj(t)})}url(t){return this._addCheck({kind:"url",...oe.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...oe.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...oe.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...oe.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...oe.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...oe.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...oe.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...oe.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...oe.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...oe.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...oe.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...oe.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...oe.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...oe.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...oe.errToObj(t)})}regex(t,a){return this._addCheck({kind:"regex",regex:t,...oe.errToObj(a)})}includes(t,a){return this._addCheck({kind:"includes",value:t,position:a==null?void 0:a.position,...oe.errToObj(a==null?void 0:a.message)})}startsWith(t,a){return this._addCheck({kind:"startsWith",value:t,...oe.errToObj(a)})}endsWith(t,a){return this._addCheck({kind:"endsWith",value:t,...oe.errToObj(a)})}min(t,a){return this._addCheck({kind:"min",value:t,...oe.errToObj(a)})}max(t,a){return this._addCheck({kind:"max",value:t,...oe.errToObj(a)})}length(t,a){return this._addCheck({kind:"length",value:t,...oe.errToObj(a)})}nonempty(t){return this.min(1,oe.errToObj(t))}trim(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const a of this._def.checks)a.kind==="min"&&(t===null||a.value>t)&&(t=a.value);return t}get maxLength(){let t=null;for(const a of this._def.checks)a.kind==="max"&&(t===null||a.value<t)&&(t=a.value);return t}}Ut.create=s=>new Ut({checks:[],typeName:fe.ZodString,coerce:(s==null?void 0:s.coerce)??!1,...Ne(s)});function bo(s,t){const a=(s.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,n=a>r?a:r,i=Number.parseInt(s.toFixed(n).replace(".","")),l=Number.parseInt(t.toFixed(n).replace(".",""));return i%l/10**n}class fs extends Se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==re.number){const i=this._getOrReturnCtx(t);return ee(i,{code:Y.invalid_type,expected:re.number,received:i.parsedType}),pe}let r;const n=new ht;for(const i of this._def.checks)i.kind==="int"?Ae.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),ee(r,{code:Y.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),ee(r,{code:Y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),ee(r,{code:Y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?bo(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),ee(r,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),ee(r,{code:Y.not_finite,message:i.message}),n.dirty()):Ae.assertNever(i);return{status:n.value,value:t.data}}gte(t,a){return this.setLimit("min",t,!0,oe.toString(a))}gt(t,a){return this.setLimit("min",t,!1,oe.toString(a))}lte(t,a){return this.setLimit("max",t,!0,oe.toString(a))}lt(t,a){return this.setLimit("max",t,!1,oe.toString(a))}setLimit(t,a,r,n){return new fs({...this._def,checks:[...this._def.checks,{kind:t,value:a,inclusive:r,message:oe.toString(n)}]})}_addCheck(t){return new fs({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:oe.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:oe.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:oe.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:oe.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:oe.toString(t)})}multipleOf(t,a){return this._addCheck({kind:"multipleOf",value:t,message:oe.toString(a)})}finite(t){return this._addCheck({kind:"finite",message:oe.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:oe.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:oe.toString(t)})}get minValue(){let t=null;for(const a of this._def.checks)a.kind==="min"&&(t===null||a.value>t)&&(t=a.value);return t}get maxValue(){let t=null;for(const a of this._def.checks)a.kind==="max"&&(t===null||a.value<t)&&(t=a.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Ae.isInteger(t.value))}get isFinite(){let t=null,a=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(a===null||r.value>a)&&(a=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(a)&&Number.isFinite(t)}}fs.create=s=>new fs({checks:[],typeName:fe.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...Ne(s)});class Ds extends Se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==re.bigint)return this._getInvalidInput(t);let r;const n=new ht;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),ee(r,{code:Y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),ee(r,{code:Y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),ee(r,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):Ae.assertNever(i);return{status:n.value,value:t.data}}_getInvalidInput(t){const a=this._getOrReturnCtx(t);return ee(a,{code:Y.invalid_type,expected:re.bigint,received:a.parsedType}),pe}gte(t,a){return this.setLimit("min",t,!0,oe.toString(a))}gt(t,a){return this.setLimit("min",t,!1,oe.toString(a))}lte(t,a){return this.setLimit("max",t,!0,oe.toString(a))}lt(t,a){return this.setLimit("max",t,!1,oe.toString(a))}setLimit(t,a,r,n){return new Ds({...this._def,checks:[...this._def.checks,{kind:t,value:a,inclusive:r,message:oe.toString(n)}]})}_addCheck(t){return new Ds({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:oe.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:oe.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:oe.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:oe.toString(t)})}multipleOf(t,a){return this._addCheck({kind:"multipleOf",value:t,message:oe.toString(a)})}get minValue(){let t=null;for(const a of this._def.checks)a.kind==="min"&&(t===null||a.value>t)&&(t=a.value);return t}get maxValue(){let t=null;for(const a of this._def.checks)a.kind==="max"&&(t===null||a.value<t)&&(t=a.value);return t}}Ds.create=s=>new Ds({checks:[],typeName:fe.ZodBigInt,coerce:(s==null?void 0:s.coerce)??!1,...Ne(s)});class Ya extends Se{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==re.boolean){const r=this._getOrReturnCtx(t);return ee(r,{code:Y.invalid_type,expected:re.boolean,received:r.parsedType}),pe}return pt(t.data)}}Ya.create=s=>new Ya({typeName:fe.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...Ne(s)});class da extends Se{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==re.date){const i=this._getOrReturnCtx(t);return ee(i,{code:Y.invalid_type,expected:re.date,received:i.parsedType}),pe}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return ee(i,{code:Y.invalid_date}),pe}const r=new ht;let n;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(n=this._getOrReturnCtx(t,n),ee(n,{code:Y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Ae.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new da({...this._def,checks:[...this._def.checks,t]})}min(t,a){return this._addCheck({kind:"min",value:t.getTime(),message:oe.toString(a)})}max(t,a){return this._addCheck({kind:"max",value:t.getTime(),message:oe.toString(a)})}get minDate(){let t=null;for(const a of this._def.checks)a.kind==="min"&&(t===null||a.value>t)&&(t=a.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const a of this._def.checks)a.kind==="max"&&(t===null||a.value<t)&&(t=a.value);return t!=null?new Date(t):null}}da.create=s=>new da({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:fe.ZodDate,...Ne(s)});class an extends Se{_parse(t){if(this._getType(t)!==re.symbol){const r=this._getOrReturnCtx(t);return ee(r,{code:Y.invalid_type,expected:re.symbol,received:r.parsedType}),pe}return pt(t.data)}}an.create=s=>new an({typeName:fe.ZodSymbol,...Ne(s)});class rn extends Se{_parse(t){if(this._getType(t)!==re.undefined){const r=this._getOrReturnCtx(t);return ee(r,{code:Y.invalid_type,expected:re.undefined,received:r.parsedType}),pe}return pt(t.data)}}rn.create=s=>new rn({typeName:fe.ZodUndefined,...Ne(s)});class nn extends Se{_parse(t){if(this._getType(t)!==re.null){const r=this._getOrReturnCtx(t);return ee(r,{code:Y.invalid_type,expected:re.null,received:r.parsedType}),pe}return pt(t.data)}}nn.create=s=>new nn({typeName:fe.ZodNull,...Ne(s)});class ln extends Se{constructor(){super(...arguments),this._any=!0}_parse(t){return pt(t.data)}}ln.create=s=>new ln({typeName:fe.ZodAny,...Ne(s)});class on extends Se{constructor(){super(...arguments),this._unknown=!0}_parse(t){return pt(t.data)}}on.create=s=>new on({typeName:fe.ZodUnknown,...Ne(s)});class Yt extends Se{_parse(t){const a=this._getOrReturnCtx(t);return ee(a,{code:Y.invalid_type,expected:re.never,received:a.parsedType}),pe}}Yt.create=s=>new Yt({typeName:fe.ZodNever,...Ne(s)});class cn extends Se{_parse(t){if(this._getType(t)!==re.undefined){const r=this._getOrReturnCtx(t);return ee(r,{code:Y.invalid_type,expected:re.void,received:r.parsedType}),pe}return pt(t.data)}}cn.create=s=>new cn({typeName:fe.ZodVoid,...Ne(s)});class At extends Se{_parse(t){const{ctx:a,status:r}=this._processInputParams(t),n=this._def;if(a.parsedType!==re.array)return ee(a,{code:Y.invalid_type,expected:re.array,received:a.parsedType}),pe;if(n.exactLength!==null){const l=a.data.length>n.exactLength.value,o=a.data.length<n.exactLength.value;(l||o)&&(ee(a,{code:l?Y.too_big:Y.too_small,minimum:o?n.exactLength.value:void 0,maximum:l?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(ee(a,{code:Y.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(ee(a,{code:Y.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),a.common.async)return Promise.all([...a.data].map((l,o)=>n.type._parseAsync(new Ht(a,l,a.path,o)))).then(l=>ht.mergeArray(r,l));const i=[...a.data].map((l,o)=>n.type._parseSync(new Ht(a,l,a.path,o)));return ht.mergeArray(r,i)}get element(){return this._def.type}min(t,a){return new At({...this._def,minLength:{value:t,message:oe.toString(a)}})}max(t,a){return new At({...this._def,maxLength:{value:t,message:oe.toString(a)}})}length(t,a){return new At({...this._def,exactLength:{value:t,message:oe.toString(a)}})}nonempty(t){return this.min(1,t)}}At.create=(s,t)=>new At({type:s,minLength:null,maxLength:null,exactLength:null,typeName:fe.ZodArray,...Ne(t)});function ds(s){if(s instanceof He){const t={};for(const a in s.shape){const r=s.shape[a];t[a]=Wt.create(ds(r))}return new He({...s._def,shape:()=>t})}else return s instanceof At?new At({...s._def,type:ds(s.element)}):s instanceof Wt?Wt.create(ds(s.unwrap())):s instanceof vs?vs.create(ds(s.unwrap())):s instanceof rs?rs.create(s.items.map(t=>ds(t))):s}class He extends Se{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),a=Ae.objectKeys(t);return this._cached={shape:t,keys:a},this._cached}_parse(t){if(this._getType(t)!==re.object){const u=this._getOrReturnCtx(t);return ee(u,{code:Y.invalid_type,expected:re.object,received:u.parsedType}),pe}const{status:r,ctx:n}=this._processInputParams(t),{shape:i,keys:l}=this._getCached(),o=[];if(!(this._def.catchall instanceof Yt&&this._def.unknownKeys==="strip"))for(const u in n.data)l.includes(u)||o.push(u);const c=[];for(const u of l){const h=i[u],f=n.data[u];c.push({key:{status:"valid",value:u},value:h._parse(new Ht(n,f,n.path,u)),alwaysSet:u in n.data})}if(this._def.catchall instanceof Yt){const u=this._def.unknownKeys;if(u==="passthrough")for(const h of o)c.push({key:{status:"valid",value:h},value:{status:"valid",value:n.data[h]}});else if(u==="strict")o.length>0&&(ee(n,{code:Y.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const h of o){const f=n.data[h];c.push({key:{status:"valid",value:h},value:u._parse(new Ht(n,f,n.path,h)),alwaysSet:h in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const u=[];for(const h of c){const f=await h.key,d=await h.value;u.push({key:f,value:d,alwaysSet:h.alwaysSet})}return u}).then(u=>ht.mergeObjectSync(r,u)):ht.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(t){return oe.errToObj,new He({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(a,r)=>{var i,l;const n=((l=(i=this._def).errorMap)==null?void 0:l.call(i,a,r).message)??r.defaultError;return a.code==="unrecognized_keys"?{message:oe.errToObj(t).message??n}:{message:n}}}:{}})}strip(){return new He({...this._def,unknownKeys:"strip"})}passthrough(){return new He({...this._def,unknownKeys:"passthrough"})}extend(t){return new He({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new He({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:fe.ZodObject})}setKey(t,a){return this.augment({[t]:a})}catchall(t){return new He({...this._def,catchall:t})}pick(t){const a={};for(const r of Ae.objectKeys(t))t[r]&&this.shape[r]&&(a[r]=this.shape[r]);return new He({...this._def,shape:()=>a})}omit(t){const a={};for(const r of Ae.objectKeys(this.shape))t[r]||(a[r]=this.shape[r]);return new He({...this._def,shape:()=>a})}deepPartial(){return ds(this)}partial(t){const a={};for(const r of Ae.objectKeys(this.shape)){const n=this.shape[r];t&&!t[r]?a[r]=n:a[r]=n.optional()}return new He({...this._def,shape:()=>a})}required(t){const a={};for(const r of Ae.objectKeys(this.shape))if(t&&!t[r])a[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Wt;)i=i._def.innerType;a[r]=i}return new He({...this._def,shape:()=>a})}keyof(){return ri(Ae.objectKeys(this.shape))}}He.create=(s,t)=>new He({shape:()=>s,unknownKeys:"strip",catchall:Yt.create(),typeName:fe.ZodObject,...Ne(t)});He.strictCreate=(s,t)=>new He({shape:()=>s,unknownKeys:"strict",catchall:Yt.create(),typeName:fe.ZodObject,...Ne(t)});He.lazycreate=(s,t)=>new He({shape:s,unknownKeys:"strip",catchall:Yt.create(),typeName:fe.ZodObject,...Ne(t)});class ma extends Se{_parse(t){const{ctx:a}=this._processInputParams(t),r=this._def.options;function n(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return a.common.issues.push(...o.ctx.common.issues),o.result;const l=i.map(o=>new $t(o.ctx.common.issues));return ee(a,{code:Y.invalid_union,unionErrors:l}),pe}if(a.common.async)return Promise.all(r.map(async i=>{const l={...a,common:{...a.common,issues:[]},parent:null};return{result:await i._parseAsync({data:a.data,path:a.path,parent:l}),ctx:l}})).then(n);{let i;const l=[];for(const c of r){const u={...a,common:{...a.common,issues:[]},parent:null},h=c._parseSync({data:a.data,path:a.path,parent:u});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:u}),u.common.issues.length&&l.push(u.common.issues)}if(i)return a.common.issues.push(...i.ctx.common.issues),i.result;const o=l.map(c=>new $t(c));return ee(a,{code:Y.invalid_union,unionErrors:o}),pe}}get options(){return this._def.options}}ma.create=(s,t)=>new ma({options:s,typeName:fe.ZodUnion,...Ne(t)});function Za(s,t){const a=Bt(s),r=Bt(t);if(s===t)return{valid:!0,data:s};if(a===re.object&&r===re.object){const n=Ae.objectKeys(t),i=Ae.objectKeys(s).filter(o=>n.indexOf(o)!==-1),l={...s,...t};for(const o of i){const c=Za(s[o],t[o]);if(!c.valid)return{valid:!1};l[o]=c.data}return{valid:!0,data:l}}else if(a===re.array&&r===re.array){if(s.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<s.length;i++){const l=s[i],o=t[i],c=Za(l,o);if(!c.valid)return{valid:!1};n.push(c.data)}return{valid:!0,data:n}}else return a===re.date&&r===re.date&&+s==+t?{valid:!0,data:s}:{valid:!1}}class ua extends Se{_parse(t){const{status:a,ctx:r}=this._processInputParams(t),n=(i,l)=>{if(en(i)||en(l))return pe;const o=Za(i.value,l.value);return o.valid?((tn(i)||tn(l))&&a.dirty(),{status:a.value,value:o.data}):(ee(r,{code:Y.invalid_intersection_types}),pe)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,l])=>n(i,l)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ua.create=(s,t,a)=>new ua({left:s,right:t,typeName:fe.ZodIntersection,...Ne(a)});class rs extends Se{_parse(t){const{status:a,ctx:r}=this._processInputParams(t);if(r.parsedType!==re.array)return ee(r,{code:Y.invalid_type,expected:re.array,received:r.parsedType}),pe;if(r.data.length<this._def.items.length)return ee(r,{code:Y.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),pe;!this._def.rest&&r.data.length>this._def.items.length&&(ee(r,{code:Y.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());const i=[...r.data].map((l,o)=>{const c=this._def.items[o]||this._def.rest;return c?c._parse(new Ht(r,l,r.path,o)):null}).filter(l=>!!l);return r.common.async?Promise.all(i).then(l=>ht.mergeArray(a,l)):ht.mergeArray(a,i)}get items(){return this._def.items}rest(t){return new rs({...this._def,rest:t})}}rs.create=(s,t)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new rs({items:s,typeName:fe.ZodTuple,rest:null,...Ne(t)})};class dn extends Se{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:a,ctx:r}=this._processInputParams(t);if(r.parsedType!==re.map)return ee(r,{code:Y.invalid_type,expected:re.map,received:r.parsedType}),pe;const n=this._def.keyType,i=this._def.valueType,l=[...r.data.entries()].map(([o,c],u)=>({key:n._parse(new Ht(r,o,r.path,[u,"key"])),value:i._parse(new Ht(r,c,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const c of l){const u=await c.key,h=await c.value;if(u.status==="aborted"||h.status==="aborted")return pe;(u.status==="dirty"||h.status==="dirty")&&a.dirty(),o.set(u.value,h.value)}return{status:a.value,value:o}})}else{const o=new Map;for(const c of l){const u=c.key,h=c.value;if(u.status==="aborted"||h.status==="aborted")return pe;(u.status==="dirty"||h.status==="dirty")&&a.dirty(),o.set(u.value,h.value)}return{status:a.value,value:o}}}}dn.create=(s,t,a)=>new dn({valueType:t,keyType:s,typeName:fe.ZodMap,...Ne(a)});class Os extends Se{_parse(t){const{status:a,ctx:r}=this._processInputParams(t);if(r.parsedType!==re.set)return ee(r,{code:Y.invalid_type,expected:re.set,received:r.parsedType}),pe;const n=this._def;n.minSize!==null&&r.data.size<n.minSize.value&&(ee(r,{code:Y.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&r.data.size>n.maxSize.value&&(ee(r,{code:Y.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());const i=this._def.valueType;function l(c){const u=new Set;for(const h of c){if(h.status==="aborted")return pe;h.status==="dirty"&&a.dirty(),u.add(h.value)}return{status:a.value,value:u}}const o=[...r.data.values()].map((c,u)=>i._parse(new Ht(r,c,r.path,u)));return r.common.async?Promise.all(o).then(c=>l(c)):l(o)}min(t,a){return new Os({...this._def,minSize:{value:t,message:oe.toString(a)}})}max(t,a){return new Os({...this._def,maxSize:{value:t,message:oe.toString(a)}})}size(t,a){return this.min(t,a).max(t,a)}nonempty(t){return this.min(1,t)}}Os.create=(s,t)=>new Os({valueType:s,minSize:null,maxSize:null,typeName:fe.ZodSet,...Ne(t)});class mn extends Se{get schema(){return this._def.getter()}_parse(t){const{ctx:a}=this._processInputParams(t);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}}mn.create=(s,t)=>new mn({getter:s,typeName:fe.ZodLazy,...Ne(t)});class un extends Se{_parse(t){if(t.data!==this._def.value){const a=this._getOrReturnCtx(t);return ee(a,{received:a.data,code:Y.invalid_literal,expected:this._def.value}),pe}return{status:"valid",value:t.data}}get value(){return this._def.value}}un.create=(s,t)=>new un({value:s,typeName:fe.ZodLiteral,...Ne(t)});function ri(s,t){return new ys({values:s,typeName:fe.ZodEnum,...Ne(t)})}class ys extends Se{_parse(t){if(typeof t.data!="string"){const a=this._getOrReturnCtx(t),r=this._def.values;return ee(a,{expected:Ae.joinValues(r),received:a.parsedType,code:Y.invalid_type}),pe}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const a=this._getOrReturnCtx(t),r=this._def.values;return ee(a,{received:a.data,code:Y.invalid_enum_value,options:r}),pe}return pt(t.data)}get options(){return this._def.values}get enum(){const t={};for(const a of this._def.values)t[a]=a;return t}get Values(){const t={};for(const a of this._def.values)t[a]=a;return t}get Enum(){const t={};for(const a of this._def.values)t[a]=a;return t}extract(t,a=this._def){return ys.create(t,{...this._def,...a})}exclude(t,a=this._def){return ys.create(this.options.filter(r=>!t.includes(r)),{...this._def,...a})}}ys.create=ri;class Ka extends Se{_parse(t){const a=Ae.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==re.string&&r.parsedType!==re.number){const n=Ae.objectValues(a);return ee(r,{expected:Ae.joinValues(n),received:r.parsedType,code:Y.invalid_type}),pe}if(this._cache||(this._cache=new Set(Ae.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const n=Ae.objectValues(a);return ee(r,{received:r.data,code:Y.invalid_enum_value,options:n}),pe}return pt(t.data)}get enum(){return this._def.values}}Ka.create=(s,t)=>new Ka({values:s,typeName:fe.ZodNativeEnum,...Ne(t)});class ha extends Se{unwrap(){return this._def.type}_parse(t){const{ctx:a}=this._processInputParams(t);if(a.parsedType!==re.promise&&a.common.async===!1)return ee(a,{code:Y.invalid_type,expected:re.promise,received:a.parsedType}),pe;const r=a.parsedType===re.promise?a.data:Promise.resolve(a.data);return pt(r.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}}ha.create=(s,t)=>new ha({type:s,typeName:fe.ZodPromise,...Ne(t)});class bs extends Se{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===fe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:a,ctx:r}=this._processInputParams(t),n=this._def.effect||null,i={addIssue:l=>{ee(r,l),l.fatal?a.abort():a.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const l=n.transform(r.data,i);if(r.common.async)return Promise.resolve(l).then(async o=>{if(a.value==="aborted")return pe;const c=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return c.status==="aborted"?pe:c.status==="dirty"||a.value==="dirty"?Rs(c.value):c});{if(a.value==="aborted")return pe;const o=this._def.schema._parseSync({data:l,path:r.path,parent:r});return o.status==="aborted"?pe:o.status==="dirty"||a.value==="dirty"?Rs(o.value):o}}if(n.type==="refinement"){const l=o=>{const c=n.refinement(o,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?pe:(o.status==="dirty"&&a.dirty(),l(o.value),{status:a.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?pe:(o.status==="dirty"&&a.dirty(),l(o.value).then(()=>({status:a.value,value:o.value}))))}if(n.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ps(l))return pe;const o=n.transform(l.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>ps(l)?Promise.resolve(n.transform(l.value,i)).then(o=>({status:a.value,value:o})):pe);Ae.assertNever(n)}}bs.create=(s,t,a)=>new bs({schema:s,typeName:fe.ZodEffects,effect:t,...Ne(a)});bs.createWithPreprocess=(s,t,a)=>new bs({schema:t,effect:{type:"preprocess",transform:s},typeName:fe.ZodEffects,...Ne(a)});class Wt extends Se{_parse(t){return this._getType(t)===re.undefined?pt(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Wt.create=(s,t)=>new Wt({innerType:s,typeName:fe.ZodOptional,...Ne(t)});class vs extends Se{_parse(t){return this._getType(t)===re.null?pt(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}vs.create=(s,t)=>new vs({innerType:s,typeName:fe.ZodNullable,...Ne(t)});class Qa extends Se{_parse(t){const{ctx:a}=this._processInputParams(t);let r=a.data;return a.parsedType===re.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:a.path,parent:a})}removeDefault(){return this._def.innerType}}Qa.create=(s,t)=>new Qa({innerType:s,typeName:fe.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Ne(t)});class Ja extends Se{_parse(t){const{ctx:a}=this._processInputParams(t),r={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ca(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new $t(r.common.issues)},input:r.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new $t(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Ja.create=(s,t)=>new Ja({innerType:s,typeName:fe.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Ne(t)});class hn extends Se{_parse(t){if(this._getType(t)!==re.nan){const r=this._getOrReturnCtx(t);return ee(r,{code:Y.invalid_type,expected:re.nan,received:r.parsedType}),pe}return{status:"valid",value:t.data}}}hn.create=s=>new hn({typeName:fe.ZodNaN,...Ne(s)});class vo extends Se{_parse(t){const{ctx:a}=this._processInputParams(t),r=a.data;return this._def.type._parse({data:r,path:a.path,parent:a})}unwrap(){return this._def.type}}class yr extends Se{_parse(t){const{status:a,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?pe:i.status==="dirty"?(a.dirty(),Rs(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const n=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?pe:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:r.path,parent:r})}}static create(t,a){return new yr({in:t,out:a,typeName:fe.ZodPipeline})}}class Xa extends Se{_parse(t){const a=this._def.innerType._parse(t),r=n=>(ps(n)&&(n.value=Object.freeze(n.value)),n);return ca(a)?a.then(n=>r(n)):r(a)}unwrap(){return this._def.innerType}}Xa.create=(s,t)=>new Xa({innerType:s,typeName:fe.ZodReadonly,...Ne(t)});var fe;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(fe||(fe={}));const Pe=Ut.create,je=fs.create,as=Ya.create;Yt.create;At.create;const ks=He.create,Ra=ma.create;ua.create;rs.create;const jo=ys.create,No=Ka.create;ha.create;Wt.create;vs.create;const _o=ks({description:Pe().min(1,"Description is required"),current_balance:je().min(.01,"Balance must be positive"),monthly_payment:je().min(0,"Monthly payment cannot be negative"),interest_rate:je().min(0).max(50,"Interest rate must be between 0% and 50%"),loan_term_years:je().min(1).max(50,"Loan term must be between 1 and 50 years"),remaining_years:je().min(0).max(50,"Remaining years cannot exceed 50"),is_fixed_rate:Ra([as(),Pe()]).transform(s=>s===!0||s==="true").default(!0),property_value:je().min(0).optional(),purchase_date:Pe().optional(),escrow_included:Ra([as(),Pe()]).transform(s=>s===!0||s==="true").optional(),tax_deductible:Ra([as(),Pe()]).transform(s=>s===!0||s==="true").optional(),refinance_date:Pe().optional()}),wo=ks({card_name:Pe().min(1,"Card name is required"),current_balance:je().min(0,"Balance cannot be negative"),credit_limit:je().min(1,"Credit limit must be positive"),apr:je().min(0).max(50,"APR must be between 0% and 50%"),intro_apr:je().min(0).max(50).optional(),intro_apr_end_date:Pe().optional(),minimum_payment:je().min(0).optional(),average_monthly_payment:je().min(0).optional(),rewards_type:Pe().optional()}),ko=ks({vehicle_description:Pe().min(1,"Vehicle description is required"),current_balance:je().min(.01,"Balance must be positive"),monthly_payment:je().min(0,"Monthly payment cannot be negative"),interest_rate:je().min(0).max(30,"Interest rate must be between 0% and 30%"),original_loan_amount:je().min(1,"Original loan amount must be positive"),loan_term_months:je().min(1).max(120,"Loan term must be between 1 and 120 months"),remaining_months:je().min(0).max(120,"Remaining months cannot exceed 120"),vehicle_value:je().min(0).optional(),vehicle_year:je().min(1900).max(new Date().getFullYear()+2).optional(),vehicle_make:Pe().optional(),vehicle_model:Pe().optional()}),So=ks({loan_servicer:Pe().min(1,"Loan servicer is required"),current_balance:je().min(.01,"Balance must be positive"),monthly_payment:je().min(0,"Monthly payment cannot be negative"),interest_rate:je().min(0).max(20,"Interest rate must be between 0% and 20%"),loan_type:jo(["federal","private"],{required_error:"Loan type is required"}),repayment_plan:Pe().optional(),subsidized:as().optional(),eligible_for_forgiveness:as().optional(),graduation_date:Pe().optional(),first_payment_date:Pe().optional(),expected_payoff_date:Pe().optional()}),xn=ks({description:Pe().min(1,"Description is required"),current_balance:je().min(.01,"Balance must be positive"),monthly_payment:je().min(0,"Monthly payment cannot be negative"),interest_rate:je().min(0).max(50,"Interest rate must be between 0% and 50%"),loan_term_months:je().min(1).max(600,"Loan term must be between 1 and 600 months"),remaining_months:je().min(0).max(600,"Remaining months cannot exceed 600"),purpose:Pe().optional(),secured:as().default(!1)}),br=(s,t,a)=>{if(t===0)return s/a;const r=t/100/12;return s*(r*Math.pow(1+r,a))/(Math.pow(1+r,a)-1)},Co=(s,t,a)=>{if(a===0)return s/t;const r=a/100/12;return Math.log(t/(t-s*r))/Math.log(1+r)},ni=({subcategory:s,entry:t,isEditing:a=!1,onSubmit:r,onCancel:n})=>{const i=()=>{switch(s){case"mortgage_real_estate":return _o;case"credit_cards":return wo;case"auto_loans":return ko;case"student_loans":return So;case"personal_loans":return xn;default:return xn}},{register:l,handleSubmit:o,control:c,reset:u,formState:h,formState:{errors:f,isSubmitting:d},watch:x,setValue:b,trigger:m}=Xn({resolver:ti(i()),defaultValues:N(s,t,a)}),p=x();w.useEffect(()=>{if(a&&t){const j=N(s,t,a);u(j)}},[t,a,s,u]);function N(j,E,A){if(A&&E){console.log("🔍 Loading entry data for editing:",E);const R={current_balance:parseFloat(E.amount)||"",monthly_payment:parseFloat(E.minimum_payment)||"",interest_rate:parseFloat(E.interest_rate)||""};console.log("🔍 Basic editing data:",R);const F=(O=>{try{return JSON.parse(O||"{}")}catch{return{}}})(E.loan_details);switch(j){case"mortgage_real_estate":const O={...R,description:E.description||"",loan_term_years:E.loan_term_months?Math.round(E.loan_term_months/12):30,remaining_years:E.remaining_months?Math.round(E.remaining_months/12):"",is_fixed_rate:E.is_fixed_rate??!0,property_value:F.property_value||"",purchase_date:E.loan_start_date?new Date(E.loan_start_date).toISOString().split("T")[0]:"",escrow_included:F.escrow_included||!1,tax_deductible:F.tax_deductible||!0};return console.log("🔍 Mortgage form defaults:",O),O;case"credit_cards":return{...R,card_name:E.description||"",credit_limit:F.credit_limit||"",apr:E.interest_rate||"",rewards_type:F.rewards_type||""};case"auto_loans":return{...R,vehicle_description:E.description||"",original_loan_amount:E.original_amount||"",loan_term_months:E.loan_term_months||60,remaining_months:E.remaining_months||"",vehicle_year:F.vehicle_year||new Date().getFullYear(),vehicle_make:F.vehicle_make||"",vehicle_model:F.vehicle_model||""};case"student_loans":return{...R,loan_servicer:E.description||"",loan_type:F.loan_type||"federal",subsidized:F.subsidized||!1,eligible_for_forgiveness:F.eligible_for_forgiveness||!1};default:return{...R,description:E.description||"",loan_term_months:E.loan_term_months||36,remaining_months:E.remaining_months||"",secured:F.secured||!1}}}const y={current_balance:"",monthly_payment:"",interest_rate:""};switch(j){case"mortgage_real_estate":return{...y,description:"",loan_term_years:30,remaining_years:"",is_fixed_rate:!0,property_value:"",escrow_included:!1,tax_deductible:!0};case"credit_cards":return{...y,card_name:"",credit_limit:"",apr:"",rewards_type:""};case"auto_loans":return{...y,vehicle_description:"",original_loan_amount:"",loan_term_months:60,remaining_months:"",vehicle_year:new Date().getFullYear()};case"student_loans":return{...y,loan_servicer:"",loan_type:"federal",subsidized:!1,eligible_for_forgiveness:!1};default:return{...y,description:"",loan_term_months:36,remaining_months:"",secured:!1}}}const S=(()=>{const j=parseFloat(p.current_balance||"0"),E=parseFloat(p.monthly_payment||"0"),A=parseFloat(p.interest_rate||"0");if(j<=0||E<=0)return null;const y=[];if(E>0&&A>=0)try{const R=Co(j,E,A);if(R>0&&R<1200){const k=Math.floor(R/12),F=Math.ceil(R%12);y.push(`Payoff time: ${k} years, ${F} months`);const O=E*R-j;O>0&&y.push(`Total interest: $${O.toLocaleString()}`)}}catch{}return A<3?y.push("✅ Excellent rate - consider investing instead of early payoff"):A>15&&y.push("⚠️ High rate - prioritize paying this off"),y})(),T=async(j,E)=>{E&&(E.preventDefault(),E.stopPropagation()),console.log("🚀 Form submission started with data:",j);try{const A={category:q.LIABILITIES,subcategory:s,description:v(j,s),amount:parseFloat(j.current_balance||j.balance||"0"),currency:"USD",frequency:be.ONE_TIME,interest_rate:parseFloat(j.interest_rate||j.apr||"0"),loan_term_months:L(j,s),remaining_months:P(j,s),minimum_payment:parseFloat(j.minimum_payment||j.monthly_payment||"0"),is_fixed_rate:j.is_fixed_rate==="true"||j.is_fixed_rate===!0,loan_start_date:j.purchase_date||j.first_payment_date?new Date(j.purchase_date||j.first_payment_date).toISOString():void 0,original_amount:parseFloat(j.original_loan_amount||j.current_balance||"0"),loan_details:JSON.stringify(j)};console.log("📤 Submitting entry data:",A),await r(A),console.log("✅ Form submission successful!")}catch(A){console.error("❌ Form submission error:",A),alert("Failed to submit form: "+A)}};function v(j,E){switch(E){case"mortgage_real_estate":return j.description||"Home Mortgage";case"credit_cards":return j.card_name||"Credit Card";case"auto_loans":return j.vehicle_description||"Auto Loan";case"student_loans":return`${j.loan_servicer||"Student"} Loan`;default:return j.description||"Personal Loan"}}function L(j,E){switch(E){case"mortgage_real_estate":return parseInt(j.loan_term_years||"0")*12;case"auto_loans":case"personal_loans":return parseInt(j.loan_term_months||"0");default:return 0}}function P(j,E){switch(E){case"mortgage_real_estate":return parseInt(j.remaining_years||"0")*12;case"auto_loans":case"personal_loans":return parseInt(j.remaining_months||"0");default:return 0}}const z=()=>{switch(s){case"mortgage_real_estate":return e.jsx(Ao,{register:l,control:c,errors:f,watch:x,setValue:b});case"credit_cards":return e.jsx(To,{register:l,control:c,errors:f,watch:x,setValue:b});case"auto_loans":return e.jsx(Io,{register:l,control:c,errors:f,watch:x,setValue:b});case"student_loans":return e.jsx(Eo,{register:l,control:c,errors:f,watch:x,setValue:b});default:return e.jsx(Ro,{register:l,control:c,errors:f,watch:x,setValue:b})}},C=()=>({mortgage_real_estate:a?"Edit Mortgage Details":"Mortgage Details",credit_cards:a?"Edit Credit Card Details":"Credit Card Details",auto_loans:a?"Edit Auto Loan Details":"Auto Loan Details",student_loans:a?"Edit Student Loan Details":"Student Loan Details",personal_loans:a?"Edit Personal Loan Details":"Personal Loan Details"})[s]||(a?"Edit Loan Details":"Loan Details");return e.jsxs(_,{className:"max-w-4xl mx-auto",children:[e.jsxs(_.Header,{children:[e.jsx(_.Title,{children:C()}),e.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"Enter detailed information to receive personalized financial advice"})]}),e.jsxs("form",{onSubmit:j=>{j.preventDefault(),j.stopPropagation()},className:"space-y-6",children:[z(),S&&S.length>0&&e.jsxs("div",{className:"bg-blue-900/20 border border-blue-600 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-blue-300 font-medium flex items-center gap-2 mb-2",children:[e.jsx(gs,{className:"w-4 h-4"}),"Smart Insights"]}),e.jsx("div",{className:"space-y-1",children:S.map((j,E)=>e.jsx("p",{className:"text-sm text-blue-200",children:j},E))})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx($,{type:"button",onClick:o(T),isLoading:d,className:"flex-1 md:flex-none",leftIcon:e.jsx(_s,{className:"w-4 h-4"}),children:a?"Update Liability":"Add Liability"}),n&&e.jsx($,{type:"button",variant:"outline",onClick:n,disabled:d,children:"Cancel"})]})]})]})},Ao=({register:s,control:t,errors:a,watch:r,setValue:n})=>{var u,h,f,d,x,b,m,p;const i=parseFloat(r("current_balance")||"0"),l=parseFloat(r("interest_rate")||"0"),o=parseInt(r("loan_term_years")||"0"),c=()=>{if(i>0&&l>0&&o>0){const N=br(i,l,o*12);n("monthly_payment",Math.round(N))}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Description *",placeholder:"e.g., Home Loan, Primary Mortgage",error:(u=a.description)==null?void 0:u.message,...s("description")}),e.jsx(W,{label:"Current Balance *",type:"number",step:"0.01",placeholder:"313,026",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(h=a.current_balance)==null?void 0:h.message,...s("current_balance",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(W,{label:"Interest Rate * (%)",type:"number",step:"0.001",placeholder:"2.75",error:(f=a.interest_rate)==null?void 0:f.message,...s("interest_rate",{valueAsNumber:!0})}),e.jsx(W,{label:"Original Term (Years) *",type:"number",placeholder:"30",error:(d=a.loan_term_years)==null?void 0:d.message,...s("loan_term_years",{valueAsNumber:!0})}),e.jsx(W,{label:"Years Remaining *",type:"number",placeholder:"15",error:(x=a.remaining_years)==null?void 0:x.message,...s("remaining_years",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(W,{label:"Monthly Payment",type:"number",step:"0.01",placeholder:"2,264",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(b=a.monthly_payment)==null?void 0:b.message,...s("monthly_payment",{valueAsNumber:!0})}),e.jsx($,{type:"button",variant:"outline",onClick:c,className:"mt-6 px-3",title:"Calculate payment",children:e.jsx(_s,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Rate Type"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"true",...s("is_fixed_rate"),className:"mr-2",defaultChecked:!0}),"Fixed Rate"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"false",...s("is_fixed_rate"),className:"mr-2"}),"Variable Rate"]})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-600 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-200 mb-3",children:"Property Information (Optional)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Property Value",type:"number",step:"0.01",placeholder:"1,050,000",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(m=a.property_value)==null?void 0:m.message,...s("property_value",{valueAsNumber:!0})}),e.jsx(W,{label:"Purchase Date",type:"date",error:(p=a.purchase_date)==null?void 0:p.message,...s("purchase_date")})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...s("escrow_included"),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Escrow included (taxes, insurance)"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...s("tax_deductible"),className:"mr-2",defaultChecked:!0}),e.jsx("span",{className:"text-sm text-gray-200",children:"Interest is tax deductible"})]})]})]})]})},To=({register:s,control:t,errors:a,watch:r})=>{var o,c,u,h,f,d,x,b;const n=parseFloat(r("current_balance")||"0"),i=parseFloat(r("credit_limit")||"0"),l=i>0?(n/i*100).toFixed(1):"0";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Card Name *",placeholder:"e.g., Chase Sapphire, Capital One",error:(o=a.card_name)==null?void 0:o.message,...s("card_name")}),e.jsx(W,{label:"Current Balance *",type:"number",step:"0.01",placeholder:"971",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(c=a.current_balance)==null?void 0:c.message,...s("current_balance",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(W,{label:"Credit Limit *",type:"number",step:"0.01",placeholder:"15,000",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(u=a.credit_limit)==null?void 0:u.message,...s("credit_limit",{valueAsNumber:!0})}),e.jsx(W,{label:"APR * (%)",type:"number",step:"0.01",placeholder:"22.99",error:(h=a.apr)==null?void 0:h.message,...s("apr",{valueAsNumber:!0})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200 mb-1",children:"Utilization Rate"}),e.jsxs("div",{className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-sm",children:[l,"%",parseFloat(l)>30&&e.jsx("span",{className:"text-red-400 ml-2",children:"High"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Minimum Payment",type:"number",step:"0.01",placeholder:"30",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(f=a.minimum_payment)==null?void 0:f.message,...s("minimum_payment",{valueAsNumber:!0})}),e.jsx(W,{label:"Average Monthly Payment",type:"number",step:"0.01",placeholder:"200",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(d=a.average_monthly_payment)==null?void 0:d.message,...s("average_monthly_payment",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-600 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-200 mb-3",children:"Additional Details (Optional)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Intro APR (%)",type:"number",step:"0.01",placeholder:"0",error:(x=a.intro_apr)==null?void 0:x.message,...s("intro_apr",{valueAsNumber:!0})}),e.jsx(W,{label:"Intro APR End Date",type:"date",error:(b=a.intro_apr_end_date)==null?void 0:b.message,...s("intro_apr_end_date")})]}),e.jsx("div",{className:"mt-4",children:e.jsx(gt,{name:"rewards_type",control:t,render:({field:m})=>e.jsx($e,{label:"Rewards Type",options:[{value:"",label:"No rewards"},{value:"cashback",label:"Cashback"},{value:"points",label:"Points"},{value:"miles",label:"Miles"}],...m})})})]})]})},Io=({register:s,control:t,errors:a,watch:r,setValue:n})=>{var u,h,f,d,x,b,m,p,N,g,S;parseFloat(r("current_balance")||"0");const i=parseFloat(r("original_loan_amount")||"0"),l=parseFloat(r("interest_rate")||"0"),o=parseInt(r("loan_term_months")||"0"),c=()=>{if(i>0&&l>0&&o>0){const T=br(i,l,o);n("monthly_payment",Math.round(T))}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Vehicle Description *",placeholder:"e.g., 2021 Tesla Model 3",error:(u=a.vehicle_description)==null?void 0:u.message,...s("vehicle_description")}),e.jsx(W,{label:"Current Balance *",type:"number",step:"0.01",placeholder:"25,000",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(h=a.current_balance)==null?void 0:h.message,...s("current_balance",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(W,{label:"Original Loan Amount *",type:"number",step:"0.01",placeholder:"45,000",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(f=a.original_loan_amount)==null?void 0:f.message,...s("original_loan_amount",{valueAsNumber:!0})}),e.jsx(W,{label:"Interest Rate * (%)",type:"number",step:"0.01",placeholder:"3.5",error:(d=a.interest_rate)==null?void 0:d.message,...s("interest_rate",{valueAsNumber:!0})}),e.jsx(W,{label:"Loan Term (Months) *",type:"number",placeholder:"60",error:(x=a.loan_term_months)==null?void 0:x.message,...s("loan_term_months",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(W,{label:"Monthly Payment *",type:"number",step:"0.01",placeholder:"812",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(b=a.monthly_payment)==null?void 0:b.message,...s("monthly_payment",{valueAsNumber:!0})}),e.jsx($,{type:"button",variant:"outline",onClick:c,className:"mt-6 px-3",title:"Calculate payment",children:e.jsx(_s,{className:"w-4 h-4"})})]}),e.jsx(W,{label:"Months Remaining *",type:"number",placeholder:"36",error:(m=a.remaining_months)==null?void 0:m.message,...s("remaining_months",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-600 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-200 mb-3",children:"Vehicle Details (Optional)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(W,{label:"Current Value",type:"number",step:"0.01",placeholder:"30,000",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(p=a.vehicle_value)==null?void 0:p.message,...s("vehicle_value",{valueAsNumber:!0})}),e.jsx(W,{label:"Year",type:"number",placeholder:"2021",error:(N=a.vehicle_year)==null?void 0:N.message,...s("vehicle_year",{valueAsNumber:!0})}),e.jsx(W,{label:"Make",placeholder:"Tesla",error:(g=a.vehicle_make)==null?void 0:g.message,...s("vehicle_make")}),e.jsx(W,{label:"Model",placeholder:"Model 3",error:(S=a.vehicle_model)==null?void 0:S.message,...s("vehicle_model")})]})]})]})},Eo=({register:s,control:t,errors:a})=>{var r,n,i,l,o,c,u,h;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Loan Servicer *",placeholder:"e.g., Navient, Great Lakes",error:(r=a.loan_servicer)==null?void 0:r.message,...s("loan_servicer")}),e.jsx(W,{label:"Current Balance *",type:"number",step:"0.01",placeholder:"35,000",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(n=a.current_balance)==null?void 0:n.message,...s("current_balance",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(W,{label:"Monthly Payment *",type:"number",step:"0.01",placeholder:"350",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(i=a.monthly_payment)==null?void 0:i.message,...s("monthly_payment",{valueAsNumber:!0})}),e.jsx(W,{label:"Interest Rate * (%)",type:"number",step:"0.01",placeholder:"4.5",error:(l=a.interest_rate)==null?void 0:l.message,...s("interest_rate",{valueAsNumber:!0})}),e.jsx(gt,{name:"loan_type",control:t,render:({field:f})=>{var d;return e.jsx($e,{label:"Loan Type *",options:[{value:"federal",label:"Federal"},{value:"private",label:"Private"}],error:(d=a.loan_type)==null?void 0:d.message,...f})}})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-600 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-200 mb-3",children:"Federal Loan Details (Optional)"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:e.jsx(W,{label:"Repayment Plan",placeholder:"e.g., Income-Driven, Standard",error:(o=a.repayment_plan)==null?void 0:o.message,...s("repayment_plan")})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...s("subsidized"),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Subsidized loan"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...s("eligible_for_forgiveness"),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Eligible for loan forgiveness"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(W,{label:"Graduation Date",type:"date",error:(c=a.graduation_date)==null?void 0:c.message,...s("graduation_date")}),e.jsx(W,{label:"First Payment Date",type:"date",error:(u=a.first_payment_date)==null?void 0:u.message,...s("first_payment_date")}),e.jsx(W,{label:"Expected Payoff Date",type:"date",error:(h=a.expected_payoff_date)==null?void 0:h.message,...s("expected_payoff_date")})]})]})},Ro=({register:s,control:t,errors:a,watch:r,setValue:n})=>{var u,h,f,d,x,b;const i=parseFloat(r("current_balance")||"0"),l=parseFloat(r("interest_rate")||"0"),o=parseInt(r("loan_term_months")||"0"),c=()=>{if(i>0&&l>0&&o>0){const m=br(i,l,o);n("monthly_payment",Math.round(m))}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Description *",placeholder:"e.g., Personal Loan, Debt Consolidation",error:(u=a.description)==null?void 0:u.message,...s("description")}),e.jsx(W,{label:"Current Balance *",type:"number",step:"0.01",placeholder:"10,000",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(h=a.current_balance)==null?void 0:h.message,...s("current_balance",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(W,{label:"Interest Rate * (%)",type:"number",step:"0.01",placeholder:"8.5",error:(f=a.interest_rate)==null?void 0:f.message,...s("interest_rate",{valueAsNumber:!0})}),e.jsx(W,{label:"Loan Term (Months) *",type:"number",placeholder:"36",error:(d=a.loan_term_months)==null?void 0:d.message,...s("loan_term_months",{valueAsNumber:!0})}),e.jsx(W,{label:"Months Remaining *",type:"number",placeholder:"24",error:(x=a.remaining_months)==null?void 0:x.message,...s("remaining_months",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(W,{label:"Monthly Payment *",type:"number",step:"0.01",placeholder:"315",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(b=a.monthly_payment)==null?void 0:b.message,...s("monthly_payment",{valueAsNumber:!0})}),e.jsx($,{type:"button",variant:"outline",onClick:c,className:"mt-6 px-3",title:"Calculate payment",children:e.jsx(_s,{className:"w-4 h-4"})})]}),e.jsx(gt,{name:"purpose",control:t,render:({field:m})=>e.jsx($e,{label:"Purpose",options:[{value:"",label:"Not specified"},{value:"debt_consolidation",label:"Debt Consolidation"},{value:"home_improvement",label:"Home Improvement"},{value:"medical",label:"Medical Expenses"},{value:"vacation",label:"Vacation"},{value:"other",label:"Other"}],...m})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...s("secured"),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Secured loan (backed by collateral)"})]})})]})},Po={[q.ASSETS]:{"Cash & Bank Accounts":[{name:"Checking Account",avgValue:3e3,description:"Primary checking account",cash_percentage:100},{name:"Savings Account",avgValue:5e4,description:"Emergency fund and savings",cash_percentage:100},{name:"Money Market Account",avgValue:67e3,description:"High-yield savings account",cash_percentage:100},{name:"Checking Offshore",avgValue:5681,description:"Offshore bank account",cash_percentage:100},{name:"Certificate of Deposit",avgValue:1e4,description:"Fixed-term deposit",cash_percentage:100}],"Investment Accounts":[{name:"Brokerage Account",avgValue:1e5,description:"Taxable investment account",stocks_percentage:70,bonds_percentage:15,cash_percentage:10,real_estate_percentage:5},{name:"Individual Stocks",avgValue:25e3,description:"Direct stock holdings",stocks_percentage:100},{name:"ETF Portfolio",avgValue:5e4,description:"Exchange-traded funds",stocks_percentage:80,bonds_percentage:20},{name:"Mutual Funds",avgValue:75e3,description:"Managed investment funds",stocks_percentage:60,bonds_percentage:30,real_estate_percentage:10}],"Retirement Accounts":[{name:"401k Account",avgValue:15e4,description:"Employer-sponsored retirement",stocks_percentage:60,bonds_percentage:30,real_estate_percentage:10},{name:"Traditional IRA",avgValue:75e3,description:"Traditional individual retirement",stocks_percentage:65,bonds_percentage:35},{name:"Roth IRA",avgValue:5e4,description:"After-tax retirement account",stocks_percentage:70,bonds_percentage:20,real_estate_percentage:10},{name:"SEP-IRA",avgValue:1e5,description:"Self-employed retirement",stocks_percentage:55,bonds_percentage:35,real_estate_percentage:10}],"Real Estate":[{name:"Primary Residence",avgValue:45e4,description:"Your main home",real_estate_percentage:100},{name:"Rental Property",avgValue:3e5,description:"Investment rental property",real_estate_percentage:100},{name:"Vacation Home",avgValue:25e4,description:"Second home or vacation property",real_estate_percentage:100}],"Personal Property":[{name:"Jewelry",avgValue:3e4,description:"Valuable jewelry and watches",alternative_percentage:100},{name:"Art & Collectibles",avgValue:25e3,description:"Art, antiques, collectibles",alternative_percentage:100},{name:"Vehicles",avgValue:35e3,description:"Cars, boats, motorcycles",alternative_percentage:100},{name:"Electronics",avgValue:5e3,description:"Computers, phones, gadgets"},{name:"Furniture",avgValue:15e3,description:"Home furniture and fixtures"}],"Business Assets":[{name:"Business Checking",avgValue:25e3,description:"Business bank account"},{name:"Business Equipment",avgValue:5e4,description:"Machinery, computers, tools"},{name:"Business Real Estate",avgValue:5e5,description:"Commercial property"},{name:"Business Investments",avgValue:1e5,description:"Business-owned investments"}]},[q.LIABILITIES]:{"Mortgage & Real Estate":[{name:"Primary Mortgage",avgValue:35e4,description:"Home loan balance"},{name:"Investment Property Loan",avgValue:2e5,description:"Rental property mortgage"},{name:"HELOC",avgValue:5e4,description:"Home equity line of credit"}],"Credit Cards":[{name:"Personal Credit Card",avgValue:5e3,description:"Credit card balance"},{name:"Business Credit Card",avgValue:8e3,description:"Business expenses card"}]},[q.INCOME]:{"Employment Income":[{name:"Base Salary",avgValue:8e3,description:"Monthly salary",frequency:be.MONTHLY},{name:"Annual Bonus",avgValue:15e3,description:"Year-end bonus",frequency:be.ANNUALLY},{name:"Stock Options",avgValue:25e3,description:"Equity compensation",frequency:be.ANNUALLY}],"Investment Income":[{name:"Dividend Income",avgValue:500,description:"Stock dividends",frequency:be.MONTHLY},{name:"Rental Income",avgValue:2500,description:"Property rental",frequency:be.MONTHLY},{name:"Interest Income",avgValue:200,description:"Savings interest",frequency:be.MONTHLY}]},[q.EXPENSES]:{Housing:[{name:"Mortgage Payment",avgValue:2500,description:"Monthly mortgage",frequency:be.MONTHLY},{name:"Property Tax",avgValue:8e3,description:"Annual property tax",frequency:be.ANNUALLY},{name:"Utilities",avgValue:200,description:"Electric, gas, water",frequency:be.MONTHLY}],Transportation:[{name:"Car Payment",avgValue:400,description:"Auto loan payment",frequency:be.MONTHLY},{name:"Gas",avgValue:150,description:"Fuel costs",frequency:be.MONTHLY},{name:"Car Insurance",avgValue:1200,description:"Auto insurance",frequency:be.ANNUALLY}]}},gn=s=>({[q.PROFILE]:[{value:"",label:"Select subcategory..."},{value:"Personal Information",label:"Personal Information"},{value:"Spouse/Partner",label:"Spouse/Partner"},{value:"Dependents",label:"Dependents"},{value:"Extended Family",label:"Extended Family"},{value:"Contact & Location",label:"Contact & Location"}],[q.BENEFITS]:[{value:"",label:"Select subcategory..."},{value:"social_security",label:"Social Security"},{value:"employment_benefits",label:"Employment Benefits"},{value:"government_benefits",label:"Government Benefits"}],[q.TAX_INFO]:[{value:"",label:"Select subcategory..."},{value:"filing_status",label:"Filing Status"},{value:"tax_advantaged",label:"Tax Advantaged Accounts"},{value:"tax_planning",label:"Tax Planning"}],[q.ASSETS]:[{value:"",label:"Select subcategory..."},{value:"cash_bank_accounts",label:"Cash & Bank Accounts"},{value:"investment_accounts",label:"Investment Accounts"},{value:"retirement_accounts",label:"Retirement Accounts"},{value:"real_estate",label:"Real Estate"},{value:"personal_property",label:"Personal Property"},{value:"business_assets",label:"Business Assets"},{value:"other_assets",label:"Other Assets"}],[q.LIABILITIES]:[{value:"",label:"Select subcategory..."},{value:"mortgage_real_estate",label:"Mortgage & Real Estate"},{value:"credit_cards",label:"Credit Cards"},{value:"auto_loans",label:"Auto Loans"},{value:"student_loans",label:"Student Loans"},{value:"personal_loans",label:"Personal Loans"},{value:"other_debt",label:"Other Debt"}],[q.INCOME]:[{value:"",label:"Select subcategory..."},{value:"employment_income",label:"Employment Income"},{value:"business_income",label:"Business Income"},{value:"investment_income",label:"Investment Income"},{value:"rental_income",label:"Rental Income"},{value:"passive_income",label:"Passive Income"},{value:"other_income",label:"Other Income"}],[q.EXPENSES]:[{value:"",label:"Select subcategory..."},{value:"housing",label:"Housing"},{value:"utilities",label:"Utilities"},{value:"transportation",label:"Transportation"},{value:"food",label:"Food & Dining"},{value:"healthcare",label:"Healthcare"},{value:"personal",label:"Personal"}]})[s]||[],Lo=({isOpen:s,onClose:t,category:a,subcategory:r,onSuccess:n,editingEntry:i})=>{var p,N;const[l,o]=w.useState({category:a||q.ASSETS,subcategory:r||"",description:"",amount:0,currency:"USD",frequency:be.ONE_TIME,notes:"",real_estate_percentage:void 0,stocks_percentage:void 0,bonds_percentage:void 0,cash_percentage:void 0,alternative_percentage:void 0}),c=Dn(),u=Sl();w.useEffect(()=>{s&&o(g=>({...g,category:a||q.ASSETS,subcategory:r||""}))},[s,a,r]),w.useEffect(()=>{s&&i&&(console.log("📝 Initializing form with editing entry:",i),typeof i.id=="string"&&i.id.startsWith("profile-")?o(g=>({...g,category:q.PROFILE,subcategory:"Personal Information",description:i.description,amount:0,notes:i.notes,frequency:be.ONE_TIME})):o(g=>({...g,category:i.category||a||q.ASSETS,subcategory:i.subcategory||r||"",description:i.description||"",amount:i.amount||0,notes:i.notes||"",frequency:i.frequency||be.ONE_TIME})))},[s,i,a,r]),w.useEffect(()=>{console.log("📝 FormData updated:",{category:l.category,subcategory:l.subcategory,isLiabilities:l.category===q.LIABILITIES,isEnhancedType:["mortgage_real_estate","credit_cards","auto_loans","student_loans","personal_loans"].includes(l.subcategory)})},[l.category,l.subcategory]),w.useEffect(()=>{a&&o(g=>({...g,category:a})),r&&o(g=>({...g,subcategory:r}))},[a,r]);const h=g=>{o({...l,description:g.name,amount:g.avgValue,frequency:g.frequency||be.ONE_TIME,notes:g.description,real_estate_percentage:g.real_estate_percentage||0,stocks_percentage:g.stocks_percentage||0,bonds_percentage:g.bonds_percentage||0,cash_percentage:g.cash_percentage||0,alternative_percentage:g.alternative_percentage||0})},f=async g=>{g.preventDefault();const S=l.category===q.PROFILE||l.category===q.BENEFITS||l.category===q.TAX_INFO;if(!l.description||!S&&l.amount<=0){alert("Please fill in all required fields");return}const T={...l,amount:parseFloat(l.amount.toString()),frequency:S?be.ONE_TIME:l.frequency};try{console.log("📤 Submitting entry:",T),console.log("📤 Subcategory value being sent:",T.subcategory),console.log("📤 Full form data:",JSON.stringify(T,null,2));let v;if(S)if(i&&typeof i.id=="string"&&i.id.startsWith("profile-")){console.log("🔄 Updating existing profile entry:",i.id),console.log("🔍 SMART MODAL DEBUG - Edit path taken for profile entry");const{profileApi:L}=await Mn(async()=>{const{profileApi:z}=await Promise.resolve().then(()=>On);return{profileApi:z}},void 0);let P={};switch(i.id){case"profile-age":P.age=parseInt(T.notes)||null;break;case"profile-state":P.state=T.notes||null;break;case"profile-notes":P.notes=`Name: ${T.notes}`;break;case"profile-marital":P.marital_status=T.notes||null;break;case"profile-employment":P.employment_status=T.notes||null;break;case"profile-occupation":P.occupation=T.notes||null;break;case"profile-gender":P.gender=T.notes||null;break;case"profile-phone":P.phone=T.notes||null;break;case"profile-city":P.city=T.notes||null;break;case"profile-risk":P.risk_tolerance=T.notes||null;break;default:console.warn("Unknown profile field for update:",i.id),P.notes=`${T.description}: ${T.notes}`}console.log("📤 Profile update data:",P),v=await L.updateProfile(P),console.log("✅ Profile entry updated successfully:",v)}else console.log("🔍 SMART MODAL DEBUG - Create path taken for new profile entry"),console.log("📤 Submission data being sent to createProfileMutation:",T),v=await u.mutateAsync(T),console.log("✅ Profile entry created successfully:",v);else v=await c.mutateAsync(T),console.log("✅ Financial entry created successfully:",v);n==null||n(),t(),o({category:a||q.ASSETS,subcategory:r||"",description:"",amount:0,currency:"USD",frequency:be.ONE_TIME,notes:"",real_estate_percentage:void 0,stocks_percentage:void 0,bonds_percentage:void 0,cash_percentage:void 0,alternative_percentage:void 0})}catch(v){console.error("❌ Failed to create entry:",v),console.error("❌ Error details:",{status_code:v==null?void 0:v.status_code,detail:v==null?void 0:v.detail,message:v==null?void 0:v.message,fullError:v});let L="Failed to save entry: ";(v==null?void 0:v.status_code)===401?(L+="Your session has expired. Please refresh the page and log in again.",setTimeout(()=>{confirm("Your session has expired. Would you like to refresh the page to log in again?")&&window.location.reload()},100)):(v==null?void 0:v.status_code)===422?L+=`Invalid data. ${(v==null?void 0:v.detail)||"Please check your inputs."}`:v!=null&&v.detail?L+=v.detail:v instanceof Error?L+=v.message:L+="Unknown error",alert(L)}};if(!s)return null;const d=l.subcategory||"General",x=((p=Po[l.category])==null?void 0:p[d])||[],b=[{value:q.PROFILE,label:"Profile"},{value:q.ASSETS,label:"Assets"},{value:q.LIABILITIES,label:"Liabilities"},{value:q.INCOME,label:"Income"},{value:q.EXPENSES,label:"Expenses"},{value:q.BENEFITS,label:"Benefits"},{value:q.TAX_INFO,label:"Tax Info"}],m=[{value:be.ONE_TIME,label:"One-time"},{value:be.MONTHLY,label:"Monthly"},{value:be.ANNUALLY,label:"Annually"},{value:be.QUARTERLY,label:"Quarterly"},{value:be.WEEKLY,label:"Weekly"}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto border border-gray-700",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:["Add ",l.category.charAt(0).toUpperCase()+l.category.slice(1)," Entry"]}),l.subcategory&&e.jsxs("p",{className:"text-blue-100 text-sm mt-1",children:["Subcategory: ",((N=gn(l.category).find(g=>g.value===l.subcategory))==null?void 0:N.label)||l.subcategory]})]}),e.jsx("button",{onClick:t,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors",children:e.jsx(is,{className:"w-5 h-5"})})]})}),x.length>0&&e.jsxs("div",{className:"p-6 border-b bg-gray-700 border-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(el,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-300",children:["Smart Suggestions for ",d]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:x.map((g,S)=>e.jsxs("button",{onClick:()=>h(g),className:"text-left p-3 bg-gray-700 border border-gray-600 rounded-lg hover:border-blue-400 hover:bg-gray-600 transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-100 text-sm",children:g.name}),e.jsxs("div",{className:"text-blue-600 text-sm font-semibold",children:["$",g.avgValue.toLocaleString()]}),e.jsx("div",{className:"text-xs text-gray-300",children:g.description})]},S))})]}),l.category===q.LIABILITIES&&l.subcategory&&["mortgage_real_estate","credit_cards","auto_loans","student_loans","personal_loans"].includes(l.subcategory)?e.jsx("div",{className:"p-6",children:e.jsx(ni,{subcategory:l.subcategory,isEditing:!1,onSubmit:async g=>{try{console.log("💳 Smart liability form submitted from modal:",g);const S=await c.mutateAsync(g);console.log("✅ Smart form create successful:",S),n==null||n(),t()}catch(S){console.error("❌ Smart form submission failed:",S),alert(`❌ Failed to create entry. Error: ${S.message||S.detail||S.toString()}`)}},onCancel:t})}):e.jsxs("form",{onSubmit:f,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Category"}),e.jsx($e,{options:b,value:l.category,onChange:g=>{console.log("🔄 Category changed to:",g.target.value),o({...l,category:g.target.value,subcategory:""})}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Subcategory"}),e.jsx($e,{value:l.subcategory,onChange:g=>{console.log("🔄 Subcategory changed to:",g.target.value),o({...l,subcategory:g.target.value})},options:gn(l.category)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),e.jsx(W,{type:"text",value:l.description,onChange:g=>o({...l,description:g.target.value}),placeholder:"Enter a clear description",leftIcon:e.jsx(lt,{className:"w-4 h-4"}),required:!0})]}),l.category===q.PROFILE||l.category===q.BENEFITS||l.category===q.TAX_INFO?e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Value"}),e.jsx(W,{type:"text",value:l.notes||"",onChange:g=>{o({...l,notes:g.target.value,amount:0})},placeholder:l.category===q.PROFILE?"e.g., 45, California, Married":l.category===q.BENEFITS?"e.g., 3500, Full retirement at 67":"e.g., 32%, Married filing jointly"})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Amount *"}),e.jsx(W,{type:"text",inputMode:"decimal",value:l.amount>0?l.amount.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}):"",onChange:g=>{let S=g.target.value;S=S.replace(/[^0-9.,]/g,"");const T=S.replace(/,/g,"");if(T===""){o({...l,amount:0});return}let v=T;v.length>1&&v[0]==="0"&&v[1]!=="."&&(v=v.replace(/^0+/,""),v===""&&(v="0"));const L=v.split(".");L.length>2&&(v=L[0]+"."+L.slice(1).join("")),L.length===2&&L[1].length>2&&(v=L[0]+"."+L[1].substring(0,2));const P=parseFloat(v);isNaN(P)?o({...l,amount:0}):o({...l,amount:P})},placeholder:"0",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Frequency"}),e.jsx($e,{options:m,value:l.frequency,onChange:g=>o({...l,frequency:g.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:l.notes,onChange:g=>o({...l,notes:g.target.value}),placeholder:"Additional details (optional)",className:"w-full p-3 border border-gray-600 bg-gray-700 text-gray-100 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]})]}),l.category===q.ASSETS&&e.jsxs("div",{className:"border-t border-gray-600 pt-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-green-300 mb-3 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2"}),"Asset Allocation (How is this asset allocated?)"]}),e.jsx("p",{className:"text-sm text-green-200 mb-4",children:"For accurate portfolio analysis, tell us how this asset is allocated across different asset classes:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(W,{label:"Real Estate %",type:"number",min:"0",max:"100",value:l.real_estate_percentage||"",onChange:g=>o({...l,real_estate_percentage:g.target.value?Number(g.target.value):void 0}),placeholder:"0"}),e.jsx(W,{label:"Stocks %",type:"number",min:"0",max:"100",value:l.stocks_percentage||"",onChange:g=>o({...l,stocks_percentage:g.target.value?Number(g.target.value):void 0}),placeholder:"0"}),e.jsx(W,{label:"Bonds %",type:"number",min:"0",max:"100",value:l.bonds_percentage||"",onChange:g=>o({...l,bonds_percentage:g.target.value?Number(g.target.value):void 0}),placeholder:"0"}),e.jsx(W,{label:"Cash %",type:"number",min:"0",max:"100",value:l.cash_percentage||"",onChange:g=>o({...l,cash_percentage:g.target.value?Number(g.target.value):void 0}),placeholder:"0"}),e.jsx(W,{label:"Alternative %",type:"number",min:"0",max:"100",value:l.alternative_percentage||"",onChange:g=>o({...l,alternative_percentage:g.target.value?Number(g.target.value):void 0}),placeholder:"0"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-xs text-green-200",children:[e.jsxs("strong",{children:["Total: ",(l.real_estate_percentage||0)+(l.stocks_percentage||0)+(l.bonds_percentage||0)+(l.cash_percentage||0)+(l.alternative_percentage||0),"%"]}),(l.real_estate_percentage||0)+(l.stocks_percentage||0)+(l.bonds_percentage||0)+(l.cash_percentage||0)+(l.alternative_percentage||0)>100&&e.jsx("span",{className:"text-red-400 ml-2",children:"⚠️ Total exceeds 100%"}),(l.real_estate_percentage||0)+(l.stocks_percentage||0)+(l.bonds_percentage||0)+(l.cash_percentage||0)+(l.alternative_percentage||0)===100&&e.jsx("span",{className:"text-green-400 ml-2",children:"✅ Perfect!"})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2",children:[e.jsx("strong",{children:"Examples:"}),e.jsxs("ul",{className:"mt-1 space-y-1",children:[e.jsx("li",{children:"• Primary Home: Real Estate 100%"}),e.jsx("li",{children:"• 401K: Stocks 60%, Bonds 30%, Real Estate 10%"}),e.jsx("li",{children:"• Bitcoin: Alternative 100%"}),e.jsx("li",{children:"• Checking: Cash 100%"}),e.jsx("li",{children:"• Brokerage: Stocks 70%, Bonds 15%, Cash 10%, Real Estate 5%"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-600",children:[e.jsx($,{type:"button",variant:"outline",onClick:t,disabled:c.isLoading||u.isLoading,children:"Cancel"}),e.jsx($,{type:"submit",disabled:c.isLoading||u.isLoading,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:c.isLoading||u.isLoading?"Saving...":"Save Entry"})]})]})]})})},Fo=ks({category:No(q,{required_error:"Category is required"}),subcategory:Pe().optional(),description:Pe().min(1,"Description is required").max(255,"Description must be less than 255 characters"),amount:je({required_error:"Value is required",invalid_type_error:"Value must be a number"}).min(0,"Value must be at least 0").max(99999999999e-2,"Value is too large"),currency:Pe().default("USD"),frequency:Pe().refine(s=>Object.values(be).includes(s),{message:"Invalid frequency value"}).default(be.ONE_TIME),entry_date:Pe().optional(),notes:Pe().optional(),real_estate_percentage:je().min(0).max(100).optional(),stocks_percentage:je().min(0).max(100).optional(),bonds_percentage:je().min(0).max(100).optional(),cash_percentage:je().min(0).max(100).optional(),alternative_percentage:je().min(0).max(100).optional(),interest_rate:je().min(0).max(50).optional(),loan_term_months:je().min(0).max(600).optional(),remaining_months:je().min(0).max(600).optional(),minimum_payment:je().min(0).optional(),is_fixed_rate:as().optional(),loan_start_date:Pe().optional(),original_amount:je().min(0).optional(),loan_details:Pe().optional()}),Pa=s=>s.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}),Mo=({entry:s,onSuccess:t,onCancel:a})=>{var L,P,z,C;const r=!!s,n=Dn(),i=fl(),{register:l,handleSubmit:o,control:c,reset:u,formState:{errors:h,isSubmitting:f},watch:d,setValue:x}=Xn({resolver:ti(Fo),defaultValues:{category:q.ASSETS,subcategory:"",description:"",amount:0,currency:"USD",frequency:be.ONE_TIME,entry_date:"",notes:"",real_estate_percentage:void 0,stocks_percentage:void 0,bonds_percentage:void 0,cash_percentage:void 0,alternative_percentage:void 0,interest_rate:void 0,loan_term_months:void 0,remaining_months:void 0,minimum_payment:void 0,is_fixed_rate:void 0,loan_start_date:void 0,original_amount:void 0,loan_details:void 0}});w.useEffect(()=>{if(s){console.log("🔍 Setting form data for entry:",s),console.log("🔍 Entry object keys:",Object.keys(s)),console.log("🔍 Entry values:",{id:s.id,category:s.category,subcategory:s.subcategory,description:s.description,amount:s.amount,frequency:s.frequency,currency:s.currency,entry_date:s.entry_date,interest_rate:s.interest_rate});let j=s.frequency;Object.values(be).includes(s.frequency)||(console.warn("⚠️ Invalid frequency value:",s.frequency,"using one-time as fallback"),j=be.ONE_TIME);const A={category:s.category,subcategory:s.subcategory||"",description:s.description||"",amount:Number(s.amount)||0,currency:s.currency||"USD",frequency:j,entry_date:s.entry_date?new Date(s.entry_date).toISOString().split("T")[0]:"",notes:s.notes||"",real_estate_percentage:s.real_estate_percentage||void 0,stocks_percentage:s.stocks_percentage||void 0,bonds_percentage:s.bonds_percentage||void 0,cash_percentage:s.cash_percentage||void 0,alternative_percentage:s.alternative_percentage||void 0,interest_rate:s.interest_rate||void 0,loan_term_months:s.loan_term_months||void 0,remaining_months:s.remaining_months||void 0,minimum_payment:s.minimum_payment||void 0,is_fixed_rate:s.is_fixed_rate||void 0,loan_start_date:s.loan_start_date?new Date(s.loan_start_date).toISOString().split("T")[0]:void 0,original_amount:s.original_amount||void 0,loan_details:s.loan_details||void 0};console.log("📝 Form data being set:",A),u(A),Object.entries(A).forEach(([y,R])=>{x(y,R)})}else console.log("🆕 No entry provided, using defaults for new entry"),u({category:q.ASSETS,subcategory:"",description:"",amount:0,currency:"USD",frequency:be.ONE_TIME,entry_date:"",notes:"",real_estate_percentage:void 0,stocks_percentage:void 0,bonds_percentage:void 0,cash_percentage:void 0,alternative_percentage:void 0,interest_rate:void 0,loan_term_months:void 0,remaining_months:void 0,minimum_payment:void 0,is_fixed_rate:void 0,loan_start_date:void 0,original_amount:void 0,loan_details:void 0})},[s,u,x]);const b=d("category"),m=d("subcategory"),p=d(),N=j=>({[q.ASSETS]:[{value:"real_estate",label:"Real Estate"},{value:"retirement_accounts",label:"Retirement Accounts"},{value:"investment_accounts",label:"Investment Accounts"},{value:"cash_bank_accounts",label:"Cash & Bank Accounts"},{value:"personal_property",label:"Personal Property"},{value:"business_assets",label:"Business Assets"},{value:"other_assets",label:"Other Assets"}],[q.LIABILITIES]:[{value:"mortgage_real_estate",label:"Mortgage & Real Estate"},{value:"credit_cards",label:"Credit Cards"},{value:"auto_loans",label:"Auto Loans"},{value:"student_loans",label:"Student Loans"},{value:"personal_loans",label:"Personal Loans"},{value:"other_debt",label:"Other Debt"}],[q.INCOME]:[{value:"employment_income",label:"Employment Income"},{value:"business_income",label:"Business Income"},{value:"investment_income",label:"Investment Income"},{value:"rental_income",label:"Rental Income"},{value:"passive_income",label:"Passive Income"},{value:"other_income",label:"Other Income"}],[q.EXPENSES]:[{value:"housing",label:"Housing"},{value:"utilities",label:"Utilities"},{value:"transportation",label:"Transportation"},{value:"food",label:"Food & Dining"},{value:"healthcare",label:"Healthcare"},{value:"personal",label:"Personal"}]})[j]||[],g=[{value:q.ASSETS,label:"Assets"},{value:q.LIABILITIES,label:"Liabilities"},{value:q.INCOME,label:"Income"},{value:q.EXPENSES,label:"Expenses"}],S=[{value:be.ONE_TIME,label:"One-time"},{value:be.MONTHLY,label:"Monthly"},{value:be.QUARTERLY,label:"Quarterly"},{value:be.ANNUALLY,label:"Annually"},{value:be.WEEKLY,label:"Weekly"},{value:be.DAILY,label:"Daily"}],T=async j=>{console.log("🚀 Form submission started"),console.log("📝 Form data:",j),console.log("✏️ Is editing:",r),console.log("📄 Entry:",s);try{if(r&&s){console.log("🔄 Updating entry with ID:",s.id);const E={id:parseInt(s.id),update:{description:j.description,amount:j.amount,frequency:j.category===q.PROFILE||j.category===q.BENEFITS||j.category===q.TAX_INFO?be.ONE_TIME:j.frequency,subcategory:j.subcategory,notes:j.notes,real_estate_percentage:j.real_estate_percentage,stocks_percentage:j.stocks_percentage,bonds_percentage:j.bonds_percentage,cash_percentage:j.cash_percentage,alternative_percentage:j.alternative_percentage,interest_rate:j.interest_rate,loan_term_months:j.loan_term_months,remaining_months:j.remaining_months,minimum_payment:j.minimum_payment,is_fixed_rate:j.is_fixed_rate,loan_start_date:j.loan_start_date,original_amount:j.original_amount,loan_details:j.loan_details}};console.log("📤 Update data being sent:",E);const A=await i.mutateAsync(E);console.log("✅ Update successful:",A)}else{console.log("➕ Creating new entry");const E={category:j.category,subcategory:j.subcategory,description:j.description,amount:j.amount,currency:j.currency,frequency:j.category===q.PROFILE||j.category===q.BENEFITS||j.category===q.TAX_INFO?be.ONE_TIME:j.frequency,entry_date:j.entry_date||void 0,notes:j.notes,real_estate_percentage:j.real_estate_percentage,stocks_percentage:j.stocks_percentage,bonds_percentage:j.bonds_percentage,cash_percentage:j.cash_percentage,alternative_percentage:j.alternative_percentage,interest_rate:j.interest_rate,loan_term_months:j.loan_term_months,remaining_months:j.remaining_months,minimum_payment:j.minimum_payment,is_fixed_rate:j.is_fixed_rate,loan_start_date:j.loan_start_date,original_amount:j.original_amount,loan_details:j.loan_details};console.log("📤 Create data being sent:",E);const A=await n.mutateAsync(E);console.log("✅ Create successful:",A)}console.log("🎉 Entry saved successfully"),alert(`✅ Entry ${r?"updated":"created"} successfully!`),setTimeout(()=>{t==null||t()},100),r||u()}catch(E){console.error("❌ Failed to save financial entry:",E);const A=E.message||E.detail||E.toString();A.includes("Authentication expired")||A.includes("Could not validate credentials")?(alert("🔐 Your session has expired. Please refresh the page to continue."),window.location.reload()):alert(`❌ Failed to ${r?"update":"create"} entry. Please try again. Error: ${A}`)}},v=n.isPending||i.isPending;return e.jsxs(_,{className:"max-w-2xl mx-auto",children:[e.jsxs(_.Header,{children:[e.jsx(_.Title,{children:r?"Edit Financial Entry":"Add Financial Entry"}),e.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"Enter your financial data to track your net worth and progress"})]}),e.jsxs("form",{onSubmit:o(T,j=>{console.log("❌ Form validation failed:",j),alert("Form validation failed. Please check the highlighted fields.")}),className:"space-y-6",children:[r&&e.jsx("div",{className:"bg-blue-900/20 border border-blue-600 rounded-lg p-3 text-xs",children:e.jsxs("details",{children:[e.jsx("summary",{className:"text-blue-300 cursor-pointer mb-2",children:"🔍 Debug Form Values"}),e.jsxs("div",{className:"text-blue-200 space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Entry ID:"})," ",s==null?void 0:s.id]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Form Values:"})," ",JSON.stringify(p,null,2)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Errors:"})," ",JSON.stringify(h,null,2)]}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{type:"button",onClick:async()=>{console.log("🧪 Testing direct mutation...");try{const j=await i.mutateAsync({id:parseInt(s.id),update:{description:p.description||"Test Update",amount:p.amount||1e3,frequency:p.frequency||be.ONE_TIME,subcategory:p.subcategory,notes:p.notes}});console.log("✅ Direct mutation successful:",j),alert("Direct mutation worked!")}catch(j){console.error("❌ Direct mutation failed:",j),alert("Direct mutation failed: "+j)}},className:"px-2 py-1 bg-green-600 text-white text-xs rounded",children:"🧪 Test Direct Update"})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(gt,{name:"category",control:c,render:({field:j})=>{var E;return e.jsx($e,{label:"Category *",options:g,error:(E=h.category)==null?void 0:E.message,...j})}}),e.jsx(gt,{name:"subcategory",control:c,render:({field:j})=>{var E;return e.jsx($e,{label:"Subcategory",options:[{value:"",label:"Select subcategory..."},...N(b)],error:(E=h.subcategory)==null?void 0:E.message,...j})}})]}),b===q.LIABILITIES&&m&&["mortgage_real_estate","credit_cards","auto_loans","student_loans","personal_loans"].includes(m)&&e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-yellow-300",children:"Enhanced Liability Details"}),e.jsx("span",{className:"text-xs text-yellow-200 bg-yellow-800 px-2 py-1 rounded",children:"Smart Form Active"})]}),e.jsx("p",{className:"text-sm text-yellow-200 mb-4",children:"We'll collect detailed information about this liability to provide better financial advice. You can continue with the basic form below if you prefer."}),e.jsx(ni,{subcategory:m,entry:r?s:void 0,isEditing:r,onSubmit:async j=>{var E,A;console.log("💳 Smart liability form submitted:",j);try{if(r&&s){const y={description:j.description,amount:j.amount,frequency:j.frequency||be.ONE_TIME,subcategory:j.subcategory};j.notes!==void 0&&(y.notes=j.notes),j.interest_rate!==void 0&&(y.interest_rate=j.interest_rate),j.loan_term_months!==void 0&&(y.loan_term_months=j.loan_term_months),j.remaining_months!==void 0&&(y.remaining_months=j.remaining_months),j.minimum_payment!==void 0&&(y.minimum_payment=j.minimum_payment),j.is_fixed_rate!==void 0&&(y.is_fixed_rate=j.is_fixed_rate),j.loan_start_date!==void 0&&j.loan_start_date!==""&&(y.loan_start_date=j.loan_start_date),j.original_amount!==void 0&&(y.original_amount=j.original_amount),j.loan_details!==void 0&&(y.loan_details=j.loan_details);const R={id:parseInt(s.id),update:y};console.log("📤 Sending update data:",JSON.stringify(R,null,2));const k=await i.mutateAsync(R);console.log("✅ Smart form update successful:",k)}else{const y=await n.mutateAsync(j);console.log("✅ Smart form create successful:",y)}t==null||t(),r||u()}catch(y){console.error("❌ Smart form submission failed:",y);let R="";(A=(E=y.response)==null?void 0:E.data)!=null&&A.detail?Array.isArray(y.response.data.detail)?R=y.response.data.detail.map(k=>{var F;return`${(F=k.loc)==null?void 0:F.join(".")}: ${k.msg}`}).join(", "):R=y.response.data.detail:R=y.message||y.detail||y.toString(),R.includes("Authentication expired")||R.includes("Could not validate credentials")?(alert("🔐 Your session has expired. Please refresh the page to continue."),window.location.reload()):alert(`❌ Failed to ${r?"update":"create"} liability.

Error: ${R}`)}},onCancel:()=>{r?a==null||a():x("subcategory","")}}),e.jsx("div",{className:"mt-4 pt-4 border-t border-yellow-600",children:e.jsx("p",{className:"text-xs text-yellow-200",children:"Or continue with the basic form below for simple entry..."})})]}),(b===q.PROFILE||b===q.BENEFITS||b===q.TAX_INFO)&&e.jsxs(e.Fragment,{children:[e.jsx(W,{label:"Description *",placeholder:b===q.PROFILE?"e.g., Age: 45, State: California, Marital Status: Married":b===q.BENEFITS?"e.g., Social Security: $3,500/month at 67":"e.g., Filing Status: Married Filing Jointly, Tax Bracket: 32%",leftIcon:e.jsx(lt,{className:"w-4 h-4"}),error:(L=h.description)==null?void 0:L.message,...l("description")}),e.jsx(W,{label:"Value",placeholder:b===q.PROFILE?"45":b===q.BENEFITS?"3500":"32",leftIcon:e.jsx(dr,{className:"w-4 h-4"}),type:"text",...l("amount",{setValueAs:j=>(b===q.PROFILE,parseFloat(j)||0)})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Additional Details"}),e.jsx("textarea",{placeholder:b===q.PROFILE?"Additional personal information...":b===q.BENEFITS?"Benefit calculation details...":"Tax planning notes...",className:"w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,...l("notes")})]})]}),!(b===q.LIABILITIES&&m&&["mortgage_real_estate","credit_cards","auto_loans","student_loans","personal_loans"].includes(m))&&!(b===q.PROFILE||b===q.BENEFITS||b===q.TAX_INFO)&&e.jsxs(e.Fragment,{children:[e.jsx(W,{label:"Description *",placeholder:"e.g., Chase Checking Account, Monthly Rent, etc.",leftIcon:e.jsx(lt,{className:"w-4 h-4"}),error:(P=h.description)==null?void 0:P.message,...l("description")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(gt,{name:"amount",control:c,render:({field:j})=>{var y;const[E,A]=xe.useState(j.value&&j.value>0?Pa(j.value):"");return xe.useEffect(()=>{j.value&&j.value>0?A(Pa(j.value)):A("")},[j.value]),e.jsx(W,{label:"Amount *",type:"text",inputMode:"decimal",placeholder:"0",leftIcon:e.jsx(ge,{className:"w-4 h-4"}),error:(y=h.amount)==null?void 0:y.message,value:E,onChange:R=>{let k=R.target.value;k=k.replace(/[^0-9.,]/g,"");const F=k.replace(/,/g,"");if(F===""){A(""),j.onChange(0);return}let O=F;O.length>1&&O[0]==="0"&&O[1]!=="."&&(O=O.replace(/^0+/,""),O===""&&(O="0"));const J=O.split(".");J.length>2&&(O=J[0]+"."+J.slice(1).join("")),J.length===2&&J[1].length>2&&(O=J[0]+"."+J[1].substring(0,2));const U=parseFloat(O);if(isNaN(U))A(O),j.onChange(0);else{const D=Pa(U);A(D),j.onChange(U)}}})}})}),e.jsx(W,{label:"Currency",value:"USD",disabled:!0,...l("currency")})]}),b===q.ASSETS&&(m==="cash_bank_accounts"||m==="investment_accounts")&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Interest Rate / APY (%)",type:"number",step:"0.01",min:"0",max:"20",placeholder:"e.g., 4.25",leftIcon:e.jsx("span",{className:"text-green-400 text-sm font-medium",children:"%"}),error:(z=h.interest_rate)==null?void 0:z.message,...l("interest_rate",{setValueAs:j=>j===""?void 0:parseFloat(j)})}),e.jsx("div",{className:"flex items-end",children:e.jsx("p",{className:"text-xs text-gray-400 pb-2",children:"Enter the current annual percentage yield (APY) for this account. This helps optimize your cash allocation recommendations."})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(gt,{name:"frequency",control:c,render:({field:j})=>{var E;return e.jsx($e,{label:"Frequency",options:S,error:(E=h.frequency)==null?void 0:E.message,...j})}}),e.jsx(W,{label:"Entry Date",type:"date",leftIcon:e.jsx(It,{className:"w-4 h-4"}),error:(C=h.entry_date)==null?void 0:C.message,...l("entry_date")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Notes"}),e.jsx("textarea",{rows:3,placeholder:"Additional notes or context...",className:"block w-full rounded-md border-gray-600 bg-gray-700 text-white placeholder:text-gray-400 shadow-sm focus:border-blue-400 focus:ring-blue-400 focus:ring-1",...l("notes")}),h.notes&&e.jsx("p",{className:"mt-1 text-xs text-red-400",children:h.notes.message})]}),b===q.ASSETS&&e.jsxs("div",{className:"bg-green-900/20 border border-green-600 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-lg font-medium text-green-300 mb-3 flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"Asset Allocation (How is this asset allocated?)"]}),e.jsx("p",{className:"text-sm text-green-200 mb-4",children:"For accurate portfolio analysis, tell us how this asset is allocated across different asset classes:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(gt,{name:"real_estate_percentage",control:c,render:({field:j})=>{var E;return e.jsx(W,{label:"Real Estate %",type:"number",min:"0",max:"100",placeholder:"0",error:(E=h.real_estate_percentage)==null?void 0:E.message,...j,value:j.value||"",onChange:A=>j.onChange(A.target.value?Number(A.target.value):void 0)})}}),e.jsx(gt,{name:"stocks_percentage",control:c,render:({field:j})=>{var E;return e.jsx(W,{label:"Stocks %",type:"number",min:"0",max:"100",placeholder:"0",error:(E=h.stocks_percentage)==null?void 0:E.message,...j,value:j.value||"",onChange:A=>j.onChange(A.target.value?Number(A.target.value):void 0)})}}),e.jsx(gt,{name:"bonds_percentage",control:c,render:({field:j})=>{var E;return e.jsx(W,{label:"Bonds %",type:"number",min:"0",max:"100",placeholder:"0",error:(E=h.bonds_percentage)==null?void 0:E.message,...j,value:j.value||"",onChange:A=>j.onChange(A.target.value?Number(A.target.value):void 0)})}}),e.jsx(gt,{name:"cash_percentage",control:c,render:({field:j})=>{var E;return e.jsx(W,{label:"Cash %",type:"number",min:"0",max:"100",placeholder:"0",error:(E=h.cash_percentage)==null?void 0:E.message,...j,value:j.value||"",onChange:A=>j.onChange(A.target.value?Number(A.target.value):void 0)})}}),e.jsx(gt,{name:"alternative_percentage",control:c,render:({field:j})=>{var E;return e.jsx(W,{label:"Alternative %",type:"number",min:"0",max:"100",placeholder:"0",error:(E=h.alternative_percentage)==null?void 0:E.message,...j,value:j.value||"",onChange:A=>j.onChange(A.target.value?Number(A.target.value):void 0)})}})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-xs text-green-200",children:[e.jsxs("strong",{children:["Total: ",(p.real_estate_percentage||0)+(p.stocks_percentage||0)+(p.bonds_percentage||0)+(p.cash_percentage||0)+(p.alternative_percentage||0),"%"]}),(p.real_estate_percentage||0)+(p.stocks_percentage||0)+(p.bonds_percentage||0)+(p.cash_percentage||0)+(p.alternative_percentage||0)>100&&e.jsx("span",{className:"text-red-400 ml-2",children:"⚠️ Total exceeds 100%"}),(p.real_estate_percentage||0)+(p.stocks_percentage||0)+(p.bonds_percentage||0)+(p.cash_percentage||0)+(p.alternative_percentage||0)===100&&e.jsx("span",{className:"text-green-400 ml-2",children:"✅ Perfect!"})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2",children:[e.jsx("strong",{children:"Examples:"}),e.jsxs("ul",{className:"mt-1 space-y-1",children:[e.jsx("li",{children:"• Primary Home: Real Estate 100%"}),e.jsx("li",{children:"• 401K: Stocks 60%, Bonds 30%, Real Estate 10%"}),e.jsx("li",{children:"• Bitcoin: Alternative 100%"}),e.jsx("li",{children:"• Checking: Cash 100%"}),e.jsx("li",{children:"• Brokerage: Stocks 70%, Bonds 15%, Cash 10%, Real Estate 5%"})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx($,{type:"submit",isLoading:v,className:"flex-1 md:flex-none",onClick:j=>{console.log("🖱️ Button clicked!",j)},children:r?"Update Entry":"Add Entry"}),a&&e.jsx($,{type:"button",variant:"outline",onClick:a,disabled:v,children:"Cancel"})]})]})]})]},(s==null?void 0:s.id)||"new")},$o=({onSave:s,existingData:t={},category:a="all"})=>{const[r,n]=w.useState(t),[i,l]=w.useState("mortgage"),[o,c]=w.useState({}),u=[{name:"Netflix",defaultCost:15.99,category:"streaming"},{name:"Spotify",defaultCost:9.99,category:"streaming"},{name:"Amazon Prime",defaultCost:14.99,category:"shopping"},{name:"Gym Membership",defaultCost:49.99,category:"fitness"},{name:"Disney+",defaultCost:7.99,category:"streaming"},{name:"Hulu",defaultCost:14.99,category:"streaming"},{name:"HBO Max",defaultCost:15.99,category:"streaming"},{name:"Apple TV+",defaultCost:6.99,category:"streaming"},{name:"YouTube Premium",defaultCost:11.99,category:"streaming"},{name:"Cloud Storage",defaultCost:9.99,category:"software"}],h=(g,S)=>{n(T=>({...T,[g]:S})),o[g]&&c(T=>({...T,[g]:""}))},f=(g,S)=>{const T=r.subscriptions||[],v=T.find(L=>L.name===g);n(v?L=>({...L,subscriptions:T.filter(P=>P.name!==g)}):L=>({...L,subscriptions:[...T,{name:g,cost:S,usage:"monthly"}]}))},d=()=>{const g={};r.mortgageRate&&(r.mortgageRate<0||r.mortgageRate>20)&&(g.mortgageRate="Rate must be between 0-20%"),r.contribution401k&&(r.contribution401k<0||r.contribution401k>100)&&(g.contribution401k="Must be between 0-100%");const S=(r.stockPercentage||0)+(r.bondPercentage||0);if(S>0&&S!==100&&(g.allocation=`Stock + Bond must equal 100% (currently ${S}%)`),Object.keys(g).length>0){c(g);return}s(r)},x=()=>e.jsx(_,{className:"mb-6",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(An,{className:"w-6 h-6 text-blue-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Mortgage Details"}),e.jsx(ke,{variant:"info",size:"sm",children:"Optional but Recommended"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Interest Rate"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.1",placeholder:"6.5",value:r.mortgageRate||"",onChange:g=>h("mortgageRate",parseFloat(g.target.value)),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400",children:"%"})]}),o.mortgageRate&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:o.mortgageRate}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Check your mortgage statement"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Monthly Payment"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2.5 text-gray-400",children:"$"}),e.jsx("input",{type:"number",placeholder:"1890",value:r.mortgagePayment||"",onChange:g=>h("mortgagePayment",parseFloat(g.target.value)),className:"w-full pl-8 pr-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Lender Name"}),e.jsx("input",{type:"text",placeholder:"Wells Fargo",value:r.mortgageLender||"",onChange:g=>h("mortgageLender",g.target.value),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Loan Term"}),e.jsxs("select",{value:r.mortgageTermYears||"",onChange:g=>h("mortgageTermYears",parseInt(g.target.value)),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select term"}),e.jsx("option",{value:"15",children:"15 years"}),e.jsx("option",{value:"20",children:"20 years"}),e.jsx("option",{value:"30",children:"30 years"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mortgage Start Date"}),e.jsx("input",{type:"date",value:r.mortgageStartDate||"",onChange:g=>h("mortgageStartDate",g.target.value),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Used to calculate payoff timeline"})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-900/20 border border-blue-600/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(gs,{className:"w-4 h-4 text-blue-400 mt-0.5"}),e.jsx("p",{className:"text-sm text-blue-200",children:"With this information, we can calculate potential refinancing savings and optimize your mortgage strategy."})]})})]})}),b=()=>e.jsx(_,{className:"mb-6",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ge,{className:"w-6 h-6 text-green-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"401(k) & Retirement"}),e.jsx(ke,{variant:"success",size:"sm",children:"High Impact"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Your Contribution Rate"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"1",placeholder:"6",value:r.contribution401k||"",onChange:g=>h("contribution401k",parseFloat(g.target.value)),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400",children:"%"})]}),o.contribution401k&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:o.contribution401k}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Percentage of gross salary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Employer Match"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"1",placeholder:"3",value:r.employerMatch||"",onChange:g=>h("employerMatch",parseFloat(g.target.value)),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400",children:"%"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"How much employer matches"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Match Limit"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"1",placeholder:"6",value:r.employerMatchLimit||"",onChange:g=>h("employerMatchLimit",parseFloat(g.target.value)),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400",children:"%"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Up to what % they match"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Vesting Schedule"}),e.jsxs("select",{value:r.vestingSchedule||"",onChange:g=>h("vestingSchedule",g.target.value),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select schedule"}),e.jsx("option",{value:"immediate",children:"Immediate"}),e.jsx("option",{value:"1-year",children:"1 Year Cliff"}),e.jsx("option",{value:"3-year-graded",children:"3 Year Graded"}),e.jsx("option",{value:"5-year-graded",children:"5 Year Graded"})]})]})]}),r.contribution401k&&r.employerMatch&&r.contribution401k<(r.employerMatchLimit||r.employerMatch)&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-900/20 border border-yellow-600/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Nt,{className:"w-4 h-4 text-yellow-400 mt-0.5"}),e.jsxs("p",{className:"text-sm text-yellow-200",children:["You're leaving free money on the table! Increase your contribution to ",r.employerMatchLimit||r.employerMatch,"% to get the full employer match."]})]})})]})}),m=()=>e.jsx(_,{className:"mb-6",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Rn,{className:"w-6 h-6 text-purple-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Investment Allocation"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Stock Allocation"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"5",placeholder:"60",value:r.stockPercentage||"",onChange:g=>h("stockPercentage",parseFloat(g.target.value)),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400",children:"%"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Bond Allocation"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"5",placeholder:"40",value:r.bondPercentage||"",onChange:g=>h("bondPercentage",parseFloat(g.target.value)),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400",children:"%"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Average Expense Ratio"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",placeholder:"0.75",value:r.averageExpenseRatio||"",onChange:g=>h("averageExpenseRatio",parseFloat(g.target.value)),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400",children:"%"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Average fund fees"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Investment Platform"}),e.jsxs("select",{value:r.investmentPlatform||"",onChange:g=>h("investmentPlatform",g.target.value),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select platform"}),e.jsx("option",{value:"vanguard",children:"Vanguard"}),e.jsx("option",{value:"fidelity",children:"Fidelity"}),e.jsx("option",{value:"schwab",children:"Charles Schwab"}),e.jsx("option",{value:"etrade",children:"E*TRADE"}),e.jsx("option",{value:"robinhood",children:"Robinhood"}),e.jsx("option",{value:"other",children:"Other"})]})]})]}),o.allocation&&e.jsx("div",{className:"mt-4 p-3 bg-red-900/20 border border-red-600/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Nt,{className:"w-4 h-4 text-red-400 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-200",children:o.allocation})]})})]})}),p=()=>{var g;return e.jsx(_,{className:"mb-6",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(It,{className:"w-6 h-6 text-orange-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Monthly Subscriptions"}),e.jsxs(ke,{variant:"warning",size:"sm",children:["$",(r.subscriptions||[]).reduce((S,T)=>S+T.cost,0).toFixed(2),"/month"]})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Select all subscriptions you currently have. We'll help identify ones you might not be using."}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:u.map(S=>{const T=(r.subscriptions||[]).some(v=>v.name===S.name);return e.jsxs("button",{onClick:()=>f(S.name,S.defaultCost),className:`
                  p-3 rounded-lg border transition-all
                  ${T?"bg-blue-900/30 border-blue-600 text-blue-300":"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-600"}
                `,children:[e.jsx("div",{className:"font-medium text-sm",children:S.name}),e.jsxs("div",{className:"text-xs mt-1",children:["$",S.defaultCost,"/mo"]})]},S.name)})}),(r.subscriptions||[]).length>3&&e.jsx("div",{className:"mt-4 p-3 bg-orange-900/20 border border-orange-600/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Nt,{className:"w-4 h-4 text-orange-400 mt-0.5"}),e.jsxs("p",{className:"text-sm text-orange-200",children:["You have ",(g=r.subscriptions)==null?void 0:g.length," subscriptions. Consider reviewing which ones you actually use regularly."]})]})})]})})},N=g=>a==="all"?!0:a===g;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-blue-900/20 to-purple-900/20 border-blue-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Advisor-Level Data Collection"}),e.jsx("p",{className:"text-gray-300",children:"Provide additional details for personalized recommendations. All fields are optional but highly recommended."})]})}),N("mortgage")&&x(),N("retirement")&&b(),N("investments")&&m(),N("subscriptions")&&p(),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx($,{variant:"outline",onClick:()=>n({}),children:"Skip for Now"}),e.jsx($,{variant:"primary",onClick:d,children:"Save & Generate Recommendations"})]})]})},Bs={all:["advisor"],data:()=>[...Bs.all,"data"],recommendations:()=>[...Bs.all,"recommendations"]},Do=()=>ot({queryKey:Bs.data(),queryFn:async()=>{var s,t,a,r,n,i,l,o,c,u,h,f,d;try{const x=await G.get("/api/v1/advisor/advisor-data");return{mortgageRate:(s=x.mortgage)==null?void 0:s.interest_rate,mortgagePayment:(t=x.mortgage)==null?void 0:t.monthly_payment,mortgageLender:(a=x.mortgage)==null?void 0:a.lender,mortgageTermYears:(r=x.mortgage)==null?void 0:r.term_years,mortgageStartDate:(n=x.mortgage)==null?void 0:n.start_date,contribution401k:(i=x.retirement)==null?void 0:i.contribution_percent,employerMatch:(l=x.retirement)==null?void 0:l.employer_match,employerMatchLimit:(o=x.retirement)==null?void 0:o.employer_match_limit,vestingSchedule:(c=x.retirement)==null?void 0:c.vesting_schedule,stockPercentage:(u=x.investments)==null?void 0:u.stock_percentage,bondPercentage:(h=x.investments)==null?void 0:h.bond_percentage,averageExpenseRatio:(f=x.investments)==null?void 0:f.average_expense_ratio,investmentPlatform:(d=x.investments)==null?void 0:d.platform,subscriptions:x.subscriptions||[]}}catch(x){return console.error("Failed to fetch advisor data:",x),{}}},staleTime:5*60*1e3}),Oo=()=>{const s=ct();return dt({mutationFn:async t=>{var r;const a={mortgage_rate:t.mortgageRate,mortgage_payment:t.mortgagePayment,mortgage_lender:t.mortgageLender,mortgage_term_years:t.mortgageTermYears,mortgage_start_date:t.mortgageStartDate,contribution_401k:t.contribution401k,employer_match:t.employerMatch,employer_match_limit:t.employerMatchLimit,vesting_schedule:t.vestingSchedule,stock_percentage:t.stockPercentage,bond_percentage:t.bondPercentage,average_expense_ratio:t.averageExpenseRatio,investment_platform:t.investmentPlatform,subscriptions:(r=t.subscriptions)==null?void 0:r.map(n=>({name:n.name,cost:n.cost,usage_frequency:n.usage,can_cancel:!0}))};return await G.post("/api/v1/advisor/save-advisor-data",a)},onSuccess:t=>{s.invalidateQueries({queryKey:Bs.all}),s.invalidateQueries({queryKey:["financial"]}),console.log("Advisor data saved:",t)},onError:t=>{console.error("Failed to save advisor data:",t)}})},Bo=()=>ot({queryKey:Bs.recommendations(),queryFn:async()=>{try{return(await G.get("/api/v1/advisor/smart-recommendations")).map(t=>({id:t.id,category:t.category,title:t.title,description:t.description,currentValue:t.current_value,recommendedValue:t.recommended_value,monthlySavings:t.monthly_savings,annualSavings:t.annual_savings,actionSteps:t.action_steps,difficulty:t.difficulty,timeToImplement:t.time_to_implement,confidenceLevel:t.confidence_level,assumptionsMade:t.assumptions_made}))}catch(s){return console.error("Failed to fetch smart recommendations:",s),[{id:"mock-mortgage",category:"mortgage",title:"Potential Mortgage Refinancing",description:"Based on typical rates, you might save by refinancing. Enter your rate for exact calculations.",currentValue:6.5,recommendedValue:5.8,monthlySavings:320,annualSavings:3840,actionSteps:["Check your current mortgage statement for exact rate","Get quotes from 3-5 lenders","Calculate break-even point including closing costs"],difficulty:"medium",timeToImplement:"30-45 days",confidenceLevel:"medium",assumptionsMade:["Assumed 6.5% current rate based on market average"]},{id:"mock-401k",category:"retirement",title:"Maximize Employer 401k Match",description:"Enter your contribution rate to see if you're missing free money.",actionSteps:["Log into your 401k portal","Check current contribution percentage","Increase to capture full employer match"],difficulty:"easy",timeToImplement:"Next payroll cycle",confidenceLevel:"high",assumptionsMade:[]}]}},staleTime:10*60*1e3}),zo=()=>{var R;const[s,t]=w.useState(!1),[a,r]=w.useState(),[n,i]=w.useState(),[l,o]=w.useState(null),[c,u]=w.useState(!1),[h,f]=w.useState("overview"),{data:d,isLoading:x,refetch:b}=$n(),{data:m}=Do(),p=Oo(),{data:N}=Bo();console.log("🔍 Categorized Data:",d);const g=(d==null?void 0:d.summary)||{net_worth:0,monthly_income:0,monthly_expenses:0,monthly_cash_flow:0,total_assets:0,total_liabilities:0},S=g.total_assets,T=g.total_liabilities,v=g.monthly_income,L=g.monthly_expenses,P=g.net_worth,z=g.monthly_cash_flow,C=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),j=(k,F)=>{r(k),i(F),t(!0)},E=k=>{if(console.log("✏️ Edit button clicked for entry:",k),console.log("✏️ Entry ID:",k.id,"Type:",typeof k.id),typeof k.id=="string"&&k.id.startsWith("profile-")){console.log("✏️ Opening profile edit for:",k),r(q.PROFILE),i("Personal Information"),o(k),t(!0);return}if(typeof k.id=="string"&&k.id.startsWith("family-")){console.warn("🚫 EDIT BLOCKED: Family entries cannot be edited from this view."),setTimeout(()=>{alert(`Family entries cannot be edited from this view.

Please use the Profile tab to manage family information.`)},100);return}if(typeof k.id=="string"&&(k.id.startsWith("benefit-")||k.id.startsWith("tax-"))){console.warn("🚫 EDIT BLOCKED: Benefit and tax entries cannot be edited from this view."),setTimeout(()=>{alert(`Benefit and tax entries cannot be edited from this view.

Please use the respective tabs to manage this information.`)},100);return}o(k)},A=()=>{b(),t(!1),o(null)},y=async k=>{try{await p.mutateAsync(k),u(!1),b()}catch(F){console.error("Failed to save advisor data:",F)}};return e.jsx("div",{className:"min-h-screen bg-gray-900 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(ge,{className:"w-8 h-8 text-green-500"}),"Financial Management"]}),e.jsx("p",{className:"text-gray-300 mt-1",children:"Complete financial overview, advisor-level insights, and intelligent data management"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs($,{variant:"outline",onClick:()=>b(),disabled:x,className:"flex items-center gap-2",children:[e.jsx(_t,{className:`w-4 h-4 ${x?"animate-spin":""}`}),"Refresh"]}),e.jsxs($,{onClick:()=>j(),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[e.jsx(Tt,{className:"w-4 h-4"}),"Add Entry"]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:ge},{id:"advisor",label:"Advisor Data",icon:Te},{id:"connections",label:"Account Connections",icon:Aa}].map(k=>e.jsxs("button",{onClick:()=>f(k.id),className:`
                    flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm
                    ${h===k.id?"border-blue-500 text-blue-300":"border-transparent text-gray-500 hover:text-gray-300 hover:border-gray-300"}
                  `,children:[e.jsx(k.icon,{className:"w-4 h-4"}),k.label,k.id==="advisor"&&N&&N.length>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5",children:N.length})]},k.id))})})}),h==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(_,{className:"bg-gradient-to-r from-blue-900 to-blue-800",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-200 text-sm",children:"Net Worth"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:C(P)})]}),e.jsx(Te,{className:"w-8 h-8 text-blue-400"})]}),e.jsxs("div",{className:"mt-2 text-xs text-blue-300",children:[e.jsxs("p",{children:["Assets: ",C(S)]}),e.jsxs("p",{children:["Liabilities: ",C(T)]})]})]})}),e.jsx(_,{className:"bg-gradient-to-r from-green-900 to-green-800",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-200 text-sm",children:"Monthly Income"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:C(v)})]}),e.jsx(ge,{className:"w-8 h-8 text-green-400"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-xs text-green-300",children:["Annual: ",C(v*12)]})})]})}),e.jsx(_,{className:"bg-gradient-to-r from-red-900 to-red-800",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-200 text-sm",children:"Monthly Expenses"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:C(L)})]}),e.jsx($s,{className:"w-8 h-8 text-red-400"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-xs text-red-300",children:["Annual: ",C(L*12)]})})]})}),e.jsx(_,{className:`bg-gradient-to-r ${z>=0?"from-purple-900 to-purple-800":"from-orange-900 to-orange-800"}`,children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${z>=0?"text-purple-200":"text-orange-200"}`,children:"Monthly Cash Flow"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:C(z)})]}),z>=0?e.jsx(Te,{className:"w-8 h-8 text-purple-400"}):e.jsx($s,{className:"w-8 h-8 text-orange-400"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:`text-xs ${z>=0?"text-purple-300":"text-orange-300"}`,children:["Savings Rate: ",v>0?(z/v*100).toFixed(1):0,"%"]})})]})})]}),e.jsx(_,{className:"hover:border-blue-600 transition-colors",children:e.jsx(wl,{onAddEntry:j,onEditEntry:E})})]}),h==="advisor"&&e.jsx("div",{className:"space-y-6",children:c?e.jsx($o,{onSave:y,existingData:m}):e.jsxs(e.Fragment,{children:[N&&N.length>0&&e.jsx(_,{className:"bg-gradient-to-r from-green-900/20 to-blue-900/20 border-green-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-green-100 mb-4",children:["🎯 Smart Recommendations (",N.length,")"]}),e.jsx("div",{className:"space-y-4",children:N.slice(0,3).map(k=>e.jsxs("div",{className:"border border-green-600/30 rounded-lg p-4 bg-green-900/10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:k.title}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${k.difficulty==="easy"?"bg-green-600 text-white":k.difficulty==="medium"?"bg-yellow-600 text-white":"bg-red-600 text-white"}`,children:k.difficulty})]}),e.jsx("p",{className:"text-green-200 text-sm mb-3",children:k.description}),k.monthlySavings&&e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-green-400 font-semibold",children:["Save $",k.monthlySavings,"/month"]}),e.jsxs("span",{className:"text-green-300",children:["$",k.annualSavings,"/year"]})]})]},k.id))})]})}),e.jsx(_,{className:"bg-gradient-to-r from-blue-900/20 to-purple-900/20 border-blue-600",children:e.jsx(_.Body,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Get Advisor-Level Recommendations"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Answer a few quick questions about your mortgage, 401k, and subscriptions to unlock personalized financial recommendations."}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🏠"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Mortgage Rate"}),e.jsx("div",{className:"text-xs text-blue-400",children:m!=null&&m.mortgageRate?`${m.mortgageRate}%`:"Not provided"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"💰"}),e.jsx("div",{className:"text-sm text-gray-300",children:"401k Contribution"}),e.jsx("div",{className:"text-xs text-blue-400",children:m!=null&&m.contribution401k?`${m.contribution401k}%`:"Not provided"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"📊"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Stock Allocation"}),e.jsx("div",{className:"text-xs text-blue-400",children:m!=null&&m.stockPercentage?`${m.stockPercentage}%`:"Not provided"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"📱"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Subscriptions"}),e.jsxs("div",{className:"text-xs text-blue-400",children:[((R=m==null?void 0:m.subscriptions)==null?void 0:R.length)||0," tracked"]})]})]}),e.jsxs($,{onClick:()=>u(!0),className:"bg-blue-600 hover:bg-blue-700",children:[Object.keys(m||{}).length>0?"Update":"Add"," Advisor Data"]})]})})})]})}),h==="connections"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-blue-900/20 to-purple-900/20 border-blue-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Account Connections"}),e.jsx("p",{className:"text-gray-300 mt-1",children:"Connect your accounts for automatic data sync and real-time insights"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:"0"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Connected Accounts"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🏦"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Banking"}),e.jsx("div",{className:"text-xs text-red-400",children:"Not Connected"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:"📈"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Investments"}),e.jsx("div",{className:"text-xs text-red-400",children:"Not Connected"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🏠"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Real Estate"}),e.jsx("div",{className:"text-xs text-red-400",children:"Not Connected"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:"₿"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Crypto"}),e.jsx("div",{className:"text-xs text-red-400",children:"Not Connected"})]})]})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(An,{className:"w-6 h-6 text-blue-400"}),"Banking & Credit Cards"]}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Connect your bank accounts, credit cards, and loan accounts through Plaid's secure connection."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:["Chase","Bank of America","Wells Fargo","Citi","Capital One","American Express"].map(k=>e.jsxs($,{variant:"outline",className:"flex items-center justify-between p-4 h-auto",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Wa,{className:"w-6 h-6 text-blue-400"}),e.jsx("span",{children:k})]}),e.jsx("span",{className:"text-xs text-gray-400",children:"Connect"})]},k))}),e.jsxs($,{className:"w-full bg-blue-600 hover:bg-blue-700",children:[e.jsx(Aa,{className:"w-4 h-4 mr-2"}),"Connect Banking Accounts via Plaid"]})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(Te,{className:"w-6 h-6 text-green-400"}),"Investment & Retirement Accounts"]}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Connect your brokerage, 401k, IRA, and other investment accounts."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:["Fidelity","Charles Schwab","Vanguard","E*TRADE","TD Ameritrade","Robinhood"].map(k=>e.jsxs($,{variant:"outline",className:"flex items-center justify-between p-4 h-auto",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pn,{className:"w-6 h-6 text-green-400"}),e.jsx("span",{children:k})]}),e.jsx("span",{className:"text-xs text-gray-400",children:"Connect"})]},k))}),e.jsxs($,{className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(Aa,{className:"w-4 h-4 mr-2"}),"Connect Investment Accounts"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(Gt,{className:"w-6 h-6 text-purple-400"}),"Real Estate"]}),e.jsx("p",{className:"text-gray-300 mb-4 text-sm",children:"Connect your mortgage and track property values."}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs($,{variant:"outline",className:"w-full flex items-center justify-between",children:[e.jsx("span",{children:"Zillow Integration"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Property Values"})]}),e.jsxs($,{variant:"outline",className:"w-full flex items-center justify-between",children:[e.jsx("span",{children:"Mortgage Lender"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Loan Details"})]})]}),e.jsx($,{className:"w-full bg-purple-600 hover:bg-purple-700 text-sm",children:"Connect Real Estate"})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(Qi,{className:"w-6 h-6 text-orange-400"}),"Cryptocurrency"]}),e.jsx("p",{className:"text-gray-300 mb-4 text-sm",children:"Connect crypto exchanges and wallets."}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs($,{variant:"outline",className:"w-full flex items-center justify-between",children:[e.jsx("span",{children:"Coinbase"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Exchange"})]}),e.jsxs($,{variant:"outline",className:"w-full flex items-center justify-between",children:[e.jsx("span",{children:"Binance"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Exchange"})]})]}),e.jsx($,{className:"w-full bg-orange-600 hover:bg-orange-700 text-sm",children:"Connect Crypto Accounts"})]})})]}),e.jsx(_,{className:"bg-gradient-to-r from-gray-800 to-gray-700 border-gray-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Manual Entry"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Can't find your account? Add entries manually and upgrade later."}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs($,{onClick:()=>{f("overview"),setTimeout(()=>j("income","salary"),100)},variant:"outline",className:"flex flex-col items-center gap-2 py-4",children:[e.jsx(ge,{className:"w-6 h-6 text-green-400"}),e.jsx("span",{children:"Add Income"})]}),e.jsxs($,{onClick:()=>{f("overview"),setTimeout(()=>j("assets","investment"),100)},variant:"outline",className:"flex flex-col items-center gap-2 py-4",children:[e.jsx(Te,{className:"w-6 h-6 text-blue-400"}),e.jsx("span",{children:"Add Asset"})]}),e.jsxs($,{onClick:()=>{f("overview"),setTimeout(()=>j("expenses","housing"),100)},variant:"outline",className:"flex flex-col items-center gap-2 py-4",children:[e.jsx(Gt,{className:"w-6 h-6 text-purple-400"}),e.jsx("span",{children:"Add Expense"})]}),e.jsxs($,{onClick:()=>{f("overview"),setTimeout(()=>j("liabilities","credit_card"),100)},variant:"outline",className:"flex flex-col items-center gap-2 py-4",children:[e.jsx(Wa,{className:"w-6 h-6 text-red-400"}),e.jsx("span",{children:"Add Debt"})]})]})]})})]}),e.jsx(Lo,{isOpen:s,onClose:()=>{t(!1),r(void 0),i(void 0),o(null)},category:a,subcategory:n,onSuccess:A,editingEntry:l}),l&&!(typeof l.id=="string"&&l.id.startsWith("profile-"))&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto border border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Edit Entry"}),e.jsx("button",{onClick:()=>o(null),className:"text-gray-400 hover:text-white",children:e.jsx(is,{className:"w-6 h-6"})})]}),e.jsx(Mo,{entry:l,onSuccess:A,onCancel:()=>o(null)})]})})})]})})},Uo=({isOpen:s,onClose:t,onSuccess:a,editingItem:r})=>{const[n,i]=w.useState({type:"profile"}),[l,o]=w.useState(!1);w.useEffect(()=>{s&&r?i({type:r.type,...r}):s&&i({type:"profile"})},[s,r]);const c=async d=>{d.preventDefault(),o(!0);try{const{type:x,...b}=n;switch(x){case"profile":r!=null&&r.id?await Qe.updateProfile(b):await Qe.createOrUpdateProfile(b);break;case"family":r!=null&&r.id?await Qe.updateFamilyMember(r.id,b):await Qe.addFamilyMember(b);break;case"benefit":r!=null&&r.id?await Qe.updateBenefit(r.id,b):await Qe.addBenefit(b);break;case"tax":r!=null&&r.id?await Qe.updateTaxInfo(r.id,b):await Qe.addTaxInfo(b);break}a(),t()}catch(x){console.error("Failed to save:",x),alert(`Failed to save: ${x.message||"Unknown error"}`)}finally{o(!1)}},u=(d,x)=>{i(b=>({...b,[d]:x}))};if(!s)return null;const h=()=>{const d=r!=null&&r.id?"Edit":"Add";switch(n.type){case"profile":return`${d} Personal Information`;case"family":return`${d} Family Member`;case"benefit":return`${d} Benefit`;case"tax":return`${d} Tax Information`;default:return`${d} Entry`}},f=()=>{switch(n.type){case"profile":return e.jsx(Lt,{className:"w-6 h-6 text-blue-400"});case"family":return e.jsx(xs,{className:"w-6 h-6 text-green-400"});case"benefit":return e.jsx(Mt,{className:"w-6 h-6 text-purple-400"});case"tax":return e.jsx(lt,{className:"w-6 h-6 text-orange-400"});default:return e.jsx(Lt,{className:"w-6 h-6 text-blue-400"})}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto border border-gray-700",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[f(),e.jsx("h2",{className:"text-xl font-bold text-white",children:h()})]}),e.jsx("button",{onClick:t,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors",children:e.jsx(is,{className:"w-5 h-5"})})]})}),e.jsxs("form",{onSubmit:c,className:"p-6 space-y-6",children:[!(r!=null&&r.id)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Entry Type"}),e.jsx($e,{value:n.type,onChange:d=>i({type:d.target.value}),options:[{value:"profile",label:"Personal Information"},{value:"family",label:"Family Member"},{value:"benefit",label:"Benefit"},{value:"tax",label:"Tax Information"}]})]}),n.type==="profile"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(W,{label:"Age",type:"number",value:n.age||"",onChange:d=>u("age",d.target.value?parseInt(d.target.value):null),placeholder:"35"}),e.jsx(W,{label:"Date of Birth",type:"date",value:n.date_of_birth?n.date_of_birth.split("T")[0]:"",onChange:d=>u("date_of_birth",d.target.value)}),e.jsx(W,{label:"State",type:"text",value:n.state||"",onChange:d=>u("state",d.target.value),placeholder:"California"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx($e,{label:"Marital Status",value:n.marital_status||"",onChange:d=>u("marital_status",d.target.value),options:[{value:"",label:"Select..."},{value:"single",label:"Single"},{value:"married",label:"Married"},{value:"divorced",label:"Divorced"},{value:"widowed",label:"Widowed"}]}),e.jsx($e,{label:"Employment Status",value:n.employment_status||"",onChange:d=>u("employment_status",d.target.value),options:[{value:"",label:"Select..."},{value:"employed",label:"Employed"},{value:"self_employed",label:"Self Employed"},{value:"unemployed",label:"Unemployed"},{value:"retired",label:"Retired"},{value:"student",label:"Student"}]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Occupation",type:"text",value:n.occupation||"",onChange:d=>u("occupation",d.target.value),placeholder:"Software Engineer"}),e.jsx($e,{label:"Risk Tolerance",value:n.risk_tolerance||"",onChange:d=>u("risk_tolerance",d.target.value),options:[{value:"",label:"Select..."},{value:"conservative",label:"Conservative"},{value:"moderate",label:"Moderate"},{value:"aggressive",label:"Aggressive"}]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Additional Notes"}),e.jsx("textarea",{value:n.notes||"",onChange:d=>u("notes",d.target.value),placeholder:"Any additional personal information...",className:"w-full p-3 border border-gray-600 bg-gray-700 text-gray-100 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]})]}),n.type==="family"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Name",type:"text",value:n.name||"",onChange:d=>u("name",d.target.value),placeholder:"John Doe",required:!0}),e.jsx($e,{label:"Relationship",value:n.relationship_type||"",onChange:d=>u("relationship_type",d.target.value),options:[{value:"",label:"Select..."},{value:"spouse",label:"Spouse"},{value:"partner",label:"Partner"},{value:"child",label:"Child"},{value:"dependent",label:"Dependent"},{value:"parent",label:"Parent"},{value:"sibling",label:"Sibling"},{value:"other",label:"Other"}],required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Age",type:"number",value:n.age||"",onChange:d=>u("age",d.target.value?parseInt(d.target.value):null),placeholder:"35"}),e.jsx(W,{label:"Date of Birth",type:"date",value:n.date_of_birth?n.date_of_birth.split("T")[0]:"",onChange:d=>u("date_of_birth",d.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Annual Income",type:"number",value:n.income||"",onChange:d=>u("income",d.target.value?parseFloat(d.target.value):null),placeholder:"50000"}),e.jsx(W,{label:"Retirement Savings",type:"number",value:n.retirement_savings||"",onChange:d=>u("retirement_savings",d.target.value?parseFloat(d.target.value):null),placeholder:"100000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Notes"}),e.jsx("textarea",{value:n.notes||"",onChange:d=>u("notes",d.target.value),placeholder:"Additional information about family member...",className:"w-full p-3 border border-gray-600 bg-gray-700 text-gray-100 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]})]}),n.type==="benefit"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Benefit Name",type:"text",value:n.benefit_name||"",onChange:d=>u("benefit_name",d.target.value),placeholder:"Social Security",required:!0}),e.jsx($e,{label:"Benefit Type",value:n.benefit_type||"",onChange:d=>u("benefit_type",d.target.value),options:[{value:"",label:"Select..."},{value:"social_security",label:"Social Security"},{value:"pension",label:"Pension"},{value:"disability",label:"Disability"},{value:"unemployment",label:"Unemployment"},{value:"health_insurance",label:"Health Insurance"},{value:"other",label:"Other"}],required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Monthly Benefit Amount",type:"number",value:n.estimated_monthly_benefit||"",onChange:d=>u("estimated_monthly_benefit",d.target.value?parseFloat(d.target.value):null),placeholder:"2500"}),e.jsx(W,{label:"Eligibility Date",type:"date",value:n.eligibility_date?n.eligibility_date.split("T")[0]:"",onChange:d=>u("eligibility_date",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Notes"}),e.jsx("textarea",{value:n.notes||"",onChange:d=>u("notes",d.target.value),placeholder:"Additional benefit details...",className:"w-full p-3 border border-gray-600 bg-gray-700 text-gray-100 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]})]}),n.type==="tax"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Tax Year",type:"number",value:n.tax_year||new Date().getFullYear(),onChange:d=>u("tax_year",d.target.value?parseInt(d.target.value):null),placeholder:"2024",required:!0}),e.jsx($e,{label:"Filing Status",value:n.filing_status||"",onChange:d=>u("filing_status",d.target.value),options:[{value:"",label:"Select..."},{value:"single",label:"Single"},{value:"married_jointly",label:"Married Filing Jointly"},{value:"married_separately",label:"Married Filing Separately"},{value:"head_of_household",label:"Head of Household"},{value:"qualifying_widow",label:"Qualifying Widow(er)"}]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(W,{label:"Adjusted Gross Income",type:"number",value:n.adjusted_gross_income||"",onChange:d=>u("adjusted_gross_income",d.target.value?parseFloat(d.target.value):null),placeholder:"75000"}),e.jsx(W,{label:"Federal Tax Bracket (%)",type:"number",step:"0.1",value:n.federal_tax_bracket||"",onChange:d=>u("federal_tax_bracket",d.target.value?parseFloat(d.target.value):null),placeholder:"22"}),e.jsx(W,{label:"Effective Tax Rate (%)",type:"number",step:"0.1",value:n.effective_tax_rate||"",onChange:d=>u("effective_tax_rate",d.target.value?parseFloat(d.target.value):null),placeholder:"18.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Notes"}),e.jsx("textarea",{value:n.notes||"",onChange:d=>u("notes",d.target.value),placeholder:"Additional tax information...",className:"w-full p-3 border border-gray-600 bg-gray-700 text-gray-100 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-600",children:[e.jsx($,{type:"button",variant:"outline",onClick:t,disabled:l,children:"Cancel"}),e.jsx($,{type:"submit",disabled:l,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:l?"Saving...":r!=null&&r.id?"Update":"Save"})]})]})]})})},La={will:{label:"Will",icon:lt,color:"text-blue-500"},trust:{label:"Trust",icon:wt,color:"text-green-500"},power_of_attorney:{label:"Power of Attorney",icon:xs,color:"text-purple-500"},healthcare_directive:{label:"Healthcare Directive",icon:Mt,color:"text-red-500"},beneficiary_designation:{label:"Beneficiary Designations",icon:Lt,color:"text-orange-500"}},qo={current:{label:"Current",color:"bg-green-500",textColor:"text-green-500"},needs_update:{label:"Needs Update",color:"bg-yellow-500",textColor:"text-yellow-500"},missing:{label:"Missing",color:"bg-red-500",textColor:"text-red-500"},in_progress:{label:"In Progress",color:"bg-blue-500",textColor:"text-blue-500"}},Vo=()=>{var y,R,k,F,O,J,U;const[s,t]=w.useState([]),[a,r]=w.useState(null),[n,i]=w.useState(!0),[l,o]=w.useState(null),[c,u]=w.useState(!1),[h,f]=w.useState(null),[d,x]=w.useState({document_type:"will",document_name:"",status:"current",last_updated:"",next_review_date:"",attorney_contact:"",document_location:""}),[b,m]=w.useState(!1),[p,N]=w.useState([]);w.useEffect(()=>{S(),g()},[]);const g=async()=>{try{const D=await G.get("/api/v1/estate-planning/document-types");N(D.document_types||[])}catch(D){console.error("Failed to fetch document types:",D)}},S=async()=>{try{i(!0),o(null);const[D,V]=await Promise.all([G.get("/api/v1/estate-planning/documents"),G.get("/api/v1/estate-planning/summary")]);t(D||[]),r(V||null)}catch(D){console.error("Failed to load estate planning data:",D),o("Failed to load estate planning data")}finally{i(!1)}},T=async D=>{if(confirm("Are you sure you want to delete this estate planning document?"))try{await G.delete(`/api/v1/estate-planning/documents/${D}`),await S()}catch(V){console.error("Failed to delete document:",V),o("Failed to delete document")}},v=()=>{x({document_type:"will",document_name:"",status:"current",last_updated:"",next_review_date:"",attorney_contact:"",document_location:""})},L=async D=>{var V,he;if(D.preventDefault(),!d.document_name.trim()){o("Document name is required");return}m(!0),o(null);try{const ye={document_type:d.document_type,document_name:d.document_name.trim(),status:d.status,last_updated:d.last_updated?d.last_updated:void 0,next_review_date:d.next_review_date?d.next_review_date:void 0,attorney_contact:d.attorney_contact.trim()||void 0,document_location:d.document_location.trim()||void 0,document_details:{}};h?(await G.put(`/api/v1/estate-planning/documents/${h.id}`,ye),f(null)):(await G.post("/api/v1/estate-planning/documents",ye),u(!1)),v(),await S()}catch(ye){console.error("Failed to save document:",ye),o(((he=(V=ye.response)==null?void 0:V.data)==null?void 0:he.detail)||"Failed to save document")}finally{m(!1)}},P=D=>{var V,he;x({document_type:D.document_type,document_name:D.document_name,status:D.status,last_updated:((V=D.last_updated)==null?void 0:V.split("T")[0])||"",next_review_date:((he=D.next_review_date)==null?void 0:he.split("T")[0])||"",attorney_contact:D.attorney_contact||"",document_location:D.document_location||""}),f(D),o(null)},z=()=>{v(),u(!0),o(null)},C=D=>D?new Date(D).toLocaleDateString():"Not set",j=D=>{var V;return((V=La[D])==null?void 0:V.icon)||lt},E=D=>{var V;return((V=La[D])==null?void 0:V.color)||"text-gray-500"},A=D=>{switch(D){case"current":return qe;case"needs_update":return Je;case"missing":return Nt;case"in_progress":return Dt;default:return lt}};return n?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"text-white",children:"Loading estate planning data..."})}):l&&!a?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-red-400",children:["Error: ",l]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(_,{children:e.jsx(_.Body,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Total Documents"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(a==null?void 0:a.total_documents)||0})]}),e.jsx(lt,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(_,{children:e.jsx(_.Body,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Current"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:((R=(y=a==null?void 0:a.documents_by_status)==null?void 0:y.current)==null?void 0:R.count)||0})]}),e.jsx(qe,{className:"w-8 h-8 text-green-500"})]})})}),e.jsx(_,{children:e.jsx(_.Body,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Need Updates"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(((F=(k=a==null?void 0:a.documents_by_status)==null?void 0:k.needs_update)==null?void 0:F.count)||0)+(((J=(O=a==null?void 0:a.documents_by_status)==null?void 0:O.missing)==null?void 0:J.count)||0)})]}),e.jsx(Je,{className:"w-8 h-8 text-yellow-500"})]})})}),e.jsx(_,{children:e.jsx(_.Body,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Reviews Due"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:((U=a==null?void 0:a.upcoming_reviews)==null?void 0:U.length)||0})]}),e.jsx(It,{className:"w-8 h-8 text-purple-500"})]})})})]}),(a==null?void 0:a.gaps_identified)&&a.gaps_identified.length>0&&e.jsxs(_,{children:[e.jsx(_.Header,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Je,{className:"w-5 h-5 text-yellow-500"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Estate Planning Gaps"})]})}),e.jsx(_.Body,{children:e.jsx("div",{className:"space-y-2",children:a.gaps_identified.map((D,V)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Nt,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-200",children:D})]},V))})})]}),e.jsxs(_,{children:[e.jsx(_.Header,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Estate Planning Documents"}),e.jsxs($,{onClick:z,children:[e.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Add Document"]})]})}),e.jsx(_.Body,{children:s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(nl,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-2",children:"No Estate Planning Documents"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Start protecting your financial future by adding your estate planning documents"}),e.jsxs($,{onClick:z,children:[e.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Add Your First Document"]})]}):e.jsx("div",{className:"space-y-4",children:Object.entries((a==null?void 0:a.documents_by_type)||{}).map(([D,V])=>{const he=j(D),ye=La[D],Ie=s.filter(de=>de.document_type===D);return e.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 bg-gray-800",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(he,{className:`w-6 h-6 ${E(D)}`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white",children:ye==null?void 0:ye.label}),e.jsxs("p",{className:"text-sm text-white",children:[V.count," documents"]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Ie.map(de=>{const Oe=A(de.status),Fe=qo[de.status];return e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-white",children:de.document_name}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>P(de),className:"p-1 text-gray-300 hover:text-white transition-colors",children:e.jsx(ra,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>T(de.id),className:"p-1 text-gray-300 hover:text-white transition-colors",children:e.jsx(ws,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{className:`w-4 h-4 ${(Fe==null?void 0:Fe.textColor)||"text-gray-400"}`}),e.jsx("span",{className:`text-sm ${(Fe==null?void 0:Fe.textColor)||"text-gray-400"}`,children:(Fe==null?void 0:Fe.label)||de.status})]}),de.last_updated&&e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Last Updated"}),e.jsx("p",{className:"font-medium text-white",children:C(de.last_updated)})]}),de.next_review_date&&e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Next Review"}),e.jsx("p",{className:"font-medium text-white",children:C(de.next_review_date)})]}),de.attorney_contact&&e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Attorney"}),e.jsx("p",{className:"font-medium text-white",children:de.attorney_contact})]})]})]},de.id)})})]},D)})})})]}),(c||h)&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:h?"Edit Estate Planning Document":"Add Estate Planning Document"}),l&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-red-600 text-sm",children:l})}),e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Document Type *"}),e.jsx("select",{value:d.document_type,onChange:D=>x({...d,document_type:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0,children:p.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Document Name *"}),e.jsx("input",{type:"text",value:d.document_name,onChange:D=>x({...d,document_name:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Last Will and Testament",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),e.jsxs("select",{value:d.status,onChange:D=>x({...d,status:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"current",children:"Current"}),e.jsx("option",{value:"needs_update",children:"Needs Update"}),e.jsx("option",{value:"missing",children:"Missing"}),e.jsx("option",{value:"in_progress",children:"In Progress"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Updated"}),e.jsx("input",{type:"date",value:d.last_updated,onChange:D=>x({...d,last_updated:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Next Review Date"}),e.jsx("input",{type:"date",value:d.next_review_date,onChange:D=>x({...d,next_review_date:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attorney Contact"}),e.jsx("input",{type:"text",value:d.attorney_contact,onChange:D=>x({...d,attorney_contact:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Attorney name and contact info"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Document Location"}),e.jsx("input",{type:"text",value:d.document_location,onChange:D=>x({...d,document_location:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Physical or digital storage location"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx($,{type:"button",variant:"outline",onClick:()=>{u(!1),f(null)},disabled:b,children:"Cancel"}),e.jsx($,{type:"submit",disabled:b,children:b?h?"Updating...":"Saving...":h?"Update Document":"Save Document"})]})]})]})})]})},Fa={life:{icon:Mt,label:"Life Insurance",color:"text-red-500",description:"Life insurance protection for beneficiaries"},disability:{icon:ir,label:"Disability Insurance",color:"text-orange-500",description:"Income protection if unable to work"},health:{icon:wt,label:"Health Insurance",color:"text-green-500",description:"Medical coverage and healthcare expenses"},auto:{icon:lr,label:"Auto Insurance",color:"text-blue-500",description:"Vehicle coverage and liability protection"},homeowners:{icon:Gt,label:"Homeowners Insurance",color:"text-purple-500",description:"Property and liability protection for homes"},umbrella:{icon:Ln,label:"Umbrella Insurance",color:"text-indigo-500",description:"Additional liability coverage"},renters:{icon:Gt,label:"Renters Insurance",color:"text-teal-500",description:"Personal property protection for renters"},travel:{icon:al,label:"Travel Insurance",color:"text-pink-500",description:"Coverage for travel-related incidents"}},Wo=()=>{const[s,t]=w.useState([]),[a,r]=w.useState(null),[n,i]=w.useState(!0),[l,o]=w.useState(null),[c,u]=w.useState(!1),[h,f]=w.useState(null),[d,x]=w.useState({policy_type:"life",policy_name:"",coverage_amount:"",annual_premium:"",beneficiary_primary:"",beneficiary_secondary:""}),[b,m]=w.useState(!1),[p,N]=w.useState([]);w.useEffect(()=>{S(),g()},[]);const g=async()=>{try{const A=await G.get("/api/v1/insurance/policy-types");N(A.policy_types||[])}catch(A){console.error("Failed to fetch policy types:",A)}},S=async()=>{try{i(!0),o(null);const[A,y]=await Promise.all([G.get("/api/v1/insurance/policies"),G.get("/api/v1/insurance/policies/summary")]);t(A),r(y)}catch(A){console.error("Failed to load insurance data:",A),o(A instanceof Error?A.message:"Failed to load insurance data")}finally{i(!1)}},T=async A=>{if(confirm("Are you sure you want to delete this insurance policy?"))try{await G.delete(`/api/v1/insurance/policies/${A}`),await S()}catch(y){console.error("Failed to delete policy:",y),o("Failed to delete policy")}},v=()=>{x({policy_type:"life",policy_name:"",coverage_amount:"",annual_premium:"",beneficiary_primary:"",beneficiary_secondary:""})},L=async A=>{var y,R;if(A.preventDefault(),!d.policy_name.trim()){o("Policy name is required");return}m(!0),o(null);try{const k={policy_type:d.policy_type,policy_name:d.policy_name.trim(),coverage_amount:d.coverage_amount?parseFloat(d.coverage_amount):void 0,annual_premium:d.annual_premium?parseFloat(d.annual_premium):void 0,beneficiary_primary:d.beneficiary_primary.trim()||void 0,beneficiary_secondary:d.beneficiary_secondary.trim()||void 0,policy_details:{}};h?(await G.put(`/api/v1/insurance/policies/${h.id}`,k),f(null)):(await G.post("/api/v1/insurance/policies",k),u(!1)),v(),await S()}catch(k){console.error("Failed to save policy:",k),o(((R=(y=k.response)==null?void 0:y.data)==null?void 0:R.detail)||"Failed to save policy")}finally{m(!1)}},P=A=>{var y,R;x({policy_type:A.policy_type,policy_name:A.policy_name,coverage_amount:((y=A.coverage_amount)==null?void 0:y.toString())||"",annual_premium:((R=A.annual_premium)==null?void 0:R.toString())||"",beneficiary_primary:A.beneficiary_primary||"",beneficiary_secondary:A.beneficiary_secondary||""}),f(A),o(null)},z=()=>{v(),u(!0),o(null)},C=A=>A?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(A):"$0",j=A=>{const y=Fa[A];return y?y.icon:wt},E=A=>{const y=Fa[A];return(y==null?void 0:y.color)||"text-gray-500"};return n?e.jsx(_,{className:"w-full",children:e.jsx(_.Body,{children:e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading insurance policies..."})]})})}):l?e.jsx(_,{className:"w-full border-red-200",children:e.jsx(_.Body,{children:e.jsxs("div",{className:"flex items-center text-red-600",children:[e.jsx(Nt,{className:"w-5 h-5 mr-2"}),e.jsx("span",{children:l}),e.jsx($,{variant:"outline",size:"sm",onClick:S,className:"ml-4",children:"Retry"})]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(_,{children:e.jsx(_.Body,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Total Policies"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(a==null?void 0:a.total_policies)||0})]}),e.jsx(wt,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(_,{children:e.jsx(_.Body,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Annual Premiums"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:C((a==null?void 0:a.total_annual_premiums)||0)})]}),e.jsx(ge,{className:"w-8 h-8 text-green-500"})]})})}),e.jsx(_,{children:e.jsx(_.Body,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Coverage Types"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:a?Object.keys(a.coverage_by_type).length:0})]}),e.jsx(Ln,{className:"w-8 h-8 text-purple-500"})]})})})]}),e.jsxs(_,{children:[e.jsx(_.Header,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Insurance Policies"}),e.jsxs($,{onClick:z,children:[e.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Add Policy"]})]})}),e.jsx(_.Body,{children:s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(wt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Insurance Policies"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Start protecting your financial future by adding your insurance policies"}),e.jsxs($,{onClick:()=>u(!0),children:[e.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Add Your First Policy"]})]}):e.jsx("div",{className:"space-y-4",children:Object.entries((a==null?void 0:a.coverage_by_type)||{}).map(([A,y])=>{const R=j(A),k=Fa[A],F=s.filter(O=>O.policy_type===A);return e.jsxs("div",{className:"border border-gray-700 rounded-lg p-4 bg-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{className:`w-6 h-6 ${E(A)}`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white",children:k==null?void 0:k.label}),e.jsxs("p",{className:"text-sm text-white",children:[y.count," policies • ",C(y.total_coverage)," coverage"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-white",children:C(y.total_premiums)}),e.jsx("p",{className:"text-sm text-white",children:"annual premium"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:F.map(O=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-white",children:O.policy_name}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>P(O),className:"p-1 text-gray-300 hover:text-white transition-colors",children:e.jsx(ra,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>T(O.id),className:"p-1 text-gray-300 hover:text-white transition-colors",children:e.jsx(ws,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Coverage"}),e.jsx("p",{className:"font-medium text-white",children:C(O.coverage_amount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Premium"}),e.jsx("p",{className:"font-medium text-white",children:C(O.annual_premium)})]}),O.beneficiary_primary&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-white",children:"Primary Beneficiary"}),e.jsx("p",{className:"font-medium text-white",children:O.beneficiary_primary})]})]})]},O.id))})]},A)})})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add Insurance Policy"}),l&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-red-600 text-sm",children:l})}),e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Policy Type *"}),e.jsx("select",{value:d.policy_type,onChange:A=>x({...d,policy_type:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0,children:p.map(A=>e.jsx("option",{value:A.value,children:A.label},A.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Policy Name *"}),e.jsx("input",{type:"text",value:d.policy_name,onChange:A=>x({...d,policy_name:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Term Life Insurance Policy",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Coverage Amount"}),e.jsx("input",{type:"number",value:d.coverage_amount,onChange:A=>x({...d,coverage_amount:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"500000",min:"0",step:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Premium"}),e.jsx("input",{type:"number",value:d.annual_premium,onChange:A=>x({...d,annual_premium:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"1200",min:"0",step:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Beneficiary"}),e.jsx("input",{type:"text",value:d.beneficiary_primary,onChange:A=>x({...d,beneficiary_primary:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Spouse name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Secondary Beneficiary"}),e.jsx("input",{type:"text",value:d.beneficiary_secondary,onChange:A=>x({...d,beneficiary_secondary:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Children or other beneficiary"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx($,{type:"button",variant:"outline",onClick:()=>u(!1),disabled:b,children:"Cancel"}),e.jsx($,{type:"submit",disabled:b,children:b?"Saving...":"Save Policy"})]})]})]})}),h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Edit Insurance Policy"}),l&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-red-600 text-sm",children:l})}),e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Policy Type *"}),e.jsx("select",{value:d.policy_type,onChange:A=>x({...d,policy_type:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0,children:p.map(A=>e.jsx("option",{value:A.value,children:A.label},A.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Policy Name *"}),e.jsx("input",{type:"text",value:d.policy_name,onChange:A=>x({...d,policy_name:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Term Life Insurance Policy",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Coverage Amount"}),e.jsx("input",{type:"number",value:d.coverage_amount,onChange:A=>x({...d,coverage_amount:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"500000",min:"0",step:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Premium"}),e.jsx("input",{type:"number",value:d.annual_premium,onChange:A=>x({...d,annual_premium:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"1200",min:"0",step:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Beneficiary"}),e.jsx("input",{type:"text",value:d.beneficiary_primary,onChange:A=>x({...d,beneficiary_primary:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Spouse name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Secondary Beneficiary"}),e.jsx("input",{type:"text",value:d.beneficiary_secondary,onChange:A=>x({...d,beneficiary_secondary:A.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Children or other beneficiary"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx($,{type:"button",variant:"outline",onClick:()=>f(null),disabled:b,children:"Cancel"}),e.jsx($,{type:"submit",disabled:b,children:b?"Updating...":"Update Policy"})]})]})]})})]})},Go=()=>{const[s,t]=w.useState(null),[a,r]=w.useState(!0),[n,i]=w.useState(null),[l,o]=w.useState(!1),[c,u]=w.useState({risk_tolerance_score:5,investment_timeline_years:10,rebalancing_frequency:"quarterly",investment_philosophy:"passive",esg_preference_level:3,international_allocation_target:20,alternative_investment_interest:0,cryptocurrency_allocation:0,individual_stock_tolerance:0,tax_loss_harvesting_enabled:!1,dollar_cost_averaging_preference:!0}),f=(()=>{const S=window.location.hostname;return"https://wealthpath-backend.onrender.com"})(),d=()=>localStorage.getItem("access_token"),x=async(S,T={})=>{const v=d(),L={"Content-Type":"application/json",...v&&{Authorization:`Bearer ${v}`},...T.headers},P=await fetch(`${f}${S}`,{...T,headers:L});if(!P.ok){const z=await P.json().catch(()=>({detail:"Request failed"}));throw new Error(z.detail||`HTTP ${P.status}`)}return P.json()},b=async()=>{try{r(!0),i(null);const S=await x("/api/v1/investment-preferences/");t(S),u(S)}catch(S){S.message.includes("404")?t(null):i(S.message),console.error("Error loading investment preferences:",S)}finally{r(!1)}},m=async()=>{try{i(null);const T=await x("/api/v1/investment-preferences/",{method:s?"PUT":"POST",body:JSON.stringify(c)});t(T),o(!1)}catch(S){i(S.message),console.error("Error saving investment preferences:",S)}},p=async()=>{if(confirm("Are you sure you want to delete your investment preferences? This action cannot be undone."))try{i(null),await x("/api/v1/investment-preferences/",{method:"DELETE"}),t(null),u({risk_tolerance_score:5,investment_timeline_years:10,rebalancing_frequency:"quarterly",investment_philosophy:"passive",esg_preference_level:3,international_allocation_target:20,alternative_investment_interest:!1,cryptocurrency_allocation:0,individual_stock_tolerance:!1,tax_loss_harvesting_enabled:!1,dollar_cost_averaging_preference:!0})}catch(S){i(S.message),console.error("Error deleting investment preferences:",S)}},N=S=>S?S<=3?"Conservative":S<=6?"Moderate":S<=8?"Moderate-Aggressive":"Aggressive":"Unknown",g=S=>S?S<=5?"Short-term":S<=15?"Medium-term":"Long-term":"Unknown";return w.useEffect(()=>{b()},[]),a?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}):e.jsxs("div",{className:"space-y-6",children:[n&&e.jsx(_,{className:"bg-red-900/20 border-red-500/20 p-4",children:e.jsxs("div",{className:"flex items-center space-x-2 text-red-400",children:[e.jsx(Nt,{className:"h-4 w-4"}),e.jsxs("span",{children:["Error: ",n]})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"h-5 w-5 text-blue-400"}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Investment Preferences"})]}),e.jsxs("div",{className:"flex gap-3",children:[s&&e.jsxs($,{variant:"outline",onClick:p,className:"text-red-400 hover:text-red-300 border-red-500/20",children:[e.jsx(ws,{className:"w-4 h-4 mr-2"}),"Delete"]}),e.jsxs($,{onClick:()=>o(!l),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[s?e.jsx(ga,{className:"w-4 h-4 mr-2"}):e.jsx(Tt,{className:"w-4 h-4 mr-2"}),s?"Edit Preferences":"Set Preferences"]})]})]}),s?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(De,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-white font-medium",children:"Risk Profile"})]}),e.jsx("p",{className:"text-2xl font-bold text-white",children:N(s.risk_tolerance_score)}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Score: ",s.risk_tolerance_score,"/10"]})]}),e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Dt,{className:"h-4 w-4 text-blue-400"}),e.jsx("span",{className:"text-white font-medium",children:"Timeline"})]}),e.jsx("p",{className:"text-2xl font-bold text-white",children:g(s.investment_timeline_years)}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.investment_timeline_years," years"]})]}),e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(sl,{className:"h-4 w-4 text-purple-400"}),e.jsx("span",{className:"text-white font-medium",children:"Philosophy"})]}),e.jsx("p",{className:"text-2xl font-bold text-white capitalize",children:s.investment_philosophy||"Not Set"}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.rebalancing_frequency," rebalancing"]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(tt,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"No investment preferences set"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Set your investment preferences to receive personalized recommendations"})]})]})}),l&&e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Investment Preferences"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Risk Tolerance (1-10)"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"range",min:"1",max:"10",value:c.risk_tolerance_score||5,onChange:S=>u({...c,risk_tolerance_score:parseInt(S.target.value)}),className:"flex-1"}),e.jsx("span",{className:"text-white w-8",children:c.risk_tolerance_score})]}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Current: ",N(c.risk_tolerance_score)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Investment Timeline (years)"}),e.jsx(W,{type:"number",min:"1",max:"50",value:c.investment_timeline_years||"",onChange:S=>u({...c,investment_timeline_years:parseInt(S.target.value)}),className:"bg-gray-700 border-gray-600 text-white",placeholder:"e.g. 15"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Investment Philosophy"}),e.jsxs("select",{value:c.investment_philosophy||"passive",onChange:S=>u({...c,investment_philosophy:S.target.value}),className:"w-full p-2 bg-gray-700 border border-gray-600 text-white rounded",children:[e.jsx("option",{value:"passive",children:"Passive"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"hybrid",children:"Hybrid"}),e.jsx("option",{value:"value",children:"Value"}),e.jsx("option",{value:"growth",children:"Growth"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Rebalancing Frequency"}),e.jsxs("select",{value:c.rebalancing_frequency||"quarterly",onChange:S=>u({...c,rebalancing_frequency:S.target.value}),className:"w-full p-2 bg-gray-700 border border-gray-600 text-white rounded",children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"}),e.jsx("option",{value:"annual",children:"Annual"}),e.jsx("option",{value:"threshold",children:"Threshold-based"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"International Allocation Target (%)"}),e.jsx(W,{type:"number",min:"0",max:"100",value:c.international_allocation_target||"",onChange:S=>u({...c,international_allocation_target:parseFloat(S.target.value)}),className:"bg-gray-700 border-gray-600 text-white",placeholder:"e.g. 20"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center space-x-2 text-white",children:[e.jsx("input",{type:"checkbox",checked:c.alternative_investment_interest||!1,onChange:S=>u({...c,alternative_investment_interest:S.target.checked}),className:"rounded"}),e.jsx("span",{children:"Interest in alternative investments"})]}),e.jsxs("label",{className:"flex items-center space-x-2 text-white",children:[e.jsx("input",{type:"checkbox",checked:c.individual_stock_tolerance||!1,onChange:S=>u({...c,individual_stock_tolerance:S.target.checked}),className:"rounded"}),e.jsx("span",{children:"Comfortable with individual stocks"})]}),e.jsxs("label",{className:"flex items-center space-x-2 text-white",children:[e.jsx("input",{type:"checkbox",checked:c.tax_loss_harvesting_enabled||!1,onChange:S=>u({...c,tax_loss_harvesting_enabled:S.target.checked}),className:"rounded"}),e.jsx("span",{children:"Enable tax-loss harvesting"})]}),e.jsxs("label",{className:"flex items-center space-x-2 text-white",children:[e.jsx("input",{type:"checkbox",checked:c.dollar_cost_averaging_preference||!1,onChange:S=>u({...c,dollar_cost_averaging_preference:S.target.checked}),className:"rounded"}),e.jsx("span",{children:"Prefer dollar-cost averaging"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-600",children:[e.jsxs($,{onClick:m,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Save Preferences"]}),e.jsx($,{variant:"outline",onClick:()=>o(!1),className:"border-gray-600 text-gray-300 hover:text-white",children:"Cancel"})]})]})]})})]})},Ho=()=>{const[s,t]=w.useState({benefits:[]}),[a,r]=w.useState(!0),[n,i]=w.useState(null),[l,o]=w.useState(!1),[c,u]=w.useState(!1),[h,f]=w.useState(!1),[d,x]=w.useState({estimated_benefit:"",claiming_age:"67",full_retirement_age:"67"}),[b,m]=w.useState({match_formula:"",vesting_schedule:"",employer_contribution:"",max_contribution:""}),[p,N]=w.useState({pension_type:"defined_benefit",monthly_payout:"",vesting_schedule:"",lump_sum_available:!1}),[g,S]=w.useState(!1),[T,v]=w.useState(!1),[L,P]=w.useState(!1),[z,C]=w.useState(!1),E=(()=>{const U=window.location.hostname;return"https://wealthpath-backend.onrender.com"})(),A=()=>localStorage.getItem("access_token"),y=async(U,D={})=>{const V=A(),he={"Content-Type":"application/json",...V&&{Authorization:`Bearer ${V}`},...D.headers},ye=await fetch(`${E}${U}`,{...D,headers:he});if(!ye.ok){const Ie=await ye.json().catch(()=>({detail:"Request failed"}));throw new Error(Ie.detail||`HTTP ${ye.status}`)}return ye.json()},R=async()=>{var U,D;try{r(!0),i(null);const V=await y("/api/v1/profile/complete-profile");t({benefits:V.benefits||[]});const he=(U=V.benefits)==null?void 0:U.find(Ie=>Ie.benefit_type==="social_security");he&&x(Ie=>{var de,Oe,Fe;return{...Ie,estimated_benefit:((de=he.estimated_monthly_benefit)==null?void 0:de.toString())||"",claiming_age:((Oe=he.social_security_claiming_age)==null?void 0:Oe.toString())||"67",full_retirement_age:((Fe=he.full_retirement_age)==null?void 0:Fe.toString())||"67"}});const ye=(D=V.benefits)==null?void 0:D.find(Ie=>Ie.benefit_type==="401k");ye&&m(Ie=>{var de,Oe;return{...Ie,match_formula:ye.employer_401k_match_formula||"",vesting_schedule:ye.employer_401k_vesting_schedule||"",employer_contribution:((de=ye.employer_contribution)==null?void 0:de.toString())||"",max_contribution:((Oe=ye.max_401k_contribution)==null?void 0:Oe.toString())||""}})}catch(V){i(V.message),console.error("Error loading benefits data:",V)}finally{r(!1)}},k=()=>{const U=parseInt(d.claiming_age),D=parseInt(d.full_retirement_age),V=parseFloat(d.estimated_benefit);if(!V||!U)return null;let he=1;U<D?he=1-(D-U)*.0667:U>D&&(he=1+Math.min(U-D,70-D)*.08);const ye=V*he,Ie=ye*12;return{monthlyBenefit:ye,annualBenefit:Ie,adjustmentFactor:he,recommendation:U<D?"Consider waiting until Full Retirement Age for full benefits":U>70?"No additional credits after age 70":"Optimal claiming strategy depends on your health and financial needs"}},F=()=>{const U=b.match_formula,D=parseFloat(b.employer_contribution)||0;if(!U)return null;let V=0,he=[];return U.includes("100%")&&U.includes("3%")?(V=D*.03,he.push("Contribute at least 3% to get full employer match")):U.includes("50%")&&U.includes("6%")&&(V=D*.06*.5,he.push("Contribute at least 6% to maximize employer match")),{maxMatch:V,recommendations:he,annualMatch:V*12}},O=async()=>{S(!0),P(!1);try{(await y("/api/v1/profile/social-security",{method:"POST",body:JSON.stringify({estimated_monthly_benefit:parseFloat(d.estimated_benefit)||0,planned_claiming_age:parseInt(d.claiming_age)||67,full_retirement_age:parseInt(d.full_retirement_age)||67})})).status==="success"&&(P(!0),setTimeout(()=>P(!1),3e3))}catch(U){console.error("Failed to save Social Security data:",U),i("Failed to save Social Security data. Please try again.")}finally{S(!1)}},J=async()=>{v(!0),C(!1);try{(await y("/api/v1/profile/401k",{method:"POST",body:JSON.stringify({employer_match_formula:b.match_formula||"",vesting_schedule:b.vesting_schedule||"",annual_salary:parseFloat(b.employer_contribution)||0,annual_401k_limit:parseFloat(b.max_contribution)||23e3})})).status==="success"&&(C(!0),await y("/api/v1/profile/sync-vector-store",{method:"POST"}),setTimeout(()=>C(!1),3e3))}catch(U){console.error("Failed to save 401(k) data:",U),i("Failed to save 401(k) data. Please try again.")}finally{v(!1)}};return w.useEffect(()=>{R()},[]),a?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}):e.jsxs("div",{className:"space-y-6",children:[n&&e.jsx(_,{className:"bg-red-900/20 border-red-500/20 p-4",children:e.jsxs("div",{className:"flex items-center space-x-2 text-red-400",children:[e.jsx(Nt,{className:"h-4 w-4"}),e.jsxs("span",{children:["Error: ",n]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(_,{className:"bg-gray-800 border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Social Security"}),e.jsxs("p",{className:"text-white text-2xl font-bold",children:["$",d.estimated_benefit?parseFloat(d.estimated_benefit).toLocaleString():"Not Set"]}),e.jsxs("p",{className:"text-white text-sm",children:["Monthly at claiming age ",d.claiming_age]})]}),e.jsx(ge,{className:"h-8 w-8 text-green-400"})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"401(k) Match"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:b.match_formula||"Not Set"}),e.jsx("p",{className:"text-white text-sm",children:"Employer matching formula"})]}),e.jsx(Te,{className:"h-8 w-8 text-blue-400"})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Benefits Count"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:s.benefits.length}),e.jsx("p",{className:"text-white text-sm",children:"Total benefits tracked"})]}),e.jsx(Mt,{className:"h-8 w-8 text-purple-400"})]})})]}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(wt,{className:"h-5 w-5 text-green-400"}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Social Security Optimization"})]}),e.jsx($,{onClick:()=>o(!l),className:"bg-green-600 hover:bg-green-700 text-white",children:l?"Hide":"Configure"})]}),l&&e.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Estimated Monthly Benefit at FRA"}),e.jsx(W,{type:"number",placeholder:"e.g. 3200",className:"bg-gray-800 border-gray-600 text-white",value:d.estimated_benefit,onChange:U=>x({...d,estimated_benefit:U.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Planned Claiming Age"}),e.jsxs("select",{className:"w-full p-2 bg-gray-800 border border-gray-600 text-white rounded",value:d.claiming_age,onChange:U=>x({...d,claiming_age:U.target.value}),children:[e.jsx("option",{value:"62",children:"62 (Early, Reduced)"}),e.jsx("option",{value:"65",children:"65"}),e.jsx("option",{value:"67",children:"67 (Full Retirement Age)"}),e.jsx("option",{value:"68",children:"68"}),e.jsx("option",{value:"69",children:"69"}),e.jsx("option",{value:"70",children:"70 (Maximum Credits)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Full Retirement Age"}),e.jsxs("select",{className:"w-full p-2 bg-gray-800 border border-gray-600 text-white rounded",value:d.full_retirement_age,onChange:U=>x({...d,full_retirement_age:U.target.value}),children:[e.jsx("option",{value:"66",children:"66"}),e.jsx("option",{value:"67",children:"67"})]})]})]}),d.estimated_benefit&&e.jsx("div",{className:"mt-4 p-4 bg-gray-800 rounded-lg",children:(()=>{const U=k();return U?e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium mb-2",children:"Benefit Calculation"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Adjusted Monthly Benefit"}),e.jsxs("p",{className:"text-white font-bold",children:["$",U.monthlyBenefit.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Annual Benefit"}),e.jsxs("p",{className:"text-white font-bold",children:["$",U.annualBenefit.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Adjustment Factor"}),e.jsxs("p",{className:"text-white font-bold",children:[(U.adjustmentFactor*100).toFixed(1),"%"]})]})]}),e.jsx("div",{className:"mt-3 p-3 bg-blue-900/30 rounded border border-blue-500/20",children:e.jsx("p",{className:"text-blue-300 text-sm",children:U.recommendation})})]}):null})()}),e.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-gray-700",children:e.jsx($,{onClick:O,disabled:g,className:`
                    px-4 py-2 font-medium transition-all flex items-center space-x-2
                    ${g?"bg-gray-400 cursor-not-allowed":L?"bg-green-500 hover:bg-green-600":"bg-blue-500 hover:bg-blue-600"}
                    text-white
                  `,children:g?e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Saving..."})]}):L?e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{children:"Saved!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Or,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Changes"})]})})})]})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"h-5 w-5 text-blue-400"}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"401(k) Optimization"})]}),e.jsx($,{onClick:()=>u(!c),className:"bg-blue-600 hover:bg-blue-700 text-white",children:c?"Hide":"Configure"})]}),c&&e.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Employer Match Formula"}),e.jsx(W,{type:"text",placeholder:"e.g. 100% up to 3%, 50% up to 6%",className:"bg-gray-800 border-gray-600 text-white",value:b.match_formula,onChange:U=>m({...b,match_formula:U.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Vesting Schedule"}),e.jsx(W,{type:"text",placeholder:"e.g. 25% per year starting year 2",className:"bg-gray-800 border-gray-600 text-white",value:b.vesting_schedule,onChange:U=>m({...b,vesting_schedule:U.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Your Annual Salary"}),e.jsx(W,{type:"number",placeholder:"e.g. 120000",className:"bg-gray-800 border-gray-600 text-white",value:b.employer_contribution,onChange:U=>m({...b,employer_contribution:U.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Annual 401k Limit (2024)"}),e.jsx(W,{type:"number",placeholder:"Enter annual 401k contribution limit",className:"bg-gray-800 border-gray-600 text-white",value:b.max_contribution,onChange:U=>m({...b,max_contribution:U.target.value})})]})]}),b.match_formula&&b.employer_contribution&&e.jsx("div",{className:"mt-4 p-4 bg-gray-800 rounded-lg",children:(()=>{const U=F();return U?e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium mb-2",children:"401(k) Match Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Maximum Annual Match"}),e.jsxs("p",{className:"text-white font-bold",children:["$",U.annualMatch.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Monthly Match Potential"}),e.jsxs("p",{className:"text-white font-bold",children:["$",U.maxMatch.toLocaleString()]})]})]}),U.recommendations.length>0&&e.jsx("div",{className:"mt-3 p-3 bg-green-900/30 rounded border border-green-500/20",children:U.recommendations.map((D,V)=>e.jsx("p",{className:"text-green-300 text-sm",children:D},V))})]}):null})()}),e.jsx("div",{className:"flex justify-end mt-4 pt-4 border-t border-gray-700",children:e.jsx($,{onClick:J,disabled:T,className:`
                    px-4 py-2 font-medium transition-all flex items-center space-x-2
                    ${T?"bg-gray-400 cursor-not-allowed":z?"bg-green-500 hover:bg-green-600":"bg-blue-500 hover:bg-blue-600"}
                    text-white
                  `,children:T?e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Saving..."})]}):z?e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{children:"Saved!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Or,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Changes"})]})})})]})]})}),e.jsx("div",{className:"flex flex-wrap gap-4",children:e.jsx($,{onClick:R,className:"bg-gray-600 hover:bg-gray-700 text-white",children:"Refresh Data"})})]})},Yo=()=>{const[s,t]=w.useState({tax_info:null}),[a,r]=w.useState(!0),[n,i]=w.useState(null),[l,o]=w.useState(!1),[c,u]=w.useState(!1),[h,f]=w.useState(!1),[d,x]=w.useState(!1),[b,m]=w.useState(!1),[p,N]=w.useState({adjusted_gross_income:"",filing_status:"single",state_tax_rate:"",charitable_giving_annual:"",itemized_deduction_total:"",tax_loss_harvesting_enabled:!1,backdoor_roth_eligible:!1,mega_backdoor_roth_available:!1}),[g,S]=w.useState({backdoor_roth_conversion:"",mega_backdoor_roth_amount:"",tax_loss_harvesting_savings:"",charitable_bunching_strategy:!1,business_income_amount:"",rental_income_amount:""}),v=(()=>{const y=window.location.hostname;return"https://wealthpath-backend.onrender.com"})(),L=()=>localStorage.getItem("access_token"),P=async(y,R={})=>{const k=L(),F={"Content-Type":"application/json",...k&&{Authorization:`Bearer ${k}`},...R.headers},O=await fetch(`${v}${y}`,{...R,headers:F});if(!O.ok){const J=await O.json().catch(()=>({detail:"Request failed"}));throw new Error(J.detail||`HTTP ${O.status}`)}return O.json()},z=async()=>{var y,R,k,F;try{r(!0),i(null);const O=await P("/api/v1/profile/complete-profile");t({tax_info:O.tax_info||null}),O.tax_info&&N({adjusted_gross_income:((y=O.tax_info.adjusted_gross_income)==null?void 0:y.toString())||"",filing_status:O.tax_info.filing_status||"single",state_tax_rate:((R=O.tax_info.state_tax_rate)==null?void 0:R.toString())||"",charitable_giving_annual:((k=O.tax_info.charitable_giving_annual)==null?void 0:k.toString())||"",itemized_deduction_total:((F=O.tax_info.itemized_deduction_total)==null?void 0:F.toString())||"",tax_loss_harvesting_enabled:O.tax_info.tax_loss_harvesting_enabled||!1,backdoor_roth_eligible:O.tax_info.backdoor_roth_eligible||!1,mega_backdoor_roth_available:O.tax_info.mega_backdoor_roth_available||!1})}catch(O){i(O.message),console.error("Error loading tax data:",O)}finally{r(!1)}},C=async()=>{x(!0),m(!1);try{await P("/api/v1/profile/tax-info",{method:"POST",body:JSON.stringify({tax_year:new Date().getFullYear(),filing_status:p.filing_status,adjusted_gross_income:parseFloat(p.adjusted_gross_income)||null,state_tax_bracket:parseFloat(p.state_tax_rate)||null,itemized_deductions:parseFloat(p.itemized_deduction_total)||null})})&&(m(!0),setTimeout(()=>m(!1),3e3),await z())}catch(y){console.error("Failed to save tax data:",y),i("Failed to save tax data")}finally{x(!1)}},j=(y,R)=>{const k={single:[{min:0,max:11600,rate:10},{min:11600,max:47150,rate:12},{min:47150,max:100525,rate:22},{min:100525,max:191650,rate:24},{min:191650,max:243725,rate:32},{min:243725,max:609350,rate:35},{min:609350,max:1/0,rate:37}],married_filing_jointly:[{min:0,max:23200,rate:10},{min:23200,max:94300,rate:12},{min:94300,max:201050,rate:22},{min:201050,max:383900,rate:24},{min:383900,max:487450,rate:32},{min:487450,max:731200,rate:35},{min:731200,max:1/0,rate:37}]},F=k[R]||k.single;for(const O of F)if(y>O.min&&y<=O.max)return O.rate;return 37},E=()=>{const y=parseFloat(p.adjusted_gross_income)||0,R=parseFloat(p.charitable_giving_annual)||0,k=parseFloat(p.state_tax_rate)||0;if(!y)return null;const F=j(y,p.filing_status),O=F+k,J=R*(O/100),U=p.filing_status==="married_filing_jointly"?29200:14600,D=parseFloat(p.itemized_deduction_total)||0,V=Math.max(0,D-U)*(O/100),he=y>153e3?7e3*(O/100):0;return{federalBracket:F,marginalRate:O,charitableTaxSavings:J,itemizingBenefit:V,backdoorRothSavings:he,taxLossHarvestingSavings:p.tax_loss_harvesting_enabled?y*.005:0,totalPotentialSavings:J+V+he}},A=()=>{const y=parseFloat(p.adjusted_gross_income)||0,R=[];return y>153e3&&!p.backdoor_roth_eligible&&R.push({strategy:"Backdoor Roth IRA",description:"You may be eligible for a backdoor Roth IRA conversion",potentialSavings:"$1,400+ annually in tax-free growth",priority:"high"}),y>23e4&&p.mega_backdoor_roth_available&&R.push({strategy:"Mega Backdoor Roth",description:"Maximize after-tax 401k contributions and convert to Roth",potentialSavings:"Up to $46,000 additional tax-free savings",priority:"high"}),parseFloat(p.charitable_giving_annual)>5e3&&R.push({strategy:"Charitable Bunching",description:"Bundle multiple years of charitable giving into one year",potentialSavings:"Maximize itemized deductions",priority:"medium"}),!p.tax_loss_harvesting_enabled&&y>75e3&&R.push({strategy:"Tax Loss Harvesting",description:"Systematically realize investment losses to offset gains",potentialSavings:"Up to $3,000 annually in tax savings",priority:"medium"}),R};return w.useEffect(()=>{z()},[]),a?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}):e.jsxs("div",{className:"space-y-6",children:[n&&e.jsx(_,{className:"bg-red-900/20 border-red-500/20 p-4",children:e.jsxs("div",{className:"flex items-center space-x-2 text-red-400",children:[e.jsx(Nt,{className:"h-4 w-4"}),e.jsxs("span",{children:["Error: ",n]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(_,{className:"bg-gray-800 border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Tax Bracket"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:p.adjusted_gross_income?`${j(parseFloat(p.adjusted_gross_income),p.filing_status)}%`:"N/A"}),e.jsx("p",{className:"text-white text-sm",children:"Federal marginal rate"})]}),e.jsx(Rn,{className:"h-8 w-8 text-red-400"})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"AGI"}),e.jsxs("p",{className:"text-white text-2xl font-bold",children:["$",p.adjusted_gross_income?parseFloat(p.adjusted_gross_income).toLocaleString():"0"]}),e.jsx("p",{className:"text-white text-sm",children:"Adjusted Gross Income"})]}),e.jsx(ge,{className:"h-8 w-8 text-green-400"})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Charitable"}),e.jsxs("p",{className:"text-white text-2xl font-bold",children:["$",p.charitable_giving_annual?parseFloat(p.charitable_giving_annual).toLocaleString():"0"]}),e.jsx("p",{className:"text-white text-sm",children:"Annual giving"})]}),e.jsx(De,{className:"h-8 w-8 text-blue-400"})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Strategies"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:[p.tax_loss_harvesting_enabled,p.backdoor_roth_eligible,p.mega_backdoor_roth_available].filter(Boolean).length}),e.jsx("p",{className:"text-white text-sm",children:"Active strategies"})]}),e.jsx(Te,{className:"h-8 w-8 text-purple-400"})]})})]}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_s,{className:"h-5 w-5 text-blue-400"}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Tax Information & Optimization"})]}),e.jsx($,{onClick:()=>o(!l),className:"bg-blue-600 hover:bg-blue-700 text-white",children:l?"Hide":"Configure"})]}),l&&e.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Adjusted Gross Income"}),e.jsx(W,{type:"number",placeholder:"e.g. 150000",className:"bg-gray-800 border-gray-600 text-white",value:p.adjusted_gross_income,onChange:y=>N({...p,adjusted_gross_income:y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Filing Status"}),e.jsxs("select",{className:"w-full p-2 bg-gray-800 border border-gray-600 text-white rounded",value:p.filing_status,onChange:y=>N({...p,filing_status:y.target.value}),children:[e.jsx("option",{value:"single",children:"Single"}),e.jsx("option",{value:"married_filing_jointly",children:"Married Filing Jointly"}),e.jsx("option",{value:"married_filing_separately",children:"Married Filing Separately"}),e.jsx("option",{value:"head_of_household",children:"Head of Household"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"State Tax Rate (%)"}),e.jsx(W,{type:"number",step:"0.1",placeholder:"e.g. 7.5",className:"bg-gray-800 border-gray-600 text-white",value:p.state_tax_rate,onChange:y=>N({...p,state_tax_rate:y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Annual Charitable Giving"}),e.jsx(W,{type:"number",placeholder:"e.g. 15000",className:"bg-gray-800 border-gray-600 text-white",value:p.charitable_giving_annual,onChange:y=>N({...p,charitable_giving_annual:y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-white block mb-2",children:"Itemized Deductions Total"}),e.jsx(W,{type:"number",placeholder:"e.g. 25000",className:"bg-gray-800 border-gray-600 text-white",value:p.itemized_deduction_total,onChange:y=>N({...p,itemized_deduction_total:y.target.value})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:p.tax_loss_harvesting_enabled,onChange:y=>N({...p,tax_loss_harvesting_enabled:y.target.checked}),className:"text-blue-500"}),e.jsx("span",{className:"text-white",children:"Tax-loss harvesting enabled"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:p.backdoor_roth_eligible,onChange:y=>N({...p,backdoor_roth_eligible:y.target.checked}),className:"text-blue-500"}),e.jsx("span",{className:"text-white",children:"Backdoor Roth IRA eligible"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:p.mega_backdoor_roth_available,onChange:y=>N({...p,mega_backdoor_roth_available:y.target.checked}),className:"text-blue-500"}),e.jsx("span",{className:"text-white",children:"Mega backdoor Roth available"})]})]})]})]})}),p.adjusted_gross_income&&e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(tt,{className:"h-5 w-5 text-green-400"}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Tax Savings Analysis"})]}),(()=>{const y=E();return y?e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Marginal Tax Rate"}),e.jsxs("p",{className:"text-white font-bold text-xl",children:[y.marginalRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Charitable Savings"}),e.jsxs("p",{className:"text-white font-bold text-xl",children:["$",y.charitableTaxSavings.toLocaleString()]})]}),e.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Itemizing Benefit"}),e.jsxs("p",{className:"text-white font-bold text-xl",children:["$",y.itemizingBenefit.toLocaleString()]})]}),e.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Savings"}),e.jsxs("p",{className:"text-white font-bold text-xl",children:["$",y.totalPotentialSavings.toLocaleString()]})]})]})}):null})()]})}),p.adjusted_gross_income&&e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(De,{className:"h-5 w-5 text-yellow-400"}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Tax Planning Recommendations"})]}),e.jsx("div",{className:"space-y-4",children:A().map((y,R)=>e.jsx("div",{className:`p-4 rounded-lg border ${y.priority==="high"?"bg-red-900/20 border-red-500/20":"bg-yellow-900/20 border-yellow-500/20"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:y.strategy}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:y.description}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Potential: ",y.potentialSavings]})]}),e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${y.priority==="high"?"bg-red-600 text-white":"bg-yellow-600 text-white"}`,children:y.priority.toUpperCase()})]})},R))})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx($,{onClick:C,disabled:d,className:"bg-blue-600 hover:bg-blue-700 text-white disabled:bg-blue-400",children:d?"Saving...":"Save Tax Information"}),b&&e.jsxs("div",{className:"flex items-center space-x-2 bg-green-600 text-white px-3 py-2 rounded",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{children:"Saved!"})]}),e.jsx($,{onClick:z,className:"bg-gray-600 hover:bg-gray-700 text-white",children:"Refresh Data"})]})]})},Zo=()=>{var m,p,N,g,S,T;const[s,t]=w.useState("personal"),[a,r]=w.useState(!1),[n,i]=w.useState(null),[l,o]=w.useState({personal:!1,family:!1,benefits:!1,tax:!1}),{data:c,isLoading:u,refetch:h}=ot({queryKey:["complete-profile"],queryFn:async()=>await Qe.getCompleteProfile()}),f=v=>new Date(v).toLocaleDateString(),d=(v,L)=>{i({...v,type:L}),r(!0)},x=async(v,L)=>{const P={family:"family member",benefit:"benefit",tax:"tax information"};if(confirm(`Are you sure you want to delete this ${P[L]}?

This action cannot be undone.`))try{switch(L){case"family":await Qe.deleteFamilyMember(v);break;case"benefit":await Qe.deleteBenefit(v);break;case"tax":await Qe.deleteTaxInfo(v);break}h()}catch(z){console.error(`Failed to delete ${L}:`,z),alert(`Failed to delete ${P[L]}. Please try again.`)}},b=[{id:"personal",label:"Personal Info",icon:Lt},{id:"family",label:"Family",icon:xs},{id:"benefits",label:"Benefits",icon:Mt},{id:"tax",label:"Tax Info",icon:lt},{id:"estate",label:"Estate Planning",icon:$r},{id:"insurance",label:"Insurance",icon:wt},{id:"investment",label:"Investment Preferences",icon:Te}];return u?e.jsx("div",{className:"min-h-screen bg-gray-900 py-8 flex items-center justify-center",children:e.jsx("div",{className:"text-white",children:"Loading profile data..."})}):e.jsx("div",{className:"min-h-screen bg-gray-900 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(Lt,{className:"w-8 h-8 text-blue-500"}),"Profile Management"]}),e.jsx("p",{className:"text-gray-300 mt-1",children:"Manage your personal information, family details, benefits, and tax data"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs($,{variant:"outline",onClick:()=>h(),disabled:u,className:"flex items-center gap-2",children:[e.jsx(_t,{className:`w-4 h-4 ${u?"animate-spin":""}`}),"Refresh"]})})]})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:b.map(v=>{var L,P,z,C;return e.jsxs("button",{onClick:()=>t(v.id),className:`
                    flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm
                    ${s===v.id?"border-blue-500 text-blue-300":"border-transparent text-gray-500 hover:text-gray-300 hover:border-gray-300"}
                  `,children:[e.jsx(v.icon,{className:"w-4 h-4"}),v.label,v.id==="family"&&((L=c==null?void 0:c.family_members)==null?void 0:L.length)>0&&e.jsx("span",{className:"bg-blue-500 text-white text-xs rounded-full px-2 py-0.5",children:c.family_members.length}),v.id==="benefits"&&((P=c==null?void 0:c.benefits)==null?void 0:P.length)>0&&e.jsx("span",{className:"bg-green-500 text-white text-xs rounded-full px-2 py-0.5",children:c.benefits.length}),v.id==="tax"&&(c==null?void 0:c.tax_info)&&e.jsx("span",{className:"bg-purple-500 text-white text-xs rounded-full px-2 py-0.5",children:"1"}),v.id==="estate"&&((z=c==null?void 0:c.estate_documents)==null?void 0:z.length)>0&&e.jsx("span",{className:"bg-indigo-500 text-white text-xs rounded-full px-2 py-0.5",children:c.estate_documents.length}),v.id==="insurance"&&((C=c==null?void 0:c.insurance_policies)==null?void 0:C.length)>0&&e.jsx("span",{className:"bg-cyan-500 text-white text-xs rounded-full px-2 py-0.5",children:c.insurance_policies.length}),v.id==="investment"&&(c==null?void 0:c.investment_preferences)&&e.jsx("span",{className:"bg-emerald-500 text-white text-xs rounded-full px-2 py-0.5",children:"1"})]},v.id)})})})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 mb-8",children:[e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Lt,{className:"w-6 h-6 text-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-medium text-gray-400 mb-1",children:"Profile"}),e.jsxs("p",{className:"text-lg font-bold text-white",children:[Math.round(((c!=null&&c.profile?1:0)+(((m=c==null?void 0:c.family_members)==null?void 0:m.length)>0?1:0)+(((p=c==null?void 0:c.benefits)==null?void 0:p.length)>0?1:0)+(c!=null&&c.tax_info?1:0))*25),"%"]})]})})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xs,{className:"w-6 h-6 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-medium text-gray-400 mb-1",children:"Family"}),e.jsx("p",{className:"text-lg font-bold text-white",children:((N=c==null?void 0:c.family_members)==null?void 0:N.length)||0})]})})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Mt,{className:"w-6 h-6 text-purple-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-medium text-gray-400 mb-1",children:"Benefits"}),e.jsx("p",{className:"text-lg font-bold text-white",children:((g=c==null?void 0:c.benefits)==null?void 0:g.length)||0})]})})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(lt,{className:"w-6 h-6 text-orange-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-medium text-gray-400 mb-1",children:"Tax Info"}),e.jsx("p",{className:"text-lg font-bold text-white",children:c!=null&&c.tax_info?1:0})]})})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx($r,{className:"w-6 h-6 text-indigo-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-medium text-gray-400 mb-1",children:"Estate Docs"}),e.jsx("p",{className:"text-lg font-bold text-white",children:((S=c==null?void 0:c.estate_documents)==null?void 0:S.length)||0})]})})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(wt,{className:"w-6 h-6 text-cyan-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-medium text-gray-400 mb-1",children:"Insurance"}),e.jsx("p",{className:"text-lg font-bold text-white",children:((T=c==null?void 0:c.insurance_policies)==null?void 0:T.length)||0})]})})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Te,{className:"w-6 h-6 text-emerald-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-medium text-gray-400 mb-1",children:"Investment"}),e.jsx("p",{className:"text-lg font-bold text-white",children:c!=null&&c.investment_preferences?1:0})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[s==="personal"&&e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Personal Information"}),e.jsxs($,{onClick:()=>{i({type:"profile",...c==null?void 0:c.profile}),r(!0)},className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[e.jsx(ra,{className:"w-4 h-4"}),"Edit Profile"]})]}),c!=null&&c.profile?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[c.profile.age&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-1",children:"Age"}),e.jsxs("p",{className:"text-lg text-white",children:[c.profile.age," years old"]})]}),c.profile.date_of_birth&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-1",children:"Date of Birth"}),e.jsx("p",{className:"text-lg text-white",children:f(c.profile.date_of_birth)})]}),c.profile.state&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-1",children:"State"}),e.jsx("p",{className:"text-lg text-white",children:c.profile.state})]}),c.profile.marital_status&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-1",children:"Marital Status"}),e.jsx("p",{className:"text-lg text-white",children:c.profile.marital_status})]}),c.profile.employment_status&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-1",children:"Employment"}),e.jsx("p",{className:"text-lg text-white",children:c.profile.employment_status})]}),c.profile.occupation&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-1",children:"Occupation"}),e.jsx("p",{className:"text-lg text-white",children:c.profile.occupation})]}),c.profile.risk_tolerance&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-1",children:"Risk Tolerance"}),e.jsx("p",{className:"text-lg text-white",children:c.profile.risk_tolerance})]}),c.profile.notes&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg md:col-span-2 lg:col-span-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-1",children:"Additional Notes"}),e.jsx("p",{className:"text-white",children:c.profile.notes})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Lt,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"No personal information found"}),e.jsx($,{onClick:()=>{i({type:"profile"}),r(!0)},className:"bg-blue-600 hover:bg-blue-700",children:"Add Personal Information"})]})]})}),s==="family"&&e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Family Members"}),e.jsxs($,{onClick:()=>{i({type:"family"}),r(!0)},className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[e.jsx(Tt,{className:"w-4 h-4"}),"Add Family Member"]})]}),c!=null&&c.family_members&&c.family_members.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.family_members.map(v=>e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:v.name||`${v.relationship_type.charAt(0).toUpperCase()+v.relationship_type.slice(1)}`}),e.jsx("p",{className:"text-sm text-gray-300 capitalize",children:v.relationship_type})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",size:"sm",onClick:()=>d(v,"family"),className:"p-2",children:e.jsx(ra,{className:"w-3 h-3"})}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>x(v.id,"family"),className:"p-2 text-red-400 hover:text-red-300",children:e.jsx(ws,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[v.age&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Age:"}),e.jsx("span",{className:"text-white",children:v.age})]}),v.date_of_birth&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Birth Date:"}),e.jsx("span",{className:"text-white",children:f(v.date_of_birth)})]}),v.income&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Income:"}),e.jsxs("span",{className:"text-white",children:["$",v.income.toLocaleString()]})]}),v.retirement_savings&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Retirement:"}),e.jsxs("span",{className:"text-white",children:["$",v.retirement_savings.toLocaleString()]})]}),v.notes&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-600",children:e.jsx("p",{className:"text-gray-300",children:v.notes})})]})]},v.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xs,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"No family members added"}),e.jsx($,{onClick:()=>{i({type:"family"}),r(!0)},className:"bg-blue-600 hover:bg-blue-700",children:"Add First Family Member"})]})]})}),s==="benefits"&&e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:e.jsx(Ho,{})}),s==="tax"&&e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:e.jsx(Yo,{})}),s==="estate"&&e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:e.jsx(Vo,{})}),s==="insurance"&&e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:e.jsx(Wo,{})}),s==="investment"&&e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:e.jsx(Go,{})})]}),e.jsx(Uo,{isOpen:a,onClose:()=>{r(!1),i(null)},onSuccess:()=>{h(),r(!1),i(null)},editingItem:n})]})})},Ko=({onAssumptionsChange:s,isLoading:t=!1})=>{const[a,r]=w.useState({salary_growth_rate:2,real_estate_appreciation:2.5,stock_market_return:5,retirement_account_return:6.5,inflation_rate:2.5}),[n,i]=w.useState(!1),[l,o]=w.useState(!1),c=[{key:"salary_growth_rate",label:"Salary Growth",icon:ge,min:0,max:10,step:.5,color:"text-green-400",description:"Industry average for your role and experience",defaultValue:2},{key:"real_estate_appreciation",label:"Real Estate",icon:Gt,min:0,max:8,step:.5,color:"text-green-400",description:"Based on your property locations and market data",defaultValue:2.5},{key:"stock_market_return",label:"Stock Returns",icon:Te,min:0,max:15,step:.5,color:"text-green-400",description:"Historical S&P 500 average: 10%, we use conservative 8%",defaultValue:5},{key:"retirement_account_return",label:"401k Return",icon:tt,min:0,max:12,step:.5,color:"text-green-400",description:"Conservative retirement account growth rate",defaultValue:6.5},{key:"inflation_rate",label:"Inflation",icon:tt,min:0,max:6,step:.5,color:"text-green-400",description:"Federal Reserve target + 0.5% buffer",defaultValue:2.5}],u=(d,x)=>{r(b=>({...b,[d]:x})),i(!0)},h=async()=>{if(!(!n||!s)){o(!0);try{await s(a),i(!1)}catch(d){console.error("Failed to apply assumption changes:",d)}finally{o(!1)}}},f=()=>{const d=c.reduce((x,b)=>({...x,[b.key]:b.defaultValue}),{});r(d),i(!0)};return e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(Us,{className:"w-5 h-5"}),"Key Assumptions Used"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{variant:"outline",size:"sm",onClick:f,disabled:t,className:"text-gray-300 border-gray-600 hover:bg-gray-700",children:"Reset Defaults"}),n&&e.jsx($,{onClick:h,disabled:l||t,className:`px-6 py-2 font-medium transition-all ${l?"bg-gray-600":"bg-blue-600 hover:bg-blue-700 animate-pulse shadow-lg shadow-blue-500/20"}`,children:l?"Applying...":"Apply Changes & Recalculate"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:c.map(d=>{const x=d.icon,b=a[d.key]||d.defaultValue,m=b!==d.defaultValue;return e.jsxs("div",{className:`bg-gray-700 rounded-lg p-4 transition-all duration-200 ${m?"ring-2 ring-blue-500 bg-gray-700/80":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(x,{className:`w-4 h-4 ${d.color}`}),e.jsx("span",{className:"text-sm text-gray-300 font-medium",children:d.label}),m&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"})]}),e.jsxs("div",{className:`text-2xl font-bold mb-4 transition-colors ${m?"text-blue-400":d.color}`,children:[b.toFixed(1),"%"]}),e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"range",min:d.min,max:d.max,step:d.step,value:b,onChange:p=>u(d.key,parseFloat(p.target.value)),disabled:t,className:`w-full h-2 rounded-lg appearance-none cursor-pointer transition-all ${t?"opacity-50 cursor-not-allowed":""}`,style:{background:`linear-gradient(to right, #4f46e5 0%, #4f46e5 ${(b-d.min)/(d.max-d.min)*100}%, #374151 ${(b-d.min)/(d.max-d.min)*100}%, #374151 100%)`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-2",children:[e.jsxs("span",{children:[d.min,"%"]}),e.jsxs("span",{children:[d.max,"%"]})]}),e.jsx("div",{className:"text-xs text-gray-400 leading-tight",children:d.description}),m&&e.jsxs("div",{className:"text-xs text-blue-400 mt-2 font-medium",children:["Default: ",d.defaultValue,"%"]})]},d.key)})}),n&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-orange-900/30 border border-orange-600 rounded-lg",children:[e.jsx(Je,{className:"w-5 h-5 text-orange-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-orange-300 font-medium mb-1",children:"Projection Parameters Modified"}),e.jsx("p",{className:"text-sm text-orange-300/80",children:'Adjusting these assumptions will recalculate all projections and confidence intervals. Click "Apply Changes" to see updated results with your custom parameters.'})]})]}),t&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-3 text-gray-400",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{children:"Recalculating projections with new assumptions..."})]})})]})})},Qo=(s={})=>ot({queryKey:["projection","comprehensive",s],queryFn:async()=>{const t=new URLSearchParams({years:String(s.years||20),include_monte_carlo:String(s.include_monte_carlo!==!1),monte_carlo_iterations:String(s.monte_carlo_iterations||1e3),force_recalculate:"false"});return await G.get(`/api/v1/projections/comprehensive?${t}`)},staleTime:1e3*60*10,gcTime:1e3*60*30,enabled:!0,retry:2,retryDelay:1e3}),Jo=()=>{const s=ct();return dt({mutationFn:async t=>await G.post("/api/v1/projections/assumptions",t),onSuccess:()=>{s.invalidateQueries({queryKey:["projection"]})},onError:t=>{console.error("Failed to update projection assumptions:",t)}})},Xo=()=>{var d,x,b,m,p,N;const[s,t]=w.useState(20),[a,r]=w.useState(!1),{data:n,isLoading:i,error:l,refetch:o}=Qo({years:s,include_monte_carlo:!0,monte_carlo_iterations:1e3}),c=Jo(),u=async g=>{r(!0);try{const S={};Object.entries(g).forEach(([T,v])=>{S[T]=v/100}),await c.mutateAsync(S),await o()}catch(S){console.error("Failed to update assumptions and recalculate:",S)}finally{r(!1)}},h=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(g),f=(d=n==null?void 0:n.monte_carlo_results)==null?void 0:d.confidence_intervals;return(x=n==null?void 0:n.projections)==null||x[s-1],e.jsx("div",{className:"min-h-screen bg-gray-900 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold text-white mb-2 flex items-center gap-3",children:[e.jsx(_s,{className:"w-8 h-8 text-blue-500"}),"Financial Projections"]}),e.jsx("p",{className:"text-lg text-gray-300",children:"Comprehensive wealth modeling with Monte Carlo simulation and customizable assumptions"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("select",{value:s,onChange:g=>t(parseInt(g.target.value)),className:"px-4 py-2 bg-gray-800 border border-gray-600 text-white rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:10,children:"10 Years"}),e.jsx("option",{value:15,children:"15 Years"}),e.jsx("option",{value:20,children:"20 Years"}),e.jsx("option",{value:25,children:"25 Years"}),e.jsx("option",{value:30,children:"30 Years"})]})})]})}),l&&e.jsx(_,{className:"mb-6 bg-red-900/20 border-red-600",children:e.jsxs("div",{className:"p-4 flex items-start gap-3",children:[e.jsx(Nt,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-red-300 font-semibold mb-1",children:"Projection Error"}),e.jsx("p",{className:"text-red-300/80 text-sm",children:"Unable to calculate projections. Please check your financial data and try again."})]})]})}),e.jsx(_,{className:"mb-6 bg-blue-900/20 border-blue-600",children:e.jsx("div",{className:"p-4",children:e.jsxs("p",{className:"text-blue-300 text-sm",children:[e.jsx("strong",{children:"Methodology:"})," Multi-factor projection considers asset appreciation, income growth, intelligent savings allocation, and market volatility. Monte Carlo simulation with 1000 iterations provides confidence intervals. Calculation time: ",((b=n==null?void 0:n.calculation_metadata)==null?void 0:b.calculation_time_ms)||0,"ms."]})})}),e.jsx("div",{className:"mb-8",children:e.jsx(Ko,{onAssumptionsChange:u,isLoading:a||i})}),f&&e.jsx(_,{className:"mb-8 bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(De,{className:"w-5 h-5 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Confidence Analysis (1000 Simulations)"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-orange-900/20 border-2 border-orange-600 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-sm text-orange-300 mb-2",children:"Conservative (90% confident)"}),e.jsx("div",{className:"text-3xl font-bold text-orange-400 mb-2",children:h(((m=f.p10)==null?void 0:m[s-1])||0)}),e.jsx("div",{className:"text-xs text-orange-300",children:"90% chance of exceeding this"})]}),e.jsxs("div",{className:"bg-blue-900/20 border-2 border-blue-600 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-sm text-blue-300 mb-2",children:"Expected (Most Likely)"}),e.jsx("div",{className:"text-3xl font-bold text-blue-400 mb-2",children:h(((p=f.p50)==null?void 0:p[s-1])||0)}),e.jsx("div",{className:"text-xs text-blue-300",children:"50% probability"})]}),e.jsxs("div",{className:"bg-green-900/20 border-2 border-green-600 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-sm text-green-300 mb-2",children:"Optimistic (Stretch Goal)"}),e.jsx("div",{className:"text-3xl font-bold text-green-400 mb-2",children:h(((N=f.p90)==null?void 0:N[s-1])||0)}),e.jsx("div",{className:"text-xs text-green-300",children:"10% chance of exceeding"})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx($,{variant:"outline",size:"sm",className:"text-gray-300 border-gray-600",children:"Show Simulation Details →"})})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(tt,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Our Projection Methodology"}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-0 h-0 border-l-4 border-r-4 border-t-8 border-transparent border-t-gray-400 cursor-pointer"})})]}),e.jsxs("div",{className:"text-sm text-gray-300 leading-relaxed",children:[e.jsx("p",{className:"mb-3",children:"Our advanced projection system uses a multi-factor approach combining your current financial position, income trajectory, spending patterns, and investment allocations. We apply Monte Carlo simulation to model market volatility and provide confidence intervals around our projections."}),e.jsxs("p",{className:"mb-3",children:[e.jsx("strong",{children:"Key Features:"})," Asset-specific growth rates, inflation adjustment, tax considerations, intelligent rebalancing, and lifecycle-aware allocation shifts. All assumptions are based on historical data and current market conditions, with conservative estimates to ensure reliability."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Confidence Intervals:"})," Our 1000-iteration Monte Carlo simulation accounts for market volatility, economic cycles, and uncertainty in key variables. This provides you with realistic ranges rather than single-point estimates."]})]})]})}),(i||a)&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsx(_,{className:"p-8 bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-semibold",children:a?"Recalculating Projections":"Loading Projections"}),e.jsx("div",{className:"text-gray-400 text-sm",children:a?"Applying your new assumptions...":"Running Monte Carlo simulation..."})]})]})})})]})})},st="/api/v1",ft={createGoal:async s=>await G.post(`${st}/goals`,s),getGoals:async s=>await G.get(`${st}/goals`,{params:s}),getGoal:async s=>await G.get(`${st}/goals/${s}`),updateGoal:async(s,t)=>await G.put(`${st}/goals/${s}`,t),deleteGoal:async s=>{await G.delete(`${st}/goals/${s}`)},recordProgress:async(s,t)=>await G.post(`${st}/goals/${s}/progress`,t),getGoalProgress:async(s,t)=>await G.get(`${st}/goals/${s}/progress`,{params:{limit:t}}),getGoalHistory:async s=>await G.get(`${st}/goals/${s}/history`),getGoalConflicts:async()=>await G.get(`${st}/goals/analysis/conflicts`),getGoalSummary:async()=>await G.get(`${st}/goals/summary`),batchUpdateGoals:async(s,t,a)=>await G.put(`${st}/goals/batch`,{goal_ids:s,updates:t,batch_reason:a}),createPreferences:async s=>await G.post(`${st}/preferences`,s),getPreferences:async()=>await G.get(`${st}/preferences`),updatePreferences:async s=>await G.put(`${st}/preferences`,s),getCategories:async()=>await G.get(`${st}/categories`),getTemplates:async()=>await G.get(`${st}/templates`)},Le={all:["goals"],lists:()=>[...Le.all,"list"],list:s=>[...Le.lists(),{filters:s}],details:()=>[...Le.all,"detail"],detail:s=>[...Le.details(),s],progress:s=>[...Le.detail(s),"progress"],history:s=>[...Le.detail(s),"history"],summary:()=>[...Le.all,"summary"],conflicts:()=>[...Le.all,"conflicts"],preferences:()=>["preferences"],categories:()=>["categories"],templates:()=>["templates"]},ec=s=>ot({queryKey:Le.list(s||{}),queryFn:async()=>{try{console.log("🔍 Fetching goals with filters:",s);const t=await ft.getGoals(s);return console.log("✅ Goals API response:",t),console.log("📊 Goals count:",(t==null?void 0:t.length)||0),console.log("📋 First goal (if any):",t==null?void 0:t[0]),t||[]}catch(t){return console.error("❌ Error fetching goals:",t),console.error("🔐 Auth tokens:",localStorage.getItem("auth_tokens")),[]}}}),tc=(s,t)=>ot({queryKey:Le.progress(s),queryFn:()=>ft.getGoalProgress(s,t),enabled:!!s}),sc=s=>ot({queryKey:Le.history(s),queryFn:()=>ft.getGoalHistory(s),enabled:!!s}),ac=()=>ot({queryKey:Le.summary(),queryFn:async()=>{try{return await ft.getGoalSummary()||{active_goals:0,achieved_goals:0,total_target:0,nearest_deadline:null,average_progress:0}}catch(s){return console.error("Error fetching goal summary:",s),{active_goals:0,achieved_goals:0,total_target:0,nearest_deadline:null,average_progress:0}}}}),rc=()=>ot({queryKey:Le.preferences(),queryFn:ft.getPreferences}),nc=()=>ot({queryKey:Le.categories(),queryFn:async()=>{try{return await ft.getCategories()||{}}catch(s){return console.error("Error fetching categories:",s),{}}}}),ic=()=>ot({queryKey:Le.templates(),queryFn:async()=>{try{return await ft.getTemplates()||[]}catch(s){return console.error("Error fetching templates:",s),[]}}}),lc=()=>{const s=ct();return dt({mutationFn:t=>ft.createGoal(t),onSuccess:()=>{s.invalidateQueries({queryKey:Le.lists()}),s.invalidateQueries({queryKey:Le.summary()})}})},ii=()=>{const s=ct();return dt({mutationFn:({goalId:t,update:a})=>ft.updateGoal(t,a),onSuccess:t=>{s.setQueryData(Le.detail(t.goal_id),t),s.invalidateQueries({queryKey:Le.lists()}),s.invalidateQueries({queryKey:Le.summary()})}})},oc=()=>{const s=ct();return dt({mutationFn:t=>ft.deleteGoal(t),onSuccess:(t,a)=>{s.removeQueries({queryKey:Le.detail(a)}),s.invalidateQueries({queryKey:Le.lists()}),s.invalidateQueries({queryKey:Le.summary()})}})},cc=()=>{const s=ct();return dt({mutationFn:({goalId:t,progress:a})=>ft.recordProgress(t,a),onSuccess:(t,{goalId:a})=>{s.invalidateQueries({queryKey:Le.progress(a)}),s.invalidateQueries({queryKey:Le.detail(a)}),s.invalidateQueries({queryKey:Le.summary()})}})},dc=()=>{const s=ct();return dt({mutationFn:t=>ft.updatePreferences(t),onSuccess:t=>{s.setQueryData(Le.preferences(),t)}})},js={retirement:"Retirement",education:"Education",real_estate:"Real Estate",business:"Business",travel:"Travel",emergency_fund:"Emergency Fund",debt_payoff:"Debt Payoff",major_purchase:"Major Purchase",other:"Other"},er={active:"Active",paused:"Paused",achieved:"Achieved",cancelled:"Cancelled"},mc={conservative:"Conservative",moderate:"Moderate",aggressive:"Aggressive"},uc={beginner:"Beginner",intermediate:"Intermediate",advanced:"Advanced"},hc=({goal:s,onClose:t,onSuccess:a})=>{const r=!!s,i=fa().getNetWorth();console.log("📝 GoalForm rendered with:",{goal:s,isEditing:r}),console.log("📝 Goal data:",s),console.log("💰 Current net worth from financial store:",i);const l=y=>{switch(y){case"retirement":return{current_age:30,retirement_age:65,annual_spending:5e4};case"education":return{degree_type:"undergraduate",institution_type:"public",start_year:new Date().getFullYear()+5};case"real_estate":return{property_type:"primary_residence",down_payment_percentage:20};case"emergency_fund":return{months_of_expenses:6};default:return{}}},[o,c]=w.useState({category:(s==null?void 0:s.category)||"retirement",name:(s==null?void 0:s.name)||"",description:(s==null?void 0:s.description)||"",target_amount:(s==null?void 0:s.target_amount)||0,target_date:s!=null&&s.target_date?s.target_date.split("T")[0]:"",priority:(s==null?void 0:s.priority)||3,params:(s==null?void 0:s.params)||l((s==null?void 0:s.category)||"retirement")}),u=y=>{const R=typeof y=="string"?parseFloat(y):y;return isNaN(R)?"":R.toString()},h=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(y),[f,d]=w.useState(!1),[x,b]=w.useState(""),[m,p]=w.useState("");w.useEffect(()=>{s&&c({category:s.category,name:s.name,description:s.description||"",target_amount:s.target_amount,target_date:s.target_date?s.target_date.split("T")[0]:"",priority:s.priority,params:s.params||l(s.category)})},[s]);const{data:N}=nc(),{data:g=[]}=ic(),S=lc(),T=ii(),v=g.filter(y=>y.category===o.category),L=N==null?void 0:N[o.category],P=async y=>{y.preventDefault();try{if(console.log("Submitting goal with data:",o),r&&s){const R={name:o.name,description:o.description,target_amount:o.target_amount,target_date:o.target_date,priority:o.priority,params:o.params,change_reason:m||"User updated goal"};await T.mutateAsync({goalId:s.goal_id,update:R})}else await S.mutateAsync(o);a==null||a()}catch(R){console.error("Failed to save goal:",R),console.error("Form data at time of error:",o),alert("Failed to save goal. Please try again.")}},z=y=>{const R=g.find(k=>k.name===y);R&&c(k=>({...k,name:R.name,description:R.description,category:R.category,params:{...k.params,...R.template_params}})),b(y)},C=(y,R)=>{typeof R=="number"&&isNaN(R)||c(k=>({...k,params:{...k.params,[y]:R}}))},j=y=>{c(R=>({...R,category:y,params:l(y)}))},E=()=>L?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-white",children:"Category-Specific Information"}),o.category==="retirement"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Current Age",type:"number",value:o.params.current_age||"",onChange:y=>{const R=y.target.value;if(R==="")C("current_age","");else{const k=parseInt(R);isNaN(k)||C("current_age",k)}},min:"18",max:"80",required:!0}),e.jsx(W,{label:"Retirement Age",type:"number",value:o.params.retirement_age||"",onChange:y=>{const R=y.target.value;if(R==="")C("retirement_age","");else{const k=parseInt(R);isNaN(k)||C("retirement_age",k)}},min:"50",max:"80",required:!0})]}),e.jsx(W,{label:"Annual Spending in Retirement",type:"number",value:o.params.annual_spending||"",onChange:y=>{const R=y.target.value;if(R==="")C("annual_spending","");else{const k=parseFloat(R);isNaN(k)||C("annual_spending",k)}},leftIcon:e.jsx(ge,{className:"w-4 h-4"}),min:"0",required:!0})]}),o.category==="education"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx($e,{label:"Degree Type",value:o.params.degree_type||"",onChange:y=>C("degree_type",y.target.value),options:[{value:"",label:"Select degree type..."},{value:"undergraduate",label:"Undergraduate"},{value:"graduate",label:"Graduate/Masters"},{value:"doctoral",label:"Doctoral/PhD"},{value:"professional",label:"Professional (MD, JD, etc.)"},{value:"certification",label:"Certification/Training"}],required:!0}),e.jsx($e,{label:"Institution Type",value:o.params.institution_type||"",onChange:y=>C("institution_type",y.target.value),options:[{value:"",label:"Select institution type..."},{value:"public",label:"Public University"},{value:"private",label:"Private University"},{value:"community",label:"Community College"},{value:"online",label:"Online Program"},{value:"trade",label:"Trade/Technical School"}],required:!0})]}),e.jsx(W,{label:"Start Year",type:"number",value:o.params.start_year||"",onChange:y=>C("start_year",parseInt(y.target.value)),min:"2024",max:"2030",required:!0})]}),o.category==="real_estate"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx($e,{label:"Property Type",value:o.params.property_type||"",onChange:y=>C("property_type",y.target.value),options:[{value:"",label:"Select property type..."},{value:"primary_residence",label:"Primary Residence"},{value:"investment_property",label:"Investment Property"},{value:"vacation_home",label:"Vacation Home"},{value:"commercial",label:"Commercial Property"}],required:!0}),e.jsx(W,{label:"Down Payment (%)",type:"number",value:o.params.down_payment_percentage||"",onChange:y=>C("down_payment_percentage",parseFloat(y.target.value)),min:"5",max:"50",required:!0})]})}),o.category==="emergency_fund"&&e.jsx(W,{label:"Months of Expenses",type:"number",value:o.params.months_of_expenses||"",onChange:y=>C("months_of_expenses",parseInt(y.target.value)),min:"3",max:"12",required:!0})]}):null,A=S.isPending||T.isPending;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto border border-gray-700",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(De,{className:"w-6 h-6 text-white"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:r?"Edit Goal":"Create New Goal"})]}),e.jsx("button",{onClick:t,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors",children:e.jsx(is,{className:"w-5 h-5"})})]})}),e.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[!r&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Choose Goal Type:"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Select the type of goal you want to create"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[{key:"retirement",emoji:"🏖️",label:"Retirement",desc:"FIRE, Early Retirement"},{key:"real_estate",emoji:"🏠",label:"Real Estate",desc:"Home, Investment Property"},{key:"education",emoji:"🎓",label:"Education",desc:"529 Plans, College Fund"},{key:"business",emoji:"🚀",label:"Business",desc:"Startup, Investment"},{key:"custom",emoji:"💰",label:"Custom",desc:"Emergency, Vacation, etc."}].map(y=>e.jsxs("button",{type:"button",onClick:()=>j(y.key==="custom"?"emergency_fund":y.key),className:`relative p-4 rounded-lg border-2 transition-all hover:scale-105 ${o.category===y.key||y.key==="custom"&&!["retirement","real_estate","education","business"].includes(o.category)?"border-blue-500 bg-blue-900/30 ring-2 ring-blue-500/50":"border-gray-600 bg-gray-700/50 hover:border-blue-400"}`,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:y.emoji}),e.jsx("div",{className:"font-medium text-white text-sm",children:y.label}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:y.desc})]}),(o.category===y.key||y.key==="custom"&&!["retirement","real_estate","education","business"].includes(o.category))&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"●"})})]},y.key))})]}),!r&&v.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:["Quick Start Templates for ",js[o.category]]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:v.map(y=>e.jsxs("button",{type:"button",onClick:()=>z(y.name),className:`text-left p-3 rounded-lg border transition-colors ${x===y.name?"border-blue-500 bg-blue-900/20":"border-gray-600 bg-gray-700 hover:border-blue-400"}`,children:[e.jsx("div",{className:"font-medium text-gray-100",children:y.name}),e.jsx("div",{className:"text-sm text-gray-400",children:y.description})]},y.name))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx($e,{label:"Category *",value:o.category,onChange:y=>j(y.target.value),options:[{value:"",label:"Select category..."},...Object.entries(js).map(([y,R])=>({value:y,label:R}))],leftIcon:e.jsx(dr,{className:"w-4 h-4"}),required:!0}),e.jsx(W,{label:"Priority (1-10) *",type:"number",value:o.priority,onChange:y=>c(R=>({...R,priority:parseInt(y.target.value)})),min:"1",max:"10",required:!0})]}),e.jsx(W,{label:"Goal Name *",value:o.name,onChange:y=>c(R=>({...R,name:y.target.value})),placeholder:"e.g., Emergency Fund, House Down Payment",required:!0}),e.jsx(W,{label:"Description",value:o.description,onChange:y=>c(R=>({...R,description:y.target.value})),leftIcon:e.jsx(gs,{className:"w-4 h-4"}),placeholder:"Brief description of your goal"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(W,{label:"Target Amount *",type:"number",value:u(o.target_amount),onChange:y=>{const R=y.target.value;if(R===""||R==="0")c(k=>({...k,target_amount:0}));else{const k=parseFloat(R);isNaN(k)||c(F=>({...F,target_amount:k}))}},leftIcon:e.jsx(ge,{className:"w-4 h-4"}),min:"100",step:"0.01",required:!0}),o.target_amount>0&&e.jsxs("p",{className:"text-sm text-green-400 mt-1",children:["Formatted: ",h(o.target_amount)]}),!r&&i>0&&e.jsxs("p",{className:"text-sm text-blue-400 mt-1",children:["💡 Your current net worth: ",h(i)]})]}),e.jsx(W,{label:"Target Date *",type:"date",value:o.target_date,onChange:y=>c(R=>({...R,target_date:y.target.value})),leftIcon:e.jsx(It,{className:"w-4 h-4"}),min:new Date().toISOString().split("T")[0],required:!0})]})]}),E(),L&&e.jsx(_,{className:"bg-blue-900/20 border-blue-600",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(gs,{className:"w-5 h-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-blue-100",children:[L.name," Goals"]}),e.jsx("p",{className:"text-blue-200 text-sm mt-1",children:L.description}),e.jsxs("p",{className:"text-blue-300 text-xs mt-2",children:["Typical timeline: ",L.typical_timeline]})]})]})})}),r&&e.jsx(W,{label:"Reason for Change",value:m,onChange:y=>p(y.target.value),placeholder:"Describe why you're making this change..."}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-600",children:[e.jsx($,{type:"button",variant:"outline",onClick:t,disabled:A,children:"Cancel"}),e.jsx($,{type:"submit",disabled:A,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:A?"Saving...":r?"Update Goal":"Create Goal"})]})]})]})})},xc=({goal:s,onClose:t,onEdit:a})=>{const[r,n]=w.useState("overview"),[i,l]=w.useState(!1),[o,c]=w.useState(""),[u,h]=w.useState(""),{data:f=[]}=tc(s.goal_id,10),{data:d=[]}=sc(s.goal_id),x=cc(),b=P=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(P),m=P=>new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),p=P=>new Date(P).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=P=>{const z=new Date,j=new Date(P).getTime()-z.getTime();return Math.ceil(j/(1e3*60*60*24))},g=()=>{const P=s.target_amount-(s.current_amount||0),z=N(s.target_date),C=Math.max(1,z/30.44);return P/C},S=async()=>{if(o)try{await x.mutateAsync({goalId:s.goal_id,progress:{current_amount:parseFloat(o),notes:u||void 0}}),c(""),h(""),l(!1)}catch(P){console.error("Failed to record progress:",P),alert("Failed to record progress. Please try again.")}},T=s.progress_percentage||0,v=N(s.target_date),L=g();return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto border border-gray-700",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(De,{className:"w-6 h-6 text-white"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s.name}),e.jsx("p",{className:"text-blue-100",children:js[s.category]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs($,{variant:"outline",onClick:()=>a==null?void 0:a(s),className:"text-white border-white/30 hover:bg-white/10",children:[e.jsx(ga,{className:"w-4 h-4 mr-2"}),"Edit Goal"]}),e.jsx("button",{onClick:t,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors",children:e.jsx(is,{className:"w-5 h-5"})})]})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",label:"Overview",icon:De},{id:"progress",label:"Progress",icon:Te},{id:"history",label:"History",icon:Dr}].map(P=>{const z=P.icon;return e.jsxs("button",{onClick:()=>n(P.id),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${r===P.id?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-300"}`,children:[e.jsx(z,{className:"w-4 h-4"}),P.label]},P.id)})})}),e.jsxs("div",{className:"p-6",children:[r==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{children:e.jsxs(_.Body,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Progress Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Target Amount"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:b(s.target_amount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Current Amount"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:b(s.current_amount||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Remaining"}),e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:b(s.target_amount-(s.current_amount||0))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Progress"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-500 h-3 rounded-full transition-all",style:{width:`${Math.min(T,100)}%`}})}),e.jsxs("span",{className:"text-lg font-bold text-blue-400",children:[T.toFixed(1),"%"]})]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(_,{children:e.jsxs(_.Body,{className:"p-4 text-center",children:[e.jsx(It,{className:"w-8 h-8 text-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Target Date"}),e.jsx("p",{className:"text-lg font-bold text-white",children:m(s.target_date)}),e.jsx("p",{className:`text-sm ${v<90?"text-red-400":"text-gray-400"}`,children:v>0?`${v} days left`:"Overdue"})]})}),e.jsx(_,{children:e.jsxs(_.Body,{className:"p-4 text-center",children:[e.jsx(ge,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Monthly Required"}),e.jsx("p",{className:"text-lg font-bold text-white",children:b(L)}),e.jsx("p",{className:"text-sm text-gray-400",children:"to reach goal"})]})}),e.jsx(_,{children:e.jsxs(_.Body,{className:"p-4 text-center",children:[e.jsx(De,{className:"w-8 h-8 text-purple-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Priority"}),e.jsxs("p",{className:"text-lg font-bold text-white",children:[s.priority,"/10"]}),e.jsx(ke,{className:"mt-1",children:er[s.status]})]})})]}),s.params&&Object.keys(s.params).length>0&&e.jsx(_,{children:e.jsxs(_.Body,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Goal Details"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(s.params).map(([P,z])=>e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:P.replace(/_/g," ").replace(/\b\w/g,C=>C.toUpperCase())}),e.jsx("p",{className:"text-white font-medium",children:typeof z=="number"&&P.includes("amount")?b(z):String(z)})]},P))})]})})]}),r==="progress"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Progress History"}),e.jsxs($,{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Record Progress"]})]}),i&&e.jsx(_,{className:"border-blue-600",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Record New Progress"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(W,{label:"Current Amount",type:"number",value:o,onChange:P=>c(P.target.value),leftIcon:e.jsx(ge,{className:"w-4 h-4"}),placeholder:"Enter current total amount",min:"0",step:"0.01"}),e.jsx(W,{label:"Notes (Optional)",value:u,onChange:P=>h(P.target.value),placeholder:"Add notes about this progress update..."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{onClick:S,disabled:!o||x.isPending,className:"bg-blue-600 hover:bg-blue-700",children:x.isPending?"Recording...":"Record Progress"}),e.jsx($,{variant:"outline",onClick:()=>l(!1),children:"Cancel"})]})]})]})}),e.jsx("div",{className:"space-y-3",children:f.length===0?e.jsx(_,{children:e.jsxs(_.Body,{className:"text-center py-8",children:[e.jsx(Te,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No progress recorded yet"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Start tracking your progress towards this goal"})]})}):f.map(P=>e.jsx(_,{children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold text-white",children:b(P.current_amount)}),e.jsxs("p",{className:"text-blue-400 font-medium",children:[P.percentage_complete.toFixed(1),"% complete"]}),P.notes&&e.jsx("p",{className:"text-gray-300 text-sm mt-2",children:P.notes})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:p(P.recorded_at)}),e.jsx(ke,{variant:"secondary",size:"sm",children:P.source})]})]})})},P.progress_id))})]}),r==="history"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Change History"}),e.jsx("div",{className:"space-y-3",children:d.length===0?e.jsx(_,{children:e.jsxs(_.Body,{className:"text-center py-8",children:[e.jsx(Dr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No history available"})]})}):d.map(P=>e.jsx(_,{children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{variant:P.change_type==="created"?"default":"secondary",size:"sm",children:P.change_type}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["by ",P.actor]})]}),e.jsx("span",{className:"text-gray-400 text-sm",children:p(P.changed_at)})]}),P.reason&&e.jsx("p",{className:"text-gray-300 text-sm mb-2",children:P.reason}),P.change_type==="updated"&&P.diff.old&&P.diff.new&&e.jsxs("details",{className:"text-xs text-gray-400",children:[e.jsxs("summary",{className:"cursor-pointer hover:text-gray-300",children:["View Changes ",e.jsx(or,{className:"inline w-3 h-3"})]}),e.jsx("div",{className:"mt-2 p-2 bg-gray-900 rounded",children:e.jsx("pre",{className:"text-xs overflow-x-auto",children:JSON.stringify(P.diff,null,2)})})]})]})},P.history_id))})]})]})]})})},pn=({label:s,value:t,onChange:a,min:r,max:n,step:i=1,leftLabel:l,rightLabel:o,showValue:c=!0,formatValue:u})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:s}),c&&e.jsx("span",{className:"text-sm text-blue-400 font-medium",children:u?u(t):`${t}/${n}`})]}),(l||o)&&e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1",children:[e.jsx("span",{children:l}),e.jsx("span",{children:o})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"range",min:r,max:n,step:i,value:t,onChange:h=>a(parseFloat(h.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"}),e.jsx("style",{jsx:!0,children:`
          .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            border: 2px solid #1e293b;
          }
          
          .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            border: 2px solid #1e293b;
          }
        `})]})]}),gc=({onClose:s})=>{const{data:t,isLoading:a}=rc(),r=dc(),[n,i]=w.useState({risk_tolerance:"moderate",investment_timeline:20,financial_knowledge:"intermediate",emergency_fund_months:6,debt_payoff_priority:"balanced",goal_categories_enabled:["retirement","emergency_fund","education","real_estate"],notification_preferences:{}}),[l,o]=w.useState(7),[c,u]=w.useState("aggressive"),[h,f]=w.useState({stocks:8,real_estate:5,bonds:2,crypto:1,international:3}),[d,x]=w.useState({retirement_lifestyle:"maintain",work_flexibility:{part_time:!0,consulting:!0,full_retirement:!1},geographic_flexibility:{relocate:!0,stay_current:!1,international:!0}}),[b,m]=w.useState({financial_security:2,family_time:1,travel_experiences:4,leaving_legacy:3,luxury_comfort:5}),[p,N]=w.useState({esg_investing:!0,religious_restrictions:!1,charity_support:!0}),[g,S]=w.useState({tax_filing_status:"married_filing_jointly",federal_tax_bracket:.24,state_tax_rate:.065,state:"NY",tax_optimization_priority:"moderate",tax_loss_harvesting:!0,roth_ira_eligible:!0}),[T,v]=w.useState("risk");w.useEffect(()=>{t&&(i({risk_tolerance:t.risk_tolerance,investment_timeline:t.investment_timeline,financial_knowledge:t.financial_knowledge,retirement_age:t.retirement_age,annual_income_goal:t.annual_income_goal,emergency_fund_months:t.emergency_fund_months,debt_payoff_priority:t.debt_payoff_priority,goal_categories_enabled:t.goal_categories_enabled,notification_preferences:t.notification_preferences}),t.risk_score&&o(t.risk_score),t.investment_style&&u(t.investment_style),t.stocks_preference&&f(C=>({...C,stocks:t.stocks_preference,bonds:t.bonds_preference||5,real_estate:t.real_estate_preference||5,crypto:t.crypto_preference||1,international:C.international})),t.retirement_lifestyle&&x(C=>({...C,retirement_lifestyle:t.retirement_lifestyle,work_flexibility:t.work_flexibility||C.work_flexibility})),t.esg_investing!==void 0&&N(C=>({...C,esg_investing:t.esg_investing})),t.tax_filing_status&&S(C=>({...C,tax_filing_status:t.tax_filing_status,federal_tax_bracket:t.federal_tax_bracket||.24,state_tax_rate:t.state_tax_rate||.065,state:t.state||"NY",tax_optimization_priority:t.tax_optimization_priority||"moderate",tax_loss_harvesting:t.tax_loss_harvesting!==void 0?t.tax_loss_harvesting:!0,roth_ira_eligible:t.roth_ira_eligible!==void 0?t.roth_ira_eligible:!0})))},[t]);const L=async C=>{C.preventDefault();try{const j={...n,risk_score:l,investment_style:c,stocks_preference:h.stocks,bonds_preference:h.bonds,real_estate_preference:h.real_estate,crypto_preference:h.crypto,retirement_lifestyle:d.retirement_lifestyle,work_flexibility:d.work_flexibility,esg_investing:p.esg_investing,...g};await r.mutateAsync(j),s()}catch(j){console.error("Failed to update preferences:",j),alert("Failed to update preferences. Please try again.")}},P=C=>{const j=n.goal_categories_enabled||[],E=j.includes(C)?j.filter(A=>A!==C):[...j,C];i(A=>({...A,goal_categories_enabled:E}))},z=C=>{const j=n.notification_preferences||{};i(E=>({...E,notification_preferences:{...j,[C]:!j[C]}}))};return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-gray-800 rounded-xl p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto border border-gray-700",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 p-6 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Us,{className:"w-6 h-6 text-white"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Financial Preferences"})]}),e.jsx("button",{onClick:s,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors",children:e.jsx(is,{className:"w-5 h-5"})})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"risk",label:"Risk & Investment"},{id:"lifestyle",label:"Lifestyle"},{id:"values",label:"Values & Priorities"},{id:"goals",label:"Goal Categories"},{id:"tax",label:"Tax & Optimization"}].map(C=>e.jsx("button",{onClick:()=>v(C.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${T===C.id?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-300"}`,children:C.label},C.id))})}),e.jsxs("form",{onSubmit:L,className:"p-6",children:[T==="risk"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Risk & Investment Profile"}),e.jsx("div",{className:"space-y-4",children:e.jsx(pn,{label:"Overall Risk Tolerance",value:l,onChange:o,min:1,max:10,leftLabel:"Conservative",rightLabel:"Aggressive",formatValue:C=>`${C}/10 - ${C>=8?"Aggressive":C>=5?"Moderate-High":"Conservative"}`})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"Investment Style"}),e.jsx("div",{className:"space-y-2",children:[{value:"conservative",label:"Conservative (Preserve capital)"},{value:"moderate",label:"Moderate (Balanced growth)"},{value:"aggressive",label:"Aggressive (Maximum growth)"}].map(C=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"radio",name:"investmentStyle",value:C.value,checked:c===C.value,onChange:j=>u(j.target.value),className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-gray-300",children:C.label})]},C.value))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-200",children:"Asset Preferences"}),e.jsx("div",{className:"space-y-3",children:[{key:"stocks",label:"Stocks"},{key:"real_estate",label:"Real Estate"},{key:"bonds",label:"Bonds"},{key:"crypto",label:"Crypto"},{key:"international",label:"International"}].map(C=>e.jsx(pn,{label:C.label,value:h[C.key],onChange:j=>f(E=>({...E,[C.key]:j})),min:1,max:10,formatValue:j=>`${j}/10 - ${j>=8?"High":j>=5?"Medium":j===1?"None":"Low"}`},C.key))})]})]}),T==="lifestyle"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Lifestyle Preferences"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"Retirement Lifestyle"}),e.jsx("div",{className:"space-y-2",children:[{value:"downsize",label:"Downsize (Reduce expenses by 30%)"},{value:"maintain",label:"Maintain (Same as current)"},{value:"upgrade",label:"Upgrade (Increase by 20%)"}].map(C=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"radio",name:"retirementLifestyle",value:C.value,checked:d.retirement_lifestyle===C.value,onChange:j=>x(E=>({...E,retirement_lifestyle:j.target.value})),className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-gray-300",children:C.label})]},C.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"Work Flexibility"}),e.jsx("div",{className:"space-y-2",children:[{key:"part_time",label:"Open to part-time work in retirement"},{key:"consulting",label:"Consider consulting/freelance"},{key:"full_retirement",label:"Full retirement only"}].map(C=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:d.work_flexibility[C.key],onChange:j=>x(E=>({...E,work_flexibility:{...E.work_flexibility,[C.key]:j.target.checked}})),className:"h-4 w-4 text-blue-600 rounded"}),e.jsx("span",{className:"text-gray-300",children:C.label})]},C.key))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"Geographic Flexibility"}),e.jsx("div",{className:"space-y-2",children:[{key:"relocate",label:"Willing to relocate for lower cost of living"},{key:"stay_current",label:"Must stay in current area"},{key:"international",label:"Open to international retirement"}].map(C=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:d.geographic_flexibility[C.key],onChange:j=>x(E=>({...E,geographic_flexibility:{...E.geographic_flexibility,[C.key]:j.target.checked}})),className:"h-4 w-4 text-blue-600 rounded"}),e.jsx("span",{className:"text-gray-300",children:C.label})]},C.key))})]})]}),T==="values"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Values & Priorities"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-3",children:"What matters most? (Rank 1-5)"}),e.jsx("div",{className:"space-y-3",children:[{key:"financial_security",label:"Financial Security"},{key:"family_time",label:"Family Time"},{key:"travel_experiences",label:"Travel & Experiences"},{key:"leaving_legacy",label:"Leaving a Legacy"},{key:"luxury_comfort",label:"Luxury & Comfort"}].map(C=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300",children:C.label}),e.jsx("select",{value:b[C.key],onChange:j=>m(E=>({...E,[C.key]:parseInt(j.target.value)})),className:"bg-gray-700 text-white border border-gray-600 rounded px-2 py-1 text-sm",children:[1,2,3,4,5].map(j=>e.jsx("option",{value:j,children:j},j))})]},C.key))})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"Special Considerations"}),e.jsx("div",{className:"space-y-2",children:[{key:"esg_investing",label:"ESG/Sustainable Investing Important"},{key:"religious_restrictions",label:"Religious/Ethical Restrictions"},{key:"charity_support",label:"Want to support charities"}].map(C=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:p[C.key],onChange:j=>N(E=>({...E,[C.key]:j.target.checked})),className:"h-4 w-4 text-blue-600 rounded"}),e.jsx("span",{className:"text-gray-300",children:C.label})]},C.key))})]})]}),T==="goals"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Financial Profile"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx($e,{label:"Risk Tolerance",value:n.risk_tolerance||"",onChange:C=>i(j=>({...j,risk_tolerance:C.target.value})),options:[...Object.entries(mc).map(([C,j])=>({value:C,label:j}))]}),e.jsx($e,{label:"Financial Knowledge",value:n.financial_knowledge||"",onChange:C=>i(j=>({...j,financial_knowledge:C.target.value})),options:[...Object.entries(uc).map(([C,j])=>({value:C,label:j}))]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx(W,{label:"Investment Timeline (years)",type:"number",value:n.investment_timeline||"",onChange:C=>i(j=>({...j,investment_timeline:parseInt(C.target.value)})),min:"1",max:"50"}),e.jsx(W,{label:"Emergency Fund (months of expenses)",type:"number",value:n.emergency_fund_months||"",onChange:C=>i(j=>({...j,emergency_fund_months:parseInt(C.target.value)})),min:"1",max:"12"})]}),e.jsx($e,{label:"Debt Payoff Strategy",value:n.debt_payoff_priority||"",onChange:C=>i(j=>({...j,debt_payoff_priority:C.target.value})),options:[{value:"avalanche",label:"Avalanche (Highest Interest First)"},{value:"snowball",label:"Snowball (Smallest Balance First)"},{value:"balanced",label:"Balanced Approach"}]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Optional Goals"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(W,{label:"Retirement Age",type:"number",value:n.retirement_age||"",onChange:C=>i(j=>({...j,retirement_age:parseInt(C.target.value)||void 0})),min:"50",max:"80",placeholder:"e.g., 65"}),e.jsx(W,{label:"Annual Income Goal",type:"number",value:n.annual_income_goal||"",onChange:C=>i(j=>({...j,annual_income_goal:parseFloat(C.target.value)||void 0})),min:"0",step:"1000",placeholder:"e.g., 100000"})]})]}),e.jsx(_,{className:"bg-blue-900/20 border-blue-600",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(gs,{className:"w-5 h-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-100",children:"About These Settings"}),e.jsx("p",{className:"text-blue-200 text-sm mt-1",children:"These preferences help us provide personalized recommendations and goal templates that match your financial situation and risk tolerance."})]})]})})})]}),T==="goals"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Enabled Goal Categories"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Select which types of goals you want to track. You can change this anytime."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries(js).map(([C,j])=>{var E,A;return e.jsx("div",{className:`p-4 rounded-lg border cursor-pointer transition-all ${(E=n.goal_categories_enabled)!=null&&E.includes(C)?"border-blue-500 bg-blue-900/20":"border-gray-600 bg-gray-700 hover:border-gray-500"}`,onClick:()=>P(C),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white",children:j}),e.jsxs("p",{className:"text-gray-400 text-xs",children:[C==="retirement"&&"Long-term retirement planning",C==="education"&&"Education and learning goals",C==="real_estate"&&"Property and real estate",C==="business"&&"Business and entrepreneurship",C==="travel"&&"Travel and experiences",C==="emergency_fund"&&"Emergency savings",C==="debt_payoff"&&"Debt elimination",C==="major_purchase"&&"Large purchases",C==="other"&&"Custom and other goals"]})]}),((A=n.goal_categories_enabled)==null?void 0:A.includes(C))&&e.jsx(qe,{className:"w-5 h-5 text-blue-500"})]})},C)})})]})}),T==="tax"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Tax & Optimization"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"Tax Filing Status"}),e.jsxs("select",{value:g.tax_filing_status,onChange:C=>S(j=>({...j,tax_filing_status:C.target.value})),className:"w-full p-2 bg-gray-700 text-white border border-gray-600 rounded",children:[e.jsx("option",{value:"single",children:"Single"}),e.jsx("option",{value:"married_filing_jointly",children:"Married Filing Jointly"}),e.jsx("option",{value:"married_filing_separately",children:"Married Filing Separately"}),e.jsx("option",{value:"head_of_household",children:"Head of Household"}),e.jsx("option",{value:"qualifying_widow",children:"Qualifying Widow(er)"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"Federal Tax Bracket"}),e.jsxs("select",{value:g.federal_tax_bracket,onChange:C=>S(j=>({...j,federal_tax_bracket:parseFloat(C.target.value)})),className:"w-full p-2 bg-gray-700 text-white border border-gray-600 rounded mt-2",children:[e.jsx("option",{value:.1,children:"10%"}),e.jsx("option",{value:.12,children:"12%"}),e.jsx("option",{value:.22,children:"22%"}),e.jsx("option",{value:.24,children:"24%"}),e.jsx("option",{value:.32,children:"32%"}),e.jsx("option",{value:.35,children:"35%"}),e.jsx("option",{value:.37,children:"37%"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"State"}),e.jsx("input",{type:"text",value:g.state,onChange:C=>S(j=>({...j,state:C.target.value.toUpperCase()})),maxLength:2,placeholder:"NY",className:"w-full p-2 bg-gray-700 text-white border border-gray-600 rounded mt-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"State Tax Rate (%)"}),e.jsx("input",{type:"number",value:(g.state_tax_rate*100).toFixed(2),onChange:C=>S(j=>({...j,state_tax_rate:parseFloat(C.target.value)/100})),min:"0",max:"15",step:"0.1",className:"w-full p-2 bg-gray-700 text-white border border-gray-600 rounded mt-2"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"Tax Optimization Priority"}),e.jsx("div",{className:"space-y-2",children:[{value:"aggressive",label:"Aggressive (Maximum tax savings)"},{value:"moderate",label:"Moderate (Balanced approach)"},{value:"conservative",label:"Conservative (Simple strategies)"},{value:"none",label:"None (No tax optimization)"}].map(C=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"radio",name:"taxOptimization",value:C.value,checked:g.tax_optimization_priority===C.value,onChange:j=>S(E=>({...E,tax_optimization_priority:j.target.value})),className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-gray-300",children:C.label})]},C.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-200",children:"Tax Strategies"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:g.tax_loss_harvesting,onChange:C=>S(j=>({...j,tax_loss_harvesting:C.target.checked})),className:"h-4 w-4 text-blue-600 rounded"}),e.jsx("span",{className:"text-gray-300",children:"Tax Loss Harvesting"})]}),e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:g.roth_ira_eligible,onChange:C=>S(j=>({...j,roth_ira_eligible:C.target.checked})),className:"h-4 w-4 text-blue-600 rounded"}),e.jsx("span",{className:"text-gray-300",children:"Roth IRA Eligible"})]})]})]})]}),T==="notifications"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Notification Preferences"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Choose how you'd like to be notified about your goal progress and milestones."}),e.jsx("div",{className:"space-y-4",children:[{key:"goal_reminders",label:"Goal Progress Reminders",description:"Weekly reminders to update your progress"},{key:"milestone_alerts",label:"Milestone Achievements",description:"Notifications when you reach milestones"},{key:"deadline_warnings",label:"Deadline Warnings",description:"Alerts for upcoming goal deadlines"},{key:"conflict_alerts",label:"Goal Conflict Alerts",description:"Notifications about conflicting goals"},{key:"monthly_summary",label:"Monthly Summary",description:"Monthly progress summary email"}].map(C=>{var j,E;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white",children:C.label}),e.jsx("p",{className:"text-gray-400 text-sm",children:C.description})]}),e.jsx("button",{type:"button",onClick:()=>z(C.key),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(j=n.notification_preferences)!=null&&j[C.key]?"bg-blue-600":"bg-gray-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(E=n.notification_preferences)!=null&&E[C.key]?"translate-x-6":"translate-x-1"}`})})]},C.key)})})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-600 mt-8",children:[e.jsx($,{type:"button",variant:"outline",onClick:s,disabled:r.isPending,children:"Cancel"}),e.jsx($,{type:"submit",disabled:r.isPending,className:"bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700",children:r.isPending?"Saving...":"Save Preferences"})]})]})]})})},pc=({className:s=""})=>{const[t,a]=w.useState(!1),[r,n]=w.useState(!1),[i,l]=w.useState(null),[o,c]=w.useState(""),[u,h]=w.useState(""),[f,d]=w.useState("list"),{data:x=[],isLoading:b,error:m,refetch:p}=ec({status:o||void 0,category:u||void 0}),N=oc();ii(),console.log("🎯 GoalManager render:",{goals:x,goalsLength:x==null?void 0:x.length,isLoading:b,error:m,statusFilter:o,categoryFilter:u,goalsType:typeof x,goalsIsArray:Array.isArray(x),firstGoal:x==null?void 0:x[0]}),x&&!Array.isArray(x)&&console.error("⚠️ Goals is not an array! Got:",x);const{data:g}=ac(),S=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),T=k=>new Date(k).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),v=k=>{const F=new Date,J=new Date(k).getTime()-F.getTime();return Math.ceil(J/(1e3*60*60*24))},L=k=>k>=80?"text-green-500":k>=50?"text-yellow-500":"text-red-500",P=k=>k>=8?"bg-red-100 text-red-800 border border-red-300":k>=5?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-green-100 text-green-800 border border-green-300",z=k=>k>=8?"Critical":k>=6?"High Priority":k>=4?"Medium Priority":"Low Priority",C=k=>({retirement:"🏖️",real_estate:"🏠",education:"🎓",business:"🚀",emergency_fund:"🛡️",vacation:"🏝️",vehicle:"🚗",health:"💊",custom:"💰"})[k]||"💰",j=k=>{var F;if(k.category==="real_estate"&&((F=k.params)!=null&&F.down_payment_percentage)){const O=k.params.down_payment_percentage/100;return k.target_amount*O}return k.target_amount},E=k=>{var he;const F=new Date(k.target_date),O=new Date,J=Math.max(1,Math.ceil((F.getTime()-O.getTime())/(1e3*60*60*24*30)));let U=k.target_amount;if(k.category==="real_estate"&&((he=k.params)!=null&&he.down_payment_percentage)){const ye=k.params.down_payment_percentage/100;U=k.target_amount*ye}const D=parseFloat(k.current_amount||"0");return Math.max(0,U-D)/J},A=k=>{const F=new Date(k.target_date),O=new Date,J=Math.ceil((F.getTime()-O.getTime())/(1e3*60*60*24)),U=E(k);return{isDateValid:J>0,monthlySavingsRequired:U,isAmountRealistic:U<5e4,message:J<=0?"Target date has passed":U>5e4?"Very high monthly requirement":""}},y=async k=>{if(window.confirm(`Are you sure you want to delete the goal "${k.name}"?

This action cannot be undone.`))try{await N.mutateAsync(k.goal_id)}catch(O){console.error("Failed to delete goal:",O),alert("Failed to delete goal. Please try again.")}},R=k=>{console.log("🔧 Edit button clicked for goal:",k),console.log("🔧 Setting selectedGoal to:",k),console.log("🔧 Current showAddGoal state:",t),l(k),a(!0),console.log("🔧 Should now show modal with showAddGoal=true and selectedGoal=",k)};return b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):m?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-4",children:"Error loading goals. Please try again."}),e.jsx($,{onClick:()=>p(),children:"Retry"})]}):e.jsxs("div",{className:`goal-manager ${s}`,children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(De,{className:"w-8 h-8 text-blue-500"}),"Financial Goals"]}),e.jsx("p",{className:"text-gray-300 mt-1",children:"Track and achieve your financial objectives"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs($,{variant:"outline",onClick:()=>n(!0),className:"flex items-center gap-2",children:[e.jsx(Us,{className:"w-4 h-4"}),"Preferences"]}),e.jsxs($,{variant:"outline",onClick:async()=>{try{const k=await fetch(`${et()}/api/v1/sync-net-worth`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_tokens")?JSON.parse(localStorage.getItem("auth_tokens")).access_token:""}`,"Content-Type":"application/json"}});if(k.ok){const F=await k.json();alert(F.message),p()}else alert("Failed to sync net worth. Please try again.")}catch{alert("Error syncing net worth. Please try again.")}},className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(Te,{className:"w-4 h-4"}),"Sync Net Worth"]}),e.jsxs($,{onClick:()=>a(!0),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[e.jsx(Tt,{className:"w-4 h-4"}),"Add Goal"]})]})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-blue-900 to-blue-800",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-200 text-sm",children:"Active Goals"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:g.active_goals})]}),e.jsx(De,{className:"w-8 h-8 text-blue-400"})]})})}),e.jsx(_,{className:"bg-gradient-to-r from-green-900 to-green-800",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-200 text-sm",children:"Achieved"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:g.achieved_goals})]}),e.jsx(Te,{className:"w-8 h-8 text-green-400"})]})})}),e.jsx(_,{className:"bg-gradient-to-r from-purple-900 to-purple-800",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-200 text-sm",children:"Total Target"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:S(g.total_target)})]}),e.jsx(De,{className:"w-8 h-8 text-purple-400"})]})})}),e.jsx(_,{className:"bg-gradient-to-r from-orange-900 to-orange-800",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-200 text-sm",children:"Avg Progress"}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[g.average_progress.toFixed(1),"%"]})]}),e.jsx(Te,{className:"w-8 h-8 text-orange-400"})]})})})]}),x.length>1&&e.jsx(_,{className:"mb-6 border-blue-600 bg-blue-900/20",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-100",children:"Ready for Intelligence Analysis"}),e.jsx("p",{className:"text-blue-200",children:"Complete comprehensive analysis of all your goals together in Step 4."})]}),e.jsx($,{variant:"outline",size:"sm",className:"ml-auto",children:"Continue to Step 4"})]})})}),e.jsxs("div",{className:"flex gap-4 items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(En,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-300 text-sm",children:"Filters:"})]}),e.jsxs("select",{value:o,onChange:k=>c(k.target.value),className:"bg-gray-700 border border-gray-600 text-white rounded px-3 py-1 text-sm",children:[e.jsx("option",{value:"",children:"All Statuses"}),Object.entries(er).map(([k,F])=>e.jsx("option",{value:k,children:F},k))]}),e.jsxs("select",{value:u,onChange:k=>h(k.target.value),className:"bg-gray-700 border border-gray-600 text-white rounded px-3 py-1 text-sm",children:[e.jsx("option",{value:"",children:"All Categories"}),Object.entries(js).map(([k,F])=>e.jsx("option",{value:k,children:F},k))]}),(o||u)&&e.jsx($,{variant:"ghost",size:"sm",onClick:()=>{c(""),h("")},className:"text-gray-400 hover:text-white",children:"Clear Filters"}),e.jsxs("div",{className:"flex items-center bg-gray-700 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>d("list"),className:`px-3 py-1 text-sm font-medium rounded transition-colors ${f==="list"?"bg-blue-600 text-white":"text-gray-400 hover:text-white"}`,children:"List"}),e.jsx("button",{onClick:()=>d("timeline"),className:`px-3 py-1 text-sm font-medium rounded transition-colors ${f==="timeline"?"bg-blue-600 text-white":"text-gray-400 hover:text-white"}`,children:"Timeline"})]})]})]}),e.jsx("div",{className:"space-y-4",children:f==="timeline"?e.jsx(_,{children:e.jsxs(_.Body,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Goal Timeline"}),x.length===0?e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No goals to display"}):e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-4",children:[e.jsx("span",{children:"2024"}),e.jsx("span",{children:"2030"}),e.jsx("span",{children:"2040"})]}),e.jsx("div",{className:"relative bg-gray-700 h-2 rounded-full mb-8",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 via-purple-500 to-green-500 h-full rounded-full opacity-50"})}),e.jsx("div",{className:"space-y-4",children:x.sort((k,F)=>new Date(k.target_date).getTime()-new Date(F.target_date).getTime()).map(k=>{const F=new Date(k.target_date),O=new Date().getFullYear(),J=F.getFullYear(),U=J-O;return e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-800/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl",children:C(k.category)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-white",children:k.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[e.jsxs("span",{children:[S(k.target_amount)," by ",J]}),e.jsxs("span",{className:"px-2 py-1 bg-blue-900/50 rounded text-blue-300",children:[U," years"]}),e.jsx("span",{className:`px-2 py-1 rounded ${P(k.priority)}`,children:z(k.priority)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Progress"}),e.jsxs("div",{className:"text-lg font-bold text-blue-400",children:[(k.progress_percentage||0).toFixed(1),"%"]})]})]},k.goal_id)})})]})]})}):e.jsx("div",{className:"space-y-4",children:x.length===0?e.jsx(_,{children:e.jsxs(_.Body,{className:"text-center py-12",children:[e.jsx(De,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-100 mb-2",children:"No Goals Yet"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Start by creating your first financial goal to track your progress."}),e.jsx($,{onClick:()=>a(!0),children:"Create Your First Goal"})]})}):x.map(k=>{var D;const F=v(k.target_date),O=k.progress_percentage||0,J=E(k),U=A(k);return e.jsx(_,{className:"hover:border-blue-600 transition-colors",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl",children:C(k.category)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:k.name}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx(ke,{variant:"secondary",children:js[k.category]}),e.jsx(ke,{className:P(k.priority),children:z(k.priority)}),e.jsx(ke,{variant:k.status==="active"?"default":"secondary",children:er[k.status]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{variant:"ghost",size:"sm",onClick:()=>l(k),children:e.jsx(ns,{className:"w-4 h-4"})}),e.jsx($,{variant:"ghost",size:"sm",onClick:V=>{V.preventDefault(),V.stopPropagation(),console.log("🔧 Edit button CLICKED!",k.name),R(k)},children:e.jsx(ga,{className:"w-4 h-4"})}),e.jsx($,{variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300",onClick:()=>y(k),disabled:N.isPending,children:e.jsx(ws,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx("div",{children:k.category==="real_estate"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Property Value"}),e.jsx("p",{className:"text-lg font-bold text-white",children:S(k.target_amount)}),e.jsxs("p",{className:"text-xs text-blue-400",children:["Cash needed: ",S(j(k))," (",((D=k.params)==null?void 0:D.down_payment_percentage)||20,"% down)"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Target Amount"}),e.jsx("p",{className:"text-lg font-bold text-white",children:S(k.target_amount)})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Current Amount"}),e.jsx("p",{className:"text-lg font-bold text-white",children:S(k.current_amount||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Monthly Required"}),e.jsx("p",{className:"text-lg font-bold text-blue-400",children:S(J)}),e.jsx("p",{className:"text-xs text-gray-500",children:"to reach goal"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Target Date"}),e.jsx("p",{className:"text-lg font-bold text-white",children:T(k.target_date)}),e.jsx("p",{className:`text-sm ${F<90?"text-red-400":"text-gray-400"}`,children:F>0?`${F} days left`:"Overdue"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Progress"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${Math.min(O,100)}%`}})}),e.jsxs("span",{className:`text-sm font-bold ${L(O)}`,children:[O.toFixed(1),"%"]})]})]})]}),U.message&&e.jsx("div",{className:"mt-4 p-3 bg-orange-900/20 border border-orange-600 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-400 mt-0.5",children:"ℹ️"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-300 font-medium text-sm",children:"Goal Notice:"}),e.jsx("p",{className:"text-orange-200 text-xs mt-1",children:U.message}),e.jsx("p",{className:"text-orange-200 text-xs mt-1",children:"💡 Complete Step 4 for comprehensive goal analysis"})]})]})})]})},k.goal_id)})})}),t&&e.jsx(hc,{goal:i,onClose:()=>{console.log("🔄 GoalForm onClose called"),a(!1),l(null)},onSuccess:()=>{console.log("🔄 GoalForm onSuccess called"),a(!1),l(null),p()}}),r&&e.jsx(gc,{onClose:()=>n(!1)}),i&&!t&&e.jsx(xc,{goal:i,onClose:()=>l(null)})]})},fc=({value:s,size:t=192})=>{const a=(t-8)/2,r=2*Math.PI*a,n=`${s/100*r} ${r}`,i=l=>l>=80?"#10b981":l>=60?"#f59e0b":l>=40?"#f97316":"#ef4444";return e.jsxs("div",{className:"relative",style:{width:t,height:t},children:[e.jsxs("svg",{className:"absolute inset-0 w-full h-full",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:t/2,cy:t/2,r:a,fill:"transparent",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:"8"}),e.jsx("circle",{cx:t/2,cy:t/2,r:a,fill:"transparent",stroke:i(s),strokeWidth:"8",strokeLinecap:"round",strokeDasharray:n,className:"transition-all duration-1000 ease-out"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-bold",style:{color:i(s)},children:[s,"%"]}),e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Achievement"})]})})]})},yc=({score:s,trend:t,message:a})=>{const r=()=>{switch(t){case"up":return e.jsx(Te,{className:"w-5 h-5 text-green-500"});case"down":return e.jsx($s,{className:"w-5 h-5 text-red-500"});default:return e.jsx(tl,{className:"w-5 h-5 text-gray-400"})}},n=()=>{switch(t){case"up":return"Improving trajectory";case"down":return"Needs attention";default:return"Stable outlook"}};return e.jsx(_,{className:"bg-gradient-to-r from-gray-800 to-gray-700",children:e.jsx(_.Body,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Goal Achievement Score"}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(fc,{value:s})}),e.jsx("p",{className:"text-lg text-gray-300 mb-4",children:a}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[r(),e.jsx("span",{className:"text-sm text-gray-400",children:n()})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-green-400 font-semibold",children:"80-100%"}),e.jsx("div",{className:"text-gray-400",children:"Excellent"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-yellow-400 font-semibold",children:"60-79%"}),e.jsx("div",{className:"text-gray-400",children:"Good"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-orange-400 font-semibold",children:"40-59%"}),e.jsx("div",{className:"text-gray-400",children:"Moderate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-400 font-semibold",children:"0-39%"}),e.jsx("div",{className:"text-gray-400",children:"Challenging"})]})]})]})})})},tr=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.abs(s)),Hs=({title:s,value:t,subtitle:a,icon:r,color:n,isNegative:i=!1})=>{const l={red:"from-red-900 to-red-800",green:"from-green-900 to-green-800",blue:"from-blue-900 to-blue-800",purple:"from-purple-900 to-purple-800"},o={red:"text-red-400",green:"text-green-400",blue:"text-blue-400",purple:"text-purple-400"},c={red:"text-red-200",green:"text-green-200",blue:"text-blue-200",purple:"text-purple-200"};return e.jsx(_,{className:`bg-gradient-to-r ${l[n]}`,children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`${c[n]} text-sm font-medium`,children:s}),e.jsx("p",{className:`text-white text-2xl font-bold ${i?"text-red-300":""}`,children:typeof t=="number"&&t<0&&s.includes("GAP")?`-${tr(t)}`:typeof t=="string"?t:`${t}%`})]}),e.jsx("div",{className:`${o[n]}`,children:r})]}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:`${c[n]} text-xs`,children:a})})]})})},bc=({monthlyGap:s,successRate:t,riskAlign:a,lifestyleFit:r})=>{const i=(l=>l<=0?{text:"surplus",color:"green"}:l<=5e3?{text:"minor deficit",color:"blue"}:l<=15e3?{text:"deficit",color:"purple"}:{text:"major deficit",color:"red"})(s);return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(Hs,{title:"MONTHLY GAP",value:(s<=0,tr(s)),subtitle:s<=0?"surplus":i.text,icon:e.jsx($s,{className:"w-8 h-8"}),color:i.color,isNegative:s>0}),e.jsx(Hs,{title:"SUCCESS RATE",value:t,subtitle:"probability",icon:e.jsx(tt,{className:"w-8 h-8"}),color:t>=80?"green":t>=60?"blue":"red"}),e.jsx(Hs,{title:"RISK ALIGN",value:a,subtitle:"matched",icon:e.jsx(wt,{className:"w-8 h-8"}),color:a>=85?"green":a>=70?"blue":"purple"}),e.jsx(Hs,{title:"LIFESTYLE FIT",value:r,subtitle:"maintained",icon:e.jsx(Mt,{className:"w-8 h-8"}),color:r>=90?"green":r>=75?"blue":"red"})]})},vc=({activeTab:s,onTabChange:t,conflictCount:a,scenarioCount:r,recommendationCount:n})=>{const i=[{id:"overview",label:"Overview",icon:e.jsx(ns,{className:"w-4 h-4"})},{id:"conflicts",label:"Conflicts",icon:e.jsx(Je,{className:"w-4 h-4"}),count:a,color:a>0?"red":"gray"},{id:"scenarios",label:"Scenarios",icon:e.jsx(cr,{className:"w-4 h-4"}),count:r},{id:"timeline",label:"Timeline",icon:e.jsx(It,{className:"w-4 h-4"})},{id:"recommendations",label:"Recommendations",icon:e.jsx(zs,{className:"w-4 h-4"}),count:n,color:n>0?"green":"gray"}],l=o=>s===o.id?`
        bg-blue-600 text-white border-blue-600
        shadow-lg transform scale-105
      `:`
      bg-gray-700 text-gray-300 border-gray-600 
      hover:bg-gray-600 hover:text-white hover:border-gray-500
      transition-all duration-200
    `;return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map((o,c)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("button",{onClick:()=>t(o.id),className:`
                flex items-center gap-2 px-4 py-3 rounded-lg border
                font-medium text-sm transition-all duration-200
                ${l(o)}
              `,children:[o.icon,e.jsx("span",{children:o.label}),o.count!==void 0&&o.count>0&&e.jsx(ke,{variant:o.color==="red"?"error":o.color==="green"?"success":"info",size:"sm",children:o.count})]}),c<i.length-1&&e.jsx(or,{className:"w-4 h-4 text-gray-500 mx-1"})]},o.id))}),e.jsx("div",{className:"mt-3 px-2",children:e.jsxs("p",{className:"text-xs text-gray-400",children:[s==="overview"&&"Complete overview of your goals and their feasibility",s==="conflicts"&&"Detected conflicts between your goals and recommended resolutions",s==="scenarios"&&"Different optimization paths to achieve your goals",s==="timeline"&&"Visual timeline showing when each goal will be achieved",s==="recommendations"&&"Personalized action items to improve your success rate"]})})]})},li=({citationId:s,onClose:t})=>{const[a,r]=w.useState(null),[n,i]=w.useState(!0),[l,o]=w.useState(null);w.useEffect(()=>{(async()=>{try{i(!0),o(null);const d=await fetch(`/api/v1/advisory/knowledge-base/document/${s}`);if(!d.ok){const b=c(s);r(b),o(null);return}const x=await d.json();r(x)}catch(d){o(d instanceof Error?d.message:"Failed to load document"),r(c(s))}finally{i(!1)}})()},[s]);const c=f=>({"PLAYBOOKS-922":{kb_id:"PLAYBOOKS-922",title:"Retirement Planning Playbook",category:"playbooks",content:`# Retirement Planning Playbook

## Overview
This playbook provides comprehensive guidance for retirement planning strategies, including 401(k) optimization, Roth conversions, and asset allocation approaches.

## Key Strategies

### 401(k) Optimization
- Maximize employer match (free money)
- Consider Roth vs Traditional contributions based on tax bracket
- Utilize catch-up contributions for 50+ individuals
- Target 10-15% savings rate minimum

### Asset Allocation by Age
- **20s-30s**: 80-90% stocks, 10-20% bonds
- **40s**: 70-80% stocks, 20-30% bonds
- **50s**: 60-70% stocks, 30-40% bonds
- **60s+**: 50-60% stocks, 40-50% bonds

### Retirement Income Planning
- 4% withdrawal rule as baseline
- Social Security optimization strategies
- Tax-efficient withdrawal sequencing

---
**Sources**: IRS Publication 590, FINRA Retirement Planning Guide`,tags:["retirement","401k","asset-allocation"],last_updated:"2025-09-05",file_path:"playbooks/retirement_planning.md",related_documents:[{kb_id:"RESEARCH-808",title:"Portfolio Optimization Research",score:.85}]},"RESEARCH-808":{kb_id:"RESEARCH-808",title:"Portfolio Optimization Research",category:"research",content:`# Portfolio Optimization Research

## Modern Portfolio Theory Applications

### Risk-Return Optimization
Recent research shows that traditional 60/40 portfolios may need adjustment for current market conditions:
- Low interest rate environment reduces bond expected returns
- Increased correlation between stocks and bonds during stress periods
- Alternative assets can provide diversification benefits

### Factor-Based Investing
Academic research supports factor tilts for long-term investors:
- **Value Factor**: Historically outperforms growth over long periods
- **Size Factor**: Small-cap premium remains robust
- **Quality Factor**: High ROE, low debt companies outperform
- **Momentum Factor**: Trending assets continue to perform

### Behavioral Finance Insights
- Loss aversion leads to suboptimal portfolio decisions
- Recency bias causes overreaction to recent market events
- Diversification across time (dollar-cost averaging) reduces timing risk

---
**Sources**: Journal of Finance, Modern Portfolio Theory Research`,tags:["portfolio-theory","optimization","research"],last_updated:"2025-09-05",file_path:"research/portfolio_optimization.md",related_documents:[{kb_id:"PLAYBOOKS-922",title:"Retirement Planning Playbook",score:.78}]},"REGULATIONS-59f":{kb_id:"REGULATIONS-59f",title:"Fiduciary Duty Guidelines",category:"regulations",content:`# Fiduciary Duty Guidelines

## Definition
A fiduciary duty is the legal obligation to act in the best interests of the client, placing client interests above the advisor's own interests.

## Key Requirements

### Best Interest Standard
- Recommendations must be in the client's best interest
- Consider client's investment profile, financial situation, and investment objectives
- Avoid conflicts of interest or disclose them clearly

### Disclosure Requirements
- Material conflicts of interest must be disclosed
- Compensation structure transparency
- Third-party payments and arrangements

### Documentation Standards
- Maintain records of recommendation rationale
- Document client objectives and constraints
- Regular review and update requirements

---
**Sources**: SEC Regulation Best Interest, DOL Fiduciary Rule`,tags:["fiduciary","compliance","regulations"],last_updated:"2025-09-05",file_path:"regulations/fiduciary_duty.md",related_documents:[]},"AL-001":{kb_id:"AL-001",title:"Asset Location Strategy",category:"playbooks",content:`# Asset Location Strategy

**KB-ID: AL-001**
**Category: Tax Optimization**
**Last Updated: 2024-12-16**

## Overview
Asset location (asset placement) refers to holding different types of investments in the most tax-efficient account types to maximize after-tax returns.

## Tax-Advantaged Account Priority

### Tax-Deferred Accounts (401k, Traditional IRA)
1. **Bonds and Fixed Income** - High priority
   - Corporate bonds, Treasury bonds, CDs
   - Bond funds and bond ETFs
   - REITs (Real Estate Investment Trusts)
   - Rationale: Interest income taxed as ordinary income

### Roth Accounts (Roth IRA, Roth 401k)
1. **High-Growth Potential Assets** - Highest priority
   - Small-cap growth stocks
   - International/emerging market funds
   - Individual growth stocks
   - Rationale: Tax-free growth compounds over time

### Taxable Accounts
1. **Tax-Efficient Assets** - Preferred placement
   - Total stock market index funds
   - Broad market ETFs (VTI, VTIAX)
   - Individual blue-chip stocks held long-term
   - Municipal bonds (for high earners)

## Quantified Benefits
**High Earner (24% bracket) with $500k portfolio:**
- Optimal asset location: ~$2,000-4,000 annual tax savings
- Bond interest in 401k vs taxable: $1,200 annual savings
- Foreign tax credit in taxable: $300-600 annual benefit

---
**Sources**: IRS Publication 590, Bogleheads Asset Location Guide, Morningstar Tax Research
**Compliance**: Educational content only, not personalized tax advice`,tags:["asset-location","tax-optimization","portfolio-management"],last_updated:"2024-12-16",file_path:"playbooks/asset_location.md",related_documents:[{kb_id:"RB-001",title:"Rebalancing Strategy",score:.85},{kb_id:"IRS-001",title:"IRS Contribution Limits",score:.72}]},"RB-001":{kb_id:"RB-001",title:"Portfolio Rebalancing Strategy",category:"playbooks",content:`# Portfolio Rebalancing Strategy

**KB-ID: RB-001**
**Category: Portfolio Management**

## Rebalancing Methods

### 1. Calendar Rebalancing
**Best Practice**: Semi-annual rebalancing on fixed dates (Jan 1, July 1)

### 2. Threshold Rebalancing
**Absolute Threshold**: Rebalance when allocation differs by fixed percentage
- 5% threshold: Rebalance if target 60% stocks becomes 55% or 65%

### 3. Hybrid Approach (Recommended)
- Time: Check quarterly, rebalance semi-annually
- Threshold: 5% absolute drift for major asset classes

## Cost-Benefit Analysis
**Rebalancing Benefit**
- Adds 0.1-0.4% annual return for typical portfolios
- Risk reduction benefit often exceeds return benefit`,tags:["rebalancing","portfolio-management"],last_updated:"2024-12-16",file_path:"playbooks/rebalancing_strategy.md",related_documents:[{kb_id:"AL-001",title:"Asset Location Strategy",score:.85},{kb_id:"AA-001",title:"Asset Allocation Research",score:.78}]}})[f]||{kb_id:f,title:"Document Not Found",category:"unknown",content:"Document content not available.",tags:[],last_updated:"2024-12-16",file_path:"unknown",related_documents:[]},u=f=>{f.target===f.currentTarget&&t()},h=f=>f.split(`
`).map((d,x)=>d.startsWith("# ")?e.jsx("h1",{className:"text-2xl font-bold text-white mt-6 mb-4",children:d.substring(2)},x):d.startsWith("## ")?e.jsx("h2",{className:"text-xl font-semibold text-white mt-5 mb-3",children:d.substring(3)},x):d.startsWith("### ")?e.jsx("h3",{className:"text-lg font-medium text-white mt-4 mb-2",children:d.substring(4)},x):d.startsWith("**")&&d.endsWith("**")?e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:d.replace(/\*\*/g,"")},x):d.startsWith("- ")?e.jsx("li",{className:"text-gray-300 ml-4 mb-1",children:d.substring(2)},x):d.trim()===""?e.jsx("div",{className:"mb-2"},x):e.jsx("p",{className:"text-gray-300 mb-2 leading-relaxed",children:d},x));return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 p-4",onClick:u,children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(lt,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:n?"Loading...":(a==null?void 0:a.title)||"Document"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Knowledge Base Citation: [",s,"]"]})]})]}),e.jsx($,{variant:"outline",size:"sm",onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx(is,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"h-[calc(90vh-120px)] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[n&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),l&&!a&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-400 mb-4",children:"Loading knowledge base document..."}),e.jsx($,{onClick:t,children:"Close"})]}),a&&!n&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(_,{className:"bg-gray-800",children:e.jsxs(_.Body,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dr,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-400",children:"Category:"}),e.jsx("span",{className:"text-white capitalize",children:a.category})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(It,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-400",children:"Updated:"}),e.jsx("span",{className:"text-white",children:a.last_updated})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(aa,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-400",children:"Source:"}),e.jsx("span",{className:"text-white",children:a.file_path})]})]}),a.tags.length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(f=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:f},f))})})]})}),e.jsx("div",{className:"prose prose-invert max-w-none",children:h(a.content)})]})]})}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-700 bg-gray-800",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"This document is part of the WealthPath AI knowledge base and serves as a citation source for advisory recommendations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs($,{variant:"outline",size:"sm",children:[e.jsx(aa,{className:"w-4 h-4 mr-2"}),"View Source"]}),e.jsx($,{onClick:t,className:"bg-blue-600 hover:bg-blue-700",children:"Close"})]})]})]})})},jc=({content:s,kbSource:t,detailedInfo:a,children:r,className:n=""})=>{const[i,l]=w.useState(!1),[o,c]=w.useState(!1),[u,h]=w.useState(!1);return e.jsxs("div",{className:`relative inline-block ${n}`,children:[e.jsx("div",{onMouseEnter:()=>l(!0),onMouseLeave:()=>{l(!1),c(!1)},className:"cursor-help",children:r}),i&&e.jsxs("div",{className:"absolute z-50 w-80 p-4 bg-gray-800 border border-gray-600 rounded-lg shadow-xl bottom-full left-1/2 transform -translate-x-1/2 mb-2",children:[e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-800"}),e.jsx("div",{className:"text-sm text-gray-200 mb-3",children:s}),t&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(sa,{className:"w-3 h-3 text-blue-400"}),e.jsxs("span",{className:"text-xs text-blue-400 font-medium",children:["Source: ",t]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Professional Guidance"})]}),e.jsxs("div",{className:"flex gap-2",children:[a&&e.jsxs("button",{onClick:()=>c(!o),className:"text-xs text-blue-400 hover:text-blue-300 flex items-center gap-1",children:[e.jsx(aa,{className:"w-3 h-3"}),o?"Hide Details":"Learn More"]}),t&&e.jsxs("button",{onClick:()=>{l(!1),h(!0)},className:"text-xs text-green-400 hover:text-green-300 flex items-center gap-1",children:[e.jsx(sa,{className:"w-3 h-3"}),"View Source"]})]})]}),o&&a&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-600",children:e.jsx("div",{className:"text-xs text-gray-300",children:a})})]}),u&&t&&e.jsx(li,{citationId:t.split(":")[0],onClose:()=>h(!1)})]})},fn=({tooltip:s,kbSource:t,className:a=""})=>e.jsx(jc,{content:s,kbSource:t,className:a,children:e.jsx(Xi,{className:"w-4 h-4 text-gray-400 hover:text-gray-300 transition-colors"})}),es=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),Nc=s=>({retirement:"🏖️",real_estate:"🏠",education:"🎓",business:"🚀",emergency_fund:"🛡️",vacation:"🏝️",vehicle:"🚗",health:"💊",other:"💰"})[s]||"💰",_c=s=>s>=80?"text-green-500 bg-green-500":s>=60?"text-yellow-500 bg-yellow-500":s>=40?"text-orange-500 bg-orange-500":"text-red-500 bg-red-500",wc=s=>{const t=Math.ceil(s/20);return"█".repeat(t)+"░".repeat(5-t)},kc=({analysis:s})=>{const{goals:t=[],gaps:a={},scenarios:r=[]}=s||{},n=t.reduce((o,c)=>o+(c.monthly_required||0),0),i=n-(a.monthly_shortfall||0),l=r.find(o=>o&&o.is_recommended);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"hover:border-blue-600 transition-colors",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-6 flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5 text-blue-400"}),"Goals Overview",e.jsx(fn,{tooltip:"Goal feasibility analysis based on current trajectory and professional best practices",kbSource:"PLAYBOOKS-922: Retirement Planning",className:"ml-2"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left text-gray-300 font-medium py-3 px-2",children:"Goal"}),e.jsx("th",{className:"text-right text-gray-300 font-medium py-3 px-2",children:"Target"}),e.jsx("th",{className:"text-right text-gray-300 font-medium py-3 px-2",children:"Required/Month"}),e.jsx("th",{className:"text-center text-gray-300 font-medium py-3 px-2",children:"Feasibility"}),e.jsx("th",{className:"text-center text-gray-300 font-medium py-3 px-2",children:"Risk"})]})}),e.jsx("tbody",{children:t.map(o=>e.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[e.jsx("td",{className:"py-4 px-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:Nc((o==null?void 0:o.category)||"other")}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:(o==null?void 0:o.name)||"Unnamed Goal"}),e.jsx("div",{className:"text-sm text-gray-400 capitalize",children:((o==null?void 0:o.category)||"other").replace("_"," ")})]})]})}),e.jsx("td",{className:"text-right py-4 px-2",children:e.jsx("div",{className:"text-white font-medium",children:es((o==null?void 0:o.target_amount)||0)})}),e.jsx("td",{className:"text-right py-4 px-2",children:e.jsx("div",{className:"text-white font-medium",children:es((o==null?void 0:o.monthly_required)||0)})}),e.jsx("td",{className:"text-center py-4 px-2",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`text-sm font-mono ${_c((o==null?void 0:o.feasibility_score)||0).split(" ")[0]}`,children:wc((o==null?void 0:o.feasibility_score)||0)}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[Math.round((o==null?void 0:o.feasibility_score)||0),"%"]})]})}),e.jsx("td",{className:"text-center py-4 px-2",children:o!=null&&o.risk_aligned?e.jsx(qe,{className:"w-5 h-5 text-green-500 mx-auto"}):e.jsx(Je,{className:"w-5 h-5 text-yellow-500 mx-auto"})})]},(o==null?void 0:o.goal_id)||Math.random()))})]})})]})}),e.jsx(_,{className:"hover:border-blue-600 transition-colors",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-6 flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-green-400"}),"Combined Requirements",e.jsx(fn,{tooltip:"Monthly funding requirements calculated using professional cash flow analysis methods",kbSource:"RESEARCH-808: Cash Flow Planning",className:"ml-2"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400 mb-2",children:es(n)}),e.jsx("div",{className:"text-gray-300 font-medium",children:"Total Monthly Need"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Across all goals"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400 mb-2",children:es(i)}),e.jsx("div",{className:"text-gray-300 font-medium",children:"Available"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Current capacity"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold mb-2 ${(a.monthly_shortfall||0)>0?"text-red-400":"text-green-400"}`,children:[(a.monthly_shortfall||0)>0?`-${es(a.monthly_shortfall||0)}`:`+${es(Math.abs(a.monthly_shortfall||0))}`,(a.monthly_shortfall||0)>0&&e.jsx("span",{className:"ml-2",children:"❌"}),(a.monthly_shortfall||0)<=0&&e.jsx("span",{className:"ml-2",children:"✅"})]}),e.jsx("div",{className:"text-gray-300 font-medium",children:(a.monthly_shortfall||0)>0?"Gap":"Surplus"}),e.jsx("div",{className:"text-sm text-gray-400",children:(a.monthly_shortfall||0)>0?"Monthly shortfall":"Monthly surplus"})]})]}),(a.monthly_shortfall||0)>0&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs($,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),"View Optimization Options →"]})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:t.length}),e.jsx("div",{className:"text-gray-400",children:"Active Goals"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:t.filter(o=>o&&(o.feasibility_score||0)>=80).length}),e.jsx("div",{className:"text-gray-400",children:"High Feasibility"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:t.filter(o=>o&&!o.risk_aligned).length}),e.jsx("div",{className:"text-gray-400",children:"Risk Misaligned"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[es(a.total_capital_needed||0).replace("$","").replace(",",""),"k"]}),e.jsx("div",{className:"text-gray-400",children:"Total Target"})]})]})})]})}),l&&e.jsx(_,{className:"bg-gradient-to-r from-green-900/20 to-blue-900/20 border-green-600",children:e.jsx(_.Body,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-green-600 rounded-full p-2",children:e.jsx(qe,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-green-100 mb-2",children:"Recommended Optimization Path Available"}),e.jsxs("p",{className:"text-green-200 mb-3",children:[(l==null?void 0:l.name)||"Optimization",": ",Math.round(((l==null?void 0:l.success_rate)||0)<=1?((l==null?void 0:l.success_rate)||0)*100:(l==null?void 0:l.success_rate)||0),"% success probability"]}),e.jsx("p",{className:"text-sm text-green-300 mb-4",children:"Our analysis suggests specific optimizations that could improve your goal achievement probability."}),e.jsx($,{variant:"outline",size:"sm",className:"border-green-500 text-green-400 hover:bg-green-600 hover:text-white",children:"View Scenarios Tab →"})]})]})})})]})},Sc=s=>{switch(s.toLowerCase()){case"critical":return"bg-red-900 text-red-200 border-red-600";case"moderate":return"bg-yellow-900 text-yellow-200 border-yellow-600";case"minor":return"bg-blue-900 text-blue-200 border-blue-600";default:return"bg-gray-900 text-gray-200 border-gray-600"}},Cc=s=>{switch(s.toLowerCase()){case"critical":return"🔴";case"moderate":return"🟡";case"minor":return"🔵";default:return"⚪"}},Ac=s=>{switch(s){case"cash_flow":return e.jsx(ge,{className:"w-5 h-5"});case"timeline":return e.jsx(Dt,{className:"w-5 h-5"});case"risk":return e.jsx(Te,{className:"w-5 h-5"});default:return e.jsx(Je,{className:"w-5 h-5"})}},Tc=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),Ic=({conflict:s,onResolve:t})=>{const[a,r]=w.useState(null),[n,i]=w.useState(!1),l=async()=>{if(!a)return;i(!0);const o=s.resolution_options.find(c=>c.type===a);await t(s.id,a,o),i(!1)};return e.jsx(_,{className:`${Sc(s.severity)} border-2`,children:e.jsx(_.Body,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"text-2xl",children:Cc(s.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold uppercase tracking-wide",children:[s.severity,": ",s.type.replace("_"," ")]}),e.jsxs(ke,{variant:"secondary",size:"sm",className:"mt-1",children:[s.affected_goals.length," goals affected"]})]}),e.jsx("div",{className:"flex items-center gap-1 text-sm opacity-75",children:Ac(s.type)})]}),e.jsx("p",{className:"text-lg mb-4",children:s.description}),s.shortfall_amount&&e.jsxs("div",{className:"bg-black/20 rounded-lg p-3 mb-4",children:[e.jsx("div",{className:"text-sm opacity-90 mb-1",children:"Monthly Shortfall:"}),e.jsx("div",{className:"text-2xl font-bold",children:Tc(s.shortfall_amount)})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("h5",{className:"font-semibold text-sm uppercase tracking-wide opacity-90",children:"Resolution Options:"}),s.resolution_options.map((o,c)=>e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:`resolution-${s.id}`,value:o.type,checked:a===o.type,onChange:u=>r(u.target.value),className:"mt-1 w-4 h-4 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:o.description}),e.jsx("div",{className:"text-sm opacity-75 mt-1",children:o.impact})]})]},c))]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs($,{onClick:l,disabled:!a||n,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50",size:"sm",children:[e.jsx(Tn,{className:"w-4 h-4 mr-2"}),n?"Applying...":"Apply Selected"]}),e.jsx($,{variant:"outline",size:"sm",className:"border-gray-500 text-gray-300 hover:bg-gray-700",children:"See Impact Analysis"})]})]})]})})})},Ec=({conflicts:s})=>{const[t,a]=w.useState(new Set),r=async(i,l,o)=>{try{console.log("Resolving conflict:",i,l,o),a(c=>new Set([...c,i]))}catch(c){console.error("Failed to resolve conflict:",c)}},n=s.filter(i=>!t.has(i.id));return s.length===0?e.jsx(_,{className:"text-center py-12",children:e.jsxs(_.Body,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),e.jsx("h3",{className:"text-2xl font-semibold text-white mb-4",children:"No Conflicts Detected"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Excellent! Your financial goals are well-aligned and achievable with your current trajectory."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-green-900/20 border border-green-600 rounded-lg p-4",children:[e.jsx("div",{className:"text-green-400 font-semibold mb-2",children:"✅ Cash Flow"}),e.jsx("div",{className:"text-gray-300",children:"Monthly requirements within budget"})]}),e.jsxs("div",{className:"bg-green-900/20 border border-green-600 rounded-lg p-4",children:[e.jsx("div",{className:"text-green-400 font-semibold mb-2",children:"✅ Timeline"}),e.jsx("div",{className:"text-gray-300",children:"Goals properly spaced over time"})]}),e.jsxs("div",{className:"bg-green-900/20 border border-green-600 rounded-lg p-4",children:[e.jsx("div",{className:"text-green-400 font-semibold mb-2",children:"✅ Risk Alignment"}),e.jsx("div",{className:"text-gray-300",children:"Goals match your risk tolerance"})]})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-red-900/20 to-orange-900/20 border-red-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Je,{className:"w-8 h-8 text-red-400"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-red-100 mb-1",children:[n.length," Conflict",n.length!==1?"s":""," Detected"]}),e.jsx("p",{className:"text-red-200",children:"These conflicts may prevent you from achieving your goals as planned."})]})]}),e.jsx("div",{className:"mt-4 flex gap-4",children:["critical","moderate","minor"].map(i=>{const l=n.filter(o=>o.severity===i).length;return l===0?null:e.jsxs(ke,{variant:i==="critical"?"error":i==="moderate"?"warning":"info",size:"sm",children:[l," ",i]},i)})})]})}),t.size>0&&e.jsx(_,{className:"bg-gradient-to-r from-green-900/20 to-blue-900/20 border-green-600",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Tn,{className:"w-6 h-6 text-green-400"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-green-100",children:[t.size," Conflict",t.size!==1?"s":""," Resolved"]}),e.jsx("p",{className:"text-sm text-green-200",children:"Solutions have been applied. Re-run analysis to see updated results."})]})]})})}),e.jsx("div",{className:"space-y-4",children:n.sort((i,l)=>{const o={critical:3,moderate:2,minor:1};return o[l.severity]-o[i.severity]}).map(i=>e.jsx(Ic,{conflict:i,onResolve:r},i.id))}),n.length>0&&e.jsx(_,{className:"bg-gray-800",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx($,{variant:"outline",size:"sm",className:"text-gray-300 hover:text-white",children:"Run Impact Simulation"}),e.jsx($,{variant:"outline",size:"sm",className:"text-gray-300 hover:text-white",children:"Export Conflict Report"}),e.jsx($,{variant:"outline",size:"sm",className:"text-gray-300 hover:text-white",children:"Schedule Review Meeting"})]})]})})]})},qt={all:["intelligence"],analysis:()=>[...qt.all,"analysis"],scenarios:()=>[...qt.all,"scenarios"],timeline:()=>[...qt.all,"timeline"],simulation:s=>[...qt.all,"simulation",s]},Rc=()=>ot({queryKey:qt.analysis(),queryFn:async()=>{try{return await G.post("/api/v1/intelligence/analyze",{include_simulations:!0,scenario_count:3,optimization_level:"balanced"})}catch(s){throw console.error("Intelligence analysis failed:",s),s}},staleTime:30*1e3,gcTime:15*60*1e3,retry:1,refetchOnWindowFocus:!1}),Pc=()=>{const s=ct();return dt({mutationFn:async t=>await G.post("/api/v1/intelligence/analyze",{include_simulations:!0,scenario_count:3,optimization_level:"balanced",...t}),onSuccess:()=>{s.removeQueries({queryKey:qt.all}),s.invalidateQueries({queryKey:qt.all})}})},Lc=()=>{const s=ct();return dt({mutationFn:async t=>await G.post("/api/v1/intelligence/simulate",{iterations:1e3,variables:{},...t}),onSuccess:(t,a)=>{s.setQueryData(qt.simulation(a.scenario_id),t)}})},Fc=()=>dt({mutationFn:async s=>(console.log("Tracking recommendation action:",s),s)}),xa=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),ba=s=>s<=1?s*100:s,oi=s=>{const t=ba(s);return t>=80?"text-green-400":t>=60?"text-yellow-400":t>=40?"text-orange-400":"text-red-400"},Mc=s=>{const t=ba(s);return t>=80?"from-green-900/30 to-green-800/30 border-green-600":t>=60?"from-yellow-900/30 to-yellow-800/30 border-yellow-600":t>=40?"from-orange-900/30 to-orange-800/30 border-orange-600":"from-red-900/30 to-red-800/30 border-red-600"},$c=({scenario:s,isSelected:t,onSelect:a,onRunSimulation:r})=>{var n;return e.jsx(_,{className:`
        transition-all duration-300 cursor-pointer
        ${t?"border-blue-600 bg-blue-900/20 transform scale-105 shadow-lg":"hover:border-gray-600"}
        ${s.is_recommended?"bg-gradient-to-br from-green-900/10 to-blue-900/10":""}
      `,onClick:a,children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"text-xl font-semibold text-white",children:s.name}),s.is_recommended&&e.jsxs(ke,{variant:"success",size:"sm",children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"Recommended"]})]}),e.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:s.description})]}),e.jsx(cr,{className:"w-6 h-6 text-blue-400"})]}),e.jsx("div",{className:`bg-gradient-to-r ${Mc(s.success_rate)} border rounded-lg p-4 mb-4`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-300 mb-1",children:"Success Probability"}),e.jsxs("div",{className:`text-3xl font-bold ${oi(s.success_rate)}`,children:[Math.round(ba(s.success_rate)),"%"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-300",children:"Monte Carlo"}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:s.monte_carlo_completed?e.jsx(ke,{variant:"success",size:"sm",children:"Completed"}):e.jsxs($,{variant:"primary",size:"sm",onClick:i=>{console.log("Run button clicked for scenario:",s.id),i.stopPropagation(),r(s.id)},children:[e.jsx(rl,{className:"w-3 h-3 mr-1"}),"Run"]})})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Monthly Change"}),e.jsxs("div",{className:`font-semibold ${s.monthly_requirement_change>0?"text-red-400":"text-green-400"}`,children:[s.monthly_requirement_change>0?"+":"",xa(s.monthly_requirement_change)]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Timeline Impact"}),e.jsxs("div",{className:`font-semibold ${s.timeline_impact>0?"text-red-400":"text-green-400"}`,children:[s.timeline_impact>0?"+":"",s.timeline_impact," months"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Goals Complete"}),e.jsxs("div",{className:"text-blue-400 font-semibold",children:[Math.round(((n=s.projected_outcomes)==null?void 0:n.goal_completion_rate)||0),"%"]})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide",children:"Required Changes:"}),(s.required_changes||[]).slice(0,3).map((i,l)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{className:"text-gray-300",children:[i.description,i.amount&&e.jsxs("span",{className:"text-blue-400 font-medium ml-1",children:["(",xa(i.amount),")"]})]})]},l)),(s.required_changes||[]).length>3&&e.jsxs("div",{className:"text-xs text-gray-400 pl-4",children:["+",(s.required_changes||[]).length-3," more changes..."]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx($,{variant:t?"default":"outline",size:"sm",className:t?"bg-blue-600 hover:bg-blue-700":"",children:t?"Selected":"Select Scenario"}),e.jsx($,{variant:"outline",size:"sm",className:"text-gray-300 hover:text-white",children:"View Details"})]})]})})},Dc=({scenarios:s,onScenarioSelect:t})=>{var h,f,d,x,b;console.log("ScenariosTab - scenarios received:",s);const[a,r]=w.useState(((h=s.find(m=>m.is_recommended))==null?void 0:h.id)||((f=s[0])==null?void 0:f.id)||null),[n,i]=w.useState(new Map),l=Lc(),o=m=>{r(m),t==null||t(m)},c=async m=>{console.log("Running Monte Carlo simulation for scenario:",m);try{const p=await l.mutateAsync({scenario_id:m,iterations:1e3});console.log("Monte Carlo simulation result:",p),i(N=>new Map(N).set(m,p)),s.forEach(N=>{N.id===m&&(N.monte_carlo_completed=!0)})}catch(p){console.error("Failed to run Monte Carlo simulation:",p),alert(`Failed to run simulation: ${p.message||"Unknown error"}`)}},u=s.find(m=>m.id===a);return s.length===0?e.jsx(_,{className:"text-center py-12",children:e.jsxs(_.Body,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔄"}),e.jsx("h3",{className:"text-2xl font-semibold text-white mb-4",children:"Generating Scenarios"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Our AI is analyzing your goals and generating optimization scenarios..."}),e.jsx($,{className:"bg-blue-600 hover:bg-blue-700",children:"Refresh Analysis"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-blue-900/20 to-purple-900/20 border-blue-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(cr,{className:"w-8 h-8 text-blue-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-100 mb-1",children:"Optimization Scenarios"}),e.jsx("p",{className:"text-blue-200",children:"Compare different paths to achieve your financial goals with varying risk and timeline trade-offs."})]})]}),e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsxs(ke,{variant:"info",size:"sm",children:[s.length," scenarios generated"]}),e.jsxs(ke,{variant:"success",size:"sm",children:[s.filter(m=>m.monte_carlo_completed).length," simulations completed"]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:s.sort((m,p)=>m.is_recommended&&!p.is_recommended?-1:!m.is_recommended&&p.is_recommended?1:p.success_rate-m.success_rate).map(m=>e.jsx($c,{scenario:m,isSelected:a===m.id,onSelect:()=>o(m.id),onRunSimulation:c},m.id))}),u&&e.jsx(_,{className:"bg-gray-800",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5 text-blue-400"}),"Selected Scenario: ",u.name]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400 mb-2",children:xa(((d=u.projected_outcomes)==null?void 0:d.total_savings)||0)}),e.jsx("div",{className:"text-gray-300 font-medium",children:"Total Projected Savings"}),e.jsx("div",{className:"text-sm text-gray-400",children:"By target completion"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-400 mb-2",children:[Math.round(((x=u.projected_outcomes)==null?void 0:x.goal_completion_rate)||0),"%"]}),e.jsx("div",{className:"text-gray-300 font-medium",children:"Goal Completion"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Expected achievement rate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-purple-400 mb-2",children:[Math.round(((b=u.projected_outcomes)==null?void 0:b.risk_score)||7),"/10"]}),e.jsx("div",{className:"text-gray-300 font-medium",children:"Risk Score"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Portfolio risk level"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold mb-2 ${oi(u.success_rate)}`,children:[Math.round(ba(u.success_rate)),"%"]}),e.jsx("div",{className:"text-gray-300 font-medium",children:"Success Probability"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Monte Carlo result"})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-700",children:[e.jsxs("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-green-400"}),"Implementation Steps"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(u.required_changes||[]).map((m,p)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:p+1}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:(m.type||"general").replace("_"," ").toUpperCase()}),e.jsx("div",{className:"text-gray-300 text-sm",children:m.description}),m.amount&&e.jsxs("div",{className:"text-blue-400 text-sm font-medium mt-1",children:["Impact: ",xa(m.amount)]})]})]},p))})]}),e.jsxs("div",{className:"mt-6 flex gap-4",children:[e.jsxs($,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Apply This Scenario"]}),e.jsxs($,{variant:"outline",className:"text-gray-300 hover:text-white",children:[e.jsx(tt,{className:"w-4 h-4 mr-2"}),"Compare All Scenarios"]}),e.jsxs($,{variant:"outline",className:"text-gray-300 hover:text-white",children:[e.jsx(Dt,{className:"w-4 h-4 mr-2"}),"View Timeline Impact"]})]})]})}),e.jsx(_,{className:"bg-gradient-to-r from-yellow-900/20 to-orange-900/20 border-yellow-600",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(gs,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-yellow-100 font-semibold mb-1",children:"Scenario Performance Notes"}),e.jsx("p",{className:"text-yellow-200 text-sm",children:"Success rates are based on Monte Carlo simulations with 1,000 iterations. Scenarios consider market volatility, inflation, and your risk tolerance. Higher success rates may require more aggressive savings or longer timelines."})]})]})})})]})},Es=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),sr=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short"}),ci=s=>({retirement:"🏖️",real_estate:"🏠",education:"🎓",business:"🚀",emergency_fund:"🛡️",vacation:"🏝️",vehicle:"🚗",health:"💊",other:"💰"})[s]||"💰",yn=s=>{switch(s){case"completed":return"text-green-400 bg-green-400";case"on_track":return"text-blue-400 bg-blue-400";case"at_risk":return"text-yellow-400 bg-yellow-400";case"behind":return"text-red-400 bg-red-400";default:return"text-gray-400 bg-gray-400"}},di=s=>{switch(s){case"completed":return e.jsx(qe,{className:"w-4 h-4"});case"on_track":return e.jsx(De,{className:"w-4 h-4"});case"at_risk":case"behind":return e.jsx(Je,{className:"w-4 h-4"});default:return e.jsx(Dt,{className:"w-4 h-4"})}},Oc=({goal:s,isVisible:t})=>{const[a,r]=w.useState(!1),n=new Date().getFullYear(),l=new Date(s.target_date).getFullYear()-n,o=s.current_amount/s.target_amount*100;return t?e.jsxs("div",{className:"flex gap-6 pb-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${yn(s.status).split(" ")[1]} border-current`,children:e.jsx("div",{className:`w-2 h-2 rounded-full ${yn(s.status).split(" ")[1]} m-0.5`})}),e.jsx("div",{className:"w-0.5 bg-gray-600 flex-1 min-h-20"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(_,{className:`hover:border-blue-600 transition-colors ${s.status==="completed"?"bg-green-900/10":""}`,children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:ci(s.category)}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-white",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(ke,{variant:s.status==="completed"?"success":s.status==="on_track"?"info":s.status==="at_risk"?"warning":"error",size:"sm",children:[di(s.status),s.status.replace("_"," ").toUpperCase()]}),e.jsxs("span",{className:"text-sm text-gray-400",children:["Target: ",sr(s.target_date)]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Feasibility"}),e.jsxs("div",{className:`text-lg font-bold ${s.feasibility_score>=80?"text-green-400":s.feasibility_score>=60?"text-yellow-400":"text-red-400"}`,children:[Math.round(s.feasibility_score),"%"]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Es(s.current_amount)," / ",Es(s.target_amount)]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${s.status==="completed"?"bg-green-500":s.status==="on_track"?"bg-blue-500":s.status==="at_risk"?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(o,100)}%`}})}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[Math.round(o),"% complete"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Monthly Need"}),e.jsx("div",{className:"text-white font-semibold",children:Es(s.monthly_required)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Remaining"}),e.jsx("div",{className:"text-white font-semibold",children:Es(s.target_amount-s.current_amount)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Time Left"}),e.jsxs("div",{className:"text-white font-semibold",children:[l," year",l!==1?"s":""]})]})]}),s.milestones.length>0&&e.jsxs("div",{children:[e.jsxs($,{variant:"outline",size:"sm",onClick:()=>r(!a),className:"text-gray-300 hover:text-white",children:[a?e.jsx(In,{className:"w-3 h-3 mr-1"}):e.jsx(ns,{className:"w-3 h-3 mr-1"}),a?"Hide":"Show"," Milestones (",s.milestones.length,")"]}),a&&e.jsx("div",{className:"mt-3 space-y-2",children:s.milestones.map((c,u)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-700/50 rounded",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-300",children:c.description}),e.jsx("span",{className:"text-xs text-gray-400",children:sr(c.date)})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[Es(c.amount)," (",c.percentage,"%)"]})]})]},u))})]})]})})})]}):null},Bc=({timeline:s})=>{const[t,a]=w.useState(new Set),[r,n]=w.useState(new Set),i=[...new Set(s.goals.map(f=>f.category))],l=[...new Set(s.goals.map(f=>f.status))],c=[...s.goals].sort((f,d)=>new Date(f.target_date).getTime()-new Date(d.target_date).getTime()).filter(f=>{const d=t.size===0||t.has(f.category),x=r.size===0||r.has(f.status);return d&&x}),u=f=>{const d=new Set(t);d.has(f)?d.delete(f):d.add(f),a(d)},h=f=>{const d=new Set(r);d.has(f)?d.delete(f):d.add(f),n(d)};return s.goals.length===0?e.jsx(_,{className:"text-center py-12",children:e.jsxs(_.Body,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"📅"}),e.jsx("h3",{className:"text-2xl font-semibold text-white mb-4",children:"No Timeline Data"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Add some financial goals to see your personalized timeline."}),e.jsx($,{className:"bg-blue-600 hover:bg-blue-700",children:"Add Your First Goal"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-purple-900/20 to-blue-900/20 border-purple-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(It,{className:"w-8 h-8 text-purple-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-purple-100 mb-1",children:"Goal Achievement Timeline"}),e.jsx("p",{className:"text-purple-200",children:"Track progress and projected completion dates for all your financial goals."})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:s.goals.filter(f=>f.status==="completed").length}),e.jsx("div",{className:"text-xs text-gray-400",children:"Completed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:s.goals.filter(f=>f.status==="on_track").length}),e.jsx("div",{className:"text-xs text-gray-400",children:"On Track"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:s.goals.filter(f=>f.status==="at_risk").length}),e.jsx("div",{className:"text-xs text-gray-400",children:"At Risk"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:s.goals.filter(f=>f.status==="behind").length}),e.jsx("div",{className:"text-xs text-gray-400",children:"Behind"})]})]})]})}),e.jsx(_,{className:"bg-gray-800",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(En,{className:"w-5 h-5 text-gray-400"}),e.jsx("h4",{className:"font-semibold text-white",children:"Filters"}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>{a(new Set),n(new Set)},className:"ml-auto text-xs",children:"Clear All"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Categories:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(f=>e.jsxs("button",{onClick:()=>u(f),className:`
                      px-3 py-1 rounded-full text-xs font-medium border transition-colors
                      ${t.has(f)?"bg-blue-600 text-white border-blue-600":"bg-gray-700 text-gray-300 border-gray-600 hover:bg-gray-600"}
                    `,children:[ci(f)," ",f.replace("_"," ")]},f))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Status:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(f=>e.jsxs("button",{onClick:()=>h(f),className:`
                      px-3 py-1 rounded-full text-xs font-medium border transition-colors
                      ${r.has(f)?"bg-blue-600 text-white border-blue-600":"bg-gray-700 text-gray-300 border-gray-600 hover:bg-gray-600"}
                    `,children:[di(f)," ",f.replace("_"," ")]},f))})]})]})]})}),e.jsx(_,{className:"bg-gray-800",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-6 flex items-center gap-2",children:[e.jsx(Te,{className:"w-5 h-5 text-green-400"}),"Timeline View (",c.length," goals)"]}),c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:"🔍"}),e.jsx("p",{className:"text-gray-300",children:"No goals match your current filters."}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting your filter selection."})]}):e.jsxs("div",{className:"relative",children:[c.map((f,d)=>e.jsx(Oc,{goal:f,isVisible:!0},f.goal_id)),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-600"})}),e.jsx("div",{className:"text-sm text-gray-400 pb-4",children:"🎯 All goals timeline complete"})]})]})]})}),s.major_milestones.length>0&&e.jsx(_,{className:"bg-gradient-to-r from-indigo-900/20 to-purple-900/20 border-indigo-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5 text-indigo-400"}),"Major Milestones"]}),e.jsx("div",{className:"space-y-3",children:s.major_milestones.map((f,d)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"bg-indigo-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold flex-shrink-0",children:d+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-white font-medium",children:f.type.replace("_"," ").toUpperCase()}),e.jsx("span",{className:"text-sm text-gray-400",children:sr(f.date)})]}),e.jsx("p",{className:"text-gray-300 text-sm mb-2",children:f.description}),e.jsx("div",{className:"flex flex-wrap gap-1",children:f.goals_affected.map((x,b)=>{const m=s.goals.find(p=>p.goal_id===x);return e.jsx(ke,{variant:"secondary",size:"sm",children:m?m.name:x},b)})})]})]},d))})]})})]})},bn=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),zc=s=>{switch(s){case"immediate":return"from-red-900/30 to-orange-900/30 border-red-600";case"short_term":return"from-yellow-900/30 to-orange-900/30 border-yellow-600";case"long_term":return"from-blue-900/30 to-indigo-900/30 border-blue-600";default:return"from-gray-900/30 to-gray-800/30 border-gray-600"}},Uc=s=>{switch(s){case"immediate":return e.jsx(Nt,{className:"w-5 h-5 text-red-400"});case"short_term":return e.jsx(Dt,{className:"w-5 h-5 text-yellow-400"});case"long_term":return e.jsx(De,{className:"w-5 h-5 text-blue-400"});default:return e.jsx(zs,{className:"w-5 h-5 text-gray-400"})}},qc=s=>{switch(s){case"easy":return"text-green-400";case"moderate":return"text-yellow-400";case"hard":return"text-red-400";default:return"text-gray-400"}},Vc=s=>{switch(s){case"completed":return e.jsx(qe,{className:"w-4 h-4 text-green-400"});case"accepted":return e.jsx(zs,{className:"w-4 h-4 text-blue-400"});case"rejected":return e.jsx(Fn,{className:"w-4 h-4 text-red-400"});case"viewed":return e.jsx(ns,{className:"w-4 h-4 text-yellow-400"});default:return e.jsx(cl,{className:"w-4 h-4 text-gray-400"})}},Wc=({recommendation:s,onStatusChange:t})=>{var o,c,u,h,f;const[a,r]=w.useState(!1),[n,i]=w.useState(""),l=d=>{t(s.id,d,n)};return e.jsx(_,{className:`bg-gradient-to-r ${zc(s.type)} transition-all duration-300 hover:shadow-lg`,children:e.jsx(_.Body,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:Uc(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-1",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ke,{variant:s.priority==="high"?"error":s.priority==="medium"?"warning":"success",size:"sm",children:(s.priority||"medium").toUpperCase()}),e.jsx(ke,{variant:"secondary",size:"sm",children:(s.type||"general").replace("_"," ").toUpperCase()}),e.jsx(ke,{variant:"info",size:"sm",children:(s.category||"general").replace("_"," ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Vc(s.status),e.jsx("span",{className:"text-xs text-gray-400 capitalize",children:(s.status||"new").replace("_"," ")})]})]}),e.jsx("p",{className:"text-gray-300 text-sm mb-3",children:s.description}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Te,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-green-400",children:"Expected Impact"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-2",children:s.impact_description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-green-400 font-bold",children:["+",((o=s.projected_impact)==null?void 0:o.success_rate_improvement)||0,"%"]}),e.jsx("div",{className:"text-gray-400",children:"Success Rate"})]}),((c=s.projected_impact)==null?void 0:c.cost_reduction)&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-blue-400 font-bold",children:["-",bn(s.projected_impact.cost_reduction)]}),e.jsx("div",{className:"text-gray-400",children:"Cost Savings"})]}),((u=s.projected_impact)==null?void 0:u.time_saved)&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-yellow-400 font-bold",children:["-",s.projected_impact.time_saved,"mo"]}),e.jsx("div",{className:"text-gray-400",children:"Time Saved"})]}),((h=s.projected_impact)==null?void 0:h.additional_savings)&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-purple-400 font-bold",children:["+",bn(s.projected_impact.additional_savings)]}),e.jsx("div",{className:"text-gray-400",children:"Extra Savings"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(It,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-300",children:s.estimated_time})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(tt,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:qc(s.difficulty),children:s.difficulty})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(De,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-300",children:[((f=s.goals_affected)==null?void 0:f.length)||0," goals"]})]})]}),a&&e.jsxs("div",{className:"space-y-4",children:[s.prerequisites&&s.prerequisites.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Prerequisites:"}),e.jsx("ul",{className:"space-y-1 text-sm text-gray-400",children:(s.prerequisites||[]).map((d,x)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full mt-2 flex-shrink-0"}),d]},x))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Action Steps:"}),e.jsx("div",{className:"space-y-2",children:(s.action_steps||[]).map((d,x)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold flex-shrink-0",children:x+1}),e.jsx("div",{className:"text-sm text-gray-300 pt-0.5",children:d})]},x))})]}),s.status!=="new"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Notes (Optional):"}),e.jsx("textarea",{value:n,onChange:d=>i(d.target.value),className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white text-sm",rows:2,placeholder:"Add notes about your progress or thoughts..."})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[e.jsxs($,{onClick:()=>r(!a),variant:"outline",size:"sm",className:"text-gray-300 hover:text-white",children:[a?"Less Details":"More Details",e.jsx(Ki,{className:`w-3 h-3 ml-1 transition-transform ${a?"rotate-90":""}`})]}),s.status==="new"&&e.jsxs(e.Fragment,{children:[e.jsxs($,{onClick:()=>l("viewed"),variant:"outline",size:"sm",className:"text-blue-400 hover:text-white",children:[e.jsx(ns,{className:"w-3 h-3 mr-1"}),"Mark Viewed"]}),e.jsxs($,{onClick:()=>l("accepted"),size:"sm",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"Accept"]})]}),s.status==="viewed"&&e.jsxs(e.Fragment,{children:[e.jsxs($,{onClick:()=>l("accepted"),size:"sm",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"Accept"]}),e.jsxs($,{onClick:()=>l("rejected"),variant:"outline",size:"sm",className:"text-red-400 hover:text-white",children:[e.jsx(Fn,{className:"w-3 h-3 mr-1"}),"Reject"]})]}),s.status==="accepted"&&e.jsxs($,{onClick:()=>l("completed"),size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(zs,{className:"w-3 h-3 mr-1"}),"Mark Complete"]})]})]})]})})})},Gc=({recommendations:s})=>{const[t,a]=w.useState("all"),r=Fc(),n=[...s.immediate,...s.short_term,...s.long_term],i=t==="all"?n:n.filter(h=>h.type===t),l=async(h,f,d)=>{try{await r.mutateAsync({recommendation_id:h,action:f,notes:d})}catch(x){console.error("Failed to update recommendation status:",x)}},o=n.filter(h=>h.status==="completed").length,c=n.filter(h=>h.status==="accepted").length,u=n.filter(h=>["new","viewed"].includes(h.status)).length;return n.length===0?e.jsx(_,{className:"text-center py-12",children:e.jsxs(_.Body,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"✅"}),e.jsx("h3",{className:"text-2xl font-semibold text-white mb-4",children:"No Recommendations"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Great job! You're on track with your goals. Check back after running a new analysis."}),e.jsx($,{className:"bg-blue-600 hover:bg-blue-700",children:"Run New Analysis"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-green-900/20 to-blue-900/20 border-green-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(zs,{className:"w-8 h-8 text-green-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-green-100 mb-1",children:"Personalized Recommendations"}),e.jsx("p",{className:"text-green-200",children:"AI-powered suggestions to optimize your path to financial success."})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:o}),e.jsx("div",{className:"text-xs text-gray-400",children:"Completed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:c}),e.jsx("div",{className:"text-xs text-gray-400",children:"In Progress"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:u}),e.jsx("div",{className:"text-xs text-gray-400",children:"Pending"})]})]})]})}),e.jsx(_,{className:"bg-gray-800",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-white",children:"Filter by Timeline"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[i.length," recommendations"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","immediate","short_term","long_term"].map(h=>e.jsxs("button",{onClick:()=>a(h),className:`
                  px-4 py-2 rounded-lg font-medium text-sm transition-colors
                  ${t===h?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-white"}
                `,children:[h==="all"?"All":h.replace("_"," ").replace(/\b\w/g,f=>f.toUpperCase()),e.jsxs("span",{className:"ml-2 opacity-75",children:["(",h==="all"?n.length:n.filter(f=>f.type===h).length,")"]})]},h))})]})}),e.jsx("div",{className:"space-y-4",children:i.sort((h,f)=>{const d={high:3,medium:2,low:1},x=d[f.priority]-d[h.priority];if(x!==0)return x;const b={immediate:3,short_term:2,long_term:1},m=b[f.type]-b[h.type];return m!==0?m:f.projected_impact.success_rate_improvement-h.projected_impact.success_rate_improvement}).map(h=>e.jsx(Wc,{recommendation:h,onStatusChange:l},h.id))}),e.jsx(_,{className:"bg-gradient-to-r from-indigo-900/20 to-purple-900/20 border-indigo-600",children:e.jsxs(_.Body,{className:"p-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs($,{variant:"outline",size:"sm",className:"text-gray-300 hover:text-white",children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Accept All High Priority"]}),e.jsxs($,{variant:"outline",size:"sm",className:"text-gray-300 hover:text-white",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Show Cost-Benefit Analysis"]}),e.jsxs($,{variant:"outline",size:"sm",className:"text-gray-300 hover:text-white",children:[e.jsx(tt,{className:"w-4 h-4 mr-2"}),"Export Action Plan"]})]})]})})]})},Hc=({analysis:s,className:t=""})=>{const[a,r]=w.useState([]),[n,i]=w.useState(!1),[l,o]=w.useState(null),[c,u]=w.useState(!1),[h,f]=w.useState(null);w.useEffect(()=>{s&&d()},[s]);const d=async()=>{var g,S;i(!0);try{const T=x(s),v=[{kb_id:"PLAYBOOKS-922",title:"Retirement Planning Strategy",content:"Comprehensive retirement planning including 401(k) optimization, asset allocation by age, and catch-up contributions for 50+ individuals.",relevance_score:.95,category:"Investment Strategy",actionable_takeaway:"Review your current allocation and consider rebalancing",user_context:`Based on your ${b(((g=s.gaps)==null?void 0:g.current_trajectory)||0)} current portfolio`},{kb_id:"RESEARCH-808",title:"Portfolio Optimization Research",content:"Modern portfolio theory applications including risk-return optimization and factor-based investing for current market conditions.",relevance_score:.88,category:"Investment Research",actionable_takeaway:"Consider portfolio optimization based on modern research",user_context:`With ${(((S=s.gaps)==null?void 0:S.monthly_shortfall)||0)>0?"funding gap":"surplus"} monthly cash flow`},{kb_id:"REGULATIONS-59f",title:"Fiduciary Duty Guidelines",content:"Comprehensive guidelines on fiduciary responsibilities, including best interest standards and disclosure requirements for financial advisors.",relevance_score:.82,category:"Regulatory Compliance",actionable_takeaway:"Ensure all recommendations meet fiduciary standards",user_context:"Professional guidance backed by regulatory requirements"}];r(v)}catch(T){console.error("Failed to fetch contextual insights:",T),r([])}finally{i(!1)}},x=g=>{var T,v;const S=[];return(T=g==null?void 0:g.goals)!=null&&T.some(L=>L.category==="retirement")&&S.push("retirement planning asset allocation"),((v=g==null?void 0:g.gaps)==null?void 0:v.monthly_shortfall)>0&&S.push("cash flow optimization"),S.push("tax optimization","portfolio rebalancing"),S},b=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(g),m=g=>{switch(g.toLowerCase()){case"investment strategy":return"bg-blue-500";case"tax planning":return"bg-green-500";case"regulatory guidance":return"bg-purple-500";default:return"bg-gray-500"}},p=g=>{f(g),u(!0)},N=()=>{u(!1),f(null)};return n?e.jsx(_,{className:`border-blue-600 ${t}`,children:e.jsx(_.Body,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-center h-32",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-300",children:"Loading insights..."})]})})}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:`border-blue-600 hover:border-blue-500 transition-colors ${t}`,children:e.jsxs(_.Body,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sa,{className:"w-6 h-6 text-blue-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Professional Insights"})]}),e.jsxs(ke,{variant:"outline",className:"text-blue-400 border-blue-600",children:[a.length," Insights"]})]}),e.jsx("div",{className:"space-y-4",children:a.map((g,S)=>e.jsx("div",{className:"border border-gray-700 rounded-lg p-4 hover:border-gray-600 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${m(g.category)}`}),e.jsx("span",{className:"text-sm font-medium text-blue-400",children:g.kb_id}),e.jsx(ke,{size:"sm",className:"text-xs",children:g.category})]}),e.jsx("h4",{className:"font-semibold text-white mb-2",children:g.title}),e.jsx("p",{className:"text-gray-300 text-sm mb-3",children:g.content}),e.jsxs("div",{className:"bg-blue-900/20 border-l-4 border-blue-500 p-3 mb-3",children:[e.jsxs("p",{className:"text-blue-100 text-sm font-medium",children:["💡 ",g.actionable_takeaway]}),e.jsx("p",{className:"text-blue-200 text-xs mt-1",children:g.user_context})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Relevance"}),e.jsxs("div",{className:"text-sm font-bold text-green-400",children:[Math.round(g.relevance_score*100),"%"]})]}),e.jsxs($,{size:"sm",variant:"outline",onClick:()=>p(g.kb_id),className:"text-xs",children:[e.jsx(aa,{className:"w-3 h-3 mr-1"}),"View"]})]})]})},g.kb_id))}),a.length===0&&!n&&e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(sa,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No contextual insights available"}),e.jsx("p",{className:"text-sm",children:"Complete your financial analysis to see personalized recommendations"})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Insights powered by professional knowledge base"}),e.jsx($,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>{window.location.href="/advisory"},children:"View All Knowledge →"})]})})]})}),c&&h&&e.jsx(li,{citationId:h,onClose:N})]})},Yc=({onNext:s,className:t=""})=>{var g,S,T,v,L,P,z,C,j;const[a,r]=w.useState("overview"),[n,i]=w.useState(null),{data:l,isLoading:o,error:c,refetch:u}=Rc(),h=Pc(),f=ct(),d=E=>{r(E)},x=async()=>{await f.clear(),h.mutate({include_simulations:!0,scenario_count:3,optimization_level:"balanced"})};if(o||h.isPending)return e.jsx("div",{className:"min-h-screen bg-gray-900 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:"Analyzing your financial goals..."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Running Monte Carlo simulations and conflict detection"})]})})})});if(c||h.error){const E=(c==null?void 0:c.message)||((g=h.error)==null?void 0:g.message)||"Unknown error",A=E.includes("401")||E.includes("Unauthorized")||E.includes("authenticate");return e.jsx("div",{className:"min-h-screen bg-gray-900 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx(_,{className:"text-center py-8",children:e.jsxs(_.Body,{children:[e.jsx(Je,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Analysis Failed"}),e.jsx("p",{className:"text-gray-300 mb-6",children:A?"Authentication error. Please refresh the page and try again.":"Unable to analyze your goals. Please ensure you have completed Steps 2 and 3."}),A&&e.jsxs("p",{className:"text-sm text-gray-400 mb-6",children:["Error: ",E]}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsx($,{onClick:x,className:"bg-blue-600 hover:bg-blue-700",children:"Retry Analysis"}),!A&&e.jsx($,{variant:"outline",onClick:()=>window.location.href="/goals",children:"Check Goals Setup"}),A&&e.jsx($,{variant:"outline",onClick:()=>window.location.reload(),children:"Refresh Page"})]})]})})})})}if(!l)return e.jsx("div",{className:"min-h-screen bg-gray-900 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx(_,{className:"text-center py-12",children:e.jsxs(_.Body,{children:[e.jsx(De,{className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Analysis Available"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Run your first intelligence analysis to get personalized insights and recommendations."}),e.jsxs($,{onClick:x,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(pa,{className:"w-4 h-4 mr-2"}),"Run Intelligence Analysis"]})]})})})});const b=E=>E>=80?"Excellent probability - Goals are well-aligned":E>=60?"Good probability - Minor optimizations recommended":E>=40?"Moderate probability - Optimization recommended":"Challenging - Significant adjustments needed",m=E=>E>=70?"up":E>=50?"stable":"down",N=(E=>{var F,O,J,U,D;const A=((F=E.gaps)==null?void 0:F.monthly_shortfall)||0,y=E.success_probability?Math.round(E.success_probability*100):85,R=((O=E.conflicts)==null?void 0:O.length)===0?95:((J=E.conflicts)==null?void 0:J.length)===1?75:60,k=((D=(U=E.scenarios)==null?void 0:U.find(V=>V.is_recommended))==null?void 0:D.lifestyle_impact)*100||85;return{monthlyGap:A,successRate:y,riskAlign:Math.round(R),lifestyleFit:Math.round(k)}})(l);return e.jsx("div",{className:`min-h-screen bg-gray-900 py-8 ${t}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(tt,{className:"w-8 h-8 text-purple-500"}),"Intelligence Analysis"]}),e.jsx("p",{className:"text-gray-300 mt-1",children:"Comprehensive goal analysis and optimization recommendations"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs($,{variant:"outline",onClick:x,className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"}),"Refresh Analysis"]}),s&&e.jsx($,{onClick:s,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700",children:"Continue to Action Plan →"})]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Last updated: ",l.timestamp?new Date(l.timestamp).toLocaleString():"Now"]})]}),e.jsx("div",{className:"mb-8",children:e.jsx(yc,{score:l.overall_score||75,trend:m(l.overall_score||75),message:b(l.overall_score||75)})}),e.jsx("div",{className:"mb-8",children:e.jsx(bc,{monthlyGap:N.monthlyGap,successRate:N.successRate,riskAlign:N.riskAlign,lifestyleFit:N.lifestyleFit})}),e.jsx("div",{className:"mb-6",children:e.jsx(vc,{activeTab:a,onTabChange:d,conflictCount:((S=l.conflicts)==null?void 0:S.length)||0,scenarioCount:((T=l.scenarios)==null?void 0:T.length)||0,recommendationCount:(((L=(v=l.recommendations)==null?void 0:v.immediate)==null?void 0:L.length)||0)+(((z=(P=l.recommendations)==null?void 0:P.short_term)==null?void 0:z.length)||0)+(((j=(C=l.recommendations)==null?void 0:C.long_term)==null?void 0:j.length)||0)})}),a==="overview"&&e.jsx("div",{className:"mb-8",children:e.jsx(Hc,{analysis:l})}),e.jsxs("div",{className:"mb-8",children:[a==="overview"&&e.jsx(kc,{analysis:l}),a==="conflicts"&&e.jsx(Ec,{conflicts:l.conflicts||[]}),a==="scenarios"&&e.jsx(Dc,{scenarios:l.scenarios||[],onScenarioSelect:i}),a==="timeline"&&e.jsx(Bc,{timeline:{goals:(l.goals||[]).map(E=>({goal_id:E.goal_id,name:E.name,category:E.category,target_date:E.target_date,current_amount:E.current_amount,target_amount:E.target_amount,monthly_required:E.monthly_required,feasibility_score:E.feasibility_score,milestones:E.milestones||[],status:E.feasibility_score>=80?"on_track":E.feasibility_score>=60?"at_risk":"behind"})),major_milestones:[]}}),a==="recommendations"&&e.jsx(Gc,{recommendations:l.recommendations||{immediate:[],short_term:[],long_term:[]}})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs($,{variant:"outline",size:"sm",children:[e.jsx(xs,{className:"w-4 h-4 mr-2"}),"Share Analysis"]}),e.jsxs($,{variant:"outline",size:"sm",children:[e.jsx(It,{className:"w-4 h-4 mr-2"}),"Schedule Review"]})]}),s&&e.jsx($,{onClick:s,className:"bg-blue-600 hover:bg-blue-700",children:"Continue to Action Plan →"})]})]})})};class Ns{static getInstance(){return this.instance||(this.instance=new Ns),this.instance}constructor(){}async getCompleteFinancialProfile(t){var a,r;try{console.log(`🔍 Fetching complete financial profile for user ${t}`);const[n,i,l,o,c]=await Promise.all([this.fetchFinancialEntries(t),this.fetchLiveSummary(t),this.fetchCashFlow(t),this.fetchUserProfile(t),this.fetchGoals(t)]);console.log("✅ All data fetched successfully"),console.log("🔍 Building profile with entries:",n),console.log("🔍 Entries type:",typeof n),console.log("🔍 First asset in entries:",(r=(a=n==null?void 0:n.entries)==null?void 0:a.assets)==null?void 0:r[0]);const u={user:this.buildUserProfile(o),financials:this.buildFinancialPosition(n,i,l),goals:this.buildGoals(c),preferences:await this.buildPreferences(t),insights:this.calculateInsights(i,l,c)};return console.log("✅ Complete financial profile built:",{netWorth:u.financials.netWorth.total,monthlyIncome:u.financials.cashFlow.monthlyIncome,userName:u.user.name,goalCount:u.goals.length,assetsLength:u.financials.assets}),console.log("🔍 Final profile structure being returned:",{user:u.user,financials_keys:Object.keys(u.financials),assets_keys:Object.keys(u.financials.assets)}),u}catch(n){throw console.error("❌ Failed to fetch financial profile:",n),n instanceof Error&&n.message.includes("403")?new Error("Access denied. Please check your permissions."):n instanceof Error&&n.message.includes("404")?new Error("Financial data not found. Please add your financial information."):new Error("Unable to load financial data. Please try again or contact support.")}}async fetchFinancialEntries(t){var a,r;console.log(`📊 Fetching financial entries for user ${t}`);try{const n=await G.get(`/api/v1/financial/entries/${t}`);return console.log("🔍 API Response keys:",Object.keys(n)),console.log("🔍 Response.data type:",typeof n),console.log("🔍 Response structure:",n),n&&typeof n=="object"&&(console.log("📊 Complete response keys:",Object.keys(n)),n.entries&&(console.log("📊 Entries structure:",n.entries),console.log("📊 Assets in entries:",n.entries.assets),console.log("📊 First asset:",(a=n.entries.assets)==null?void 0:a[0]),console.log("📊 Asset keys:",Object.keys(((r=n.entries.assets)==null?void 0:r[0])||{}))),n.assets&&(console.log("📊 Direct assets structure:",n.assets),console.log("📊 Assets keys:",Object.keys(n.assets)),n.assets.real_estate&&console.log("📊 Real estate assets:",n.assets.real_estate),n.assets.retirement&&console.log("📊 Retirement assets:",n.assets.retirement)),n.summary&&console.log("📊 Summary in entries:",n.summary)),n}catch(n){throw console.error("❌ Failed to fetch entries:",n),n}}async fetchLiveSummary(t){return console.log(`💰 Fetching live summary for user ${t}`),await G.get(`/api/v1/financial/live-summary/${t}`)}async fetchCashFlow(t){return console.log(`💸 Fetching cash flow for user ${t}`),await G.get(`/api/v1/financial/cash-flow/${t}`)}async fetchUserProfile(t){return console.log(`👤 Fetching user profile for user ${t}`),await G.get(`/api/v1/users/${t}/profile`)}async fetchGoals(t){console.log(`🎯 Fetching goals for user ${t}`);try{return await G.get(`/api/v1/goals?user_id=${t}`)}catch{return console.warn("Goals endpoint failed, returning empty array"),[]}}buildUserProfile(t){return{id:t.id,name:t.name||`${t.first_name} ${t.last_name}`.trim(),email:t.email,age:t.age,location:t.location}}buildFinancialPosition(t,a,r){var u,h,f,d,x,b,m,p,N,g,S;console.log("🔍 Building financial position with:",{entries:t,summary:a,cashFlow:r}),console.log("🔍 Summary structure:",a),console.log("🔍 Summary keys:",Object.keys(a||{}));const n=(a==null?void 0:a.net_worth)||((u=t==null?void 0:t.summary)==null?void 0:u.net_worth)||0,i=((h=a==null?void 0:a.asset_breakdown)==null?void 0:h.liquid)||0,l=((f=a==null?void 0:a.asset_breakdown)==null?void 0:f.invested)||0,o=((d=a==null?void 0:a.asset_breakdown)==null?void 0:d.real_estate)||0,c=((x=a==null?void 0:a.asset_breakdown)==null?void 0:x.other)||0;return console.log("🔍 Calculated values:",{netWorthTotal:n,liquidAssets:i,investedAssets:l,realEstateAssets:o,otherAssets:c}),{netWorth:{total:n,liquid:i,invested:l,realEstate:o,other:c,lastUpdated:(a==null?void 0:a.calculation_time)||new Date().toISOString()},cashFlow:{monthlyIncome:(r==null?void 0:r.monthly_income)||((b=t==null?void 0:t.summary)==null?void 0:b.monthly_income)||0,monthlyExpenses:(r==null?void 0:r.monthly_expenses)||((m=t==null?void 0:t.summary)==null?void 0:m.monthly_expenses)||0,monthlySurplus:(r==null?void 0:r.monthly_surplus)||((p=t==null?void 0:t.summary)==null?void 0:p.cash_flow)||0,savingsRate:(r==null?void 0:r.savings_rate)||((N=t==null?void 0:t.summary)==null?void 0:N.savings_rate)||0,annualIncome:(r==null?void 0:r.annual_income)||(((g=t==null?void 0:t.summary)==null?void 0:g.monthly_income)||0)*12,annualExpenses:(r==null?void 0:r.annual_expenses)||(((S=t==null?void 0:t.summary)==null?void 0:S.monthly_expenses)||0)*12},assets:{realEstate:this.buildRealEstateAssets(t),retirement:this.buildRetirementAccounts(t),investment:this.buildInvestmentAccounts(t),crypto:this.buildCryptoHoldings(t),cash:this.buildCashAccounts(t)},liabilities:this.buildLiabilities(t)}}buildRealEstateAssets(t){var r,n;console.log("🏠 Building real estate assets from:",t);let a=[];return(r=t==null?void 0:t.assets)!=null&&r.real_estate?a=t.assets.real_estate:(n=t==null?void 0:t.entries)!=null&&n.assets&&(a=t.entries.assets.filter(i=>{var l,o;return i.subcategory==="real_estate"||((l=i.description)==null?void 0:l.toLowerCase().includes("property"))||((o=i.description)==null?void 0:o.toLowerCase().includes("home"))})),console.log("🏠 Real estate assets found:",a),a.map(i=>{var l;return{name:i.description,value:i.amount,mortgage:0,equity:i.amount,monthlyRental:(l=i.description)!=null&&l.toLowerCase().includes("rental")?2100:void 0}})}buildRetirementAccounts(t){var r,n;console.log("💰 Building retirement accounts from:",t);let a=[];return(r=t==null?void 0:t.assets)!=null&&r.retirement?a=t.assets.retirement:(n=t==null?void 0:t.entries)!=null&&n.assets&&(a=t.entries.assets.filter(i=>{var l,o;return i.subcategory==="retirement_accounts"||((l=i.description)==null?void 0:l.toLowerCase().includes("401"))||((o=i.description)==null?void 0:o.toLowerCase().includes("ira"))})),console.log("💰 Retirement assets found:",a),a.map(i=>({accountType:this.categorizeRetirementAccount(i.description),balance:i.amount,monthlyContribution:this.estimateContribution(i.description),allocation:this.getDefaultAllocation("retirement")}))}buildInvestmentAccounts(t){var r,n;console.log("📈 Building investment accounts from:",t);let a=[];return(r=t==null?void 0:t.assets)!=null&&r.investments?a=t.assets.investments:(n=t==null?void 0:t.entries)!=null&&n.assets&&(a=t.entries.assets.filter(i=>i.subcategory==="investment_accounts"||["robinhood","etrade","m1","mutual fund"].some(l=>{var o;return(o=i.description)==null?void 0:o.toLowerCase().includes(l)}))),console.log("📈 Investment assets found:",a),a.map(i=>({accountName:i.description,balance:i.amount,allocation:this.getDefaultAllocation("investment")}))}buildCryptoHoldings(t){var r;console.log("🪙 Building crypto holdings from:",t);let a=[];return t!=null&&t.assets?a=[...t.assets.investments||[],...t.assets.other||[]].filter(i=>{var l,o;return((l=i.description)==null?void 0:l.toLowerCase().includes("bitcoin"))||((o=i.description)==null?void 0:o.toLowerCase().includes("crypto"))}):(r=t==null?void 0:t.entries)!=null&&r.assets&&(a=t.entries.assets.filter(n=>{var i,l;return n.subcategory==="crypto"||((i=n.description)==null?void 0:i.toLowerCase().includes("bitcoin"))||((l=n.description)==null?void 0:l.toLowerCase().includes("crypto"))})),console.log("🪙 Crypto assets found:",a),a.map(n=>({coin:this.extractCoinName(n.description),amount:1,value:n.amount,costBasis:n.amount*.7}))}buildCashAccounts(t){var l,o;console.log("💵 Building cash accounts from:",t);let a=[];(l=t==null?void 0:t.assets)!=null&&l.other?a=t.assets.other.filter(c=>["checking","savings","money market","cash"].some(u=>{var h;return(h=c.description)==null?void 0:h.toLowerCase().includes(u)})):(o=t==null?void 0:t.entries)!=null&&o.assets&&(a=t.entries.assets.filter(c=>c.subcategory==="cash_bank_accounts"||["checking","savings","money market"].some(u=>{var h;return(h=c.description)==null?void 0:h.toLowerCase().includes(u)}))),console.log("💵 Cash assets found:",a);const r=a.filter(c=>{var u;return(u=c.description)==null?void 0:u.toLowerCase().includes("checking")}).reduce((c,u)=>c+u.amount,0),n=a.filter(c=>{var u;return(u=c.description)==null?void 0:u.toLowerCase().includes("savings")}).reduce((c,u)=>c+u.amount,0),i=a.reduce((c,u)=>c+u.amount,0);return{checking:r,savings:n,emergency:Math.min(n,25e3),total:i}}buildLiabilities(t){var r;console.log("📋 Building liabilities from:",t);let a=[];return t!=null&&t.liabilities?a=[...t.liabilities.mortgage||[],...t.liabilities.credit_cards||[],...t.liabilities.loans||[],...t.liabilities.other||[]]:(r=t==null?void 0:t.entries)!=null&&r.liabilities&&(a=t.entries.liabilities),console.log("📋 Liabilities found:",a),a.map(n=>({type:this.categorizeLiabilityType(n.description),balance:n.amount,rate:this.estimateInterestRate(n.description),payment:this.estimateMonthlyPayment(n.description,n.amount)}))}buildGoals(t){return t.map(a=>{const r=this.calculateYearsRemaining(a.target_date),n=r>0?(a.target_amount-a.current_amount)/(r*12):0;return{id:a.goal_id,name:a.name,category:a.category,targetAmount:a.target_amount,targetDate:a.target_date,currentAmount:a.current_amount,percentComplete:a.progress_percentage,monthlyRequired:n,yearsRemaining:r,onTrack:a.progress_percentage>=100-r/10*100}})}async buildPreferences(t){try{const a=await G.get(`/api/v1/preferences?user_id=${t}`);return{riskTolerance:a.risk_tolerance||5,riskToleranceLabel:this.mapRiskToleranceLabel(a.risk_tolerance||5),investmentTimeline:a.investment_timeline||20,emergencyFundMonths:a.emergency_fund_months||6,taxBracket:.24,stateTaxRate:.065,filingStatus:"married_filing_jointly"}}catch{return{riskTolerance:5,riskToleranceLabel:"moderate",investmentTimeline:20,emergencyFundMonths:6,taxBracket:.24,stateTaxRate:.065,filingStatus:"married_filing_jointly"}}}calculateInsights(t,a,r){const n=r.find(o=>o.category.toLowerCase().includes("retirement")),i=n?this.calculateYearsRemaining(n.target_date):11,l=n?n.progress_percentage:57;return{yearsToRetirement:i,retirementReadiness:l,taxOptimizationPotential:((a==null?void 0:a.annual_income)||0)*.05,rebalancingNeeded:!1,concentrationRisk:[],unusedTaxAdvantage:6e3}}categorizeRetirementAccount(t){const a=t.toLowerCase();return a.includes("401")?"401k":a.includes("roth")?"Roth IRA":a.includes("ira")?"IRA":a.includes("529")?"529 Plan":"Retirement"}estimateContribution(t){return t.toLowerCase().includes("401")?2400:t.toLowerCase().includes("ira")?500:0}getDefaultAllocation(t){return t==="retirement"?{stocks:70,bonds:20,cash:5,realEstate:5,alternatives:0}:{stocks:80,bonds:10,cash:5,realEstate:5,alternatives:0}}extractCoinName(t){return t.toLowerCase().includes("bitcoin")?"Bitcoin":t.toLowerCase().includes("ethereum")?"Ethereum":"Crypto"}categorizeLiabilityType(t){const a=t.toLowerCase();return a.includes("mortgage")||a.includes("home loan")?"Mortgage":a.includes("credit card")||a.includes("chase")?"Credit Card":a.includes("student")?"Student Loan":a.includes("auto")||a.includes("car")?"Auto Loan":"Personal Loan"}estimateInterestRate(t){const a=t.toLowerCase();return a.includes("mortgage")?.065:a.includes("credit card")?.18:a.includes("student")?.045:a.includes("auto")?.055:.08}estimateMonthlyPayment(t,a){const r=t.toLowerCase();return r.includes("mortgage")?2264:r.includes("credit card")?Math.max(a*.02,25):a*.01}calculateYearsRemaining(t){const a=new Date(t),r=new Date,i=(a.getTime()-r.getTime())/(1e3*60*60*24*365.25);return Math.max(0,i)}mapRiskToleranceLabel(t){return t<=3?"conservative":t<=7?"moderate":"aggressive"}}const Zc=Ns.getInstance();class Ma{static extractNumbers(t){let a=t.replace(/\$\d{1,3}(,\d{3})*(\.\d{2})?/g,"").replace(/\$\d+\.\d+/g,"");const r=/\b\d+\.?\d*\b/g;return(a.match(r)||[]).map(i=>parseFloat(i)).filter(i=>!isNaN(i)&&i>=1)}static auditNumbers(t,a){const r=JSON.stringify(t),n=JSON.stringify(a),i=this.extractNumbers(r),l=this.extractNumbers(n);console.log("🔍 Numbers validation:",{outputNumbers:i.slice(0,10),inputNumbers:l.slice(0,10)});const o=[Math.round(a.snapshot.asset_allocation_current.stocks/(a.snapshot.asset_allocation_current.stocks+a.snapshot.asset_allocation_current.bonds+a.snapshot.asset_allocation_current.cash)*100),Math.abs(a.computed.surplus_minus_required),a.client.age,a.client.tax_bracket_est*100,1,2,3,4,5,10,15,20,25,30,50,100,401,403,529],c=i.filter(u=>!l.includes(u)&&!o.includes(u));return c.length>0?(console.warn("🚨 Unauthorized numbers:",c),{valid:!1,error:`Unauthorized numbers found: ${c.slice(0,5).join(", ")}${c.length>5?"...":""}`,fix:"Use only numbers from plan_inputs"}):{valid:!0}}static auditCitations(t,a){const i=(()=>{var o,c;const l=[];return t.priority_actions_30d&&Array.isArray(t.priority_actions_30d)&&t.priority_actions_30d.forEach(u=>{u.exact_refs&&Array.isArray(u.exact_refs)&&l.push(...u.exact_refs)}),(o=t.risk_management)!=null&&o.citations&&Array.isArray(t.risk_management.citations)&&l.push(...t.risk_management.citations),(c=t.tax_considerations)!=null&&c.citations&&Array.isArray(t.tax_considerations.citations)&&l.push(...t.tax_considerations.citations),l})().filter(l=>!a.includes(l));return i.length>0?{valid:!1,error:`Invalid citations: ${i.join(", ")}`,fix:"Use only KB context IDs provided"}:{valid:!0}}static auditBusinessRules(t,a){const r=[],n=a.cashflow.debts.filter(o=>o.type==="credit_card").reduce((o,c)=>o+c.balance,0);return n>0&&n<5e3&&(t.priority_actions_30d.some(c=>c.title.toLowerCase().includes("pay off")||c.title.toLowerCase().includes("credit card"))||r.push({valid:!1,error:"Credit card debt < $5000 should recommend immediate payoff",fix:"Add credit card payoff to priority_actions_30d"})),a.snapshot.net_worth/a.cashflow.expenses_monthly<a.constraints.min_cash_buffer_months&&(t.executive_summary.status_flags.stabilize_first||r.push({valid:!1,error:"Insufficient emergency fund not flagged",fix:"Set stabilize_first flag to true"})),a.plan_outputs.monte_carlo.success_prob<.7&&(t.executive_summary.status_flags.stabilize_first||r.push({valid:!1,error:"Low success probability should trigger stabilization",fix:"Set stabilize_first flag to true when success < 70%"})),r.find(o=>!o.valid)||{valid:!0}}static auditCompliance(t,a){return a.constraints.compliance_mode==="advice"&&!t.disclaimer.toLowerCase().includes("specific recommendations")?{valid:!1,error:"Advisory disclaimer missing",fix:'Include "specific recommendations" in disclaimer'}:{valid:!0}}}class vr{static getInstance(){return this.instance||(this.instance=new vr),this.instance}async buildPlanInputs(t){var f,d,x,b,m,p,N,g,S,T,v,L,P,z,C,j,E,A,y,R,k,F,O,J,U,D,V,he,ye,Ie,de,Oe,Fe;const r=await Ns.getInstance().getCompleteFinancialProfile(t);console.log("🔍 DEBUG: Full profile structure received:",r),console.log("🔍 DEBUG: Profile keys:",Object.keys(r)),console.log("🔍 DEBUG: Does profile have entries?","entries"in r),console.log("🔍 DEBUG: Profile.entries:",r.entries),console.log("🔍 DEBUG: Profile.financials:",r.financials),console.log("🔍 DEBUG: Profile.financials?.assets:",(f=r.financials)==null?void 0:f.assets);const n=this.extractDebts(r),i=n.filter(se=>se.type==="credit_card").reduce((se,ve)=>se+ve.balance,0),l=((d=r.goals)==null?void 0:d.reduce((se,ve)=>se+(ve.monthlyRequired||0),0))||12060;console.log("📊 Building plan inputs with:",{userName:(x=r.user)==null?void 0:x.name,netWorth:(m=(b=r.financials)==null?void 0:b.netWorth)==null?void 0:m.total,monthlyIncome:(N=(p=r.financials)==null?void 0:p.cashFlow)==null?void 0:N.monthlyIncome,monthlyExpenses:(S=(g=r.financials)==null?void 0:g.cashFlow)==null?void 0:S.monthlyExpenses,monthlySurplus:(v=(T=r.financials)==null?void 0:T.cashFlow)==null?void 0:v.monthlySurplus,requiredMonthly:l}),console.log("🔍 About to call calculateActualAllocation with profile...");let o=[],c=[];const u=(L=r.financials)==null?void 0:L.assets;u&&typeof u=="object"?(console.log("🔍 DEBUG: Using financials.assets structure (SAME as calculateActualAllocation)"),u.realEstate&&Array.isArray(u.realEstate)&&(console.log("📍 Adding real estate assets:",u.realEstate.length),o.push(...u.realEstate)),u.retirement&&Array.isArray(u.retirement)&&(console.log("📍 Adding retirement assets:",u.retirement.length),o.push(...u.retirement)),u.investment&&Array.isArray(u.investment)&&(console.log("📍 Adding investment assets:",u.investment.length),o.push(...u.investment)),u.crypto&&Array.isArray(u.crypto)&&(console.log("📍 Adding crypto assets:",u.crypto.length),o.push(...u.crypto)),u.cash&&typeof u.cash=="object"&&(console.log("📍 Adding cash accounts:",typeof u.cash),Object.entries(u.cash).forEach(([se,ve])=>{typeof ve=="number"&&ve>0&&se!=="total"&&o.push({description:se,amount:ve,category:"cash"})})),c=((P=r.financials)==null?void 0:P.liabilities)||[]):(console.log("⚠️ No financials.assets found, using fallback"),c=[]),console.log("🔍 DEBUG: profile.entries structure:",r.entries),console.log("🔍 DEBUG: assets array:",o),console.log("🔍 DEBUG: liabilities array:",c);const h={specific_assets:o.map(se=>{let ve=se.description||se.name||se.accountName||se.accountType||se.coin||se.type||"Asset";return ve&&typeof ve=="string"&&(ve=ve.split(" ").map(ie=>ie.charAt(0).toUpperCase()+ie.slice(1).toLowerCase()).join(" ")),{name:ve,amount:se.amount||se.value||se.balance||0,category:se.subcategory||se.category||se.type||"unknown"}}),specific_debts:c.map(se=>({name:se.description||se.name||"Debt",balance:se.amount||0,rate:se.interest_rate||.18})),account_details:{checking:((z=o.find(se=>(se.description||"").toLowerCase().includes("checking")))==null?void 0:z.amount)||0,savings:((C=o.find(se=>(se.description||"").toLowerCase().includes("savings")))==null?void 0:C.amount)||0,etrade:((j=o.find(se=>{const ve=(se.description||"").toLowerCase();return ve==="etrade"||ve.includes("etrade")}))==null?void 0:j.amount)||0,robinhood:((E=o.find(se=>{const ve=(se.description||"").toLowerCase();return ve==="robinhood"||ve.includes("robinhood")}))==null?void 0:E.amount)||0,bitcoin:((A=o.find(se=>{const ve=(se.description||"").toLowerCase();return ve==="bitcoin"||ve.includes("bitcoin")}))==null?void 0:A.amount)||0,retirement_401k:((y=o.find(se=>{const ve=(se.description||"").toLowerCase();return ve==="401k"||ve.includes("401k")||ve.includes("401")}))==null?void 0:y.amount)||0}};return console.log("🔍 DEBUG: raw_details built:",h),console.log("🔍 DEBUG: account_details:",h.account_details),console.log("🔍 DEBUG: First 3 specific_assets:",h.specific_assets.slice(0,3)),console.log("🔍 DEBUG: Sample asset structure:",o[0]),console.log("🔍 DEBUG: All asset descriptions:",o.map(se=>({desc:se.description,amount:se.amount,allFields:Object.keys(se),fullObject:se}))),console.log("🔍 DEBUG: Sample asset fields:",o[4]),{client:{name:((R=r.user)==null?void 0:R.name)||"Client",age:((k=r.user)==null?void 0:k.age)||54,risk_band:this.mapRiskTolerance(((F=r.preferences)==null?void 0:F.riskTolerance)||5),tax_bracket_est:((O=r.preferences)==null?void 0:O.taxBracket)||.24},snapshot:{net_worth:((U=(J=r.financials)==null?void 0:J.netWorth)==null?void 0:U.total)||0,monthly_surplus:((V=(D=r.financials)==null?void 0:D.cashFlow)==null?void 0:V.monthlySurplus)||0,asset_allocation_current:this.calculateActualAllocation(r)},goals:(r.goals||[]).map(se=>({id:se.id||"goal-1",name:se.name||"Financial Goal",target:se.targetAmount||0,deadline:se.targetDate||"2030-01-01",required_monthly:se.monthlyRequired||0,funded_pct:se.percentComplete||0})),cashflow:{income_monthly:((ye=(he=r.financials)==null?void 0:he.cashFlow)==null?void 0:ye.monthlyIncome)||0,expenses_monthly:((de=(Ie=r.financials)==null?void 0:Ie.cashFlow)==null?void 0:de.monthlyExpenses)||0,debts:n},plan_outputs:{asset_allocation_target:{stocks:70,bonds:20,cash:10},rebalancing_trades:[],contribution_plan:[{account:"401k",monthly:2400,max_allowed:2291}],debt_actions:i<5e3?[{debt:"credit_cards",extra_payment_monthly:Math.min(i,r.financials.cashFlow.monthlySurplus*.5)}]:[],monte_carlo:{success_prob:.887,note:"Based on 10,000 simulations"}},computed:{required_contrib_total_monthly:l,surplus_minus_required:(((Fe=(Oe=r.financials)==null?void 0:Oe.cashFlow)==null?void 0:Fe.monthlySurplus)||0)-l},constraints:{min_cash_buffer_months:6,compliance_mode:"advice"},kb_context:[{id:"KB-001",title:"Asset Allocation by Age"},{id:"KB-002",title:"Tax-Advantaged Accounts"},{id:"IRS-001",title:"401k Contribution Limits"},{id:"IRS-002",title:"HSA Contribution Limits"},{id:"KB-003",title:"Emergency Fund Guidelines"},{id:"KB-004",title:"Debt Payoff Strategies"}],raw_details:h}}async generateAdvisory(t,a="openai"){console.log(`🎯 Starting deterministic advisory generation with ${a.toUpperCase()}...`);const r=await this.buildPlanInputs(t),n=3;let i=0,l=null,o=null;for(console.log("📊 Plan inputs prepared:",{clientName:r.client.name,netWorth:r.snapshot.net_worth,monthlySurplus:r.snapshot.monthly_surplus,requiredMonthly:r.computed.required_contrib_total_monthly,debtCount:r.cashflow.debts.length,goalCount:r.goals.length});i<n;){i++,console.log(`🔄 Attempt ${i}/${n} with ${a.toUpperCase()}`);try{const c=await this.callLLMProviderSpecific(r,a,o==null?void 0:o.errors),u=this.cleanJSONResponse(c);console.log("🧹 Cleaned response length:",u.length);const h=JSON.parse(u);h&&typeof h=="object"&&h.executive_summary&&(l=h,console.log("✅ Valid JSON structure found"));const d=[Ma.auditCitations(h,r.kb_context.map(b=>b.id)),Ma.auditBusinessRules(h,r),Ma.auditCompliance(h,r)].filter(b=>!b.valid);if(o={errors:d},d.length===0)return console.log("✅ All validations passed!"),h;if(console.warn(`❌ ${d.length} validation failures:`),d.forEach((b,m)=>{console.warn(`  ${m+1}. ${b.error}`),console.warn(`     Fix: ${b.fix}`)}),d.filter(b=>{var m,p,N;return((m=b.error)==null?void 0:m.includes("Unauthorized numbers"))||((p=b.error)==null?void 0:p.includes("Invalid citations"))||((N=b.error)==null?void 0:N.includes("Educational disclaimer missing"))}).length===0)return console.log("⚠️ Only minor validation issues, accepting advisory"),h;console.warn(`❌ ${d.length} validation failures - retrying with corrections:`,d)}catch(c){console.error(`Attempt ${i} failed:`,c),i===n-1&&a!=="openai"&&(console.log("🔄 Switching to OpenAI for final attempt..."),a="openai")}}return l?(console.warn("⚠️ Using last valid advisory despite validation issues"),l):(console.log("🚨 All attempts failed, trying simplified advisory..."),await this.generateSimplifiedAdvisory(r))}buildPrompt(t){var a,r,n;return`You are a fiduciary financial planner providing SPECIFIC, ACTIONABLE insights. 
NO GENERIC ADVICE. Analyze the actual data and provide concrete recommendations.

ASSET ALLOCATION ANALYSIS:
Real Estate: $${((a=t.snapshot.asset_allocation_current.real_estate)==null?void 0:a.toLocaleString())||"0"} (${Math.round((t.snapshot.asset_allocation_current.real_estate||0)/t.snapshot.net_worth*100)}%)
Stocks: $${((r=t.snapshot.asset_allocation_current.stocks)==null?void 0:r.toLocaleString())||"0"} (${Math.round((t.snapshot.asset_allocation_current.stocks||0)/t.snapshot.net_worth*100)}%)
Cash: $${((n=t.snapshot.asset_allocation_current.cash)==null?void 0:n.toLocaleString())||"0"} (${Math.round((t.snapshot.asset_allocation_current.cash||0)/t.snapshot.net_worth*100)}%)

FINANCIAL POSITION:
- Net Worth: $${t.snapshot.net_worth.toLocaleString()}
- Monthly Surplus: $${t.snapshot.monthly_surplus.toLocaleString()}
- Monthly Funding Gap: $${Math.abs(t.computed.surplus_minus_required).toLocaleString()}

PROVIDE SPECIFIC INSIGHTS LIKE:
- "52% real estate is overconcentrated - reduce to 30% by selling $XXX"
- "4% cash is too low - increase to 6 months expenses ($XXX)"
- "Use your $10,620 surplus to close the $1,929 gap and invest remaining $8,691"

plan_inputs:
${JSON.stringify(t,null,2)}

Generate the financial advisory as valid JSON matching this exact schema:
{
  "executive_summary": {
    "overview": "2-3 sentences about ${t.client.name}'s current financial position and outlook",
    "key_metrics": {
      "net_worth": ${t.snapshot.net_worth},
      "monthly_surplus": ${t.snapshot.monthly_surplus},
      "required_contrib_total_monthly": ${t.computed.required_contrib_total_monthly},
      "surplus_gap_monthly": ${Math.abs(t.computed.surplus_minus_required)}
    },
    "status_flags": {
      "on_track": ${t.computed.surplus_minus_required>=0},
      "stabilize_first": ${t.snapshot.net_worth/t.cashflow.expenses_monthly<t.constraints.min_cash_buffer_months||t.plan_outputs.monte_carlo.success_prob<.7}
    }
  },
  "priority_actions_30d": [
    {
      "title": "Action title based on client's specific situation",
      "why_it_matters": "Explanation specific to ${t.client.name}",
      "exact_refs": ["KB-xxx", "IRS-xxx"]
    }
  ],
  "strategy_12m": [
    { "quarter": "Q1", "actions": ["Specific action for Q1"] },
    { "quarter": "Q2", "actions": ["Specific action for Q2"] },
    { "quarter": "Q3", "actions": ["Specific action for Q3"] },
    { "quarter": "Q4", "actions": ["Specific action for Q4"] }
  ],
  "risk_management": {
    "top_risks": ["Risk specific to ${t.client.name}'s situation"],
    "mitigations": ["Specific mitigation strategy"],
    "citations": ["KB-001"]
  },
  "tax_considerations": {
    "ideas": ["Tax strategy specific to ${t.client.tax_bracket_est*100}% bracket"],
    "citations": ["IRS-001", "IRS-002"]
  },
  "disclaimer": "This financial advisory report provides specific recommendations based on your current financial situation. Please consult with a qualified financial advisor before implementing any recommendations."
}

CRITICAL RULES:
1. Use ONLY these exact numbers: ${t.snapshot.net_worth}, ${t.snapshot.monthly_surplus}, ${t.computed.required_contrib_total_monthly}
2. If credit card debt < $5000 (${t.cashflow.debts.filter(i=>i.type==="credit_card").reduce((i,l)=>i+l.balance,0)}), recommend "pay off immediately"
3. All citations must be from this list: ${t.kb_context.map(i=>i.id).join(", ")}
4. Include educational disclaimer
5. Return ONLY valid JSON, no other text`}buildErrorPrompt(t,a){return a.snapshot.net_worth,a.snapshot.monthly_surplus,a.computed.required_contrib_total_monthly,Math.abs(a.computed.surplus_minus_required),`CRITICAL: Your previous JSON response failed validation. Fix these specific issues:

${t.map(r=>`❌ ERROR: ${r.error}
✅ FIX: ${r.fix}`).join(`

`)}

VALIDATION RULES:
1. Use ONLY these exact numbers (no calculations, no decimals beyond input precision):
   - net_worth: ${a.snapshot.net_worth}
   - monthly_surplus: ${a.snapshot.monthly_surplus}  
   - required_contrib_total_monthly: ${a.computed.required_contrib_total_monthly}
   - surplus_gap_monthly: ${Math.abs(a.computed.surplus_minus_required)}

2. Valid citation IDs ONLY: ${a.kb_context.map(r=>r.id).join(", ")}

3. ${a.cashflow.debts.filter(r=>r.type==="credit_card").reduce((r,n)=>r+n.balance,0)<5e3?"REQUIRED: Must include credit card payoff in priority_actions_30d":"Credit card debt rule does not apply"}

4. Required disclaimer: "This financial advisory report provides specific recommendations"

RESPOND WITH CORRECTED JSON ONLY. NO other text.`}cleanJSONResponse(t){if(!t)return"{}";console.log("🔍 Original response length:",t.length),console.log("🔍 First 100 chars of original response:",t.substring(0,100));let a=t.replace(/```json\s*/gi,"").replace(/```\s*$/g,"").trim();if(a.startsWith("##")||a.startsWith("#"))throw new Error("Response is markdown format, not JSON. Retrying...");if(!a.startsWith("{")&&!a.startsWith("[")){const r=a.indexOf("{"),n=a.lastIndexOf("}");if(r!==-1&&n!==-1&&n>r)a=a.substring(r,n+1);else throw new Error("No valid JSON found in response. Retrying...")}console.log("🧹 Cleaned response length:",a.length),console.log("🔍 First 100 chars of cleaned response:",a.substring(0,100));try{return JSON.parse(a),a}catch(r){throw new Error(`Cleaned response is not valid JSON: ${r}. Retrying...`)}}async callLLMProviderSpecific(t,a,r){var f,d,x,b,m,p,N,g,S,T,v,L,P,z,C,j,E,A,y,R;console.log(`🎯 Calling ${a.toUpperCase()} with JSON mode...`);const n=`You are a professional financial advisor writing a comprehensive, detailed advisory report. Write in a conversational, informative style that provides deep analysis and practical guidance based on the client's specific financial data.

Return this EXACT JSON structure with DETAILED, free-flowing content:
{
  "executive_summary": {
    "overview": "Write 4-6 detailed sentences analyzing ${t.client.name}'s complete financial picture, including specific numbers, asset concentrations, cash flow challenges, and overall assessment. Be specific about their $${t.snapshot.net_worth} net worth, monthly gap, and key financial characteristics.",
    "key_metrics": {
      "net_worth": ${t.snapshot.net_worth},
      "monthly_surplus": ${t.snapshot.monthly_surplus},
      "required_contrib_total_monthly": ${t.computed.required_contrib_total_monthly},
      "surplus_gap_monthly": ${Math.abs(t.computed.surplus_minus_required)}
    },
    "status_flags": {
      "on_track": ${t.computed.surplus_minus_required>=0},
      "stabilize_first": ${t.snapshot.net_worth/t.cashflow.expenses_monthly<t.constraints.min_cash_buffer_months}
    }
  },
  "priority_actions_30d": [
    {
      "title": "Specific actionable recommendation with exact amounts",
      "why_it_matters": "Write 3-4 detailed sentences explaining the reasoning, impact, specific dollar amounts, and why this is urgent for ${t.client.name}. Include calculations and projections.",
      "exact_refs": ["KB-001"]
    }
  ],
  "strategy_12m": [
    {"quarter": "Q1", "actions": ["Write a detailed paragraph explaining specific actions, amounts, and reasoning for Q1. Keep as single array element."]},
    {"quarter": "Q2", "actions": ["Write a detailed paragraph explaining specific actions, amounts, and reasoning for Q2. Keep as single array element."]},
    {"quarter": "Q3", "actions": ["Write a detailed paragraph explaining specific actions, amounts, and reasoning for Q3. Keep as single array element."]},
    {"quarter": "Q4", "actions": ["Write a detailed paragraph explaining specific actions, amounts, and reasoning for Q4. Keep as single array element."]}
  ],
  "risk_management": {
    "top_risks": ["Write detailed risk assessments specific to ${t.client.name}'s situation with potential dollar impacts"],
    "mitigations": ["Write comprehensive mitigation strategies with specific steps and expected outcomes"],
    "citations": ["KB-001"]
  },
  "tax_considerations": {
    "ideas": ["Write detailed tax strategies with specific dollar amounts, timing, and expected savings for ${t.client.name}"],
    "citations": ["IRS-001"]
  },
  "disclaimer": "This financial advisory report provides specific recommendations based on your current financial situation. Please consult with a qualified financial advisor before implementing any recommendations."
}

Write conversational, detailed content with substantial information, analysis, and specific guidance.

${r?`PREVIOUS ERRORS TO FIX:
${r.map(k=>`- ${k.error}: ${k.fix}`).join(`
`)}`:""}`,i=((f=t.raw_details)==null?void 0:f.specific_debts)||[],l=((d=t.raw_details)==null?void 0:d.specific_assets)||[];console.log("🔍 DEBUG: LLM Input - debts:",i),console.log("🔍 DEBUG: LLM Input - assets:",l),console.log("🔍 DEBUG: LLM Input - account_details:",(x=t.raw_details)==null?void 0:x.account_details),console.log("🔍 DEBUG: LLM Input - specific_assets:",(b=t.raw_details)==null?void 0:b.specific_assets),console.log("🔍 DEBUG: LLM Input - specific_debts:",(m=t.raw_details)==null?void 0:m.specific_debts);const o=`Write a comprehensive, detailed financial advisory report for:

CLIENT: ${t.client.name}, Age ${t.client.age}
NET WORTH: $${t.snapshot.net_worth.toLocaleString()}

FINANCIAL SITUATION:
- Monthly Income: $${t.cashflow.income_monthly.toLocaleString()}
- Monthly Expenses: $${t.cashflow.expenses_monthly.toLocaleString()}
- Monthly Surplus: $${t.snapshot.monthly_surplus.toLocaleString()}
- Required Monthly for Goals: $${t.computed.required_contrib_total_monthly.toLocaleString()}
- Goal Funding Gap: $${Math.abs(t.computed.surplus_minus_required).toLocaleString()}

DEBTS:
${i.map(k=>`- ${k.name}: $${k.balance.toLocaleString()}`).join(`
`)}

ASSETS:
${l.slice(0,10).map(k=>`- ${k.name}: $${k.amount.toLocaleString()}`).join(`
`)}

ACCOUNT DETAILS:
- Checking: $${((g=(N=(p=t.raw_details)==null?void 0:p.account_details)==null?void 0:N.checking)==null?void 0:g.toLocaleString())||"0"}
- 401k: $${((v=(T=(S=t.raw_details)==null?void 0:S.account_details)==null?void 0:T.retirement_401k)==null?void 0:v.toLocaleString())||"0"}
- ETrade: $${((z=(P=(L=t.raw_details)==null?void 0:L.account_details)==null?void 0:P.etrade)==null?void 0:z.toLocaleString())||"0"}
- Robinhood: $${((E=(j=(C=t.raw_details)==null?void 0:C.account_details)==null?void 0:j.robinhood)==null?void 0:E.toLocaleString())||"0"}
- Bitcoin: $${((R=(y=(A=t.raw_details)==null?void 0:A.account_details)==null?void 0:y.bitcoin)==null?void 0:R.toLocaleString())||"0"}

WRITING REQUIREMENTS:
1. Write in flowing, conversational paragraphs
2. Reference specific accounts and exact dollar amounts
3. Provide detailed reasoning and calculations
4. Explain the rationale behind each recommendation
5. Include specific timelines and expected outcomes
6. Make recommendations actionable with concrete steps

CONTENT DEPTH REQUIREMENTS:
- Executive Summary: 4-6 sentences with comprehensive analysis
- Each Priority Action: 3-4 detailed sentences explaining impact and urgency
- Quarterly Strategy: Write detailed paragraphs but keep each as a SINGLE array element
- Risk Management: Detailed assessments with dollar impact projections
- Tax Considerations: Specific strategies with savings calculations

CRITICAL JSON FORMAT:
- strategy_12m actions MUST be arrays: {"quarter": "Q1", "actions": ["single detailed paragraph here"]}
- priority_actions_30d MUST be arrays with multiple objects
- All text fields should contain detailed, flowing content

Citations must use: KB-001, KB-002, KB-003, KB-004, IRS-001, IRS-002

Write a substantive, informative advisory that provides real value and actionable insights.`;console.log("🎯 Full prompt to LLM:",o);const c={provider:a,model_tier:"dev",system_prompt:n,user_prompt:o,max_tokens:4e3,temperature:.1,context_data:{net_worth:t.snapshot.net_worth,monthly_surplus:t.snapshot.monthly_surplus,required_monthly:t.computed.required_contrib_total_monthly}};a==="openai"&&(c.metadata={response_format:{type:"json_object"},model:"gpt-4-turbo-preview"});const u=await fetch(`${et()}/api/v1/llm/generate`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify(c)});if(!u.ok){const k=await u.text();throw console.error("API Error Response:",k),new Error(`LLM API failed: ${u.status} ${u.statusText} - ${k}`)}const h=await u.json();return console.log("🔍 LLM API Response:",h),h.content||""}async callLLM(t){var i;const a={user_profile:{name:"Test Client",age:45,location:"United States"},financial_summary:{net_worth:5e5,monthly_income:8e3,monthly_expenses:5e3},deterministic_prompt:t},r=await fetch(`${et()}/api/v1/llm/advisory/generate`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({step4_data:a,generation_type:"summary",provider_preferences:["openai"],enable_comparison:!1,model_tier:"dev",temperature:.1,model:"gpt-3.5-turbo",custom_prompts:{system_prompt:`CRITICAL: You MUST respond with ONLY valid JSON. NO markdown, NO explanations, NO code blocks.

You are a fiduciary financial planner API endpoint. Return ONLY a JSON object that matches the exact structure requested.

FORBIDDEN:
- Markdown headers (##)
- Code blocks (\`\`\`)
- Explanatory text
- Multiple response formats

REQUIRED:
- Start response with {
- End response with }
- Valid JSON only
- Follow validation rules strictly`,user_prompt:t}})});if(!r.ok){const l=await r.text();throw console.error("API Error Response:",l),new Error(`LLM API failed: ${r.status} ${r.statusText} - ${l}`)}const n=await r.json();return console.log("🔍 LLM API Response:",n),n.content||((i=n.llm_response)==null?void 0:i.content)||""}async generateSimplifiedAdvisory(t){console.log("🔧 Generating simplified advisory as fallback...");const a=t.cashflow.debts.filter(r=>r.type==="credit_card").reduce((r,n)=>r+n.balance,0);return{executive_summary:{overview:`${t.client.name} has a net worth of $${t.snapshot.net_worth.toLocaleString()} with a monthly surplus of $${t.snapshot.monthly_surplus.toLocaleString()}. Based on the financial analysis, there are key opportunities to optimize the financial plan.`,key_metrics:{net_worth:t.snapshot.net_worth,monthly_surplus:t.snapshot.monthly_surplus,required_contrib_total_monthly:t.computed.required_contrib_total_monthly,surplus_gap_monthly:Math.abs(t.computed.surplus_minus_required)},status_flags:{on_track:t.computed.surplus_minus_required>=0,stabilize_first:t.snapshot.net_worth/t.cashflow.expenses_monthly<t.constraints.min_cash_buffer_months}},priority_actions_30d:[...a>0&&a<5e3?[{title:"Pay off credit card debt immediately",why_it_matters:`With $${a.toLocaleString()} in credit card debt, paying this off will free up monthly cash flow and eliminate high-interest charges.`,exact_refs:["KB-004"]}]:[],{title:"Maximize 401k contributions",why_it_matters:"Increasing tax-advantaged retirement savings will provide immediate tax benefits and long-term growth.",exact_refs:["IRS-001"]},{title:"Rebalance investment portfolio",why_it_matters:"Optimizing asset allocation will align investments with risk tolerance and time horizon.",exact_refs:["KB-001"]}],strategy_12m:[{quarter:"Q1",actions:["Complete debt payoff","Increase retirement contributions"]},{quarter:"Q2",actions:["Portfolio rebalancing","Emergency fund review"]},{quarter:"Q3",actions:["Tax planning review","Goal progress assessment"]},{quarter:"Q4",actions:["Annual financial review","Next year planning"]}],risk_management:{top_risks:["Market volatility","Income disruption","Inflation impact"],mitigations:["Portfolio diversification","Emergency fund maintenance","Regular rebalancing"],citations:["KB-001","KB-003"]},tax_considerations:{ideas:["Maximize 401k contributions for immediate tax deduction","Consider Roth conversion opportunities during low-income years"],citations:["IRS-001","IRS-002"]},disclaimer:"This financial advisory report provides specific recommendations based on your current financial situation. Please consult with a qualified financial advisor before implementing any recommendations."}}mapRiskTolerance(t){return t<=3?"conservative":t<=7?"moderate":"aggressive"}extractDebts(t){var r;const a=((r=t.financials)==null?void 0:r.liabilities)||[];return console.log("🔍 Extracting debts from liabilities:",a),a.length===0?(console.log("⚠️ No liabilities found, using sample data for testing"),[{type:"credit_card",balance:971,rate:.18,payment:50},{type:"credit_card",balance:285,rate:.18,payment:25}]):a.map(n=>{const i=this.categorizeLiabilityType(n.type||n.description||"credit_card"),l=n.balance||0;return{type:i,balance:l,rate:n.rate||this.estimateInterestRate(i),payment:n.payment||this.estimateMonthlyPayment(i,l)}})}categorizeLiabilityType(t){const a=t.toLowerCase();return a.includes("mortgage")||a.includes("home loan")?"mortgage":a.includes("credit card")||a.includes("chase")?"credit_card":a.includes("student")?"student_loan":a.includes("auto")||a.includes("car")?"auto":"credit_card"}estimateInterestRate(t){const a=t.toLowerCase();return a.includes("mortgage")?.065:a.includes("credit_card")?.18:a.includes("student")?.045:a.includes("auto")?.055:.08}estimateMonthlyPayment(t,a){const r=t.toLowerCase();return r.includes("mortgage")?2264:r.includes("credit_card")?Math.max(a*.02,25):a*.01}calculateActualAllocation(t){var u;const a=(u=t.financials)==null?void 0:u.assets;console.log("🔍 Calculating actual allocation from assets:",a,"Type:",typeof a);let r=[];if(Array.isArray(a))r=a;else if(a&&typeof a=="object")console.log("🔍 Assets is structured object, flattening..."),r=[],a.realEstate&&Array.isArray(a.realEstate)&&(console.log("📍 Adding real estate assets:",a.realEstate.length),r.push(...a.realEstate)),a.retirement&&Array.isArray(a.retirement)&&(console.log("📍 Adding retirement assets:",a.retirement.length),r.push(...a.retirement)),a.investment&&Array.isArray(a.investment)&&(console.log("📍 Adding investment assets:",a.investment.length),r.push(...a.investment)),a.crypto&&Array.isArray(a.crypto)&&(console.log("📍 Adding crypto assets:",a.crypto.length),r.push(...a.crypto)),a.cash&&typeof a.cash=="object"&&!Array.isArray(a.cash)&&(console.log("📍 Adding cash accounts:",a.cash),Object.entries(a.cash).forEach(([h,f])=>{typeof f=="number"&&f>0&&h!=="total"&&r.push({accountName:h,description:h,balance:f,category:"cash"})})),console.log("📍 Total flattened assets:",r.length);else return console.log("⚠️ No valid assets found, using fallback allocation"),{stocks:60,bonds:30,cash:10};if(r.length===0)return console.log("⚠️ Empty assets array, using fallback allocation"),{stocks:60,bonds:30,cash:10};let n=0,i=0,l=0,o=0;if(r.forEach((h,f)=>{const d=h.value||h.balance||h.amount||0,x=(h.description||h.name||h.accountName||h.accountType||h.coin||h.type||"").toLowerCase();console.log(`📋 Processing asset ${f}:`,h),console.log(`📋 Asset value extracted: ${d} from fields:`,{value:h.value,amount:h.amount,balance:h.balance}),console.log(`📋 Asset type extracted: "${x}" from fields:`,{type:h.type,description:h.description,name:h.name,accountName:h.accountName,accountType:h.accountType,coin:h.coin}),d>0?(o+=d,x.includes("stock")||x.includes("equity")||x.includes("401k")||x.includes("ira")||x.includes("retirement")||x.includes("investment")||x.includes("mutual")?(n+=d,console.log(`→ Categorized as STOCKS: +$${d}`)):x.includes("bond")||x.includes("fixed")||x.includes("treasury")?(i+=d,console.log(`→ Categorized as BONDS: +$${d}`)):x.includes("cash")||x.includes("savings")||x.includes("checking")||x.includes("money market")?(l+=d,console.log(`→ Categorized as CASH: +$${d}`)):x.includes("real_estate")||x.includes("property")||x.includes("home")?console.log(`→ Found REAL ESTATE (not included in allocation): $${d}`):(console.log(`⚠️ Unknown asset type '${x}', categorizing as stocks`),n+=d)):console.log(`⚠️ Asset ${f} has zero or invalid value, skipping`)}),o===0)return console.log("⚠️ Total asset value is 0, using fallback allocation"),{stocks:60,bonds:30,cash:10};const c={stocks:Math.round(n/o*100),bonds:Math.round(i/o*100),cash:Math.round(l/o*100)};return console.log("📊 Calculated allocation:",c,`(Total: $${o.toLocaleString()})`),c}}class jr{constructor(){this.baseURL=et()}static getInstance(){return this.instance||(this.instance=new jr),this.instance}static getDTIStatus(t){return t<20?{label:"Excellent",color:"green",icon:"🟢",description:"Very low debt burden - excellent financial health"}:t<36?{label:"Good",color:"yellow",icon:"🟡",description:"Manageable debt levels - within recommended range"}:t<50?{label:"Fair",color:"orange",icon:"🟠",description:"High debt burden - consider debt reduction strategies"}:{label:"High",color:"red",icon:"🔴",description:"Very high debt burden - immediate attention needed"}}async getComprehensiveSummary(t){try{const a=localStorage.getItem("auth_tokens");if(!a)throw new Error("Authentication token not found");const n=JSON.parse(a).access_token;if(!n)throw new Error("Access token not found");const i=await fetch(`${this.baseURL}/api/v1/financial/comprehensive-summary/${t}`,{method:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(!i.ok){const c=await i.json();throw new Error(c.detail||`HTTP error! status: ${i.status}`)}const l=await i.json(),o=this.validateDataQuality(l);return o.isValid||console.warn("Data quality issues detected:",o.errors),l}catch(a){throw console.error("Failed to fetch comprehensive summary:",a),a}}formatForLLM(t){const a=this.formatUserProfile(t.user),r=this.formatPreferences(t.preferences),n=this.formatFinancials(t.financials),i=this.formatGoals(t.goals),l=this.formatRecommendations(t.recommendations),o=`
USER PROFILE:
${a}

FINANCIAL PREFERENCES:
${r}

FINANCIAL SUMMARY:
${n}

GOALS & PROGRESS:
${i}

CURRENT RECOMMENDATIONS:
${l}

DATA QUALITY: Score ${t.database_metadata.data_quality_score}/100
LAST UPDATED: ${t.database_metadata.last_updated}
CALCULATION METHOD: ${t.database_metadata.calculation_method}
`.trim();return{userProfile:a,preferences:r,financialSummary:n,goals:i,recommendations:l,fullContext:o}}formatUserProfile(t){return`
- Name: ${t.name}
- Age: ${t.age}
- Email: ${t.email}
- Account Status: ${t.status}
`.trim()}formatPreferences(t){const a=[];if(a.push(`BASIC PREFERENCES:
- Risk Tolerance: ${t.risk_tolerance} (${t.risk_score||"N/A"}/10 detailed score)
- Investment Timeline: ${t.investment_timeline} years
- Financial Knowledge: ${t.financial_knowledge}
- Emergency Fund Target: ${t.emergency_fund_months} months
- Debt Strategy: ${t.debt_payoff_priority}`),(t.investment_style||t.stocks_preference||t.bonds_preference)&&a.push(`INVESTMENT PREFERENCES:
- Investment Style: ${t.investment_style||"Not specified"}
- Stocks Preference: ${t.stocks_preference||"N/A"}/10
- Bonds Preference: ${t.bonds_preference||"N/A"}/10  
- Real Estate Preference: ${t.real_estate_preference||"N/A"}/10
- Crypto Preference: ${t.crypto_preference||"N/A"}/10
- ESG/Sustainable Investing: ${t.esg_investing?"Important":"Not specified"}`),t.retirement_lifestyle||t.work_flexibility){const r=t.work_flexibility||{};a.push(`RETIREMENT PLANNING:
- Retirement Lifestyle: ${t.retirement_lifestyle||"Not specified"}
- Open to Part-time Work: ${r.part_time?"Yes":"No"}
- Open to Consulting: ${r.consulting?"Yes":"No"}
- Target Retirement Age: ${t.retirement_age||"Not specified"}`)}if(t.tax_filing_status||t.federal_tax_bracket){const r=t.federal_tax_bracket?`${(t.federal_tax_bracket*100).toFixed(0)}%`:"Not specified",n=t.state_tax_rate?`${(t.state_tax_rate*100).toFixed(1)}%`:"Not specified";a.push(`TAX OPTIMIZATION:
- Filing Status: ${t.tax_filing_status||"Not specified"}
- Federal Tax Bracket: ${r}
- State: ${t.state||"Not specified"} (${n} tax rate)
- Tax Optimization Priority: ${t.tax_optimization_priority||"Not specified"}
- Tax Loss Harvesting: ${t.tax_loss_harvesting?"Enabled":"Disabled"}
- Roth IRA Eligible: ${t.roth_ira_eligible?"Yes":"No"}`)}return t.goal_categories_enabled&&t.goal_categories_enabled.length>0&&a.push(`GOAL CATEGORIES: ${t.goal_categories_enabled.join(", ")}`),a.join(`

`)}formatFinancials(t){return`
NET WORTH: $${t.netWorth.toLocaleString()}
- Total Assets: $${t.totalAssets.toLocaleString()}
- Total Liabilities: $${t.totalLiabilities.toLocaleString()}

CASH FLOW:
- Monthly Income: $${t.monthlyIncome.toLocaleString()}
- Monthly Expenses: $${t.monthlyExpenses.toLocaleString()}
- Monthly Surplus: $${t.monthlySurplus.toLocaleString()}
- Savings Rate: ${t.savingsRate}%

KEY RATIOS:
- Debt-to-Income Ratio: ${t.debtToIncomeRatio}%
- Emergency Fund Coverage: ${t.emergencyFundCoverage} months

ASSET ALLOCATION:
- Real Estate: ${t.assetAllocation.realEstate.percentage}% ($${t.assetAllocation.realEstate.value.toLocaleString()})
- Investments: ${t.assetAllocation.investments.percentage}% ($${t.assetAllocation.investments.value.toLocaleString()})
- Cash: ${t.assetAllocation.cash.percentage}% ($${t.assetAllocation.cash.value.toLocaleString()})
- Personal Property: ${t.assetAllocation.personalProperty.percentage}% ($${t.assetAllocation.personalProperty.value.toLocaleString()})

MAJOR ASSETS:
${this.formatAssetList(t.assets)}

LIABILITIES:
${t.liabilities.map(a=>`- ${a.name}: $${a.balance.toLocaleString()}`).join(`
`)}
`.trim()}formatAssetList(t){const a=[];return t.realEstate&&t.realEstate.length>0&&a.push(`Real Estate:
${t.realEstate.map(r=>`  - ${r.name}: $${r.value.toLocaleString()}`).join(`
`)}`),t.investments&&t.investments.length>0&&a.push(`Investments:
${t.investments.map(r=>`  - ${r.name}: $${r.value.toLocaleString()}`).join(`
`)}`),t.cash&&t.cash.length>0&&a.push(`Cash & Liquid:
${t.cash.map(r=>`  - ${r.name}: $${r.value.toLocaleString()}`).join(`
`)}`),a.join(`

`)}formatGoals(t){return!t||t.length===0?"No active goals defined":t.map((a,r)=>`
GOAL ${r+1}: ${a.name}
- Category: ${a.category}
- Target: $${a.target_amount.toLocaleString()} by ${a.target_date}
- Current Progress: $${a.currentProgress.toLocaleString()} (${a.progressPercentage}%)
- Monthly Required: $${a.monthlyRequired.toLocaleString()}
- Years Remaining: ${a.yearsToGoal}
`).join(`
`)}formatRecommendations(t){const a=[];return t.portfolio_adjustment&&a.push(`PORTFOLIO: ${t.portfolio_adjustment}`),t.risk_assessment&&a.push(`RISK ASSESSMENT: ${t.risk_assessment}`),t.tax_optimization&&a.push(`TAX OPTIMIZATION: ${t.tax_optimization}`),t.next_steps&&t.next_steps.length>0&&a.push(`NEXT STEPS:
${t.next_steps.map(r=>`- ${r}`).join(`
`)}`),t.warnings&&t.warnings.length>0&&a.push(`WARNINGS:
${t.warnings.map(r=>`⚠️ ${r}`).join(`
`)}`),a.join(`

`)}validateDataQuality(t){const a=[],r=[];let n=100;return(!t.user||!t.user.name||t.user.name==="User")&&(a.push("Invalid or generic user name"),n-=20),(!t.financials||t.financials.netWorth===0)&&(a.push("Net worth is zero or missing"),n-=30),t.financials&&t.financials.monthlyIncome===0&&(a.push("Monthly income is zero"),n-=20),t.preferences?(t.preferences.risk_score||(r.push("Detailed risk score not set"),n-=5),t.preferences.investment_style||(r.push("Investment style not specified"),n-=5),t.preferences.tax_filing_status||(r.push("Tax filing status not set"),n-=10),t.preferences.federal_tax_bracket||(r.push("Federal tax bracket not specified"),n-=10)):(a.push("User preferences missing"),n-=25),(!t.goals||t.goals.length===0)&&(r.push("No financial goals defined"),n-=10),t.financials&&t.financials.assetAllocation&&t.financials.assetAllocation.realEstate.percentage>60&&(r.push("Very high real estate concentration"),n-=5),{isValid:a.length===0,errors:a,warnings:r,score:Math.max(0,n)}}getQuickSummary(t){return{netWorth:t.financials.netWorth,monthlyIncome:t.financials.monthlyIncome,monthlySurplus:t.financials.monthlySurplus,savingsRate:t.financials.savingsRate,riskProfile:`${t.preferences.risk_tolerance} (${t.preferences.risk_score||"N/A"}/10)`,investmentStyle:t.preferences.investment_style||"Not specified",taxBracket:t.preferences.federal_tax_bracket?`${(t.preferences.federal_tax_bracket*100).toFixed(0)}%`:"Not specified",dataQuality:t.database_metadata.data_quality_score}}}class Nr{constructor(){this.baseURL=et()}static getInstance(){return this.instance||(this.instance=new Nr),this.instance}getAuthHeaders(){const t=localStorage.getItem("auth_tokens");if(!t)throw new Error("Authentication token not found");try{return{Authorization:`Bearer ${JSON.parse(t).access_token}`,"Content-Type":"application/json"}}catch{throw new Error("Invalid auth tokens format")}}async indexUserData(t){try{const a=await fetch(`${this.baseURL}/api/v1/vector/index/${t}`,{method:"POST",headers:this.getAuthHeaders()});if(!a.ok){const n=await a.json();throw new Error(n.detail||"Failed to index data")}const r=await a.json();return console.log("Vector indexing complete:",r),r}catch(a){throw console.error("Failed to index vector data:",a),a}}async searchContext(t,a,r=5){try{const n=new URL(`${this.baseURL}/api/v1/vector/search/${t}`);n.searchParams.append("query",a),n.searchParams.append("n_results",r.toString());const i=await fetch(n.toString(),{method:"POST",headers:this.getAuthHeaders()});if(!i.ok){const o=await i.json();throw new Error(o.detail||"Search failed")}return(await i.json()).results}catch(n){throw console.error("Vector search failed:",n),n}}async getChatContext(t,a){try{const r=new URL(`${this.baseURL}/api/v1/vector/chat-context/${t}`);r.searchParams.append("message",a);const n=await fetch(r.toString(),{method:"GET",headers:this.getAuthHeaders()});if(!n.ok){const l=await n.json();throw new Error(l.detail||"Failed to get context")}return(await n.json()).context}catch(r){throw console.error("Failed to get chat context:",r),r}}async getVectorStatus(t){try{const a=await fetch(`${this.baseURL}/api/v1/vector/status/${t}`,{method:"GET",headers:this.getAuthHeaders()});if(!a.ok){const r=await a.json();throw new Error(r.detail||"Failed to get status")}return await a.json()}catch(a){throw console.error("Failed to get vector status:",a),a}}async clearUserData(t){try{const a=await fetch(`${this.baseURL}/api/v1/vector/clear/${t}`,{method:"DELETE",headers:this.getAuthHeaders()});if(!a.ok){const r=await a.json();throw new Error(r.detail||"Failed to clear data")}return await a.json()}catch(a){throw console.error("Failed to clear vector data:",a),a}}async reindexUserData(t){try{return await this.clearUserData(t),await this.indexUserData(t)}catch(a){throw console.error("Failed to reindex:",a),a}}async testVectorSearch(t){const a=["What is my net worth?","How much do I have in real estate?","What are my investment preferences?","Tell me about my retirement goal","What's my tax situation?","How much emergency fund do I have?"],r={};for(const n of a)try{r[n]=await this.searchContext(t,n,3)}catch(i){console.error(`Test query failed: ${n}`,i),r[n]=[]}return r}}const vn=Nr.getInstance(),Kc=()=>{var z,C,j,E;const s=Ft(A=>A.user),[t,a]=w.useState(null),[r,n]=w.useState(!0),[i,l]=w.useState(null),[o,c]=w.useState(!1),[u,h]=w.useState({preferences:!1,financial:!1,goals:!1,recommendations:!1}),[f,d]=w.useState(!1),[x,b]=w.useState(null),[m,p]=w.useState(""),N=jr.getInstance();w.useEffect(()=>{s!=null&&s.id&&(g(),S())},[s==null?void 0:s.id]);const g=async()=>{if(!(s!=null&&s.id)){l("User not authenticated"),n(!1);return}try{n(!0),l(null);const A=await N.getComprehensiveSummary(s.id);a(A)}catch(A){console.error("Failed to load comprehensive summary:",A),l(A instanceof Error?A.message:"Failed to load summary")}finally{n(!1)}},S=async()=>{if(s!=null&&s.id)try{const A=await vn.getVectorStatus(s.id);b(A)}catch(A){console.error("Failed to load vector status:",A)}},T=async()=>{if(s!=null&&s.id)try{d(!0),p("Preparing financial data...");const A=await vn.indexUserData(s.id);p(`Successfully indexed ${A.documents_indexed} documents`),await S(),setTimeout(()=>{p("")},3e3)}catch(A){console.error("Failed to index data:",A),p(`Failed to index data: ${A instanceof Error?A.message:"Unknown error"}`),setTimeout(()=>{p("")},5e3)}finally{d(!1)}},v=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),L=A=>`${(A*100).toFixed(1)}%`,P=A=>{h(y=>({...y,[A]:!y[A]}))};return r?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[1,2,3,4].map(A=>e.jsx("div",{className:"h-24 bg-gray-700 rounded"},A))}),e.jsx("div",{className:"h-64 bg-gray-700 rounded"})]})}):i?e.jsx(_,{children:e.jsxs(_.Body,{className:"text-center py-8",children:[e.jsx(Je,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Summary"}),e.jsx("p",{className:"text-gray-600 mb-4",children:i}),e.jsx($,{onClick:g,leftIcon:e.jsx(_t,{className:"w-4 h-4"}),children:"Retry"})]})}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Financial Profile Data"}),e.jsxs("p",{className:"text-sm text-gray-300 mt-1",children:["Complete financial summary with preferences • Data Quality: ",t.database_metadata.data_quality_score,"/100",x&&e.jsxs("span",{className:"ml-2",children:["• Vector DB: ",x.is_indexed?`${x.total_documents} docs indexed`:"Not indexed"]})]}),m&&e.jsx("p",{className:`text-sm mt-1 ${m.includes("Successfully")?"text-green-400":"text-yellow-400"}`,children:m})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx($,{variant:"outline",size:"sm",onClick:T,disabled:f,leftIcon:e.jsx(Vt,{className:`w-4 h-4 ${f?"animate-pulse":""}`}),className:`${x!=null&&x.is_indexed?"border-green-500 text-green-400":"border-blue-500 text-blue-400"}`,children:f?"Indexing...":x!=null&&x.is_indexed?"Reindex":"Index to Vector DB"}),e.jsx($,{variant:"outline",size:"sm",onClick:g,leftIcon:e.jsx(_t,{className:"w-4 h-4"}),children:"Refresh"}),e.jsxs($,{variant:"outline",size:"sm",onClick:()=>c(!o),leftIcon:o?e.jsx(In,{className:"w-4 h-4"}):e.jsx(ns,{className:"w-4 h-4"}),children:[o?"Hide":"View"," Full Profile JSON"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(_,{className:"bg-gray-800 border-gray-600",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ge,{className:"w-5 h-5 text-blue-400"}),e.jsx(ke,{variant:"info",size:"sm",className:"bg-blue-600 text-white",children:"Net Worth"})]}),e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Net Worth"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:v(t.financials.netWorth)})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-600",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Te,{className:"w-5 h-5 text-green-400"}),e.jsx(ke,{variant:"success",size:"sm",className:"bg-green-600 text-white",children:"Income"})]}),e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Monthly Income"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:v(t.financials.monthlyIncome)})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-600",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx($s,{className:"w-5 h-5 text-red-400"}),e.jsx(ke,{variant:"warning",size:"sm",className:"bg-red-600 text-white",children:"Expenses"})]}),e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Monthly Expenses"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:v(t.financials.monthlyExpenses)})]})}),e.jsx(_,{className:"bg-gray-800 border-gray-600",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ge,{className:"w-5 h-5 text-purple-400"}),e.jsx(ke,{variant:"info",size:"sm",className:"bg-purple-600 text-white",children:"Surplus"})]}),e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Monthly Surplus"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:v(t.financials.monthlySurplus)})]})})]}),e.jsxs(_,{className:"bg-gray-800 border-gray-600",children:[e.jsx(_.Header,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Us,{className:"w-5 h-5 text-blue-400"}),e.jsx(_.Title,{className:"text-white",children:"Financial Preferences Profile"})]}),e.jsx($,{variant:"ghost",size:"sm",onClick:()=>P("preferences"),rightIcon:u.preferences?e.jsx(us,{className:"w-4 h-4 text-gray-300"}):e.jsx(zt,{className:"w-4 h-4 text-gray-300"}),className:"text-gray-300 hover:text-white",children:u.preferences?"Collapse":"Expand"})]})}),u.preferences&&e.jsx(_.Body,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-3 flex items-center",children:[e.jsx(Lt,{className:"w-4 h-4 mr-2 text-blue-400"}),"Basic Preferences"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Risk Tolerance:"}),e.jsx("span",{className:"font-medium text-white",children:t.preferences.risk_tolerance})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Risk Score:"}),e.jsxs("span",{className:"font-medium text-white",children:[t.preferences.risk_score||"N/A","/10"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Investment Timeline:"}),e.jsxs("span",{className:"font-medium text-white",children:[t.preferences.investment_timeline," years"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Financial Knowledge:"}),e.jsx("span",{className:"font-medium text-white",children:t.preferences.financial_knowledge})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Emergency Fund Target:"}),e.jsxs("span",{className:"font-medium text-white",children:[t.preferences.emergency_fund_months," months"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-3 flex items-center",children:[e.jsx(Te,{className:"w-4 h-4 mr-2 text-green-400"}),"Investment Style"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Investment Style:"}),e.jsx("span",{className:"font-medium text-white",children:t.preferences.investment_style||"Not specified"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Stocks Preference:"}),e.jsxs("span",{className:"font-medium text-white",children:[t.preferences.stocks_preference||"N/A","/10"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Bonds Preference:"}),e.jsxs("span",{className:"font-medium text-white",children:[t.preferences.bonds_preference||"N/A","/10"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Real Estate:"}),e.jsxs("span",{className:"font-medium text-white",children:[t.preferences.real_estate_preference||"N/A","/10"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Crypto Preference:"}),e.jsxs("span",{className:"font-medium text-white",children:[t.preferences.crypto_preference||"N/A","/10"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"ESG Investing:"}),e.jsx("span",{className:"font-medium text-white",children:t.preferences.esg_investing?"Yes":"No"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-3 flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 mr-2 text-yellow-400"}),"Tax & Retirement"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Filing Status:"}),e.jsx("span",{className:"font-medium text-white",children:t.preferences.tax_filing_status||"Not specified"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Federal Tax Bracket:"}),e.jsx("span",{className:"font-medium text-white",children:t.preferences.federal_tax_bracket?L(t.preferences.federal_tax_bracket):"Not specified"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"State:"}),e.jsx("span",{className:"font-medium text-white",children:t.preferences.state||"Not specified"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Tax Loss Harvesting:"}),e.jsx("span",{className:"font-medium text-white",children:t.preferences.tax_loss_harvesting?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Retirement Lifestyle:"}),e.jsx("span",{className:"font-medium text-white",children:t.preferences.retirement_lifestyle||"Not specified"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Work Flexibility:"}),e.jsxs("span",{className:"font-medium text-white",children:[(z=t.preferences.work_flexibility)!=null&&z.part_time?"Part-time OK":"",(C=t.preferences.work_flexibility)!=null&&C.consulting?", Consulting OK":"",!((j=t.preferences.work_flexibility)!=null&&j.part_time)&&!((E=t.preferences.work_flexibility)!=null&&E.consulting)?"Not specified":""]})]})]})]})]})})]}),e.jsxs(_,{className:"bg-gray-800 border-gray-600",children:[e.jsx(_.Header,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{className:"w-5 h-5 text-green-400"}),e.jsx(_.Title,{className:"text-white",children:"Financial Details"})]}),e.jsx($,{variant:"ghost",size:"sm",onClick:()=>P("financial"),rightIcon:u.financial?e.jsx(us,{className:"w-4 h-4 text-gray-300"}):e.jsx(zt,{className:"w-4 h-4 text-gray-300"}),className:"text-gray-300 hover:text-white",children:u.financial?"Collapse":"Expand"})]})}),u.financial&&e.jsx(_.Body,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-3 flex items-center",children:[e.jsx(De,{className:"w-4 h-4 mr-2 text-blue-400"}),"Asset Allocation"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Real Estate:"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"font-medium text-white",children:[t.financials.assetAllocation.realEstate.percentage,"%"]}),e.jsx("div",{className:"text-sm text-gray-400",children:v(t.financials.assetAllocation.realEstate.value)})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Investments:"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"font-medium text-white",children:[t.financials.assetAllocation.investments.percentage,"%"]}),e.jsx("div",{className:"text-sm text-gray-400",children:v(t.financials.assetAllocation.investments.value)})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Cash:"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"font-medium text-white",children:[t.financials.assetAllocation.cash.percentage,"%"]}),e.jsx("div",{className:"text-sm text-gray-400",children:v(t.financials.assetAllocation.cash.value)})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-3 flex items-center",children:[e.jsx(Te,{className:"w-4 h-4 mr-2 text-green-400"}),"Key Ratios"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Savings Rate:"}),e.jsxs("span",{className:"font-medium text-green-400",children:[t.financials.savingsRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Debt-to-Income:"}),e.jsxs("span",{className:"font-medium text-white",children:[t.financials.debtToIncomeRatio,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Emergency Fund:"}),e.jsxs("span",{className:"font-medium text-white",children:[t.financials.emergencyFundCoverage," months"]})]})]})]})]})})]}),t.goals&&t.goals.length>0&&e.jsxs(_,{className:"bg-gray-800 border-gray-600",children:[e.jsx(_.Header,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"w-5 h-5 text-purple-400"}),e.jsx(_.Title,{className:"text-white",children:"Financial Goals"})]}),e.jsx($,{variant:"ghost",size:"sm",onClick:()=>P("goals"),rightIcon:u.goals?e.jsx(us,{className:"w-4 h-4 text-gray-300"}):e.jsx(zt,{className:"w-4 h-4 text-gray-300"}),className:"text-gray-300 hover:text-white",children:u.goals?"Collapse":"Expand"})]})}),u.goals&&e.jsx(_.Body,{children:e.jsx("div",{className:"space-y-4",children:t.goals.map((A,y)=>e.jsxs("div",{className:"border border-gray-600 rounded-lg p-4 bg-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-semibold text-white",children:A.name}),e.jsx(ke,{variant:"info",className:"bg-purple-600 text-white",children:A.category})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300",children:"Target:"}),e.jsx("div",{className:"font-medium text-white",children:v(A.target_amount)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300",children:"Progress:"}),e.jsxs("div",{className:"font-medium text-green-400",children:[A.progressPercentage,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300",children:"Monthly Required:"}),e.jsx("div",{className:"font-medium text-white",children:v(A.monthlyRequired)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300",children:"Target Date:"}),e.jsx("div",{className:"font-medium text-white",children:A.target_date})]})]})]},A.goal_id))})})]}),e.jsxs(_,{className:"bg-gray-800 border-gray-600",children:[e.jsx(_.Header,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qe,{className:"w-5 h-5 text-blue-400"}),e.jsx(_.Title,{className:"text-white",children:"Personalized Recommendations"})]}),e.jsx($,{variant:"ghost",size:"sm",onClick:()=>P("recommendations"),rightIcon:u.recommendations?e.jsx(us,{className:"w-4 h-4 text-gray-300"}):e.jsx(zt,{className:"w-4 h-4 text-gray-300"}),className:"text-gray-300 hover:text-white",children:u.recommendations?"Collapse":"Expand"})]})}),u.recommendations&&e.jsx(_.Body,{children:e.jsxs("div",{className:"space-y-4",children:[t.recommendations.portfolio_adjustment&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-2 flex items-center",children:[e.jsx(Te,{className:"w-4 h-4 mr-2 text-green-400"}),"Portfolio Adjustment"]}),e.jsx("p",{className:"text-gray-300",children:t.recommendations.portfolio_adjustment})]}),t.recommendations.risk_assessment&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-2 flex items-center",children:[e.jsx(wt,{className:"w-4 h-4 mr-2 text-blue-400"}),"Risk Assessment"]}),e.jsx("p",{className:"text-gray-300",children:t.recommendations.risk_assessment})]}),t.recommendations.tax_optimization&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-2 flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 mr-2 text-yellow-400"}),"Tax Optimization"]}),e.jsx("p",{className:"text-gray-300",children:t.recommendations.tax_optimization})]}),t.recommendations.next_steps&&t.recommendations.next_steps.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-2 flex items-center",children:[e.jsx(qe,{className:"w-4 h-4 mr-2 text-green-400"}),"Next Steps"]}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.recommendations.next_steps.map((A,y)=>e.jsx("li",{className:"text-gray-300",children:A},y))})]}),t.recommendations.warnings&&t.recommendations.warnings.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-white mb-2 flex items-center",children:[e.jsx(Je,{className:"w-4 h-4 mr-2 text-yellow-400"}),"Warnings"]}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.recommendations.warnings.map((A,y)=>e.jsx("li",{className:"text-yellow-300",children:A},y))})]})]})})]}),o&&e.jsxs(_,{className:"bg-gray-800 border-gray-600",children:[e.jsx(_.Header,{children:e.jsx(_.Title,{className:"text-white",children:"▼ View Full Profile JSON"})}),e.jsx(_.Body,{children:e.jsx("pre",{className:"text-xs bg-gray-900 text-green-400 p-4 rounded-lg overflow-auto max-h-96 font-mono border border-gray-700",children:JSON.stringify(t,null,2)})})]})]}):e.jsx(_,{children:e.jsx(_.Body,{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600",children:"No comprehensive summary available"})})})},Qc=()=>{console.log("🚀 EnhancedPlanEngineContainer MOUNTED - START");let s;try{console.log("📍 About to call useAuthUser hook..."),s=Ft(m=>m.user),console.log("👤 User from auth store:",s),console.log("🔑 Auth token exists:",!!localStorage.getItem("auth_tokens")),console.log("📋 LocalStorage auth_tokens:",localStorage.getItem("auth_tokens"))}catch(m){console.error("💥 Error calling useAuthUser:",m),s=null}const[t,a]=w.useState(()=>{try{const m=s!=null&&s.id?`wpa-advisory-state-${s.id}`:"wpa-advisory-state-guest",p=localStorage.getItem(m);if(p){const N=JSON.parse(p);return{loading:!1,content:N.content||"",error:"",profile:N.profile||null,showRawData:!1,lastGenerated:N.lastGenerated||null,selectedProvider:N.selectedProvider||"openai",modelTier:N.modelTier||"dev",showProviderSelector:!1,temperature:N.temperature||.7,advisoryMode:N.advisoryMode||"deterministic",structuredAdvisory:N.structuredAdvisory||null,validationResults:[],expandedActions:new Set,showStatusTooltip:!1}}}catch(m){console.warn("Failed to load persisted state:",m)}return{loading:!1,content:"",error:"",profile:null,showRawData:!1,lastGenerated:null,selectedProvider:"openai",modelTier:"dev",showProviderSelector:!1,temperature:.7,advisoryMode:"deterministic",structuredAdvisory:null,validationResults:[],expandedActions:new Set,showStatusTooltip:!1}});w.useEffect(()=>{try{const m={content:t.content,profile:t.profile,lastGenerated:t.lastGenerated,selectedProvider:t.selectedProvider,modelTier:t.modelTier,temperature:t.temperature,advisoryMode:t.advisoryMode,structuredAdvisory:t.structuredAdvisory},p=s!=null&&s.id?`wpa-advisory-state-${s.id}`:"wpa-advisory-state-guest";localStorage.setItem(p,JSON.stringify(m))}catch(m){console.warn("Failed to persist state:",m)}},[t.content,t.profile,t.lastGenerated,t.selectedProvider,t.modelTier,t.temperature,t.advisoryMode,t.structuredAdvisory,s==null?void 0:s.id]),w.useEffect(()=>{a(m=>({...m,content:"",profile:null,lastGenerated:null,error:"",structuredAdvisory:null,validationResults:[]}))},[s==null?void 0:s.id]),w.useEffect(()=>{var m,p;console.log("🔄 State.content changed!",{exists:!!t.content,length:(m=t.content)==null?void 0:m.length,preview:(p=t.content)==null?void 0:p.substring(0,100)})},[t.content]);const r=(m,p)=>{var g;return((g={openai:{dev:"gpt-3.5-turbo",prod:"gpt-4"},gemini:{dev:"gemini-1.5-flash",prod:"gemini-1.5-pro"},claude:{dev:"claude-3-haiku",prod:"claude-3-opus"}}[m])==null?void 0:g[p])||"gpt-3.5-turbo"},n=(m,p)=>({"openai-dev":"0.003","openai-prod":"0.030","gemini-dev":"0.001","gemini-prod":"0.007","claude-dev":"0.003","claude-prod":"0.015"})[`${m}-${p}`]||"0.003",i=m=>({openai:"⚡",gemini:"💰",claude:"🎯"})[m]||"🤖",l=m=>({openai:"Fastest",gemini:"Cheapest",claude:"Best Quality"})[m]||"AI Provider",o=async()=>{if(console.log("🔘 Generate Advisory button clicked!"),console.log("📊 Current user state:",s),console.log("🔑 Auth token exists:",!!localStorage.getItem("auth_tokens")),console.log("📋 Auth tokens content:",localStorage.getItem("auth_tokens")),console.log("⚙️ Advisory mode:",t.advisoryMode),console.log("🤖 Selected provider:",t.selectedProvider),console.log(`🚀 Starting ${t.advisoryMode} advisory generation...`),!(s!=null&&s.id)){console.error("❌ CRITICAL: User not authenticated!"),console.log("🔍 Debug info - User object:",s),console.log("🔍 Debug info - Auth tokens:",localStorage.getItem("auth_tokens")),a(m=>({...m,loading:!1,error:"User not authenticated - Debug: Check console for details"}));return}a(m=>({...m,loading:!0,error:"",validationResults:[]}));try{t.advisoryMode==="deterministic"?await c():await u()}catch(m){console.error("❌ Advisory generation failed:",m),console.log("📋 Error details:",{message:m.message,stack:m.stack,user:s,authTokens:!!localStorage.getItem("auth_tokens")}),a(p=>({...p,error:`Failed to generate advisory: ${m.message}`,loading:!1}))}},c=async()=>{var m;if(!(s!=null&&s.id)){a(p=>({...p,loading:!1,error:"User not authenticated"}));return}console.log(`🎯 Starting deterministic advisory generation with ${t.selectedProvider.toUpperCase()}...`);try{console.log("🔄 Step 1: Getting deterministic service...");const p=vr.getInstance();console.log("🔄 Step 2: Generating advisory...");const N=await p.generateAdvisory(s.id,t.selectedProvider);console.log("✅ Step 3: Deterministic advisory generated successfully:",N),console.log("✅ Advisory has executive_summary:",!!(N!=null&&N.executive_summary)),console.log("✅ Advisory has priority_actions_30d:",((m=N==null?void 0:N.priority_actions_30d)==null?void 0:m.length)||0),console.log("🎨 Step 4: About to format advisory for display...");const g=x(N);if(console.log("🎨 Step 5: Formatted content length:",g.length),console.log("🎨 Step 5: Formatted content preview:",g.substring(0,200)),!g||g.length<100)throw new Error("Formatted content is too short or empty");console.log("👤 Step 6: Getting user profile...");const T=await Ns.getInstance().getCompleteFinancialProfile(s.id);console.log("👤 Step 7: User profile retrieved successfully"),console.log("💾 Step 8: Setting state with formatted content..."),console.log("📝 Final content preview:",g.substring(0,200)),a(v=>{var P;const L={...v,content:g,structuredAdvisory:N,profile:T,lastGenerated:Date.now(),loading:!1,validationResults:["✅ All numbers validated against source data","✅ All citations verified from knowledge base","✅ Business rules compliance verified","✅ Legal disclaimer requirements met"]};return console.log("📊 New state being set:",{hasContent:!!L.content,contentLength:(P=L.content)==null?void 0:P.length,loading:L.loading}),L}),console.log("✅ Step 9: State has been set successfully!"),setTimeout(()=>{var v,L;console.log("🔍 Verification: Current state after setState:",{hasContent:!!t.content,contentLength:(v=t.content)==null?void 0:v.length,isLoading:t.loading,preview:(L=t.content)==null?void 0:L.substring(0,100)})},100)}catch(p){console.error("❌ Error in generateDeterministicAdvisory:",p);const N=`
        <div style="color: #e5e7eb;">
          <h2 style="font-size: 1.25rem; font-weight: 400; color: #e5e7eb; margin-bottom: 1rem; padding-bottom: 0.375rem; border-bottom: 1px solid #4b5563;">Test Advisory Report</h2>
          <p style="color: #fca5a5; margin-bottom: 1rem;">⚠️ Error generating real advisory. Showing test content.</p>
          <p style="color: #d1d5db; margin-bottom: 1rem;">Error: ${(p==null?void 0:p.message)||"Unknown error"}</p>
          <p style="color: #86efac;">If you see this message, the rendering system is working but the advisory generation failed.</p>
        </div>
      `;a(g=>({...g,content:N,loading:!1,error:`Failed to generate deterministic advisory: ${(p==null?void 0:p.message)||"Unknown error"}`}))}},u=async()=>{var T,v,L,P,z;if(!(s!=null&&s.id)){a(C=>({...C,loading:!1,error:"User not authenticated"}));return}console.log("📊 Starting traditional advisory generation...");const p=await Ns.getInstance().getCompleteFinancialProfile(s.id);console.log("✅ Profile loaded:",{name:(T=p.user)==null?void 0:T.name,netWorth:(L=(v=p.financials)==null?void 0:v.netWorth)==null?void 0:L.total,monthlyIncome:(z=(P=p.financials)==null?void 0:P.cashFlow)==null?void 0:z.monthlyIncome});const N=h(p);console.log("🎯 Calling LLM API...");const g=await f(N),S=d(g);console.log("✅ Traditional advisory generated successfully"),a(C=>({...C,content:S,profile:p,lastGenerated:Date.now(),loading:!1,structuredAdvisory:null,validationResults:[]}))},h=m=>{var T,v,L,P,z,C,j,E,A,y,R,k;const p=((v=(T=m.financials)==null?void 0:T.netWorth)==null?void 0:v.total)||0,N=((P=(L=m.financials)==null?void 0:L.cashFlow)==null?void 0:P.monthlyIncome)||0,g=((C=(z=m.financials)==null?void 0:z.cashFlow)==null?void 0:C.monthlyExpenses)||0,S=N-g;return{user_profile:{name:((j=m.user)==null?void 0:j.name)||"Client",age:((E=m.user)==null?void 0:E.currentAge)||45,location:((A=m.user)==null?void 0:A.location)||"United States",monthly_income:N,monthly_expenses:g,net_worth:p},financial_summary:{assets:((y=m.financials)==null?void 0:y.assets)||{},liabilities:((R=m.financials)==null?void 0:R.liabilities)||{},cash_flow:{monthly_income:N,monthly_expenses:g,monthly_surplus:S}},goals:m.goals||[],risk_tolerance:((k=m.preferences)==null?void 0:k.riskToleranceLabel)||"moderate"}},f=async m=>{var g;const p=await fetch(`${et()}/api/v1/llm/advisory/generate`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({step4_data:m,generation_type:"summary",provider_preferences:[t.selectedProvider],enable_comparison:!1,model_tier:t.modelTier,temperature:t.temperature,model:r(t.selectedProvider,t.modelTier),custom_prompts:{system_prompt:`You are a professional financial advisor. Generate a comprehensive, executive-style advisory report.

Focus on:
1. Clear executive summary with specific numbers
2. Actionable recommendations with timelines
3. Risk assessment with data-driven insights
4. Professional narrative format (flowing paragraphs, not bullet points)

Use the client's real name and specific financial figures. Avoid generic advice.`,user_prompt:"Generate a comprehensive financial advisory for this client using their complete financial profile data."}})});if(!p.ok)throw new Error(`LLM API error: ${p.status} ${p.statusText}`);const N=await p.json();return N.content||((g=N.llm_response)==null?void 0:g.content)||""},d=m=>{if(!m)return"";let p=m.replace(/\[plan engine\]/gi,"").replace(/\*\*HIGH\*\*/gi,"").replace(/\*\*MEDIUM\*\*/gi,"").replace(/\*\*LOW\*\*/gi,"").replace(/the client/gi,"you").trim();return p=p.replace(/^##\s+Executive Summary/gmi,'<h2 class="text-lg font-bold text-gray-200 mt-5 mb-3 pb-1 border-b border-gray-500 first:mt-0">Executive Summary</h2>').replace(/^##\s+(Immediate Actions|Priority Actions)/gmi,'<h2 class="text-lg font-bold text-gray-200 mt-5 mb-3 pb-1 border-b border-gray-500">Priority Actions</h2>').replace(/^##\s+Tax Optimization/gmi,'<h2 class="text-lg font-bold text-gray-200 mt-5 mb-3 pb-1 border-b border-gray-500">Tax Optimization</h2>').replace(/^##\s+Investment Strategy/gmi,'<h2 class="text-lg font-bold text-gray-200 mt-5 mb-3 pb-1 border-b border-gray-500">Investment Strategy</h2>').replace(/^##\s+(Path to Independence|Financial Independence)/gmi,'<h2 class="text-lg font-bold text-gray-200 mt-5 mb-3 pb-1 border-b border-gray-500">Path to Independence</h2>').replace(/^##\s+Risk Management/gmi,'<h2 class="text-lg font-bold text-gray-200 mt-5 mb-3 pb-1 border-b border-gray-500">Risk Management</h2>').replace(/^##\s+([^\n\r]+)/gm,'<h2 class="text-lg font-bold text-gray-200 mt-5 mb-3 pb-1 border-b border-gray-500">$1</h2>').replace(/^(\d+)\.\s+\*\*(.+?)\*\*(.*)$/gm,'<div class="my-2 flex items-start wsj-counter-item"><div class="flex-1"><strong class="font-semibold text-gray-100">$2</strong><span class="text-gray-300 ml-1">$3</span></div></div>').replace(/^(\d+)\.\s+(.+)$/gm,'<div class="my-2 flex items-start wsj-counter-item"><div class="flex-1 text-gray-200">$2</div></div>').replace(/^\s*[-•]\s+(.+)$/gm,'<div class="my-1 ml-4 text-gray-200 relative"><span class="absolute -left-4 text-gray-400">•</span>$1</div>').replace(/\*\*([^*\n]+)\*\*/g,'<strong class="font-semibold text-gray-100">$1</strong>').replace(/\$[\d,]+\.?\d*/g,'<span class="font-semibold text-green-400 bg-green-900/30 px-1 py-0.5 rounded">$&</span>').replace(/\b\d+\.?\d*%/g,'<span class="font-semibold text-blue-400 bg-blue-900/30 px-1 py-0.5 rounded">$&</span>').replace(/\n\n+/g,'</p><p class="mb-3 text-gray-200 leading-relaxed">').replace(/\n/g," "),p=`<div class="wsj-content">
      <style>
        .wsj-content {
          counter-reset: wsj-counter;
        }
        .wsj-counter-item {
          counter-increment: wsj-counter;
          position: relative;
          padding-left: 2rem;
        }
        .wsj-counter-item::before {
          content: counter(wsj-counter);
          position: absolute;
          left: 0;
          top: 0.125rem;
          background: #3b82f6;
          color: white;
          width: 1.25rem;
          height: 1.25rem;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.75rem;
          font-weight: 600;
          font-family: Georgia, serif;
        }
      </style>
      <p class="mb-3 text-gray-200 leading-relaxed">${p}</p>
    </div>`,p},x=m=>{var N,g,S,T,v,L,P,z,C,j,E,A,y,R,k;if(console.log("🎯 formatStructuredAdvisory called with:",JSON.stringify(m,null,2)),!m)return`
        <div style="color: #e5e7eb; padding: 2rem; background: rgba(220, 38, 38, 0.1); border: 1px solid #dc2626; border-radius: 8px;">
          <h2 style="color: #fca5a5;">⚠️ No Advisory Data</h2>
          <p>The advisory data is null or undefined. Check console for details.</p>
        </div>
      `;let p=`
      <div style="color: #e5e7eb;">
        <div style="padding: 1rem; background: rgba(34, 197, 94, 0.1); border: 1px solid #22c55e; border-radius: 8px; margin-bottom: 1rem;">
          <p style="color: #86efac; margin: 0;">✅ Deterministic Advisory Report Generated</p>
          <p style="color: #bbf7d0; font-size: 0.875rem; margin: 0.5rem 0 0 0;">Data received and processing...</p>
        </div>
    `;return p+=`
      <h2 style="font-size: 1.25rem; font-weight: 400; color: #e5e7eb; margin-bottom: 1rem; padding-bottom: 0.375rem; border-bottom: 1px solid #4b5563;">Executive Summary</h2>
      
      <p style="color: #e5e7eb; margin-bottom: 1.5rem; line-height: 1.6;">
        ${((N=m==null?void 0:m.executive_summary)==null?void 0:N.overview)||((g=m==null?void 0:m.executive_summary)==null?void 0:g.situation_overview)||"Financial situation analysis and recommendations."}
      </p>
      
      ${(T=(S=t.profile)==null?void 0:S.financials)!=null&&T.netWorth?`
        <div style="background: rgba(59, 130, 246, 0.1); border: 1px solid #3b82f6; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
          <h3 style="color: #60a5fa; font-size: 1rem; font-weight: 600; margin-bottom: 0.75rem;">📊 Current Asset Allocation</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem;">
            ${t.profile.financials.assets?Object.entries({"Real Estate":t.profile.financials.netWorth.total*.52,"Stocks & Investments":t.profile.financials.netWorth.total*.44,"Cash & Liquid":t.profile.financials.netWorth.total*.04}).map(([F,O])=>`
              <div style="background: rgba(75, 85, 99, 0.3); border-radius: 6px; padding: 0.75rem;">
                <div style="color: #f3f4f6; font-weight: 600; font-size: 0.875rem;">${F}</div>
                <div style="color: #34d399; font-size: 1.125rem; font-weight: 700;">$${Math.round(O).toLocaleString()}</div>
                <div style="color: #9ca3af; font-size: 0.75rem;">${Math.round(O/t.profile.financials.netWorth.total*100)}% of portfolio</div>
              </div>
            `).join(""):""}
          </div>
        </div>
      `:""}
      
      <h2 style="font-size: 1.25rem; font-weight: 400; color: #e5e7eb; margin: 1.5rem 0 0.75rem 0; padding-bottom: 0.375rem; border-bottom: 1px solid #4b5563;">Priority Actions</h2>
      <p style="color: #9ca3af; margin-bottom: 1.5rem; font-style: italic;">(Next 30 Days)</p>
      
      ${(m.priority_actions_30d||m.priority_actions||[]).map((F,O)=>`
        <div style="margin-bottom: 1.5rem;">
          <div style="display: flex; align-items: flex-start; margin-bottom: 0.75rem;">
            <span style="display: inline-flex; align-items: center; justify-content: center; width: 1.5rem; height: 1.5rem; background: #3b82f6; color: white; border-radius: 50%; font-size: 0.875rem; font-weight: 600; margin-right: 0.75rem; flex-shrink: 0; margin-top: 0.125rem;">${O+1}</span>
            <div>
              <h3 style="color: #f3f4f6; font-size: 1rem; font-weight: 600; margin: 0 0 0.5rem 0; line-height: 1.4;">
                ${F.title||F.action||"Priority Action"}
              </h3>
              <p style="color: #d1d5db; margin: 0; line-height: 1.6; font-size: 0.95rem;">
                ${F.why_it_matters||F.rationale||"Action details."}
              </p>
            </div>
          </div>
        </div>
      `).join("")}
      
      ${((v=m.strategy_12m)==null?void 0:v.length)>0||Object.keys(m.twelve_month_strategy||{}).length>0?`
        <h2 style="font-size: 1.25rem; font-weight: 400; color: #e5e7eb; margin: 1.5rem 0 0.75rem 0; padding-bottom: 0.375rem; border-bottom: 1px solid #4b5563;">12-Month Strategy</h2>
        
        ${m.strategy_12m?m.strategy_12m.map((F,O)=>`
            <div style="margin-bottom: 1.5rem;">
              <h3 style="color: #f3f4f6; font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem;">${F.quarter||`Q${O+1}`}</h3>
              <ul style="list-style: none; padding: 0; margin: 0;">
                ${(F.actions||[]).map(J=>`
                  <li style="color: #d1d5db; margin-bottom: 0.5rem; padding-left: 1rem; position: relative; line-height: 1.6;">
                    <span style="position: absolute; left: 0; color: #60a5fa;">•</span>
                    ${J}
                  </li>
                `).join("")}
              </ul>
            </div>
          `).join(""):Object.entries(m.twelve_month_strategy||{}).map(([F,O])=>`
          <div style="margin-bottom: 1.5rem;">
            <h3 style="color: #f3f4f6; font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem;">${F}</h3>
            <ul style="list-style: none; padding: 0; margin: 0;">
              ${(O||[]).map(J=>`
                <li style="color: #d1d5db; margin-bottom: 0.5rem; padding-left: 1rem; position: relative; line-height: 1.6;">
                  <span style="position: absolute; left: 0; color: #60a5fa;">•</span>
                  ${J}
                </li>
              `).join("")}
            </ul>
          </div>
        `).join("")}
      `:""}
      
      ${(((P=(L=m.risk_management)==null?void 0:L.top_risks)==null?void 0:P.length)||0)>0||(((C=(z=m.risk_management)==null?void 0:z.mitigations)==null?void 0:C.length)||0)>0?`
        <h2 style="font-size: 1.25rem; font-weight: 400; color: #e5e7eb; margin: 1.5rem 0 0.75rem 0; padding-bottom: 0.375rem; border-bottom: 1px solid #4b5563;">Risk Management</h2>
        
        ${(((E=(j=m.risk_management)==null?void 0:j.top_risks)==null?void 0:E.length)||0)>0?`
          <h3 style="color: #fca5a5; font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem;">Key Risks</h3>
          <ul style="list-style: none; padding: 0; margin: 0 0 1.5rem 0;">
            ${m.risk_management.top_risks.map(F=>`
              <li style="color: #fecaca; margin-bottom: 0.5rem; padding-left: 1rem; position: relative; line-height: 1.6;">
                <span style="position: absolute; left: 0; color: #ef4444;">•</span>
                ${F}
              </li>
            `).join("")}
          </ul>
        `:""}
        
        ${(((y=(A=m.risk_management)==null?void 0:A.mitigations)==null?void 0:y.length)||0)>0?`
          <h3 style="color: #86efac; font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem;">Mitigations</h3>
          <ul style="list-style: none; padding: 0; margin: 0;">
            ${m.risk_management.mitigations.map(F=>`
              <li style="color: #bbf7d0; margin-bottom: 0.5rem; padding-left: 1rem; position: relative; line-height: 1.6;">
                <span style="position: absolute; left: 0; color: #22c55e;">•</span>
                ${F}
              </li>
            `).join("")}
          </ul>
        `:""}
      `:""}
      
      ${(((k=(R=m.tax_considerations)==null?void 0:R.ideas)==null?void 0:k.length)||0)>0?`
        <h2 style="font-size: 1.25rem; font-weight: 400; color: #e5e7eb; margin: 1.5rem 0 0.75rem 0; padding-bottom: 0.375rem; border-bottom: 1px solid #4b5563;">Tax Considerations</h2>
        
        <ul style="list-style: none; padding: 0; margin: 0;">
          ${m.tax_considerations.ideas.map((F,O)=>`
            <li style="color: #d1d5db; margin-bottom: 0.75rem; line-height: 1.6;">
              <strong style="color: #93c5fd;">${O+1}.</strong> ${F}
            </li>
          `).join("")}
        </ul>
      `:""}
      </div>
    `,console.log("🎨 Generated content length:",p.length),console.log("🎨 First 500 chars of content:",p.substring(0,500)),p},b=()=>{a(p=>({...p,content:"",profile:null,lastGenerated:null,error:"",structuredAdvisory:null,validationResults:[]}));const m=s!=null&&s.id?`wpa-advisory-state-${s.id}`:"wpa-advisory-state-guest";localStorage.removeItem(m)};return e.jsx("div",{className:"min-h-screen bg-gray-900 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"AI Financial Advisory"}),e.jsx("p",{className:"text-gray-400 mb-1",children:"Professional advisory powered by LLM integration"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("div",{className:"flex items-center gap-4 mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.advisoryMode==="deterministic"?"bg-blue-900/30 text-blue-400 border border-blue-500/50":"bg-gray-700/30 text-gray-400 border border-gray-600"}`,children:t.advisoryMode==="deterministic"?"🛡️ DETERMINISTIC":"🔄 TRADITIONAL"}),t.advisoryMode==="deterministic"&&e.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 text-xs rounded border border-green-500/50",children:"VALIDATED"})]})}),i(t.selectedProvider)," Provider: ",e.jsx("span",{className:"font-medium text-gray-300",children:t.selectedProvider.toUpperCase()})," • Model: ",e.jsx("span",{className:"font-medium text-gray-300",children:r(t.selectedProvider,t.modelTier)})," • Cost: ",e.jsxs("span",{className:"font-medium text-green-400",children:["$",n(t.selectedProvider,t.modelTier)]}),t.selectedProvider==="gemini"&&t.modelTier==="dev"&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-green-900/30 text-green-400 text-xs rounded",children:"CHEAPEST!"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx($,{onClick:()=>a(m=>({...m,advisoryMode:m.advisoryMode==="deterministic"?"traditional":"deterministic"})),variant:"outline",size:"sm",leftIcon:e.jsx(wt,{className:"w-4 h-4"}),className:t.advisoryMode==="deterministic"?"border-blue-500/50 text-blue-400":"border-gray-600 text-gray-400",children:t.advisoryMode==="deterministic"?"Deterministic":"Traditional"}),e.jsx($,{onClick:()=>a(m=>({...m,showProviderSelector:!m.showProviderSelector})),variant:"outline",size:"sm",leftIcon:e.jsx(Us,{className:"w-4 h-4"}),children:"LLM Settings"}),e.jsxs($,{onClick:()=>a(m=>({...m,showRawData:!m.showRawData})),variant:"outline",size:"sm",leftIcon:e.jsx(tt,{className:"w-4 h-4"}),children:[t.showRawData?"Hide":"Show"," Data"]}),t.content&&e.jsx($,{onClick:b,variant:"outline",size:"sm",leftIcon:e.jsx(_t,{className:"w-4 h-4"}),className:"text-red-400 border-red-500/50 hover:bg-red-900/20",children:"Clear Report"}),e.jsx($,{onClick:o,disabled:t.loading,isLoading:t.loading,leftIcon:t.loading?void 0:e.jsx(lt,{className:"w-4 h-4"}),variant:"primary",className:"bg-green-600 hover:bg-green-700",children:t.loading?`Generating with ${t.selectedProvider}...`:"Generate Advisory"}),e.jsx($,{onClick:()=>{console.log("🔄 Clearing content"),a(m=>({...m,content:"",loading:!1}))},variant:"secondary",className:"bg-red-600 hover:bg-red-700 mt-2 ml-2",children:"🗑️ Clear"})]})]}),t.error&&e.jsx(_,{className:"bg-red-900/20 border-red-500/50 mb-6",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-red-400 font-medium",children:"Error"})]}),e.jsx("p",{className:"text-red-300 mt-2",children:t.error})]})}),t.lastGenerated&&!t.loading&&!t.error&&e.jsx(_,{className:"bg-green-900/20 border-green-500/50 mb-6",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-green-400 font-medium",children:"Advisory Generated"}),e.jsx("span",{className:"text-gray-400 text-sm",children:new Date(t.lastGenerated).toLocaleTimeString()}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["• Cost: $",n(t.selectedProvider,t.modelTier)]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["• Mode: ",t.advisoryMode.toUpperCase()]})]})})}),t.showProviderSelector&&e.jsx(_,{className:"bg-gray-800/50 border-gray-700 mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"🤖 LLM Provider Settings"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Choose Provider"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:["openai","gemini","claude"].map(m=>e.jsx("button",{onClick:()=>a(p=>({...p,selectedProvider:m})),className:`p-4 rounded-lg border transition-all ${t.selectedProvider===m?"bg-blue-900/30 border-blue-500 text-blue-300":"bg-gray-700/30 border-gray-600 text-gray-300 hover:bg-gray-700/50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:i(m)}),e.jsx("div",{className:"font-semibold text-lg",children:m.toUpperCase()}),e.jsx("div",{className:"text-sm opacity-75",children:l(m)}),e.jsxs("div",{className:"text-xs mt-2 opacity-60",children:["Dev: $",n(m,"dev")," • Prod: $",n(m,"prod")]})]})},m))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Model Tier"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>a(m=>({...m,modelTier:"dev"})),className:`flex-1 p-3 rounded-lg border transition-all ${t.modelTier==="dev"?"bg-green-900/30 border-green-500 text-green-300":"bg-gray-700/30 border-gray-600 text-gray-300 hover:bg-gray-700/50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"💰 Dev Tier"}),e.jsx("div",{className:"text-sm opacity-75",children:"Cheaper • Good Quality"}),e.jsx("div",{className:"text-xs mt-1 opacity-60",children:r(t.selectedProvider,"dev")})]})}),e.jsx("button",{onClick:()=>a(m=>({...m,modelTier:"prod"})),className:`flex-1 p-3 rounded-lg border transition-all ${t.modelTier==="prod"?"bg-purple-900/30 border-purple-500 text-purple-300":"bg-gray-700/30 border-gray-600 text-gray-300 hover:bg-gray-700/50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"🚀 Prod Tier"}),e.jsx("div",{className:"text-sm opacity-75",children:"Premium • Best Quality"}),e.jsx("div",{className:"text-xs mt-1 opacity-60",children:r(t.selectedProvider,"prod")})]})})]})]}),e.jsx("div",{className:"bg-yellow-900/20 border border-yellow-500/30 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-yellow-400 font-medium",children:["Estimated Cost: $",n(t.selectedProvider,t.modelTier)," per advisory"]}),e.jsxs("div",{className:"text-yellow-300/70 text-sm mt-1",children:["Current Selection: ",t.selectedProvider.toUpperCase()," ",t.modelTier.toUpperCase(),"(",r(t.selectedProvider,t.modelTier),")"]})]}),t.selectedProvider==="gemini"&&t.modelTier==="dev"&&e.jsx("div",{className:"px-3 py-1 bg-green-900/30 text-green-400 text-sm rounded-full font-medium",children:"🎉 CHEAPEST OPTION!"})]})})]})}),t.showRawData&&e.jsx("div",{className:"mb-6",children:e.jsx(Kc,{})}),t.content?e.jsxs("div",{className:"bg-gray-800/90 border border-gray-600 rounded-lg shadow-xl p-6",children:[e.jsx("div",{className:"mb-6 pb-4 border-b border-gray-600",children:e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-400",children:[e.jsxs("span",{children:[i(t.selectedProvider)," ",t.selectedProvider.toUpperCase()]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:r(t.selectedProvider,t.modelTier)}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"text-green-400",children:["$",n(t.selectedProvider,t.modelTier)]})]})}),e.jsx("div",{style:{fontFamily:"Georgia, Times New Roman, serif",lineHeight:"1.6",fontSize:"15px",color:"#e5e7eb"},dangerouslySetInnerHTML:{__html:t.content||"<p>No content</p>"}})]}):null,!t.content&&!t.loading&&!t.error&&e.jsx(_,{className:"bg-gray-800/50 border-gray-700",children:e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(lt,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Ready to Generate Your Advisory"}),e.jsx("p",{className:"text-gray-400 mb-6 max-w-2xl mx-auto",children:'Click "Generate Advisory" to create a comprehensive financial advisory report using real data from your profile and AI-powered analysis.'}),e.jsx($,{onClick:o,size:"lg",variant:"primary",leftIcon:e.jsx(lt,{className:"w-5 h-5"}),className:"bg-green-600 hover:bg-green-700",children:"Generate Advisory Report"})]})})]})})},Jc=({onNext:s,className:t=""})=>e.jsx(Qc,{onNext:s,className:t}),Xc=(s,t)=>{let a=[];if(console.log("calculatePortfolioBreakdown called with:",{totalAssets:s,hasPortfolioAllocation:!!t,portfolioData:t}),t&&t.amounts){const i=t.amounts;console.log("Using portfolio allocation data:",i),a=[{category:"Real Estate",amount:i.real_estate||0,color:"#10B981",riskLevel:"Medium",liquidity:"Low"},{category:"Stocks",amount:i.stocks||0,color:"#3B82F6",riskLevel:"High",liquidity:"High"},{category:"Bonds",amount:i.bonds||0,color:"#F59E0B",riskLevel:"Low",liquidity:"Medium"},{category:"Cash",amount:i.cash||0,color:"#6B7280",riskLevel:"Low",liquidity:"High"},{category:"Alternative",amount:i.alternative||0,color:"#EF4444",riskLevel:"High",liquidity:"Medium"},{category:"Other",amount:i.other||0,color:"#9CA3AF",riskLevel:"Medium",liquidity:"Medium"}].filter(o=>o.amount>0)}else console.log("No financial data available, using fallback sample data"),s>0&&!isNaN(s)?a=[{category:"Real Estate",amount:s*.6,color:"#10B981",riskLevel:"Medium",liquidity:"Low"},{category:"Stocks",amount:s*.16,color:"#3B82F6",riskLevel:"High",liquidity:"High"},{category:"Bonds",amount:s*.04,color:"#F59E0B",riskLevel:"Low",liquidity:"Medium"},{category:"Cash",amount:s*.03,color:"#6B7280",riskLevel:"Low",liquidity:"High"},{category:"Alternative",amount:s*.01,color:"#EF4444",riskLevel:"High",liquidity:"Medium"}]:a=[{category:"Real Estate",amount:1152500,color:"#10B981",riskLevel:"Medium",liquidity:"Low"},{category:"Stocks",amount:315e3,color:"#3B82F6",riskLevel:"High",liquidity:"High"},{category:"Retirement",amount:3e5,color:"#8B5CF6",riskLevel:"Medium",liquidity:"Low"},{category:"Bonds",amount:8e4,color:"#F59E0B",riskLevel:"Low",liquidity:"Medium"},{category:"Cash",amount:72300,color:"#6B7280",riskLevel:"Low",liquidity:"High"},{category:"Alternative",amount:17700,color:"#EF4444",riskLevel:"High",liquidity:"Medium"}];const r=a.reduce((i,l)=>i+l.amount,0),n=r>0?r:s;return a.map(i=>({...i,percentage:n>0?Math.round(i.amount/n*100):0}))},ed=(s,t=38)=>[{category:"Stocks",target:70,color:"#3B82F6"},{category:"Real Estate",target:20,color:"#10B981"},{category:"Bonds",target:6,color:"#F59E0B"},{category:"Cash",target:2,color:"#6B7280"},{category:"Alternative",target:2,color:"#EF4444"}],td=({totalAssets:s,riskTolerance:t,age:a=38,financialData:r})=>{var S,T;const{data:n,isLoading:i,error:l}=bl(),o=l?"Failed to fetch portfolio data":null,c=isNaN(s)||s<=0?(n==null?void 0:n.total)||((S=r==null?void 0:r.totals)==null?void 0:S.total_assets)||((T=r==null?void 0:r.totals)==null?void 0:T.assets)||0:s;console.log("SimplePortfolioAnalysis - received data:",{originalTotalAssets:s,safeTotalAssets:c,portfolioAllocation:n,loading:i,error:o});const u=Xc(c,n),h=ed(t,a),f=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(v),d=Math.max(...u.map(v=>v.percentage)),x=d>40,b=u.find(v=>v.percentage===d),m=u.find(v=>v.category==="Real Estate"),p=u.find(v=>v.category==="Stocks"),N=h.find(v=>v.category==="Stocks"),g=[];if(m&&m.percentage>40){const v=(m.percentage-20)*c/100;g.push({type:"reduce",asset:"Real Estate",current:m.percentage,target:20,action:"Sell rental property or convert to REITs",amount:v,impact:"Reduce concentration risk, increase liquidity",priority:"High"})}if(p&&N&&p.percentage<60){const v=(70-p.percentage)*c/100;g.push({type:"increase",asset:"Stocks",current:p.percentage,target:70,action:"Reallocate from real estate to stock index funds",amount:v,impact:"Increase expected returns by 2.3% annually",priority:"High"})}return i?e.jsxs("div",{style:{marginBottom:"40px"},children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("h3",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#e2e8f0",display:"flex",alignItems:"center",gap:"12px",margin:"0 0 8px 0"},children:[e.jsx(tt,{style:{color:"#3B82F6",width:"24px",height:"24px"}}),"Portfolio Analysis"]}),e.jsx("p",{style:{color:"#9CA3AF",margin:0},children:"Loading portfolio data..."})]}),e.jsx("div",{style:{background:"#1a1a2e",borderRadius:"12px",border:"1px solid #2d2d4e",padding:"40px",textAlign:"center"},children:e.jsx("div",{style:{color:"#9CA3AF"},children:"Analyzing your portfolio allocation..."})})]}):e.jsxs("div",{style:{marginBottom:"40px"},children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("h3",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#e2e8f0",display:"flex",alignItems:"center",gap:"12px",margin:"0 0 8px 0"},children:[e.jsx(tt,{style:{color:"#3B82F6",width:"24px",height:"24px"}}),"Portfolio Analysis ",(n==null?void 0:n.entry_count)&&`(${n.entry_count} assets)`]}),e.jsxs("p",{style:{color:"#9CA3AF",margin:0},children:["Asset allocation analysis based on your ",f(c)," portfolio",o&&e.jsxs("span",{style:{color:"#EF4444"},children:[" - ",o]})]})]}),x&&b&&e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid #EF4444",borderRadius:"8px",padding:"16px",marginBottom:"24px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(Je,{style:{color:"#EF4444",width:"20px",height:"20px",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("h4",{style:{color:"#FEE2E2",fontSize:"1rem",fontWeight:"600",margin:"0 0 4px 0"},children:"Concentration Risk Alert"}),e.jsxs("p",{style:{color:"#FECACA",fontSize:"0.875rem",margin:0},children:[b.percentage,"% of your portfolio is in ",b.category,". This creates significant risk if this asset class underperforms."]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"24px",marginBottom:"32px"},children:[e.jsxs("div",{style:{background:"#1a1a2e",borderRadius:"12px",border:"1px solid #2d2d4e",padding:"24px"},children:[e.jsxs("h4",{style:{color:"#e2e8f0",fontSize:"1.1rem",fontWeight:"600",margin:"0 0 20px 0",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(sd,{style:{color:"#3B82F6",width:"20px",height:"20px"}}),"Current Allocation"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:u.map(v=>{const L=h.find(C=>C.category===v.category),P=L&&v.percentage>L.target+5,z=L&&v.percentage<L.target-5;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:v.color,flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{color:"#e2e8f0",fontSize:"0.9rem",fontWeight:"500"},children:v.category}),e.jsxs("span",{style:{color:P?"#EF4444":z?"#F59E0B":"#e2e8f0",fontSize:"0.9rem",fontWeight:"600"},children:[v.percentage,"%"]})]}),e.jsx("div",{style:{color:"#9CA3AF",fontSize:"0.75rem",marginTop:"2px"},children:f(v.amount)})]})]},v.category)})})]}),e.jsxs("div",{style:{background:"#1a1a2e",borderRadius:"12px",border:"1px solid #2d2d4e",padding:"24px"},children:[e.jsxs("h4",{style:{color:"#e2e8f0",fontSize:"1.1rem",fontWeight:"600",margin:"0 0 20px 0",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(De,{style:{color:"#10B981",width:"20px",height:"20px"}}),"Target vs Current"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:h.map(v=>{const L=u.find(C=>C.category===v.category),P=(L==null?void 0:L.percentage)||0,z=v.target-P;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#e2e8f0",fontSize:"0.85rem"},children:v.category}),e.jsxs("span",{style:{color:"#9CA3AF",fontSize:"0.75rem"},children:[P,"% → ",v.target,"%"]})]}),e.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"#374151",borderRadius:"4px",overflow:"hidden",position:"relative"},children:e.jsx("div",{style:{width:`${Math.min(100,P/v.target*100)}%`,height:"100%",backgroundColor:Math.abs(z)<=5?"#10B981":z>0?"#EF4444":"#F59E0B",transition:"all 0.3s ease"}})})]},v.category)})})]})]}),g.length>0&&e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid #3B82F6",borderRadius:"12px",padding:"24px"},children:[e.jsxs("h4",{style:{color:"#e2e8f0",fontSize:"1.1rem",fontWeight:"600",margin:"0 0 20px 0",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Te,{style:{color:"#10B981",width:"20px",height:"20px"}}),"Rebalancing Recommendations"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:g.map((v,L)=>e.jsxs("div",{style:{background:"rgba(31, 41, 55, 0.5)",border:"1px solid #374151",borderRadius:"8px",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{background:v.priority==="High"?"#EF4444":"#F59E0B",color:"white",padding:"2px 8px",borderRadius:"12px",fontSize:"0.75rem",fontWeight:"500"},children:v.priority}),e.jsxs("span",{style:{color:"#e2e8f0",fontWeight:"600"},children:[v.type==="reduce"?"Reduce":"Increase"," ",v.asset]})]}),e.jsxs("span",{style:{color:"#9CA3AF",fontSize:"0.875rem"},children:[v.current,"% → ",v.target,"%"]})]}),e.jsx("p",{style:{color:"#D1D5DB",margin:"0 0 12px 0",fontSize:"0.875rem"},children:v.action}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",fontSize:"0.875rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{color:"#9CA3AF"},children:"Amount: "}),e.jsx("span",{style:{color:"#e2e8f0",fontWeight:"500"},children:f(v.amount)})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"#9CA3AF"},children:"Impact: "}),e.jsx("span",{style:{color:"#10B981"},children:v.impact})]})]})]},L))})]})]})},sd=({style:s})=>e.jsx(tt,{style:s}),ad=()=>{const[s,t]=w.useState(null),[a,r]=w.useState(!1),n=async()=>{r(!0),t(null);const o=Date.now();try{console.log("🧪 Testing FinancialDataService...");const c=await Zc.getCompleteFinancialProfile(1),u=Date.now()-o;t({success:!0,profile:c,loadTime:u}),console.log("✅ Service test completed successfully:",c)}catch(c){const u=Date.now()-o;t({success:!1,error:c instanceof Error?c.message:"Unknown error",loadTime:u}),console.error("❌ Service test failed:",c)}finally{r(!1)}};w.useEffect(()=>{n()},[]);const i=o=>e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-4",children:"✅ Service Test Passed!"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"👤 User Profile"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",o.user.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",o.user.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Age:"})," ",o.user.age||"Not set"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"💰 Financial Position"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Net Worth:"})," $",o.financials.netWorth.total.toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Monthly Income:"})," $",o.financials.cashFlow.monthlyIncome.toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Savings Rate:"})," ",o.financials.cashFlow.savingsRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"🎯 Goals"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Goals:"})," ",o.goals.length]}),o.goals.slice(0,2).map(c=>e.jsxs("p",{children:[e.jsxs("strong",{children:[c.name,":"]})," ",c.percentComplete.toFixed(1),"% complete"]},c.id))]}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"🔍 Insights"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Years to Retirement:"})," ",o.insights.yearsToRetirement.toFixed(1)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Retirement Readiness:"})," ",o.insights.retirementReadiness.toFixed(1),"%"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Tax Optimization:"})," $",o.insights.taxOptimizationPotential.toLocaleString()]})]})]}),e.jsxs("div",{className:"mt-6 bg-white p-4 rounded border",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"🏠 Asset Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Liquid"}),e.jsxs("p",{className:"font-semibold",children:["$",o.financials.netWorth.liquid.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Invested"}),e.jsxs("p",{className:"font-semibold",children:["$",o.financials.netWorth.invested.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Real Estate"}),e.jsxs("p",{className:"font-semibold",children:["$",o.financials.netWorth.realEstate.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Other"}),e.jsxs("p",{className:"font-semibold",children:["$",o.financials.netWorth.other.toLocaleString()]})]})]})]})]}),l=o=>e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-4",children:"❌ Service Test Failed"}),e.jsx("p",{className:"text-red-700 mb-4",children:o}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"🔧 Troubleshooting"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"Check if backend server is running (Docker containers)"}),e.jsx("li",{children:"Verify authentication token is valid"}),e.jsx("li",{children:"Ensure user ID 1 exists in database"}),e.jsx("li",{children:"Check browser console for detailed errors"})]})]})]});return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"🧪 Financial Data Service Test"}),e.jsx("p",{className:"text-gray-600",children:"Testing our clean FinancialDataService that fetches from new clean API endpoints."})]}),e.jsxs("div",{className:"mb-6 flex items-center gap-4",children:[e.jsx("button",{onClick:n,disabled:a,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:a?"🔄 Testing...":"🧪 Run Test"}),s&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Load time: ",s.loadTime,"ms"]})]}),a&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-3"}),e.jsx("span",{className:"text-blue-800",children:"Testing FinancialDataService..."})]}),e.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Fetching data from: /api/v1/financial/entries, /api/v1/financial/live-summary, /api/v1/financial/cash-flow, /api/v1/users/profile"})]}),s&&!a&&(s.success&&s.profile?i(s.profile):l(s.error||"Unknown error")),(s==null?void 0:s.success)&&s.profile&&e.jsxs("div",{className:"mt-6 bg-gray-50 border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"✅ Validation Checklist"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Data Quality"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{className:s.profile.user.name!=="User"?"text-green-600":"text-red-600",children:['✓ Real user name (not "User"): ',s.profile.user.name]}),e.jsxs("li",{className:s.profile.financials.netWorth.total>1e6?"text-green-600":"text-red-600",children:["✓ Net worth > $1M: $",s.profile.financials.netWorth.total.toLocaleString()]}),e.jsxs("li",{className:s.profile.financials.cashFlow.monthlyIncome>15e3?"text-green-600":"text-red-600",children:["✓ Monthly income > $15K: $",s.profile.financials.cashFlow.monthlyIncome.toLocaleString()]}),e.jsxs("li",{className:s.profile.goals.length>0?"text-green-600":"text-red-600",children:["✓ Has goals: ",s.profile.goals.length," goals"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Performance"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{className:(s.loadTime||0)<2e3?"text-green-600":"text-red-600",children:["✓ Load time < 2s: ",s.loadTime,"ms"]}),e.jsx("li",{className:"text-green-600",children:"✓ No fallback data used"}),e.jsx("li",{className:"text-green-600",children:"✓ Live calculations only"}),e.jsx("li",{className:"text-green-600",children:"✓ Explicit error handling"})]})]})]})]})]})},rd=({messages:s,loading:t,onSendMessage:a})=>{const[r,n]=w.useState(""),i=w.useRef(null),l=w.useRef(null);w.useEffect(()=>{o()},[s]);const o=()=>{var x;(x=i.current)==null||x.scrollIntoView({behavior:"smooth"})},c=()=>{r.trim()&&!t&&(a(r.trim()),n(""),l.current&&(l.current.style.height="auto"))},u=x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),c())},h=x=>{n(x.target.value);const b=x.target;b.style.height="auto",b.style.height=Math.min(b.scrollHeight,120)+"px"},f=x=>x.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),d=x=>({openai:"⚡",gemini:"💰",claude:"🎯"})[x]||"🤖";return e.jsxs(_,{className:"bg-gray-800 border-gray-700 h-[600px] flex flex-col",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[s.length===0?e.jsxs("div",{className:"text-center text-gray-500 mt-20",children:[e.jsx(Mr,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Start a conversation with your AI Financial Advisor"})]}):s.map(x=>e.jsx("div",{className:`flex ${x.role==="user"?"justify-end":"justify-start"} group`,children:e.jsxs("div",{className:`max-w-[80%] rounded-lg p-4 ${x.role==="user"?"bg-blue-600 text-white":x.role==="assistant"?"bg-gray-700 text-gray-100":"bg-yellow-900/30 border border-yellow-500/30 text-yellow-200 text-center"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm opacity-75",children:[x.role==="user"?e.jsx(Lt,{className:"w-4 h-4"}):e.jsx(Mr,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:x.role==="user"?"You":"AI Advisor"}),e.jsx(Dt,{className:"w-3 h-3"}),e.jsx("span",{children:f(x.timestamp)})]}),x.role==="assistant"&&e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-xs text-gray-400 flex items-center space-x-2",children:[e.jsx("span",{children:d(x.provider)}),e.jsx("span",{children:x.model}),x.cost>0&&e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-3 h-3"}),e.jsxs("span",{children:["$",x.cost.toFixed(4)]})]}),e.jsxs("span",{children:[x.tokenCount," tokens"]})]})]}),e.jsx("div",{className:"prose prose-sm prose-invert max-w-none",children:x.role==="assistant"?e.jsx("div",{className:"text-gray-100 leading-relaxed",dangerouslySetInnerHTML:{__html:nd(x.content)}}):e.jsx("p",{className:"whitespace-pre-wrap",children:x.content})}),x.context&&e.jsx("div",{className:"mt-3 pt-2 border-t border-gray-600 text-xs text-gray-400",children:e.jsxs("span",{className:"opacity-60",children:["Context: ",(()=>{try{if((typeof x.context=="string"?JSON.parse(x.context):x.context).complete_context_used)return"Complete Financial Context"}catch{if(x.context.includes("complete_context_used"))return"Complete Financial Context"}return`Vector database + ${x.context.split(`
`).length} data points`})()]})})]})},x.id)),t&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-700 text-gray-100 rounded-lg p-4 max-w-[80%]",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ms,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"text-sm",children:"AI Advisor is thinking..."})]})})}),e.jsx("div",{ref:i})]}),e.jsx("div",{className:"border-t border-gray-700 p-4",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("textarea",{ref:l,value:r,onChange:h,onKeyPress:u,placeholder:"Ask about your finances, goals, or investments...",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent min-h-[44px] max-h-[120px]",disabled:t})}),e.jsx($,{onClick:c,disabled:!r.trim()||t,variant:"primary",size:"sm",leftIcon:t?e.jsx(Ms,{className:"w-4 h-4 animate-spin"}):e.jsx(ll,{className:"w-4 h-4"}),className:"bg-blue-600 hover:bg-blue-700 px-6 self-end",children:t?"Sending...":"Send"})]})})]})},nd=s=>s.replace(/\*\*([^*\n]+)\*\*/g,'<strong class="text-white">$1</strong>').replace(/\$[\d,]+\.?\d*/g,'<span class="text-green-400 font-semibold">$&</span>').replace(/\b\d+\.?\d*%/g,'<span class="text-blue-400 font-semibold">$&</span>').replace(/\n\n/g,'</p><p class="mb-2">').replace(/\n/g,"<br/>").replace(/^/,'<p class="mb-2">').replace(/$/,"</p>"),jn=[{id:"retirement",title:"Retirement",tiles:[{id:"retire_on_track",label:"Am I on track?",prompt:"Am I on track for my retirement goal?"},{id:"goal_in_2y",label:"Goal if retiring in 2 years",prompt:"What if I retire in 2 years, what should be my goal?"},{id:"monthly_for_target",label:"Monthly needed for $3.5M in 5 years",prompt:"How much should I save monthly to reach $3,500,000 in 5 years?"},{id:"withdrawal_check",label:"Safe withdrawal check (4%)",prompt:"Can I safely withdraw 4% from my portfolio?"}]},{id:"investing",title:"Investing",tiles:[{id:"rebalance",label:"Rebalance to target",prompt:"Should I rebalance my portfolio? What trades are needed to reach target allocation?"},{id:"projection_10y",label:"10-year projection (5/7/9%)",prompt:"What is my net worth projection in 10 years? Show scenarios at 5%, 7% and 9% growth."},{id:"asset_location",label:"Tax-efficient asset location",prompt:"How should I place assets across accounts for tax efficiency?"},{id:"fees",label:"Fees & drag audit",prompt:"Am I paying too much in fees? Quantify fees and performance drag."}]},{id:"taxes",title:"Taxes",tiles:[{id:"tax_bracket",label:"Tax bracket & marginal (this year)",prompt:"What is my tax bracket and marginal rate this year?"},{id:"roth_vs_trad",label:"Roth vs Traditional (this year)",prompt:"Should I contribute Roth or Traditional this year?"},{id:"roth_conv",label:"Roth conversion window",prompt:"Do I have a Roth conversion window this year?"},{id:"tlh",label:"Tax-loss harvest candidates",prompt:"Do I have tax-loss harvesting candidates right now?"}]},{id:"expenses",title:"Expenses",tiles:[{id:"breakdown",label:"Monthly expense breakdown",prompt:"Show a breakdown of my expenses for the last full month."},{id:"overspend_trends",label:"Overspending & trends (3 months)",prompt:"Find overspending and trends over the last 3 months."},{id:"subscriptions",label:"Hidden subscriptions",prompt:"List all subscriptions and price changes."},{id:"peer_compare",label:"Compare vs peers (state/city)",prompt:"Compare my spending to peers in my area."}]}],id=({onQuestionClick:s,disabled:t})=>{var o;const[a,r]=w.useState("retirement");w.useEffect(()=>{},[]);const n=jn.map(c=>({id:c.id,title:c.title,icon:c.id==="retirement"?e.jsx(De,{className:"w-4 h-4"}):c.id==="investing"?e.jsx(Te,{className:"w-4 h-4"}):c.id==="taxes"?e.jsx(ge,{className:"w-4 h-4"}):e.jsx(Ta,{className:"w-4 h-4"}),questions:c.tiles.map(u=>u.label)})),i=Object.fromEntries(jn.flatMap(c=>c.tiles.map(u=>[u.label,u.prompt]))),l=((o=n.find(c=>c.id===a))==null?void 0:o.questions)||[];return e.jsxs(_,{className:"bg-gray-800 border-gray-700 h-[600px] flex flex-col",children:[e.jsx(_.Header,{children:e.jsxs(_.Title,{className:"text-white flex items-center",children:[e.jsx(Ta,{className:"w-5 h-5 mr-2 text-blue-400"}),"Suggested Questions"]})}),e.jsxs(_.Body,{className:"flex-1 overflow-hidden flex flex-col p-0",children:[e.jsx("div",{className:"border-b border-gray-700 p-3",children:e.jsx("div",{className:"grid grid-cols-2 gap-1",children:n.map(c=>e.jsxs("button",{onClick:()=>r(c.id),disabled:t,className:`p-2 rounded-md text-xs font-medium transition-all flex items-center justify-center gap-1 ${a===c.id?"bg-blue-600 text-white":"bg-gray-700/50 text-gray-300 hover:bg-gray-700"} ${t?"opacity-50 cursor-not-allowed":""}`,children:[c.icon,e.jsx("span",{className:"truncate",children:c.title})]},c.id))})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:l.length===0?e.jsxs("div",{className:"text-center text-gray-500 mt-8",children:[e.jsx(Ta,{className:"w-8 h-8 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Loading questions..."})]}):l.map((c,u)=>e.jsxs("button",{onClick:()=>s(i[c]||c),disabled:t,className:`w-full text-left p-3 rounded-lg border transition-all ${t?"bg-gray-700/30 border-gray-600 text-gray-500 cursor-not-allowed":"bg-gray-700/50 border-gray-600 text-gray-300 hover:bg-gray-700 hover:border-gray-500 hover:text-white"}`,children:[e.jsx("div",{className:"text-sm leading-relaxed",children:c}),a==="contextual"&&e.jsx("div",{className:"text-xs text-blue-400 mt-1",children:"Personalized for you"})]},u))}),e.jsx("div",{className:"border-t border-gray-700 p-3",children:e.jsx("div",{className:"text-xs text-gray-400 text-center",children:e.jsxs("span",{children:[l.length," questions available"]})})})]})]})},ld=({session:s})=>{const[t,a]=w.useState(!1),[r,n]=w.useState(!1),i=()=>{const b={};return s.messages.forEach(m=>{m.role==="assistant"&&(b[m.provider]||(b[m.provider]={messages:0,cost:0,tokens:0}),b[m.provider].messages++,b[m.provider].cost+=m.cost,b[m.provider].tokens+=m.tokenCount)}),b},l=()=>{const b=s.messages.filter(p=>p.context),m=b.reduce((p,N)=>{var g;return p+(((g=N.context)==null?void 0:g.length)||0)},0);return{messagesWithContext:b.length,averageContextLength:b.length>0?Math.round(m/b.length):0,totalContextLength:m}},o=i(),c=l(),u=s.messages.filter(b=>b.role==="assistant"),h=u.length>0?s.totalCost/u.length:0,f=new Date().getTime()-s.startTime.getTime(),d=Math.round(f/(1e3*60)),x=b=>({openai:"⚡",gemini:"💰",claude:"🎯"})[b]||"🤖";return e.jsxs(_,{className:"bg-gray-800/50 border-gray-700",children:[e.jsx(_.Header,{children:e.jsxs(_.Title,{className:"text-white flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(tt,{className:"w-5 h-5 mr-2 text-green-400"}),"Context & Usage Analytics"]}),e.jsx(ke,{variant:"info",size:"sm",className:"bg-blue-600 text-white",children:"Live Session"})]})}),e.jsxs(_.Body,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(ss,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Messages"})]}),e.jsx("div",{className:"text-lg font-semibold text-white",children:s.messages.length}),e.jsxs("div",{className:"text-xs text-gray-400",children:[u.length," responses"]})]}),e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(pa,{className:"w-4 h-4 text-yellow-400"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Tokens"})]}),e.jsx("div",{className:"text-lg font-semibold text-white",children:s.totalTokens.toLocaleString()}),e.jsxs("div",{className:"text-xs text-gray-400",children:[Math.round(s.totalTokens/(u.length||1))," avg/msg"]})]}),e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(ge,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Cost"})]}),e.jsxs("div",{className:"text-lg font-semibold text-white",children:["$",s.totalCost.toFixed(4)]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["$",h.toFixed(4)," avg/msg"]})]}),e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(Dt,{className:"w-4 h-4 text-purple-400"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Duration"})]}),e.jsxs("div",{className:"text-lg font-semibold text-white",children:[d,"m"]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Started ",s.startTime.toLocaleTimeString()]})]})]}),Object.keys(o).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center",children:[e.jsx(Vt,{className:"w-4 h-4 mr-2 text-blue-400"}),"Provider Breakdown"]}),e.jsx("div",{className:"space-y-2",children:Object.entries(o).map(([b,m])=>e.jsxs("div",{className:"bg-gray-700/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:x(b)}),e.jsx("span",{className:"font-medium text-white",children:b.toUpperCase()})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[m.messages," messages"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Tokens:"}),e.jsx("span",{className:"text-white ml-2 font-medium",children:m.tokens.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Cost:"}),e.jsxs("span",{className:"text-green-400 ml-2 font-medium",children:["$",m.cost.toFixed(4)]})]})]})]},b))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-white font-medium flex items-center",children:[e.jsx(Vt,{className:"w-4 h-4 mr-2 text-green-400"}),"Vector Context Analysis"]}),e.jsxs($,{variant:"ghost",size:"sm",onClick:()=>a(!t),rightIcon:t?e.jsx(us,{className:"w-4 h-4"}):e.jsx(zt,{className:"w-4 h-4"}),className:"text-gray-400 hover:text-white",children:[t?"Hide":"Show"," Details"]})]}),e.jsxs("div",{className:"bg-gray-700/30 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Messages with context:"}),e.jsx("span",{className:"text-white font-medium",children:c.messagesWithContext})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Average context length:"}),e.jsxs("span",{className:"text-white font-medium",children:[c.averageContextLength," chars"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Total context data:"}),e.jsxs("span",{className:"text-green-400 font-medium",children:[(c.totalContextLength/1024).toFixed(1)," KB"]})]})]}),t&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Context sources:"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 rounded p-2",children:[e.jsx("span",{className:"text-green-400 font-medium",children:"✓ Financial Summary:"}),e.jsx("span",{className:"text-gray-300 ml-2",children:"Net worth, assets, liabilities"})]}),e.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 rounded p-2",children:[e.jsx("span",{className:"text-blue-400 font-medium",children:"✓ User Preferences:"}),e.jsx("span",{className:"text-gray-300 ml-2",children:"Risk tolerance, investment style"})]}),e.jsxs("div",{className:"bg-purple-900/20 border border-purple-500/30 rounded p-2",children:[e.jsx("span",{className:"text-purple-400 font-medium",children:"✓ Active Goals:"}),e.jsx("span",{className:"text-gray-300 ml-2",children:"Retirement, education targets"})]}),e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-500/30 rounded p-2",children:[e.jsx("span",{className:"text-yellow-400 font-medium",children:"✓ Vector Search:"}),e.jsx("span",{className:"text-gray-300 ml-2",children:"Relevant context from database"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-white font-medium flex items-center",children:[e.jsx(ss,{className:"w-4 h-4 mr-2 text-blue-400"}),"Message History"]}),e.jsxs($,{variant:"ghost",size:"sm",onClick:()=>n(!r),rightIcon:r?e.jsx(us,{className:"w-4 h-4"}):e.jsx(zt,{className:"w-4 h-4"}),className:"text-gray-400 hover:text-white",children:[r?"Hide":"Show"," Breakdown"]})]}),r&&e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:u.slice(-5).map(b=>e.jsxs("div",{className:"bg-gray-700/30 rounded p-2 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:x(b.provider)}),e.jsx("span",{className:"text-gray-400",children:b.timestamp.toLocaleTimeString()})]}),e.jsxs("div",{className:"text-green-400 font-medium",children:["$",b.cost.toFixed(4)]})]}),e.jsxs("div",{className:"flex justify-between text-gray-400",children:[e.jsx("span",{children:b.model}),e.jsxs("span",{children:[b.tokenCount," tokens"]})]})]},b.id))})]}),e.jsx("div",{className:"pt-4 border-t border-gray-700",children:e.jsxs("div",{className:"text-xs text-gray-400 text-center",children:["Session ID: ",s.sessionId]})})]})]})},$a={openai:{dev:{model:"gpt-3.5-turbo",costPer1k:{input:.001,output:.002},icon:"⚡",description:"Fastest"},prod:{model:"gpt-4",costPer1k:{input:.03,output:.06},icon:"⚡",description:"Best Quality"}},gemini:{dev:{model:"gemini-1.5-flash",costPer1k:{input:.001,output:.001},icon:"💰",description:"Cheapest"},prod:{model:"gemini-1.5-pro",costPer1k:{input:.007,output:.007},icon:"💰",description:"Balanced"}},claude:{dev:{model:"claude-3-haiku",costPer1k:{input:.003,output:.015},icon:"🎯",description:"Creative"},prod:{model:"claude-3-opus",costPer1k:{input:.015,output:.075},icon:"🎯",description:"Best Quality"}}};class _r{constructor(){this.listeners=[],this.settings=this.loadSettings()}static getInstance(){return this.instance||(this.instance=new _r),this.instance}loadSettings(){try{const t=localStorage.getItem("llm_settings");if(t){const a=JSON.parse(t);return{provider:a.provider||"gemini",modelTier:a.modelTier||"dev",selectedModel:this.getModelForProvider(a.provider||"gemini",a.modelTier||"dev"),estimatedCostPerMessage:this.calculateMessageCost(2e3,a.provider||"gemini",a.modelTier||"dev"),temperature:a.temperature||.7,insightLevel:a.insightLevel||"balanced"}}}catch(t){console.error("Failed to load LLM settings:",t)}return{provider:"gemini",modelTier:"dev",selectedModel:"gemini-1.5-flash",estimatedCostPerMessage:.001,temperature:.7,insightLevel:"balanced"}}getSettings(){return{...this.settings}}updateSettings(t){this.settings={...this.settings,...t,selectedModel:this.getModelForProvider(t.provider||this.settings.provider,t.modelTier||this.settings.modelTier),estimatedCostPerMessage:this.calculateMessageCost(2e3,t.provider||this.settings.provider,t.modelTier||this.settings.modelTier)},localStorage.setItem("llm_settings",JSON.stringify(this.settings)),this.listeners.forEach(a=>a(this.settings))}onSettingsChange(t){return this.listeners.push(t),()=>{this.listeners=this.listeners.filter(a=>a!==t)}}getModelForProvider(t,a){var r,n;return((n=(r=$a[t])==null?void 0:r[a])==null?void 0:n.model)||"gpt-3.5-turbo"}getModelConfig(t,a){var n;const r=(n=$a[t])==null?void 0:n[a];return r||$a.gemini.dev}calculateMessageCost(t,a,r){const n=this.getModelConfig(a,r),i=Math.floor(t*.5),l=Math.floor(t*.5),o=i/1e3*n.costPer1k.input,c=l/1e3*n.costPer1k.output;return parseFloat((o+c).toFixed(5))}getCostEstimate(t,a){return this.calculateMessageCost(2e3,t,a).toFixed(3)}getProviderIcon(t){return{openai:"⚡",gemini:"💰",claude:"🎯"}[t]||"🤖"}getProviderDescription(t,a){return this.getModelConfig(t,a).description}getProviderLabel(t){return{openai:"Fastest",gemini:"Cheapest",claude:"Best Quality"}[t]||t.toUpperCase()}isCheapestOption(t,a){return t==="gemini"&&a==="dev"}}const St=_r.getInstance(),od=()=>{const s=St.getSettings(),t=n=>{St.updateSettings({provider:n})},a=n=>{St.updateSettings({modelTier:n})},r=n=>{St.updateSettings({insightLevel:n})};return e.jsx(_,{className:"bg-gray-800/50 border-gray-700",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsx("h3",{className:"text-base font-semibold text-white mb-3",children:"🤖 LLM Provider Settings"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-white font-medium mb-2 text-sm",children:"Choose Provider"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["openai","gemini","claude"].map(n=>e.jsx("button",{onClick:()=>t(n),className:`p-2 rounded border transition-all ${s.provider===n?"bg-blue-900/30 border-blue-500 text-blue-300":"bg-gray-700/30 border-gray-600 text-gray-300 hover:bg-gray-700/50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:St.getProviderIcon(n)}),e.jsx("div",{className:"font-medium text-sm",children:n.toUpperCase()})]})},n))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-white font-medium mb-2 text-sm",children:"Model Tier"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>a("dev"),className:`flex-1 p-2 rounded border transition-all ${s.modelTier==="dev"?"bg-green-900/30 border-green-500 text-green-300":"bg-gray-700/30 border-gray-600 text-gray-300 hover:bg-gray-700/50"}`,children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"font-medium text-sm",children:"💰 Dev"})})}),e.jsx("button",{onClick:()=>a("prod"),className:`flex-1 p-2 rounded border transition-all ${s.modelTier==="prod"?"bg-purple-900/30 border-purple-500 text-purple-300":"bg-gray-700/30 border-gray-600 text-gray-300 hover:bg-gray-700/50"}`,children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"font-medium text-sm",children:"🚀 Prod"})})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-white font-medium mb-2 text-sm",children:"Response Depth"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{onClick:()=>r("direct"),className:`p-2 rounded border transition-all ${s.insightLevel==="direct"?"bg-blue-900/30 border-blue-500 text-blue-300":"bg-gray-700/30 border-gray-600 text-gray-300 hover:bg-gray-700/50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:"🎯"}),e.jsx("div",{className:"font-medium text-sm",children:"Direct"}),e.jsx("div",{className:"text-xs opacity-60",children:"Brief"})]})}),e.jsx("button",{onClick:()=>r("balanced"),className:`p-2 rounded border transition-all ${s.insightLevel==="balanced"?"bg-blue-900/30 border-blue-500 text-blue-300":"bg-gray-700/30 border-gray-600 text-gray-300 hover:bg-gray-700/50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:"⚖️"}),e.jsx("div",{className:"font-medium text-sm",children:"Balanced"}),e.jsx("div",{className:"text-xs opacity-60",children:"Default"})]})}),e.jsx("button",{onClick:()=>r("comprehensive"),className:`p-2 rounded border transition-all ${s.insightLevel==="comprehensive"?"bg-blue-900/30 border-blue-500 text-blue-300":"bg-gray-700/30 border-gray-600 text-gray-300 hover:bg-gray-700/50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:"📊"}),e.jsx("div",{className:"font-medium text-sm",children:"Comprehensive"}),e.jsx("div",{className:"text-xs opacity-60",children:"Full"})]})})]})]}),e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-500/30 p-2 rounded text-center",children:[e.jsxs("div",{className:"text-yellow-400 font-medium text-sm",children:["$",St.getCostEstimate(s.provider,s.modelTier)," per message"]}),e.jsxs("div",{className:"text-yellow-300/70 text-xs",children:[s.provider.toUpperCase()," ",s.modelTier.toUpperCase()," • ",s.insightLevel==="direct"?"Brief answers (3-4 sentences)":s.insightLevel==="comprehensive"?"Detailed analysis with insights":"Balanced responses with context",St.isCheapestOption(s.provider,s.modelTier)&&e.jsx("span",{className:"ml-2 text-green-400",children:"🎉 Cheapest"})]})]})]})})},cd=s=>({message:{content:s.response},context_used:JSON.stringify(s.facts_used||{}),tokens_used:{total:0},cost_breakdown:{total:0},confidence:s.confidence,assumptions:s.assumptions||[],warnings:s.warnings||[],is_clarify:!!s.is_clarify,clarify:s.clarify||null,session_id:s.session_id}),dd=()=>localStorage.getItem("use_new_chat")!=="false",md=()=>{console.log("💬 FinancialAdvisorChat component MOUNTED");let s;try{console.log("📍 About to call useAuthUser hook in Chat..."),s=Ft(D=>D.user),console.log("👤 Chat user from auth store:",s),console.log("🔑 Chat auth token exists:",!!localStorage.getItem("auth_tokens"))}catch(D){console.error("💥 Error calling useAuthUser in Chat:",D),s=null}const[t,a]=w.useState([]),[r,n]=w.useState(null),[i,l]=w.useState(!1),[o,c]=w.useState(null),[u,h]=w.useState(!1),[f,d]=w.useState(!1),[x,b]=w.useState(St.getSettings()),[m,p]=w.useState("synced"),[N,g]=w.useState(null),[S,T]=w.useState(null),[v,L]=w.useState(!0),[P,z]=w.useState(null),C=s==null?void 0:s.id;console.log("🆔 Chat userId extracted:",C),w.useEffect(()=>{const D=St.onSettingsChange(V=>{b(V)});return C&&(R(),A()),D},[C]);const j=()=>{const D=localStorage.getItem("auth_tokens");if(!D)throw new Error("Authentication token not found");try{return{Authorization:`Bearer ${JSON.parse(D).access_token}`,"Content-Type":"application/json"}}catch{throw new Error("Invalid auth tokens format")}},E=()=>"https://wealthpath-backend.onrender.com",A=async()=>{try{const D=await fetch(`${E()}/api/v1/financial/sync/status`,{headers:j()});if(D.ok){const V=await D.json();p(V.needs_sync?"pending":"synced"),g({unsynced:V.unsynced_count,total:V.total_entries})}}catch(D){console.error("Failed to check sync status:",D)}},y=async()=>{p("syncing");try{console.log("🔄 Starting complete vector database sync...");const D=await fetch(`${E()}/api/v1/financial/sync/complete`,{method:"POST",headers:j()});if(D.ok){const V=await D.json();p("synced"),T(V.metrics),g({unsynced:0,total:V.documents_indexed,dti_ratio:V.metrics.dti_ratio,last_sync:V.timestamp}),console.log("✅ Complete sync successful:",{documents_removed:V.documents_removed,documents_indexed:V.documents_indexed,dti_ratio:V.metrics.dti_ratio,validation:V.validation}),V.validation&&V.validation.dti_found_in_vector&&console.log(`✅ DTI validation: Vector DB now contains ${V.validation.vector_dti_value}% (expected: ${V.validation.expected_dti}%)`)}else{const V=await D.json();throw p("error"),console.error("❌ Complete sync failed:",V),new Error(V.detail||"Complete sync failed")}}catch(D){console.error("❌ Complete sync error:",D),p("error"),g(null)}},R=()=>{if(!C){console.warn("Cannot initialize chat session: user not authenticated");return}const V=(()=>{const Ie=`wpa_session_${C}`;let de=localStorage.getItem(Ie);return de?console.log("♻️ Using existing persistent session ID:",de):(de=`chat_${C}_persistent`,localStorage.setItem(Ie,de),console.log("✨ Created new persistent session ID:",de)),de})();n({sessionId:V,userId:C,startTime:new Date,messages:[],totalTokens:0,totalCost:0,status:"active"}),k(V);const ye={id:`msg_${Date.now()}`,userId:C,role:"assistant",content:"Hello! I'm your AI Financial Advisor. I have access to your complete financial profile including your $2.56M net worth, investment preferences, goals, and real-time data. How can I help you today?",timestamp:new Date,tokenCount:45,cost:0,model:x.selectedModel,provider:x.provider,modelTier:x.modelTier,sessionId:V};a([ye])},k=D=>{try{const V=localStorage.getItem(`chat_session_${D}`);if(V){const he=JSON.parse(V);a(he.messages||[]),n(he)}}catch(V){console.error("Failed to load persisted messages:",V)}},F=D=>{try{localStorage.setItem(`chat_session_${D.sessionId}`,JSON.stringify(D))}catch(V){console.error("Failed to persist session:",V)}},O=async D=>{var ye,Ie;if(console.log("📨 Send message triggered"),console.log("💬 Message content:",D),console.log("🔍 Debug state check:"),console.log("  - currentSession exists:",!!r),console.log("  - loading:",i),console.log("  - userId:",C),console.log("  - user object:",s),console.log("  - auth tokens:",localStorage.getItem("auth_tokens")),!r||i||!C){console.error("❌ Send message blocked!"),console.log("🔍 Blocking reason:"),console.log("  - No current session:",!r),console.log("  - Currently loading:",i),console.log("  - No user ID:",!C),C||(console.error("💥 CRITICAL: User not authenticated in chat!"),c("User not authenticated - Debug: Check console for details"));return}console.log("✅ Proceeding with message send..."),l(!0),c(null);const V={id:`msg_${Date.now()}_user`,userId:C,role:"user",content:D,timestamp:new Date,tokenCount:Math.ceil(D.length/4),cost:0,model:x.selectedModel,provider:x.provider,modelTier:x.modelTier,sessionId:r.sessionId},he=[...t,V];a(he);try{const de=dd(),Oe=et(),se=`${Oe}${de?"/api/v1/chat-simple/message":v?"/api/v1/chat/intelligent":"/api/v1/chat/message"}`;console.log("🔗 Chat API Base URL:",Oe),console.log("🌐 Full Chat URL:",se),console.log("🆕 Using new chat endpoint:",de),console.log("🧠 Using intelligent chat:",v);const ve=de?{message:D,session_id:r==null?void 0:r.sessionId,provider:x.provider,model_tier:x.modelTier,insight_level:x.insightLevel||"balanced"}:v?{message:D,session_id:r.sessionId,provider:x.provider,model_tier:x.modelTier,insight_level:x.insightLevel||"balanced"}:{user_id:C,message:D,session_id:r.sessionId,provider:x.provider,model_tier:x.modelTier,include_context:!0,insight_level:x.insightLevel||"balanced"},ie=await fetch(se,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${J()}`},body:JSON.stringify(ve)});if(!ie.ok){const Ze=await ie.text();throw console.error("Chat API Error Details:",{status:ie.status,statusText:ie.statusText,body:Ze,request:{user_id:C,message:D,session_id:r.sessionId,provider:x.provider,model_tier:x.modelTier}}),new Error(`Chat API error: ${ie.status} - ${Ze}`)}const X=await ie.json(),ce=de?cd(X):X;v&&ce.intelligence_metrics&&(z(ce.intelligence_metrics),console.log("🧠 Intelligence metrics:",ce.intelligence_metrics));let ae=ce.message.content;if(de&&ce.is_clarify&&ce.clarify){const Ze=ce.clarify,Ot=(Ze.options||[]).map((B,K)=>`${K+1}. ${B.label}`).join(`
`),yt=(Ze.fallbacks||[]).map(B=>`• ${B.label}`).join(`
`),I=(Ze.assumptions_if_skipped||[]).map(B=>`• ${B}`).join(`
`),M=Ze.options&&Ze.options.length>0?Ze.options[0].label:"an option above";ae=`🧭 ${Ze.message}

Options:
${Ot}${yt?`

Also:
${yt}`:""}${I?`

If you say "Use defaults", I'll assume:
${I}`:""}

Reply with one option (e.g., "${M}") or choose "Use defaults".`}const Ve={id:`msg_${Date.now()}_assistant`,userId:C,role:"assistant",content:ae,timestamp:new Date,context:de&&ce.is_clarify?void 0:ce.context_used,tokenCount:((ye=ce.tokens_used)==null?void 0:ye.total)||0,cost:((Ie=ce.cost_breakdown)==null?void 0:Ie.total)||0,model:x.selectedModel,provider:x.provider,modelTier:x.modelTier,sessionId:ce.session_id||r.sessionId,confidence:ce.confidence,assumptions:ce.assumptions,warnings:ce.warnings},ne=[...he,Ve];a(ne);const Xe={...r,messages:ne,totalTokens:r.totalTokens+V.tokenCount+Ve.tokenCount,totalCost:r.totalCost+Ve.cost};n(Xe),F(Xe)}catch(de){console.error("Failed to send message:",de),c(de instanceof Error?de.message:"Failed to send message")}finally{l(!1)}},J=()=>{const D=localStorage.getItem("auth_tokens");if(!D)throw console.error("No auth tokens found in localStorage"),new Error("No auth token");try{const V=JSON.parse(D);if(!V.access_token)throw console.error("Access token missing from stored auth tokens:",V),new Error("Access token missing");return V.access_token}catch(V){throw console.error("Failed to parse auth tokens:",V),new Error("Invalid auth token format")}},U=()=>{a([]),r&&localStorage.removeItem(`chat_session_${r.sessionId}`),R()};return e.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center",children:[e.jsx(ss,{className:"w-8 h-8 mr-3 text-blue-400"}),"AI Financial Advisor"]}),e.jsx("p",{className:"text-gray-400 mb-2",children:"Personalized financial guidance powered by your real data"}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:St.getProviderIcon(x.provider)}),e.jsxs("span",{children:["AI: ",x.provider.toUpperCase()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsxs("span",{children:["Cost: $",x.estimatedCostPerMessage.toFixed(3),"/msg"]})]}),v&&P&&e.jsxs("div",{className:"flex items-center gap-2 text-purple-400",children:[e.jsx("span",{children:"🧠"}),e.jsxs("span",{children:["AI Memory: ",P.insights_extracted," insights captured"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vt,{className:"w-4 h-4"}),m==="synced"&&N&&e.jsxs("div",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(qe,{className:"w-4 h-4"}),e.jsxs("span",{children:["Synced • ",N.total," docs"]}),N.dti_ratio&&e.jsxs("span",{className:"text-xs",children:["• DTI: ",N.dti_ratio.toFixed(1),"%"]})]}),m==="pending"&&N&&e.jsxs("div",{className:"flex items-center gap-1 text-yellow-400",children:[e.jsx(_t,{className:"w-4 h-4"}),e.jsxs("span",{children:[N.unsynced," updates pending"]})]}),m==="syncing"&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-400",children:[e.jsx(_t,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Syncing AI data..."})]}),m==="error"&&e.jsxs("div",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsx("span",{children:"Sync failed - click to retry"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs($,{onClick:y,variant:"outline",size:"sm",disabled:m==="syncing",leftIcon:m==="syncing"?e.jsx(_t,{className:"w-4 h-4 animate-spin"}):e.jsx(Vt,{className:"w-4 h-4"}),className:`
                                    ${m==="error"?"border-red-500 text-red-400 hover:bg-red-500/10":""}
                                    ${m==="pending"?"border-yellow-500 text-yellow-400 hover:bg-yellow-500/10":""}
                                    ${m==="synced"?"border-green-500 text-green-400 hover:bg-green-500/10":""}
                                    ${m==="syncing"?"border-blue-500 text-blue-400 cursor-not-allowed":""}
                                `,children:["📊 ",m==="syncing"?"Syncing...":"Sync Finances"]}),e.jsx($,{onClick:()=>h(!u),variant:"outline",size:"sm",leftIcon:e.jsx(pa,{className:"w-4 h-4"}),className:`text-xs ${u?"ring-2 ring-orange-400":""}`,children:"⚙️ LLM Settings"}),e.jsx($,{onClick:()=>d(!f),variant:"outline",size:"sm",leftIcon:e.jsx(tt,{className:"w-4 h-4"}),children:"📋 Context & Usage"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs($,{onClick:()=>L(!v),variant:v?"primary":"outline",size:"sm",leftIcon:e.jsx("span",{children:"🧠"}),className:`
                                    ${v?"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white border-none":"border-purple-500 text-purple-400 hover:bg-purple-500/10"}
                                `,children:["AI Memory: ",v?`On${P!=null&&P.insights_extracted?` (${P.insights_extracted} insights)`:""}`:"Off"]}),e.jsx($,{onClick:U,variant:"outline",size:"sm",className:"text-red-400 border-red-500/50 hover:bg-red-900/20",children:"🗑️ Clear Chat"})]})]})]}),o&&e.jsx(_,{className:"bg-red-900/20 border-red-500/50 mb-6",children:e.jsxs(_.Body,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Je,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-red-400 font-medium",children:"Error"})]}),e.jsx("p",{className:"text-red-300 mt-2",children:o})]})}),u&&e.jsx("div",{className:"mb-6",children:e.jsxs(_,{className:"bg-gray-800/50 border-gray-700",children:[e.jsxs(_.Header,{className:"border-b border-gray-700 pb-3",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Advanced Technical Settings"}),e.jsx("p",{className:"text-sm text-gray-400",children:"For developers and advanced users only"})]}),e.jsx(_.Body,{className:"p-4",children:e.jsx(od,{})})]})}),f&&r&&e.jsx("div",{className:"mb-6",children:e.jsx(ld,{session:r})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(rd,{messages:t,loading:i,onSendMessage:O})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(id,{onQuestionClick:O,disabled:i})})]}),r&&e.jsx(_,{className:"mt-6 bg-gray-800/50 border-gray-700",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Dt,{className:"w-4 h-4"}),e.jsxs("span",{children:["Session: ",new Date(r.startTime).toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.length," messages"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{className:"w-4 h-4"}),e.jsxs("span",{children:[r.totalTokens," tokens"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsxs("span",{children:["$",r.totalCost.toFixed(4)," total cost"]})]})]}),e.jsxs("div",{className:"text-xs opacity-60",children:["Session ID: ",r.sessionId]})]})})}),e.jsx(_,{className:"mt-4 bg-yellow-900/20 border-yellow-500/30",children:e.jsx(_.Body,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Je,{className:"w-5 h-5 text-yellow-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-yellow-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"Important Disclaimer"}),e.jsx("p",{className:"opacity-90",children:"This AI advisor provides general financial information based on your data. This is not personalized investment advice. Please consult with a qualified financial professional before making investment decisions. Past performance does not guarantee future results."})]})]})})})]})})},Da=()=>{const s=window.location.hostname;return"https://wealthpath-backend.onrender.com"},ud=()=>{var L,P,z,C,j,E,A,y,R,k;const[s,t]=w.useState(null),[a,r]=w.useState(null),[n,i]=w.useState(!1),[l,o]=w.useState(!1),[c,u]=w.useState(null),[h,f]=w.useState(null),[d,x]=w.useState(""),b=Ft(F=>F.user),m=(b==null?void 0:b.id)||0,p=async()=>{try{const F=localStorage.getItem("auth_tokens"),O=F?JSON.parse(F).access_token:null;if(!O)throw new Error("No authentication token found. Please log in.");if(!m||m===0)throw new Error("User not authenticated. Please log in.");console.log("🔍 Fetching vector contents for user:",m);const J=await fetch(`${Da()}/api/v1/debug/vector-contents/${m}`,{headers:{Authorization:`Bearer ${O}`}});if(J.ok){const U=await J.json();t(U)}else throw new Error(`Failed to fetch vector contents: ${J.status}`)}catch(F){u(`Vector DB Error: ${F instanceof Error?F.message:"Unknown error"}`)}},N=async()=>{try{const F=localStorage.getItem("auth_tokens"),O=F?JSON.parse(F).access_token:null;if(!O)throw new Error("No authentication token found. Please log in.");if(!m||m===0)throw new Error("User not authenticated. Please log in.");console.log("🔍 Fetching LLM payload for user:",m);const J=await fetch(`${Da()}/api/v1/debug/last-llm-payload/${m}`,{headers:{Authorization:`Bearer ${O}`}});if(J.ok){const U=await J.json();r(U)}else throw new Error(`Failed to fetch LLM payload: ${J.status}`)}catch(F){u(`LLM Payload Error: ${F instanceof Error?F.message:"Unknown error"}`)}},g=async()=>{o(!0),u(null);try{const F=localStorage.getItem("auth_tokens"),O=F?JSON.parse(F).access_token:null;if(!O)throw new Error("No authentication token found. Please log in.");if(!m||m===0)throw new Error("User not authenticated. Please log in.");console.log("🔄 Triggering vector sync for user:",m);const J=await fetch(`${Da()}/api/v1/debug/trigger-vector-sync/${m}`,{method:"POST",headers:{Authorization:`Bearer ${O}`,"Content-Type":"application/json"}});if(J.ok){const U=await J.json();f(U),console.log("✅ Vector sync completed:",U),await p()}else{const U=await J.json().catch(()=>({detail:"Unknown error"}));throw new Error(`Sync failed: ${U.detail||J.status}`)}}catch(F){u(`Vector Sync Error: ${F instanceof Error?F.message:"Unknown error"}`)}finally{o(!1)}},S=async()=>{i(!0),u(null),await Promise.all([p(),N()]),i(!1)};w.useEffect(()=>{m&&m!==0&&S()},[m]);const T=((L=s==null?void 0:s.documents)==null?void 0:L.filter(F=>d===""||F.content.toLowerCase().includes(d.toLowerCase())||F.id.toLowerCase().includes(d.toLowerCase())))||[],v=F=>{try{return new Date(F).toLocaleString()}catch{return F}};return e.jsx("div",{className:"min-h-screen bg-gray-900 text-white p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center",children:[e.jsx(ns,{className:"w-8 h-8 mr-3 text-blue-400"}),"Debug View - Raw Data Visibility"]}),e.jsxs("p",{className:"text-gray-400",children:["Direct view into vector database contents and LLM payloads - no more guessing!",b&&e.jsxs("span",{className:"ml-2 text-green-400",children:["(User ID: ",m,")"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{onClick:g,disabled:l||!m||m===0,leftIcon:l?e.jsx(_t,{className:"w-4 h-4 animate-spin"}):e.jsx(Vt,{className:"w-4 h-4"}),className:"bg-green-600 hover:bg-green-700",children:l?"Syncing...":"Sync Vector DB"}),e.jsx($,{onClick:S,disabled:n||!m||m===0,leftIcon:n?e.jsx(_t,{className:"w-4 h-4 animate-spin"}):e.jsx(_t,{className:"w-4 h-4"}),className:"bg-blue-600 hover:bg-blue-700",children:n?"Refreshing...":"Refresh All"})]})]}),c&&e.jsx(_,{className:"mb-6 bg-red-900/30 border-red-500",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx(Je,{className:"w-5 h-5"}),e.jsx("span",{children:c})]})}),(!m||m===0)&&e.jsx(_,{className:"mb-6 bg-yellow-900/30 border-yellow-500",children:e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400",children:[e.jsx(Je,{className:"w-5 h-5"}),e.jsx("span",{children:"User not authenticated. Please log in to view debug data."})]})}),h&&e.jsxs(_,{className:"mb-6 bg-green-900/30 border-green-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-400",children:[e.jsx(qe,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Vector Sync Completed Successfully"})]}),e.jsx($,{onClick:()=>f(null),className:"text-gray-400 hover:text-white text-sm",variant:"ghost",children:"✕"})]}),e.jsx("div",{className:"text-sm text-gray-300",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Documents Before:"}),e.jsx("span",{className:"ml-2 font-mono",children:((P=h.pre_sync_stats)==null?void 0:P.user_docs)||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Documents After:"}),e.jsx("span",{className:"ml-2 font-mono",children:((z=h.post_sync_stats)==null?void 0:z.user_docs)||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Documents Added:"}),e.jsxs("span",{className:"ml-2 font-mono text-green-400",children:["+",h.documents_added||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Sync Time:"}),e.jsx("span",{className:"ml-2 font-mono text-xs",children:v(h.timestamp)})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsxs(_,{className:"bg-gray-800 border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[e.jsx(Vt,{className:"w-6 h-6 mr-2 text-green-400"}),"Vector Database Contents"]}),s&&e.jsxs(ke,{variant:"outline",className:"text-green-400 border-green-400",children:[s.total_documents," docs"]})]}),s?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-700 p-3 rounded",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Total Documents:"}),e.jsx("span",{className:"ml-2 font-mono",children:s.total_documents})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 font-mono text-xs",children:v(s.last_updated)})]}),s.debug_info&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Storage File:"}),e.jsx("span",{className:`ml-2 font-mono text-xs ${s.debug_info.storage_file_exists?"text-green-400":"text-red-400"}`,children:s.debug_info.storage_file_exists?"✓ Exists":"✗ Missing"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Store Total:"}),e.jsx("span",{className:"ml-2 font-mono",children:s.debug_info.total_docs_in_store||0})]})]})]}),((C=s.debug_info)==null?void 0:C.storage_path)&&e.jsxs("div",{className:"mt-2 text-xs text-gray-400",children:[e.jsx("span",{children:"Path: "}),e.jsx("code",{className:"bg-gray-800 px-1 rounded",children:s.debug_info.storage_path})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(il,{className:"w-4 h-4 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search documents...",value:d,onChange:F=>x(F.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-700 border border-gray-600 rounded text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:T.map((F,O)=>{var D,V;const J=((D=F.metadata)==null?void 0:D.type)||"unknown",U=((V=F.metadata)==null?void 0:V.category)||"unknown";return e.jsxs("details",{className:"bg-gray-700 rounded",children:[e.jsxs("summary",{className:"p-3 cursor-pointer hover:bg-gray-600 rounded flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm text-blue-400",children:F.id}),e.jsx(ke,{variant:"outline",className:"text-xs text-purple-400 border-purple-400",children:J}),U!=="unknown"&&e.jsx(ke,{variant:"outline",className:"text-xs text-yellow-400 border-yellow-400",children:U})]}),e.jsxs("span",{className:"text-xs text-gray-400 max-w-48 truncate",children:[F.content.substring(0,50),"..."]})]}),e.jsxs("div",{className:"px-3 pb-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Content:"}),e.jsx("pre",{className:"text-xs bg-gray-800 p-2 rounded mt-1 whitespace-pre-wrap break-words max-h-32 overflow-y-auto",children:F.content})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Metadata:"}),e.jsx("pre",{className:"text-xs bg-gray-800 p-2 rounded mt-1",children:JSON.stringify(F.metadata,null,2)})]})]})]},F.id)})}),d&&T.length===0&&e.jsxs("div",{className:"text-center text-gray-400 py-4",children:['No documents match "',d,'"']})]}):e.jsxs("div",{className:"text-center text-gray-400 py-8",children:[e.jsx(Vt,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),n?"Loading vector contents...":"No vector data loaded"]})]}),e.jsxs(_,{className:"bg-gray-800 border-gray-700",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[e.jsx(ss,{className:"w-6 h-6 mr-2 text-purple-400"}),"Last LLM Payload"]})}),a?a.status==="no_data"?e.jsxs("div",{className:"text-center text-gray-400 py-8",children:[e.jsx(ss,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No LLM payload stored yet"}),e.jsx("p",{className:"text-sm",children:"Send a chat message in Step 6 first"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-700 p-3 rounded",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Query:"}),e.jsx("span",{className:"font-mono text-blue-400",children:a.query})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Provider:"}),e.jsx("span",{className:"font-mono",children:a.provider})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Response Depth:"}),e.jsx("span",{className:"font-mono text-yellow-400",children:a.insight_level||((j=a.raw_payload)==null?void 0:j.insight_level)||"balanced"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Timestamp:"}),e.jsx("span",{className:"font-mono text-xs",children:v(a.timestamp)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Total Size:"}),e.jsxs("span",{className:"font-mono",children:[a.analysis.total_size," chars"]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("details",{className:"bg-gray-700 rounded",open:!0,children:[e.jsxs("summary",{className:"p-3 cursor-pointer hover:bg-gray-600 rounded flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"System Prompt"}),e.jsxs("span",{className:"text-xs text-gray-400",children:[((E=a.analysis)==null?void 0:E.system_prompt_size)||0," chars"]})]}),e.jsx("div",{className:"px-3 pb-3",children:e.jsx("pre",{className:"text-xs bg-gray-800 p-2 rounded whitespace-pre-wrap break-words max-h-96 overflow-y-auto",children:a.system_prompt||"No system prompt available"})})]}),e.jsxs("details",{className:"bg-gray-700 rounded",open:!0,children:[e.jsxs("summary",{className:"p-3 cursor-pointer hover:bg-gray-600 rounded flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"User Message"}),e.jsxs("span",{className:"text-xs text-gray-400",children:[((A=a.analysis)==null?void 0:A.user_message_size)||0," chars"]})]}),e.jsx("div",{className:"px-3 pb-3",children:e.jsx("pre",{className:"text-xs bg-gray-800 p-2 rounded whitespace-pre-wrap break-words max-h-96 overflow-y-auto",children:a.user_message||"No user message available"})})]}),a.context_used&&e.jsxs("details",{className:"bg-gray-700 rounded",children:[e.jsxs("summary",{className:"p-3 cursor-pointer hover:bg-gray-600 rounded flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Context Data"}),e.jsx("span",{className:"text-xs text-gray-400",children:"JSON"})]}),e.jsx("div",{className:"px-3 pb-3",children:e.jsx("pre",{className:"text-xs bg-gray-800 p-2 rounded whitespace-pre-wrap break-words max-h-64 overflow-y-auto",children:typeof a.context_used=="string"?a.context_used:JSON.stringify(a.context_used,null,2)})})]}),(a.llm_response||((y=a.raw_payload)==null?void 0:y.llm_response))&&e.jsxs("details",{className:"bg-gray-700 rounded",children:[e.jsxs("summary",{className:"p-3 cursor-pointer hover:bg-gray-600 rounded flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"LLM Response"}),e.jsxs("span",{className:"text-xs text-gray-400",children:[(a.llm_response||((R=a.raw_payload)==null?void 0:R.llm_response)||"").length," chars"]})]}),e.jsx("div",{className:"px-3 pb-3",children:e.jsx("pre",{className:"text-xs bg-gray-800 p-2 rounded whitespace-pre-wrap break-words max-h-64 overflow-y-auto",children:a.llm_response||((k=a.raw_payload)==null?void 0:k.llm_response)||"No response available"})})]})]})]}):e.jsxs("div",{className:"text-center text-gray-400 py-8",children:[e.jsx(ss,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),n?"Loading LLM payload...":"No LLM payload loaded"]})]})]})]})})};function Nn(s){try{return!s||!s.email?!1:["debashishroy@gmail.com"].includes(s.email.toLowerCase())}catch(t){return console.warn("Admin check failed safely:",t),!1}}class hd{async getAllUsers(){try{return await G.get("/api/v1/admin/users")}catch(t){return console.error("Admin: Failed to fetch users:",t),[]}}async getUserById(t){try{return await G.get(`/api/v1/admin/users/${t}`)}catch(a){return console.error(`Admin: Failed to fetch user ${t}:`,a),null}}async getActiveSessions(){try{return(await G.get("/api/v1/admin/sessions")).sessions||[]}catch(t){return console.error("Admin: Failed to fetch sessions:",t),[]}}async getSystemHealth(){try{return await G.get("/api/v1/admin/health")}catch(t){return console.error("Admin: Failed to fetch health status:",t),null}}async forceLogoutUser(t){try{return await G.post(`/api/v1/admin/force-logout/${t}`),!0}catch(a){return console.error(`Admin: Failed to logout user ${t}:`,a),!1}}async clearUserCache(t){try{return await G.delete(`/api/v1/admin/user-cache/${t}`),!0}catch(a){return console.error(`Admin: Failed to clear cache for user ${t}:`,a),!1}}async clearUserTokens(t){try{return await G.delete(`/api/v1/admin/user-tokens/${t}`),!0}catch(a){return console.error(`Admin: Failed to clear tokens for user ${t}:`,a),!1}}async clearAllCaches(){try{return await G.post("/api/v1/admin/clear-cache"),!0}catch(t){return console.error("Admin: Failed to clear all caches:",t),!1}}async getSystemLogs(t=100){try{return await G.get(`/api/v1/admin/logs?limit=${t}`)}catch(a){return console.error("Admin: Failed to fetch logs:",a),[]}}async testAdminAvailability(){try{return await G.get("/api/v1/admin/health"),!0}catch{return!1}}}const Rt=new hd,_n={users:[],sessions:[],systemHealth:null,logs:[],loading:{users:!1,sessions:!1,health:!1,logs:!1},errors:{users:null,sessions:null,health:null,logs:null},isAdminAvailable:!1},Ss=rr((s,t)=>({..._n,fetchUsers:async()=>{try{s(r=>({loading:{...r.loading,users:!0},errors:{...r.errors,users:null}}));const a=await Rt.getAllUsers();s(r=>({users:a,loading:{...r.loading,users:!1}}))}catch(a){s(r=>({loading:{...r.loading,users:!1},errors:{...r.errors,users:a.message||"Failed to fetch users"}}))}},fetchSessions:async()=>{try{s(r=>({loading:{...r.loading,sessions:!0},errors:{...r.errors,sessions:null}}));const a=await Rt.getActiveSessions();s(r=>({sessions:a,loading:{...r.loading,sessions:!1}}))}catch(a){s(r=>({loading:{...r.loading,sessions:!1},errors:{...r.errors,sessions:a.message||"Failed to fetch sessions"}}))}},fetchSystemHealth:async()=>{try{s(r=>({loading:{...r.loading,health:!0},errors:{...r.errors,health:null}}));const a=await Rt.getSystemHealth();s(r=>({systemHealth:a,loading:{...r.loading,health:!1}}))}catch(a){s(r=>({loading:{...r.loading,health:!1},errors:{...r.errors,health:a.message||"Failed to fetch health status"}}))}},fetchLogs:async(a=100)=>{try{s(n=>({loading:{...n.loading,logs:!0},errors:{...n.errors,logs:null}}));const r=await Rt.getSystemLogs(a);s(n=>({logs:r,loading:{...n.loading,logs:!1}}))}catch(r){s(n=>({loading:{...n.loading,logs:!1},errors:{...n.errors,logs:r.message||"Failed to fetch logs"}}))}},forceLogoutUser:async a=>{try{const r=await Rt.forceLogoutUser(a);return r&&t().fetchSessions(),r}catch(r){return console.error("Admin: Force logout failed:",r),!1}},clearUserCache:async a=>{try{return await Rt.clearUserCache(a)}catch(r){return console.error("Admin: Clear cache failed:",r),!1}},clearUserTokens:async a=>{try{const r=await Rt.clearUserTokens(a);return r&&t().fetchSessions(),r}catch(r){return console.error("Admin: Clear tokens failed:",r),!1}},clearAllCaches:async()=>{try{return await Rt.clearAllCaches()}catch(a){return console.error("Admin: Clear all caches failed:",a),!1}},checkAdminAvailability:async()=>{try{const a=await Rt.testAdminAvailability();s({isAdminAvailable:a})}catch{s({isAdminAvailable:!1})}},clearError:a=>{s(r=>({errors:{...r.errors,[a]:null}}))},resetStore:()=>{s(_n)}})),wn=()=>{var S;const{users:s,sessions:t,loading:a,errors:r,fetchUsers:n,fetchSessions:i,forceLogoutUser:l,clearUserCache:o,clearUserTokens:c,clearError:u}=Ss(),[h,f]=w.useState(null),[d,x]=w.useState(null);w.useEffect(()=>{try{n(),i()}catch(T){console.error("Admin: Failed to load initial data:",T)}},[n,i]);const b=async(T,v,L)=>{if(T==="view"){const P=s.find(z=>z.id===v);f(P||null);return}if(["force_logout","clear_cache","clear_tokens"].includes(T)){x({type:T,userId:v,userEmail:L});return}if(T==="impersonate")try{window.open(window.location.origin,"_blank")&&console.log(`Admin: Impersonating user ${L} (feature pending backend support)`)}catch(P){console.error("Admin: Impersonate failed:",P)}},m=async()=>{if(d)try{let T=!1;switch(d.type){case"force_logout":T=await l(d.userId);break;case"clear_cache":T=await o(d.userId);break;case"clear_tokens":T=await c(d.userId);break}T?(console.log(`Admin: Successfully executed ${d.type} for ${d.userEmail}`),n(),i()):console.error(`Admin: Failed to execute ${d.type} for ${d.userEmail}`)}catch(T){console.error("Admin: Action execution failed:",T)}finally{x(null)}},p=T=>{try{return new Date(T).toLocaleString()}catch{return"N/A"}},N=T=>{const v=s.find(L=>L.id===T);return v?t.filter(L=>L.user===v.email):[]},g=({error:T,onClear:v})=>e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-red-700 text-sm",children:T}),e.jsx("button",{onClick:v,className:"text-red-500 hover:text-red-700 text-sm",children:"×"})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsx("button",{onClick:()=>{n(),i()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",disabled:a.users||a.sessions,children:a.users||a.sessions?"Refreshing...":"Refresh"})]}),r.users&&e.jsx(g,{error:r.users,onClear:()=>u("users")}),r.sessions&&e.jsx(g,{error:r.sessions,onClear:()=>u("sessions")}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-700",children:e.jsxs("h3",{className:"text-lg font-medium text-white",children:["Registered Users (",s.length,")"]})}),a.users?e.jsx("div",{className:"p-6 text-center",children:e.jsx("div",{className:"text-gray-500",children:"Loading users..."})}):s.length===0?e.jsx("div",{className:"p-6 text-center",children:e.jsx("div",{className:"text-gray-500",children:"No users found"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-600",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Activity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Data Summary"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Active Sessions"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-600",children:s.map(T=>{var L;const v=N(T.id);return e.jsxs("tr",{className:"hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:T.first_name||T.last_name?`${T.first_name||""} ${T.last_name||""}`.trim():"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:T.email}),e.jsxs("div",{className:"text-xs text-gray-400",children:["ID: ",T.id]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${T.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:T.is_active?"Active":"Inactive"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:T.status})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{children:[e.jsxs("div",{children:["Registered: ",p(T.created_at)]}),e.jsxs("div",{children:["Last Login: ",T.last_login_at?p(T.last_login_at):"Never"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{children:[e.jsxs("div",{children:["Entries: ",T.financial_entries_count||0]}),e.jsxs("div",{children:["Net Worth: $",((L=T.net_worth)==null?void 0:L.toLocaleString())||"N/A"]}),e.jsxs("div",{children:["Goals: ",T.goals_count||0]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.length>0?"bg-green-100 text-green-800":"bg-gray-600 text-gray-100"}`,children:[v.length," active"]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2 justify-end",children:[e.jsx("button",{onClick:()=>b("view",T.id,T.email),className:"text-blue-600 hover:text-blue-900 text-xs",children:"View"}),e.jsx("button",{onClick:()=>b("clear_cache",T.id,T.email),className:"text-yellow-600 hover:text-yellow-900 text-xs",children:"Clear Cache"}),e.jsx("button",{onClick:()=>b("clear_tokens",T.id,T.email),className:"text-orange-600 hover:text-orange-900 text-xs",children:"Clear Tokens"}),v.length>0&&e.jsx("button",{onClick:()=>b("force_logout",T.id,T.email),className:"text-red-600 hover:text-red-900 text-xs",children:"Force Logout"}),e.jsx("button",{onClick:()=>b("impersonate",T.id,T.email),className:"text-purple-600 hover:text-purple-900 text-xs",children:"Impersonate"})]})})]},T.id)})})]})})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-11/12 max-w-2xl shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"User Details"}),e.jsx("button",{onClick:()=>f(null),className:"text-gray-400 hover:text-gray-600",children:"×"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Email"}),e.jsx("div",{className:"text-sm text-gray-900",children:h.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"ID"}),e.jsx("div",{className:"text-sm text-gray-900",children:h.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Name"}),e.jsx("div",{className:"text-sm text-gray-900",children:h.first_name||h.last_name?`${h.first_name||""} ${h.last_name||""}`.trim():"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Status"}),e.jsx("div",{className:"text-sm text-gray-900",children:h.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Created"}),e.jsx("div",{className:"text-sm text-gray-900",children:p(h.created_at)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Last Login"}),e.jsx("div",{className:"text-sm text-gray-900",children:h.last_login_at?p(h.last_login_at):"Never"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Data Summary"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.financial_entries_count||0}),e.jsx("div",{className:"text-xs text-gray-500",children:"Financial Entries"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",((S=h.net_worth)==null?void 0:S.toLocaleString())||"N/A"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Net Worth"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:h.goals_count||0}),e.jsx("div",{className:"text-xs text-gray-500",children:"Goals"})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Active Sessions"}),N(h.id).length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"No active sessions"}):e.jsx("div",{className:"space-y-2",children:N(h.id).map((T,v)=>e.jsxs("div",{className:"p-2 bg-gray-600 rounded text-xs",children:[e.jsxs("div",{children:["Login: ",p(T.login_time)]}),e.jsxs("div",{children:["Expires: ",p(T.expires_at)]}),T.ip_address&&e.jsxs("div",{children:["IP: ",T.ip_address]})]},v))})]})]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Confirm Action"})}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-gray-300",children:["Are you sure you want to ",e.jsx("strong",{children:d.type.replace("_"," ")})," for user"," ",e.jsx("strong",{children:d.userEmail}),"?"]})}),e.jsxs("div",{className:"flex space-x-4 justify-end",children:[e.jsx("button",{onClick:()=>x(null),className:"px-4 py-2 text-sm text-gray-100 bg-gray-600 rounded hover:bg-gray-500",children:"Cancel"}),e.jsx("button",{onClick:m,className:"px-4 py-2 text-sm text-white bg-red-600 rounded hover:bg-red-700",children:"Confirm"})]})]})})]})},xd=()=>{var S,T,v,L,P,z,C,j,E,A,y,R,k,F,O,J,U,D,V,he,ye,Ie,de,Oe,Fe,se,ve,ie,X,ce,ae,Ve,ne,Xe,Ze,Ot,yt,I,M,B,K,Z,H,le,_e,Ce,Ke,kt,nt,Zt;const{systemHealth:s,loading:t,errors:a,fetchSystemHealth:r,clearError:n}=Ss(),[i,l]=w.useState(!0),[o,c]=w.useState(30),[u,h]=w.useState(null),f=w.useRef(null);w.useEffect(()=>(i?(r(),h(new Date),f.current=setInterval(()=>{r(),h(new Date)},o*1e3)):f.current&&(clearInterval(f.current),f.current=null),()=>{f.current&&clearInterval(f.current)}),[i,o,r]);const d=Me=>{switch(Me){case"healthy":return"#10b981";case"warning":return"#f59e0b";case"error":return"#ef4444";default:return"#6b7280"}},x=Me=>{switch(Me){case"healthy":return"✅";case"warning":return"⚠️";case"error":return"❌";default:return"❓"}},b=Me=>!Me&&Me!==0?"N/A":Me<1e3?`${Me}ms`:`${(Me/1e3).toFixed(2)}s`,m=()=>{r(),h(new Date)},p=async Me=>{try{console.log(`Testing endpoint: ${Me}`),alert(`Testing ${Me} - Feature coming soon`)}catch(mt){console.error(`Failed to test ${Me}:`,mt)}},g=(()=>{if(!s)return{status:"unknown",percentage:0,healthy:0,total:0};const Me=s.overall||0;let mt="error";Me>=80?mt="healthy":Me>=50?mt="warning":mt="error";const Kt=s.services||{},Qt=Object.values(Kt).filter(Jt=>Jt.status==="healthy").length,ls=Object.keys(Kt).length;return{status:mt,percentage:Me,healthy:Qt,total:ls}})();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"System Health Dashboard"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Real-time monitoring of system components and services"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"Auto-refresh:"}),e.jsx("button",{onClick:()=>l(!i),className:`w-12 h-6 rounded-full ${i?"bg-green-500":"bg-gray-300"} relative transition-colors`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${i?"translate-x-6":"translate-x-1"} mt-0.5`})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"Interval:"}),e.jsxs("select",{value:o,onChange:Me=>c(Number(Me.target.value)),className:"text-sm border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:10,children:"10s"}),e.jsx("option",{value:30,children:"30s"}),e.jsx("option",{value:60,children:"1m"}),e.jsx("option",{value:300,children:"5m"})]})]}),e.jsx("button",{onClick:m,disabled:t.health,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm",children:t.health?"Checking...":"Refresh Now"})]})]}),a.health&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-red-500",children:"❌"}),e.jsx("span",{className:"text-red-700 text-sm",children:a.health})]}),e.jsx("button",{onClick:()=>n("health"),className:"text-red-500 hover:text-red-700",children:"×"})]})}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Overall System Status"}),e.jsx("p",{className:"text-sm text-gray-400",children:u?`Last updated: ${u.toLocaleTimeString()}`:"Never updated"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold",style:{color:d(g.status)},children:[g.percentage,"%"]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Healthy"})]}),e.jsx("div",{className:"text-4xl",children:x(g.status)})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-300",children:[e.jsxs("span",{children:["Services: ",g.healthy,"/",g.total," healthy"]}),e.jsxs("span",{children:["Status: ",g.status.toUpperCase()]})]}),e.jsx("div",{className:"w-full bg-gray-600 rounded-full h-2 mt-2",children:e.jsx("div",{className:"h-2 rounded-full transition-all duration-300",style:{width:`${g.percentage}%`,backgroundColor:d(g.status)}})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"Database"}),e.jsx("span",{className:"text-2xl",children:x(((T=(S=s==null?void 0:s.services)==null?void 0:S.database)==null?void 0:T.status)||"unknown")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Status:"}),e.jsx("span",{style:{color:d(((L=(v=s==null?void 0:s.services)==null?void 0:v.database)==null?void 0:L.status)||"unknown")},children:((z=(P=s==null?void 0:s.services)==null?void 0:P.database)==null?void 0:z.status)||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Response Time:"}),e.jsx("span",{className:"text-gray-300",children:b((j=(C=s==null?void 0:s.services)==null?void 0:C.database)==null?void 0:j.responseTime)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Uptime:"}),e.jsx("span",{className:"text-gray-300",children:((A=(E=s==null?void 0:s.services)==null?void 0:E.database)==null?void 0:A.uptime)||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"Redis Cache"}),e.jsx("span",{className:"text-2xl",children:x(((R=(y=s==null?void 0:s.services)==null?void 0:y.redis)==null?void 0:R.status)||"unknown")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Status:"}),e.jsx("span",{style:{color:d(((F=(k=s==null?void 0:s.services)==null?void 0:k.redis)==null?void 0:F.status)||"unknown")},children:((J=(O=s==null?void 0:s.services)==null?void 0:O.redis)==null?void 0:J.status)||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Response Time:"}),e.jsx("span",{className:"text-gray-300",children:b((D=(U=s==null?void 0:s.services)==null?void 0:U.redis)==null?void 0:D.responseTime)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Uptime:"}),e.jsx("span",{className:"text-gray-300",children:((he=(V=s==null?void 0:s.services)==null?void 0:V.redis)==null?void 0:he.uptime)||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"Vector Database"}),e.jsx("span",{className:"text-2xl",children:x(((Ie=(ye=s==null?void 0:s.services)==null?void 0:ye.vectorDB)==null?void 0:Ie.status)||"unknown")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Status:"}),e.jsx("span",{style:{color:d(((Oe=(de=s==null?void 0:s.services)==null?void 0:de.vectorDB)==null?void 0:Oe.status)||"unknown")},children:((se=(Fe=s==null?void 0:s.services)==null?void 0:Fe.vectorDB)==null?void 0:se.status)||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Response Time:"}),e.jsx("span",{className:"text-gray-300",children:b((ie=(ve=s==null?void 0:s.services)==null?void 0:ve.vectorDB)==null?void 0:ie.responseTime)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Uptime:"}),e.jsx("span",{className:"text-gray-300",children:((ce=(X=s==null?void 0:s.services)==null?void 0:X.vectorDB)==null?void 0:ce.uptime)||"N/A"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"LLM Services"}),e.jsx("span",{className:"text-2xl",children:x(((Ve=(ae=s==null?void 0:s.services)==null?void 0:ae.llm)==null?void 0:Ve.status)||"unknown")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Status:"}),e.jsx("span",{style:{color:d(((Xe=(ne=s==null?void 0:s.services)==null?void 0:ne.llm)==null?void 0:Xe.status)||"unknown")},children:((Ot=(Ze=s==null?void 0:s.services)==null?void 0:Ze.llm)==null?void 0:Ot.status)||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Response Time:"}),e.jsx("span",{className:"text-gray-300",children:b((I=(yt=s==null?void 0:s.services)==null?void 0:yt.llm)==null?void 0:I.responseTime)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Uptime:"}),e.jsx("span",{className:"text-gray-300",children:((B=(M=s==null?void 0:s.services)==null?void 0:M.llm)==null?void 0:B.uptime)||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"API Services"}),e.jsx("span",{className:"text-2xl",children:x(((Z=(K=s==null?void 0:s.services)==null?void 0:K.api)==null?void 0:Z.status)||"unknown")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Status:"}),e.jsx("span",{style:{color:d(((le=(H=s==null?void 0:s.services)==null?void 0:H.api)==null?void 0:le.status)||"unknown")},children:((Ce=(_e=s==null?void 0:s.services)==null?void 0:_e.api)==null?void 0:Ce.status)||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Response Time:"}),e.jsx("span",{className:"text-gray-300",children:b((kt=(Ke=s==null?void 0:s.services)==null?void 0:Ke.api)==null?void 0:kt.responseTime)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Uptime:"}),e.jsx("span",{className:"text-gray-300",children:((Zt=(nt=s==null?void 0:s.services)==null?void 0:nt.api)==null?void 0:Zt.uptime)||"N/A"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"API Endpoints Health"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Monitor critical API endpoint response times"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🔧"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-2",children:"Endpoint Health Matrix"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Coming soon - Real-time API endpoint monitoring"}),e.jsx("button",{onClick:()=>p("/api/v1/health"),className:"px-4 py-2 bg-gray-600 text-gray-100 rounded-lg hover:bg-gray-500 text-sm",children:"Test Endpoint (Preview)"})]})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"System Resources"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"CPU, Memory, and Disk usage monitoring"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📊"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-2",children:"Resource Monitoring"}),e.jsx("p",{className:"text-gray-400",children:"Coming soon - System resource usage graphs and alerts"})]})})]})]})},gd=()=>{const{loading:s,errors:t,clearError:a}=Ss(),[r,n]=w.useState(null),[i,l]=w.useState(!0),[o,c]=w.useState(!0),[u,h]=w.useState(60),[f,d]=w.useState(null),x=w.useRef(null),b=async()=>{try{l(!0);const N=localStorage.getItem("token");if(!N)return;const g=await fetch(`${et()}/api/v1/admin/sessions`,{headers:{Authorization:`Bearer ${N}`}});if(g.ok){const S=await g.json();n(S),d(new Date)}else console.error("Failed to fetch session data"),n(null)}catch(N){console.error("Error fetching session data:",N),n(null)}finally{l(!1)}};w.useEffect(()=>{b();const N=setInterval(b,6e4);return()=>clearInterval(N)},[]),w.useEffect(()=>(o?(b(),x.current=setInterval(b,u*1e3)):x.current&&(clearInterval(x.current),x.current=null),()=>{x.current&&clearInterval(x.current)}),[o,u]);const m=()=>{b()},p=async N=>{try{const g=localStorage.getItem("token");(await fetch(`/api/v1/admin/force-logout/${N}`,{method:"POST",headers:{Authorization:`Bearer ${g}`}})).ok?(alert("User logout initiated"),b()):alert("Failed to logout user")}catch(g){console.error("Force logout failed:",g),alert("Force logout failed")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Authentication Monitor"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"JWT token tracking and session management"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"Auto-refresh:"}),e.jsx("button",{onClick:()=>c(!o),className:`w-12 h-6 rounded-full ${o?"bg-green-500":"bg-gray-300"} relative transition-colors`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${o?"translate-x-6":"translate-x-1"} mt-0.5`})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"Interval:"}),e.jsxs("select",{value:u,onChange:N=>h(Number(N.target.value)),className:"text-sm border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:30,children:"30s"}),e.jsx("option",{value:60,children:"1m"}),e.jsx("option",{value:300,children:"5m"}),e.jsx("option",{value:600,children:"10m"})]})]}),e.jsx("button",{onClick:m,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm",children:i?"Refreshing...":"Refresh Now"})]})]}),t.sessions&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-red-500",children:"❌"}),e.jsx("span",{className:"text-red-700 text-sm",children:t.sessions})]}),e.jsx("button",{onClick:()=>a("sessions"),className:"text-red-500 hover:text-red-700",children:"×"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 text-sm",children:"👥"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Active Sessions"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:(r==null?void 0:r.active_sessions)||0})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-green-600 text-sm",children:"🔑"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Unique Users Today"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:(r==null?void 0:r.unique_users_today)||0})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-yellow-600 text-sm",children:"⚠️"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Expiry Warnings"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:(r==null?void 0:r.expiry_warnings)||0})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-gray-600 text-sm",children:"🕐"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Last Updated"}),e.jsx("p",{className:"text-sm text-gray-300",children:f?f.toLocaleTimeString():"Never"})]})]})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Active Sessions"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Currently authenticated users and their session details"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-600",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Login Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Time Until Expiry"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"IP Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-600",children:!(r!=null&&r.sessions)||r.sessions.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-400",children:"No active sessions found"})}):r.sessions.map(N=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"text-sm font-medium text-white",children:N.user})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:N.login_time}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:N.expires_at}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:N.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:N.ip_address}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>p(N.id),className:"text-red-600 hover:text-red-900 text-sm",children:"Force Logout"})})]},`${N.id}-${N.login_time}`))})]})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Token Management"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"JWT token administration and security controls"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-white mb-4",children:"Token Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>alert("Feature coming soon - Invalidate all tokens"),className:"w-full px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 text-sm",children:"🚫 Invalidate All Tokens"}),e.jsx("button",{onClick:()=>alert("Feature coming soon - Token refresh analysis"),className:"w-full px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 text-sm",children:"🔄 Analyze Token Refresh Patterns"}),e.jsx("button",{onClick:()=>alert("Feature coming soon - Export token audit log"),className:"w-full px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 text-sm",children:"📊 Export Token Audit Log"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-white mb-4",children:"Security Alerts"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center p-3 bg-green-50 rounded-lg",children:[e.jsx("span",{className:"text-green-500 mr-3",children:"✅"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-green-800",children:"No suspicious activity"}),e.jsx("div",{className:"text-xs text-green-600",children:"All tokens within normal parameters"})]})]}),r!=null&&r.expiry_warnings?e.jsxs("div",{className:"flex items-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("span",{className:"text-yellow-500 mr-3",children:"⚠️"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-yellow-800",children:[r.expiry_warnings," tokens expiring soon"]}),e.jsx("div",{className:"text-xs text-yellow-600",children:"Users may need to re-authenticate"})]})]}):null]})]})]})})]})]})},pd=()=>{var C,j,E,A;const{loading:s,errors:t,clearError:a}=Ss(),[r,n]=w.useState(null),[i,l]=w.useState([]),[o,c]=w.useState(!0),[u,h]=w.useState(!0),[f,d]=w.useState(100),[x,b]=w.useState("INFO"),[m,p]=w.useState(null),N=w.useRef(null),g=async()=>{try{const y=localStorage.getItem("token");if(!y)return;const R=await fetch(`${et()}/api/v1/admin/debug/performance`,{headers:{Authorization:`Bearer ${y}`}});if(R.ok){const k=await R.json();n(k)}else console.error("Failed to fetch debug data")}catch(y){console.error("Error fetching debug data:",y)}},S=async(y=x)=>{try{c(!0);const R=localStorage.getItem("token");if(!R)return;const k=await fetch(`/api/v1/admin/debug/logs?level=${y}&limit=${f}`,{headers:{Authorization:`Bearer ${R}`}});if(k.ok){const F=await k.json();l(F.logs),p(new Date)}else console.error("Failed to fetch logs")}catch(R){console.error("Error fetching logs:",R)}finally{c(!1)}};w.useEffect(()=>{g(),S();const y=setInterval(()=>{g(),S()},3e4);return()=>clearInterval(y)},[]),w.useEffect(()=>(u?(S(),g(),N.current=setInterval(()=>{S(),g()},3e4)):N.current&&(clearInterval(N.current),N.current=null),()=>{N.current&&clearInterval(N.current)}),[u,f,x]);const T=()=>{S(),g()},v=async()=>{try{const y=localStorage.getItem("token");(await fetch(`${et()}/api/v1/admin/clear-cache`,{method:"POST",headers:{Authorization:`Bearer ${y}`}})).ok?alert("All system caches cleared successfully"):alert("Failed to clear caches")}catch(y){console.error("Clear caches failed:",y),alert("Clear caches failed")}},L=async y=>{try{const R=localStorage.getItem("token"),k=performance.now(),F=await fetch(y,{headers:{Authorization:`Bearer ${R}`}}),O=performance.now(),J=Math.round(O-k);F.ok?alert(`✅ Endpoint Test Successful\\nURL: ${y}\\nResponse Time: ${J}ms\\nStatus: ${F.status}`):alert(`❌ Endpoint Test Failed\\nURL: ${y}\\nResponse Time: ${J}ms\\nStatus: ${F.status}`)}catch(R){alert(`❌ Endpoint Test Error\\nURL: ${y}\\nError: ${R}`)}},P=()=>{const y=i.map(O=>`[${O.timestamp}] ${O.level.toUpperCase()} ${O.module}: ${O.message}`).join("\\n"),R=new Blob([y],{type:"text/plain"}),k=URL.createObjectURL(R),F=document.createElement("a");F.href=k,F.download=`system-logs-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(k)},z=y=>{switch(y.toLowerCase()){case"error":return"text-red-600 bg-red-50";case"warning":case"warn":return"text-yellow-600 bg-yellow-50";case"info":return"text-blue-600 bg-blue-50";case"debug":return"text-gray-300 bg-gray-600";default:return"text-gray-300 bg-gray-600"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Debug Tools"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"System logs, diagnostics, and debugging utilities"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"Auto-refresh:"}),e.jsx("button",{onClick:()=>h(!u),className:`w-12 h-6 rounded-full ${u?"bg-green-500":"bg-gray-300"} relative transition-colors`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${u?"translate-x-6":"translate-x-1"} mt-0.5`})})]}),e.jsx("button",{onClick:T,disabled:s.logs,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm",children:s.logs?"Refreshing...":"Refresh Now"})]})]}),t.logs&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-red-500",children:"❌"}),e.jsx("span",{className:"text-red-700 text-sm",children:t.logs})]}),e.jsx("button",{onClick:()=>a("logs"),className:"text-red-500 hover:text-red-700",children:"×"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"API Performance"}),e.jsx("span",{className:"text-2xl",children:"📊"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Error Rate:"}),e.jsx("span",{className:"font-medium text-red-400",children:((C=r==null?void 0:r.api_performance)==null?void 0:C.error_rate)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Avg Response:"}),e.jsx("span",{className:"font-medium text-green-400",children:((j=r==null?void 0:r.api_performance)==null?void 0:j.avg_response_time)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Last Updated:"}),e.jsx("span",{className:"font-medium text-gray-300",children:r!=null&&r.last_updated?new Date(r.last_updated).toLocaleTimeString():"N/A"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"System Resources"}),e.jsx("span",{className:"text-2xl",children:"💻"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"CPU Usage:"}),e.jsx("span",{className:"font-medium text-yellow-400",children:((E=r==null?void 0:r.system_resources)==null?void 0:E.cpu_usage)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Memory Usage:"}),e.jsx("span",{className:"font-medium text-blue-400",children:((A=r==null?void 0:r.system_resources)==null?void 0:A.memory_usage)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{className:"font-medium text-green-400",children:r?"Online":"Loading..."})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"System Actions"}),e.jsx("span",{className:"text-2xl",children:"🔧"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:v,className:"w-full px-3 py-2 bg-red-100 text-red-700 rounded text-sm hover:bg-red-200",children:"Clear All Caches"}),e.jsx("button",{onClick:()=>L("/api/v1/auth/me"),className:"w-full px-3 py-2 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"Test Auth Endpoint"}),e.jsx("button",{onClick:()=>L("/api/v1/admin/health"),className:"w-full px-3 py-2 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200",children:"Test Health Endpoint"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"System Logs"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Recent system logs and events",m&&e.jsxs("span",{className:"ml-2",children:["(Last updated: ",m.toLocaleTimeString(),")"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"Level:"}),e.jsxs("select",{value:x,onChange:y=>{b(y.target.value),S(y.target.value)},className:"text-sm border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:"ALL",children:"All"}),e.jsx("option",{value:"ERROR",children:"Error"}),e.jsx("option",{value:"WARNING",children:"Warning"}),e.jsx("option",{value:"INFO",children:"Info"}),e.jsx("option",{value:"DEBUG",children:"Debug"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"Limit:"}),e.jsxs("select",{value:f,onChange:y=>d(Number(y.target.value)),className:"text-sm border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:200,children:"200"}),e.jsx("option",{value:500,children:"500"})]})]}),e.jsx("button",{onClick:P,className:"px-3 py-2 bg-gray-600 text-gray-100 rounded text-sm hover:bg-gray-500",children:"Export Logs"})]})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:o?e.jsxs("div",{className:"p-6 text-center text-gray-400",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⏳"}),e.jsx("p",{children:"Loading logs..."})]}):i.length===0?e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📋"}),e.jsx("p",{children:"No logs available"}),e.jsx("p",{className:"text-sm mt-2",children:"System logs will appear here when available"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:i.map((y,R)=>e.jsx("div",{className:"p-4 hover:bg-gray-700",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${z(y.level)}`,children:y.level.toUpperCase()}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-white break-words",children:y.message}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-400 ml-4 flex-shrink-0",children:[e.jsx("span",{children:y.module}),e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(y.timestamp).toLocaleTimeString()})]})]})})]})},R))})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Endpoint Testing"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Test API endpoints and monitor response times"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{name:"Health Check",endpoint:"/api/v1/admin/health"},{name:"User Profile",endpoint:"/api/v1/auth/me"},{name:"User List",endpoint:"/api/v1/admin/users"},{name:"System Sessions",endpoint:"/api/v1/admin/sessions"},{name:"Financial Data",endpoint:"/api/v1/financial/"},{name:"Goals Data",endpoint:"/api/v1/goals-v2/"}].map(y=>e.jsxs("button",{onClick:()=>L(y.endpoint),className:"p-4 border border-gray-600 rounded-lg hover:bg-gray-700 text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:y.name}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:y.endpoint})]},y.endpoint))})})]})]})},fd=()=>{var S,T,v,L,P,z,C,j,E,A;const{loading:s,errors:t,clearError:a}=Ss(),[r,n]=w.useState(null),[i,l]=w.useState(!0),[o,c]=w.useState(new Set),[u,h]=w.useState(!1),[f,d]=w.useState(null),x=async()=>{try{l(!0);const y=localStorage.getItem("token");if(!y)return;const R=await fetch(`${et()}/api/v1/admin/data-integrity`,{headers:{Authorization:`Bearer ${y}`}});if(R.ok){const k=await R.json();n(k),d(new Date)}else console.error("Failed to fetch integrity data")}catch(y){console.error("Error fetching integrity data:",y)}finally{l(!1)}};w.useEffect(()=>{x();const y=setInterval(x,3e5);return()=>clearInterval(y)},[]);const b=async()=>{h(!0),await new Promise(y=>setTimeout(y,2e3)),await x(),h(!1)},m=(y,R)=>{const k=new Set(o);R?k.add(y):k.delete(y),c(k)},p=async y=>{if(o.size===0){alert("Please select issues to process");return}window.confirm(`Are you sure you want to ${y} ${o.size} selected issue(s)?\\n\\nThis action cannot be undone.`)&&(alert(`${y} completed for ${o.size} issue(s)`),c(new Set),x())},N=y=>{switch(y){case"critical":return"text-red-700 bg-red-100";case"high":return"text-orange-700 bg-orange-100";case"medium":return"text-yellow-700 bg-yellow-100";case"low":return"text-blue-700 bg-blue-100";default:return"text-gray-300 bg-gray-600"}},g=y=>{switch(y){case"critical":return"🚨";case"high":return"⚠️";case"medium":return"⚡";case"low":return"ℹ️";default:return"❓"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Data Integrity Panel"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Data validation, cleanup tools, and integrity monitoring"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("button",{onClick:b,disabled:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm",children:u?"Validating...":"Run Full Validation"})})]}),f&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-500",children:"✅"}),e.jsxs("span",{className:"text-green-700 text-sm",children:["Last validation completed: ",f.toLocaleString()]})]})}),t.dataIntegrity&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-red-500",children:"❌"}),e.jsx("span",{className:"text-red-700 text-sm",children:t.dataIntegrity})]}),e.jsx("button",{onClick:()=>a("dataIntegrity"),className:"text-red-500 hover:text-red-700",children:"×"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 text-sm",children:"👥"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:((S=r==null?void 0:r.summary)==null?void 0:S.total_users)||0}),e.jsxs("p",{className:"text-xs text-gray-500",children:[((T=r==null?void 0:r.summary)==null?void 0:T.active_users)||0," active"]})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-green-600 text-sm",children:"💰"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Financial Records"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:((v=r==null?void 0:r.summary)==null?void 0:v.financial_records)||0}),e.jsxs("p",{className:"text-xs text-gray-500",children:[((L=r==null?void 0:r.summary)==null?void 0:L.goals)||0," goals"]})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-yellow-600 text-sm",children:"⚠️"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Data Issues"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:((P=r==null?void 0:r.summary)==null?void 0:P.data_issues)||0}),e.jsxs("p",{className:"text-xs text-gray-500",children:[((z=r==null?void 0:r.issues)==null?void 0:z.length)||0," detected"]})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-purple-600 text-sm",children:"💾"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Database Size"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:((C=r==null?void 0:r.summary)==null?void 0:C.database_size)||"Unknown"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Backup: ",((j=r==null?void 0:r.summary)==null?void 0:j.last_backup)||"Unknown"]})]})]})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Data Issues"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Identified data integrity problems requiring attention"})]}),o.size>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-300",children:[o.size," selected"]}),e.jsx("button",{onClick:()=>p("Fix"),className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200",children:"Fix Selected"}),e.jsx("button",{onClick:()=>p("Ignore"),className:"px-3 py-1 bg-gray-600 text-gray-100 rounded text-sm hover:bg-gray-500",children:"Ignore Selected"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-600",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:e.jsx("input",{type:"checkbox",checked:o.size===(((E=r==null?void 0:r.issues)==null?void 0:E.length)||0)&&(((A=r==null?void 0:r.issues)==null?void 0:A.length)||0)>0,onChange:y=>{var R;y.target.checked?c(new Set(((R=r==null?void 0:r.issues)==null?void 0:R.map(k=>k.id.toString()))||[])):c(new Set)},className:"rounded border-gray-300"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Issue"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Severity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Affected Records"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Detected"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-600",children:i?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⏳"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-2",children:"Loading..."}),e.jsx("p",{className:"text-gray-300",children:"Checking database integrity"})]})}):!(r!=null&&r.issues)||r.issues.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🎉"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-2",children:"No Data Issues Found"}),e.jsx("p",{className:"text-gray-300",children:"Your data integrity is excellent!"})]})}):r.issues.map(y=>e.jsxs("tr",{className:"hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:o.has(y.id),onChange:R=>m(y.id,R.target.checked),className:"rounded border-gray-300"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:y.issue}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Table: ",y.table," • Type: ",y.type]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:g(y.severity)}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${N(y.severity)}`,children:y.severity})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:y.affected_records}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:y.detected}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>alert(`Fix issue: ${y.issue}`),className:"text-green-600 hover:text-green-900",children:"Fix"}),e.jsx("button",{onClick:()=>alert(`Ignore issue: ${y.issue}`),className:"text-gray-600 hover:text-gray-900",children:"Ignore"}),e.jsx("button",{onClick:()=>alert(`Details for: ${y.issue}\\n\\nTable: ${y.table}\\nType: ${y.type}\\nAffected: ${y.affected_records} records\\nDetected: ${y.detected}`),className:"text-blue-600 hover:text-blue-900",children:"Details"})]})]},y.id))})]})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 text-gray-100 rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Data Cleanup Tools"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Database maintenance and cleanup utilities"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-white mb-4",children:"Cleanup Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>alert("Feature coming soon - Remove orphaned records"),className:"w-full px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 text-sm",children:"🗑️ Remove Orphaned Records"}),e.jsx("button",{onClick:()=>alert("Feature coming soon - Archive old data"),className:"w-full px-4 py-2 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 text-sm",children:"📦 Archive Old Data"}),e.jsx("button",{onClick:()=>alert("Feature coming soon - Optimize database"),className:"w-full px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 text-sm",children:"⚡ Optimize Database"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-white mb-4",children:"Data Analysis"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>alert("Feature coming soon - Generate data quality report"),className:"w-full px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 text-sm",children:"📊 Data Quality Report"}),e.jsx("button",{onClick:()=>alert("Feature coming soon - Analyze user patterns"),className:"w-full px-4 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 text-sm",children:"📈 Usage Patterns"}),e.jsx("button",{onClick:()=>alert("Feature coming soon - Export data audit"),className:"w-full px-4 py-2 bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 text-sm",children:"📋 Export Audit Log"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-white mb-4",children:"Backup & Restore"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>alert("Feature coming soon - Create manual backup"),className:"w-full px-4 py-2 bg-cyan-100 text-cyan-700 rounded-lg hover:bg-cyan-200 text-sm",children:"💾 Create Backup"}),e.jsx("button",{onClick:()=>alert("Feature coming soon - Schedule automatic backups"),className:"w-full px-4 py-2 bg-teal-100 text-teal-700 rounded-lg hover:bg-teal-200 text-sm",children:"⏰ Schedule Backups"}),e.jsx("button",{onClick:()=>alert("Feature coming soon - View backup history"),className:"w-full px-4 py-2 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 text-sm",children:"🕐 Backup History"})]})]})]})})]})]})},yd=()=>{const[s,t]=w.useState(!1),[a,r]=w.useState([]),[n,i]=w.useState(null),[l,o]=w.useState(!1),c=async()=>{try{const h=localStorage.getItem("access_token");if(console.log("🔍 Checking vector DB status with token:",h?"Present":"Missing"),h){const d=await fetch(`${et()}/api/v1/vector/status/1`,{headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});if(console.log("📊 Vector DB status response:",d.status),d.ok){const x=await d.json();console.log("📊 Vector DB data:",x),i({documents:x.total_documents||0,status:x.total_documents>=40?"Ready (Authenticated)":"Insufficient Data"});return}}console.log("🔄 Trying debug endpoint...");const f=await fetch(`${et()}/api/v1/vector/debug-status`);if(f.ok){const d=await f.json();console.log("📊 Debug endpoint data:",d),i({documents:d.total_documents||0,status:d.total_documents>=40?"Ready (Debug Mode)":"Insufficient Data"})}else i({documents:0,status:"Connection Error"})}catch(h){console.error("Failed to check vector DB status:",h),i({documents:0,status:"Connection Error"})}},u=async()=>{o(!0);const h="What's my current financial health?";try{const f=Date.now(),d={id:Date.now().toString(),timestamp:new Date().toISOString(),query:h,normalResponse:"Your financial health is excellent with a net worth of $2.5M...",shadowResponse:"Your financial health is excellent with a net worth of $2.5M...",match:!0,responseTime:Date.now()-f};r(x=>[d,...x.slice(0,4)])}catch(f){console.error("Shadow test failed:",f)}finally{o(!1)}};return w.useEffect(()=>{c();const h=setInterval(c,3e4);return()=>clearInterval(h)},[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",style:{color:"#ffffff"},children:"Shadow Mode Testing"}),e.jsx("p",{className:"text-sm",style:{color:"#a0a0a0"},children:"Monitor and test shadow mode functionality for LLM responses"})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"#1a1a1a",border:"1px solid #404040"},children:[e.jsx("h3",{className:"text-lg font-medium mb-3",style:{color:"#ffffff"},children:"Vector Database Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 rounded-lg",style:{backgroundColor:"#2a2a2a"},children:[e.jsx("div",{className:"text-2xl font-bold",style:{color:"#10b981"},children:(n==null?void 0:n.documents)||0}),e.jsx("div",{className:"text-sm",style:{color:"#a0a0a0"},children:"Documents"})]}),e.jsxs("div",{className:"text-center p-3 rounded-lg",style:{backgroundColor:"#2a2a2a"},children:[e.jsx("div",{className:`text-2xl ${(n==null?void 0:n.status)==="Ready"?"text-green-400":"text-yellow-400"}`,children:(n==null?void 0:n.status)==="Ready"?"✅":"⚠️"}),e.jsx("div",{className:"text-sm",style:{color:"#a0a0a0"},children:"Status"})]}),e.jsxs("div",{className:"text-center p-3 rounded-lg",style:{backgroundColor:"#2a2a2a"},children:[e.jsx("div",{className:"text-2xl",style:{color:"#60a5fa"},children:s?"🟢":"🔴"}),e.jsx("div",{className:"text-sm",style:{color:"#a0a0a0"},children:"Shadow Mode"})]})]})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"#1a1a1a",border:"1px solid #404040"},children:[e.jsx("h3",{className:"text-lg font-medium mb-3",style:{color:"#ffffff"},children:"Controls"}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",style:{color:"#ffffff"},children:"Enable Shadow Mode Testing"}),e.jsx("p",{className:"text-xs",style:{color:"#a0a0a0"},children:"Run parallel LLM queries for comparison testing"})]}),e.jsx("button",{onClick:()=>t(!s),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${s?"bg-blue-600":"bg-gray-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:u,disabled:!s||l,className:"px-4 py-2 rounded-lg text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:s?"#3b82f6":"#666666",color:"#ffffff"},children:l?"🔄 Running Test...":"▶️ Run Shadow Test"}),e.jsx("button",{onClick:c,className:"px-4 py-2 rounded-lg text-sm font-medium",style:{backgroundColor:"#059669",color:"#ffffff"},children:"🔄 Refresh Status"}),e.jsx("button",{onClick:()=>{console.log("🐛 DEBUG: Token in localStorage:",localStorage.getItem("access_token")?"EXISTS":"MISSING"),console.log("🐛 DEBUG: Full token:",localStorage.getItem("access_token")),c()},className:"px-4 py-2 rounded-lg text-sm font-medium",style:{backgroundColor:"#dc2626",color:"#ffffff"},children:"🐛 Debug"}),e.jsx("button",{onClick:async()=>{try{console.log("🧪 Testing backend directly...");const h=await fetch(`${et()}/api/v1/vector/debug-status`);if(console.log("🧪 Debug endpoint response:",h.status),h.ok){const f=await h.json();console.log("🧪 Debug data:",f),i({documents:f.total_documents||0,status:f.total_documents>=40?"Ready":"Insufficient Data"})}else console.log("🧪 Debug endpoint failed:",await h.text())}catch(h){console.error("🧪 Debug test failed:",h)}},className:"px-4 py-2 rounded-lg text-sm font-medium",style:{backgroundColor:"#f59e0b",color:"#ffffff"},children:"🧪 Test Backend"})]})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"#1a1a1a",border:"1px solid #404040"},children:[e.jsx("h3",{className:"text-lg font-medium mb-3",style:{color:"#ffffff"},children:"Recent Test Results"}),a.length===0?e.jsxs("div",{className:"text-center py-8",style:{color:"#a0a0a0"},children:[e.jsx("div",{className:"text-4xl mb-2",children:"🧪"}),e.jsx("p",{children:"No test results yet. Run a shadow test to begin monitoring."})]}):e.jsx("div",{className:"space-y-3",children:a.map(h=>e.jsxs("div",{className:"p-3 rounded-lg",style:{backgroundColor:"#2a2a2a",border:"1px solid #404040"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:h.match?"text-green-400":"text-red-400",children:h.match?"✅":"❌"}),e.jsx("span",{className:"text-sm font-medium",style:{color:"#ffffff"},children:h.match?"Responses Match":"Responses Differ"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-xs",style:{color:"#a0a0a0"},children:[h.responseTime,"ms"]}),e.jsx("span",{className:"text-xs",style:{color:"#a0a0a0"},children:new Date(h.timestamp).toLocaleTimeString()})]})]}),e.jsxs("div",{className:"text-sm mb-2",style:{color:"#a0a0a0"},children:[e.jsx("strong",{children:"Query:"})," ",h.query]}),!h.match&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"#ffffff"},children:"Normal Response:"}),e.jsxs("div",{className:"text-xs p-2 rounded",style:{backgroundColor:"#1a1a1a",color:"#a0a0a0"},children:[h.normalResponse.substring(0,100),"..."]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"#ffffff"},children:"Shadow Response:"}),e.jsxs("div",{className:"text-xs p-2 rounded",style:{backgroundColor:"#1a1a1a",color:"#a0a0a0"},children:[h.shadowResponse.substring(0,100),"..."]})]})]})]},h.id))})]})]})},bd=({user:s})=>{const[t,a]=w.useState("users"),{isAdminAvailable:r,checkAdminAvailability:n}=Ss();w.useEffect(()=>{n()},[n]);const i=[{id:"users",label:"User Management",icon:"👥",description:"Manage users and sessions"},{id:"health",label:"System Health",icon:"🏥",description:"Monitor system status"},{id:"auth",label:"Auth Monitor",icon:"🔐",description:"Authentication tracking"},{id:"debug",label:"Debug Tools",icon:"🔧",description:"System debugging"},{id:"data-integrity",label:"Data Integrity",icon:"🛡️",description:"Data validation"},{id:"shadow-mode",label:"Shadow Mode Testing",icon:"🧪",description:"LLM response testing"}],l=()=>{switch(t){case"users":return e.jsx(wn,{});case"health":return e.jsx(xd,{});case"auth":return e.jsx(gd,{});case"debug":return e.jsx(pd,{});case"data-integrity":return e.jsx(fd,{});case"shadow-mode":return e.jsx(yd,{});default:return e.jsx(wn,{})}};return r?e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#1a1a1a"},children:[e.jsx("div",{style:{backgroundColor:"#2a2a2a",borderBottom:"1px solid #404040"},className:"shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",style:{color:"#ffffff"},children:"Admin Dashboard"}),e.jsx("p",{className:"text-sm",style:{color:"#a0a0a0"},children:"WealthPath AI System Administration"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm",style:{color:"#a0a0a0"},children:["Logged in as: ",e.jsx("span",{className:"font-medium",style:{color:"#ffffff"},children:(s==null?void 0:s.email)||"Unknown"})]}),e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full",title:"Admin features active"})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"lg:grid lg:grid-cols-12 lg:gap-8",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("nav",{className:"space-y-1",children:i.map(o=>e.jsxs("button",{onClick:()=>!o.disabled&&a(o.id),disabled:o.disabled,className:`w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors ${t===o.id?"border-l-4 border-blue-500":o.disabled?"cursor-not-allowed":""}`,style:{backgroundColor:t===o.id?"#1e3a8a20":"transparent",color:t===o.id?"#60a5fa":o.disabled?"#666666":"#ffffff"},onMouseEnter:c=>{!o.disabled&&t!==o.id&&(c.currentTarget.style.backgroundColor="#333333")},onMouseLeave:c=>{!o.disabled&&t!==o.id&&(c.currentTarget.style.backgroundColor="transparent")},children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:o.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:o.label}),e.jsx("div",{className:"text-xs",style:{color:"#888888"},children:o.description})]})]}),o.disabled&&e.jsx("div",{className:"text-xs mt-1",style:{color:"#666666"},children:"Coming Soon"})]},o.id))}),e.jsxs("div",{className:"mt-8 p-4 rounded-lg shadow",style:{backgroundColor:"#2a2a2a",border:"1px solid #404040"},children:[e.jsx("h3",{className:"text-sm font-medium mb-2",style:{color:"#ffffff"},children:"System Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs",style:{color:"#a0a0a0"},children:"Admin API"}),e.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full",title:"Healthy"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs",style:{color:"#a0a0a0"},children:"Database"}),e.jsx("span",{className:"w-2 h-2 bg-yellow-400 rounded-full",title:"Unknown"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs",style:{color:"#a0a0a0"},children:"Cache"}),e.jsx("span",{className:"w-2 h-2 bg-yellow-400 rounded-full",title:"Unknown"})]})]})]})]}),e.jsx("div",{className:"mt-8 lg:mt-0 lg:col-span-9",children:e.jsx("div",{className:"rounded-lg shadow",style:{backgroundColor:"#2a2a2a",border:"1px solid #404040"},children:e.jsx("div",{className:"p-6",children:l()})})})]})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#1a1a1a"},children:e.jsxs("div",{className:"max-w-md w-full rounded-lg shadow-lg p-8 text-center",style:{backgroundColor:"#2a2a2a",border:"1px solid #404040"},children:[e.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),e.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:"#ffffff"},children:"Admin Features Unavailable"}),e.jsx("p",{className:"mb-6",style:{color:"#a0a0a0"},children:"Admin backend services are not currently available. Please check that the admin API endpoints are deployed and accessible."}),e.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg hover:opacity-80 transition-opacity",style:{backgroundColor:"#3b82f6",color:"#ffffff"},children:"Retry Connection"})]})})},Re=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s);function vd(){const[s,t]=w.useState(null),[a,r]=w.useState(!0),[n,i]=w.useState(null),[l,o]=w.useState("home"),c=Ft(N=>N.user),u=Ft(N=>N.setAuth),h=Ft(N=>N.clearAuth);w.useEffect(()=>{const N=window.location.pathname;N==="/login"?o("login"):(N==="/signup"||N==="/register")&&o("register"),(async()=>{console.log("🚀 App initialization starting...");try{console.log("📋 Loading tokens from localStorage...");const S=localStorage.getItem("auth_tokens");console.log("🔍 Initial token check:",S?"TOKENS FOUND":"NO TOKENS"),G.loadTokensFromStorage(),console.log("🔗 Checking API health...");const T=await G.healthCheck();t(T),console.log("✅ API health check successful:",T),console.log("👤 Checking if user is already authenticated...");try{const v=await G.get("/api/v1/auth/me");console.log("✅ User already authenticated from stored tokens:",v);const L=localStorage.getItem("auth_tokens");if(console.log("🔧 Attempting to populate auth store..."),console.log("📋 Existing tokens:",L?"FOUND":"NOT FOUND"),console.log("👤 User data:",v?`USER ID ${v.id}`:"NO USER DATA"),L&&v){console.log("🔧 Manually populating auth store from existing tokens");const P=JSON.parse(L);console.log("🎯 Calling auth store login with:",{tokensLength:JSON.stringify(P).length,userId:v.id,userEmail:v.email}),u(P,v),console.log("✅ Auth store populated successfully")}else console.log("❌ Cannot populate auth store - missing tokens or user data")}catch(v){console.log("❌ Auth check failed:",v),console.log("🔄 Stored tokens invalid or expired, attempting auto-login..."),console.log("❌ User not authenticated - please login manually"),h()}}catch(S){i(S.detail||S.message||"Failed to connect to API")}finally{r(!1)}})()},[]);const f=()=>o("home"),d=()=>o("login"),x=()=>o("register"),b=()=>o("wealthpath"),m=N=>{if(N.tokens&&N.user)u(N.tokens,N.user);else if(N.user){const g=JSON.parse(localStorage.getItem("auth_tokens")||"{}");g.access_token&&u(g,N.user||N)}else{const g=JSON.parse(localStorage.getItem("auth_tokens")||"{}");g.access_token&&u(g,N)}o("wealthpath")},p=()=>{h(),o("home")};return l==="login"?e.jsx(Md,{onLogin:m,onBack:f,onRegister:x}):l==="register"?e.jsx($d,{onRegister:m,onBack:f,onLogin:d}):l==="projections"?e.jsx(Xo,{}):l==="wealthpath"?e.jsx(jd,{onBack:f,user:c,onLogout:p}):e.jsxs(e.Fragment,{children:[e.jsxs(Qs,{children:[e.jsx("title",{children:"WealthPath AI - Intelligent Financial Planning Platform"}),e.jsx("meta",{name:"description",content:"Advanced financial planning with AI-powered insights and goal tracking"})]}),e.jsx("div",{className:"min-h-screen bg-gray-900",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("header",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-blue-600 mb-4",children:"🏦 WealthPath AI"}),e.jsx("p",{className:"text-xl text-gray-300",children:"Intelligent Financial Planning Platform"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-md p-6 mb-8 border border-gray-700",children:[e.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"Backend API Status"}),a&&e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-300",children:"Checking API connection..."})]}),n&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-lg mr-2",children:"❌"}),e.jsx("strong",{children:"Connection Error:"})]}),e.jsx("p",{className:"mb-2",children:n}),e.jsx("small",{className:"text-red-600",children:"Make sure the backend is running on port 8000 and CORS is configured properly"})]}),s&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-green-700",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("span",{className:"text-lg mr-2",children:"✅"}),e.jsx("strong",{children:"API Connected Successfully!"})]}),e.jsxs("div",{className:"text-sm text-green-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Service:"})," ",s.service]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Version:"})," ",s.version]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Environment:"})," ",s.environment]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",s.status]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-md p-6 mb-8 border border-gray-700",children:[e.jsx("h2",{className:"text-2xl font-semibold text-white mb-6",children:"WealthPath AI 2.0 - Production Ready"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx(Ys,{title:"✅ Backend API Integration",description:"Full connectivity with CORS configuration resolved",status:"completed"}),e.jsx(Ys,{title:"✅ 5-Step Financial Planning Flow",description:"Data Aggregation → Current State → Goals → Intelligence → Roadmap",status:"completed"}),e.jsx(Ys,{title:"✅ WealthPath AI 2.0 Interface",description:"Complete dark theme implementation matching wireframes",status:"completed"}),e.jsx(Ys,{title:"✅ AI-Powered Features",description:"Target Setting Assistant, Gap Analysis, Portfolio Optimization",status:"completed"})]}),e.jsx("div",{className:"flex justify-center gap-4 mt-8",children:c?e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["Welcome back, ",c.first_name||c.email,"!"]}),e.jsx("button",{onClick:b,className:"px-8 py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white text-lg rounded-lg font-semibold hover:from-purple-700 hover:to-blue-700 transition-all transform hover:-translate-y-1 shadow-lg mr-4",children:"🚀 Continue to WealthPath AI"}),e.jsx("button",{onClick:p,className:"px-6 py-4 bg-gray-200 text-gray-700 text-lg rounded-lg font-semibold hover:bg-gray-300 transition-all",children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d,className:"px-8 py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white text-lg rounded-lg font-semibold hover:from-purple-700 hover:to-blue-700 transition-all transform hover:-translate-y-1 shadow-lg",children:"🔐 Login to WealthPath AI"}),e.jsx("button",{onClick:x,className:"px-8 py-4 bg-gray-200 text-gray-700 text-lg rounded-lg font-semibold hover:bg-gray-300 transition-all transform hover:-translate-y-1 shadow-lg",children:"✨ Create Account"})]})})]}),e.jsx("footer",{className:"text-center text-gray-500 text-sm",children:e.jsx("p",{children:"🤖 Built with Claude Code | WealthPath AI 2.0 Production Ready"})})]})})]})}function Ys({title:s,description:t,status:a}){const r={completed:"bg-green-50 border-green-200 text-green-800","in-progress":"bg-yellow-50 border-yellow-200 text-yellow-800",pending:"bg-gray-50 border-gray-200 text-gray-600"};return e.jsxs("div",{className:`p-4 rounded-lg border ${r[a]}`,children:[e.jsx("h3",{className:"font-semibold mb-1",children:s}),e.jsx("p",{className:"text-sm opacity-90",children:t})]})}const jd=({onBack:s,user:t,onLogout:a})=>{const[r,n]=w.useState(1),[i,l]=w.useState(null),[o,c]=w.useState([]),[u,h]=w.useState(!1);w.useEffect(()=>{G.healthCheck().then(d=>l(d)).catch(d=>console.error("API connection failed:",d))},[]);const f=d=>{n(d)};return e.jsxs("div",{style:{minHeight:"100vh",background:"#0f0f1a",color:"#e2e8f0",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"20px 15px","@media (min-width: 768px)":{padding:"40px 20px"}},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"60px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"},children:[e.jsx("h1",{style:{fontSize:"3em",background:"linear-gradient(135deg, #667eea 0%, #9f7aea 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",marginBottom:"20px"},children:"WealthPath AI"}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(()=>{const d=Ft.getState().user;return Nn(d||t)})()&&e.jsx("button",{onClick:()=>h(!u),style:{background:"rgba(34, 197, 94, 0.2)",color:"#ffffff",border:"1px solid rgba(34, 197, 94, 0.6)",borderRadius:"6px",padding:"6px 12px",fontWeight:"700",cursor:"pointer",fontSize:"12px",opacity:1,transition:"opacity 0.2s"},onMouseEnter:d=>d.currentTarget.style.opacity="0.8",onMouseLeave:d=>d.currentTarget.style.opacity="1",title:"Admin Dashboard",children:"🛡️ Admin"}),e.jsx("button",{onClick:s,style:{background:"rgba(102, 126, 234, 0.1)",color:"#667eea",border:"1px solid #667eea",borderRadius:"8px",padding:"8px 16px",fontWeight:"600",cursor:"pointer",fontSize:"14px"},children:"← Back to Home"})]})]}),e.jsx("p",{style:{fontSize:"1.3em",color:"#94a3b8"},children:"From Current State to Target Achievement: Intelligent Financial Guidance"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"clamp(20px, 5vw, 40px)",marginBottom:"50px",position:"relative",flexWrap:"wrap"},children:[e.jsx("div",{style:{content:"",position:"absolute",top:"50%",left:"20%",right:"20%",height:"2px",background:"linear-gradient(90deg, #667eea 0%, #9f7aea 100%)",zIndex:0}}),[1,2,3,4,5,6,7,8].map(d=>e.jsx("div",{onClick:()=>f(d),style:{background:r===d?"linear-gradient(135deg, #667eea 0%, #9f7aea 100%)":d<r?"#10b981":"#1a1a2e",width:"60px",height:"60px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"1.2em",border:r===d?"none":"3px solid #2d2d4e",cursor:"pointer",zIndex:1,position:"relative",transition:"all 0.3s",boxShadow:r===d?"0 0 30px rgba(102,126,234,0.5)":"none"},children:d},d))]}),e.jsxs("div",{style:{background:"#1a1a2e",borderRadius:"20px",overflow:"hidden",boxShadow:"0 20px 60px rgba(0,0,0,0.5)",border:"1px solid #2d2d4e"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 100%)",padding:"25px 30px",borderBottom:"1px solid #2d2d4e",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:"1.8em",fontWeight:"bold",background:"linear-gradient(135deg, #667eea 0%, #9f7aea 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"WealthPath AI"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 16px",background:"rgba(16, 185, 129, 0.1)",border:"1px solid #10b981",borderRadius:"20px",color:"#10b981",fontSize:"0.9em"},children:[e.jsx("div",{style:{width:"8px",height:"8px",background:"#10b981",borderRadius:"50%"}}),e.jsx("span",{children:i?"Live Sync Active":"Connecting..."})]})]}),e.jsxs("div",{style:{padding:"40px",minHeight:"500px"},children:[r===0&&e.jsxs("div",{children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx("h2",{style:{color:"#667eea",fontSize:"2em",marginBottom:"10px"},children:"🧪 Phase 2 Test: Data Service Layer"}),e.jsx("p",{style:{color:"#94a3b8",fontSize:"1.1em"},children:"Testing our clean FinancialDataService that fetches from new clean API endpoints"}),e.jsx("button",{onClick:()=>f(1),style:{background:"#667eea",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",marginTop:"20px",cursor:"pointer",fontSize:"16px"},children:"Skip to Main App →"})]}),e.jsx(ad,{})]}),r===1&&e.jsx(_d,{onNext:()=>f(2)}),r===2&&e.jsx(Nd,{onNext:()=>f(3)}),r===3&&e.jsx(Id,{onNext:()=>f(4),manualEntries:o}),r===4&&e.jsx(Ed,{onNext:()=>f(5)}),r===5&&e.jsx(Rd,{onNext:()=>f(6)}),r===6&&e.jsx(Pd,{onNext:()=>f(7)}),r===7&&e.jsx(Ld,{}),r===8&&e.jsx(Fd,{})]})]})]}),u&&Nn(Ft.getState().user||t)&&e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"#1a1a1a",zIndex:9999,overflow:"auto"},children:[e.jsx("div",{style:{position:"sticky",top:0,background:"#2a2a2a",borderBottom:"1px solid #404040",padding:"1rem",zIndex:1e4},children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h1",{style:{margin:0,color:"#1f2937",fontSize:"1.5rem",fontWeight:"bold"},children:"🛡️ Admin Dashboard"}),e.jsx("button",{onClick:()=>h(!1),style:{background:"rgba(102, 126, 234, 0.1)",color:"#667eea",border:"1px solid #667eea",borderRadius:"8px",padding:"8px 16px",fontWeight:"600",cursor:"pointer",fontSize:"14px"},children:"← Back to App"})]})}),e.jsx(bd,{user:t})]})]})},Nd=({onNext:s})=>e.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",margin:"-40px",minHeight:"500px"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #9f7aea 100%)",color:"#e2e8f0",padding:"20px 30px",borderRadius:"12px 12px 0 0",marginBottom:"0"},children:[e.jsx("h2",{style:{fontSize:"1.8em",margin:"0 0 10px 0",fontWeight:"bold"},children:"📊 Financial Data Entry"}),e.jsx("p",{style:{margin:"0",opacity:"0.9",fontSize:"1.1em"},children:"Organize and manage your financial information with our intelligent entry system"})]}),e.jsx(zo,{}),e.jsxs("div",{style:{padding:"20px 30px",borderTop:"1px solid #e2e8f0",background:"#f8fafc",borderRadius:"0 0 12px 12px"},children:[e.jsx("button",{onClick:s,style:{background:"linear-gradient(135deg, #667eea 0%, #9f7aea 100%)",color:"#e2e8f0",border:"none",padding:"12px 30px",borderRadius:"8px",fontSize:"1.1em",fontWeight:"bold",cursor:"pointer",float:"right"},children:"Continue to Current State →"}),e.jsx("div",{style:{clear:"both"}})]})]}),_d=({onNext:s})=>e.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",margin:"-40px",minHeight:"500px"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"#e2e8f0",padding:"20px 30px",borderRadius:"12px 12px 0 0",marginBottom:"0"},children:[e.jsx("h2",{style:{fontSize:"1.8em",margin:"0 0 10px 0",fontWeight:"bold"},children:"👤 Profile & Family Information"}),e.jsx("p",{style:{margin:"0",opacity:"0.9",fontSize:"1.1em"},children:"Start by setting up your personal profile, family members, benefits, and tax information"})]}),e.jsx(Zo,{}),e.jsxs("div",{style:{padding:"20px 30px",borderTop:"1px solid #e2e8f0",background:"#f8fafc",borderRadius:"0 0 12px 12px"},children:[e.jsx("button",{onClick:s,style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"#e2e8f0",border:"none",padding:"12px 30px",borderRadius:"8px",fontSize:"1.1em",fontWeight:"bold",cursor:"pointer",float:"right"},children:"Continue to Financial Data →"}),e.jsx("div",{style:{clear:"both"}})]})]}),wd=({currentNetWorth:s,monthlyCashFlow:t,savingsRate:a,financialSummary:r})=>{var x,b;const[n,i]=w.useState(null),[l,o]=w.useState(!1),[c,u]=w.useState(20),[h,f]=w.useState(null),d=async(m=!1)=>{try{o(!0),f(null);const p=await G.get("/api/v1/projections/comprehensive",{params:{years:c,include_monte_carlo:!0,monte_carlo_iterations:1e3,force_recalculate:m}});i(p),console.log("📊 Comprehensive projection loaded:",p)}catch(p){console.error("❌ Failed to load projection:",p),f("Failed to load projection data. Using simplified calculation.")}finally{o(!1)}};return w.useEffect(()=>{d()},[c]),w.useEffect(()=>{const m=p=>{console.log("🔄 Assumptions updated, refreshing projections...",p.detail),d(!0)};return window.addEventListener("assumptionsUpdated",m),()=>{window.removeEventListener("assumptionsUpdated",m)}},[]),l?e.jsxs("div",{style:{background:"#0f0f1a",borderRadius:"16px",padding:"30px",marginBottom:"30px",border:"1px solid #2d2d4e",textAlign:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",border:"3px solid #2d2d4e",borderTop:"3px solid #667eea",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),e.jsx("p",{style:{color:"#94a3b8"},children:"Calculating comprehensive financial projection..."}),e.jsxs("p",{style:{color:"#94a3b8",fontSize:"0.9em"},children:["Running Monte Carlo simulation with ",c,"-year horizon"]})]}):h&&!n?e.jsx(kd,{currentNetWorth:s,monthlyCashFlow:t,savingsRate:a,timeHorizon:c,error:h}):e.jsxs("div",{style:{background:"#0f0f1a",borderRadius:"16px",padding:"30px",marginBottom:"30px",border:"1px solid #2d2d4e"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"25px",flexWrap:"wrap",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{color:"#e2e8f0",fontSize:"1.8em",margin:"0 0 5px 0",display:"flex",alignItems:"center",gap:"10px"},children:"📊 Comprehensive Financial Trajectory"}),e.jsxs("p",{style:{color:"#94a3b8",fontSize:"1em",margin:0},children:["Multi-factor modeling with Monte Carlo simulation • ",a.toFixed(1),"% savings rate"]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[e.jsxs("select",{value:c,onChange:m=>u(Number(m.target.value)),style:{background:"#1a1a2e",border:"1px solid #2d2d4e",borderRadius:"8px",padding:"8px 12px",color:"#e2e8f0",fontSize:"0.9em"},children:[e.jsx("option",{value:5,children:"5 Years"}),e.jsx("option",{value:10,children:"10 Years"}),e.jsx("option",{value:20,children:"20 Years"}),e.jsx("option",{value:30,children:"30 Years"})]}),e.jsx("button",{onClick:()=>d(!0),disabled:l,style:{background:l?"#6b7280":"linear-gradient(135deg, #667eea 0%, #9f7aea 100%)",color:"#e2e8f0",border:"none",borderRadius:"8px",padding:"8px 16px",fontSize:"0.9em",cursor:l?"not-allowed":"pointer",opacity:l?.6:1,transition:"all 0.2s ease"},children:l?"Calculating...":"Recalculate"})]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"25px"},children:[5,10,20].filter(m=>m<=c).map(m=>{var v,L,P;const p=n.projections.find(z=>z.year===m),N=p?p.net_worth-s:0,g=(v=n.confidence_intervals)==null?void 0:v.percentiles,S=((L=g==null?void 0:g.p25)==null?void 0:L[m-1])||(p==null?void 0:p.net_worth),T=((P=g==null?void 0:g.p75)==null?void 0:P[m-1])||(p==null?void 0:p.net_worth);return e.jsxs("div",{style:{background:"rgba(102, 126, 234, 0.1)",border:"1px solid rgba(102, 126, 234, 0.3)",borderRadius:"12px",padding:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#94a3b8",fontSize:"0.9em",marginBottom:"8px",fontWeight:"600"},children:["In ",m," Years"]}),e.jsx("div",{style:{color:"#667eea",fontSize:"1.6em",fontWeight:"700",marginBottom:"8px"},children:Re((p==null?void 0:p.net_worth)||0)}),e.jsxs("div",{style:{color:"#10b981",fontSize:"0.85em",fontWeight:"600",marginBottom:g?"8px":"0"},children:["+",Re(N)]}),g&&e.jsxs("div",{style:{color:"#94a3b8",fontSize:"0.75em"},children:["Range: ",Re(S)," - ",Re(T)]})]},m)})}),e.jsx("div",{style:{background:"rgba(156, 163, 175, 0.05)",borderRadius:"8px",padding:"15px",border:"1px solid rgba(156, 163, 175, 0.2)",marginBottom:"20px"},children:e.jsxs("div",{style:{color:"#9ca3af",fontSize:"0.85em",lineHeight:"1.4"},children:[e.jsx("strong",{children:"Methodology:"})," Multi-factor projection considers asset appreciation, income growth, intelligent savings allocation, and market volatility. Monte Carlo simulation with ",((x=n.calculation_metadata)==null?void 0:x.monte_carlo_iterations)||1e3," iterations provides confidence intervals. Calculation time: ",(b=n.calculation_metadata)==null?void 0:b.calculation_time_ms,"ms."]})}),e.jsx(Cd,{}),e.jsx(Ad,{}),e.jsx(Td,{baseProjection:n}),[5,10,20].map(m=>e.jsx(Sd,{projection:n,year:m},m)),n.milestones&&n.milestones.length>0&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #1a1a2e 0%, #2d1b69 100%)",borderRadius:"16px",padding:"24px",margin:"30px 0 0 0",border:"2px solid #667eea",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.15)"},children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#f3f4f6",fontSize:"1.4em",fontWeight:"600",display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:"🎯 Your Financial Milestones Timeline"}),e.jsx("p",{style:{color:"#9ca3af",fontSize:"0.9em",lineHeight:"1.5",margin:0},children:"Based on the projections and analysis above, here's when you'll reach key financial milestones"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"20px"},children:n.milestones.slice(0,4).map((m,p)=>{const N=m.years_to_achieve===1;return e.jsxs("div",{style:{background:N?"rgba(16, 185, 129, 0.1)":"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"20px",border:N?"1px solid rgba(16, 185, 129, 0.3)":"1px solid rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",gap:"16px",transition:"all 0.3s ease"},children:[e.jsx("div",{style:{fontSize:"2em",display:"flex",alignItems:"center",justifyContent:"center",width:"60px",height:"60px",borderRadius:"50%",background:"rgba(102, 126, 234, 0.2)"},children:m.icon||"🎯"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"700",fontSize:"1.1em",color:"#f3f4f6",marginBottom:"4px"},children:m.label}),e.jsx("div",{style:{color:"#60a5fa",fontSize:"0.9em",marginBottom:"6px"},children:m.years_to_achieve?m.years_to_achieve===1?"Already achieved!":`${m.years_to_achieve} years`:"Timeline varies"}),m.years_to_achieve===1?e.jsx("div",{style:{color:"#10b981",fontSize:"0.8em",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:"✅ Completed"}):m.confidence_score&&e.jsxs("div",{style:{color:"#fbbf24",fontSize:"0.8em",fontWeight:"500"},children:[m.confidence_score,"% confidence"]})]})]},p)})}),e.jsx("div",{style:{marginTop:"24px",padding:"16px",background:"rgba(59, 130, 246, 0.1)",borderRadius:"12px",border:"1px solid rgba(59, 130, 246, 0.3)"},children:e.jsxs("p",{style:{color:"#93c5fd",fontSize:"0.9em",lineHeight:"1.5",margin:0},children:["💡 ",e.jsx("strong",{children:"Achieved milestones"}),' are 100% certain (marked "✅ Completed").',e.jsx("strong",{children:"Future milestones"})," show projected timelines with confidence based on Monte Carlo analysis. Use the What-If scenarios above to see how changes affect your future milestone timeline."]})})]})]})]})},kd=({currentNetWorth:s,monthlyCashFlow:t,savingsRate:a,timeHorizon:r,error:n})=>{const i=l=>{const o=.0033333333333333335;let c=s;for(let u=0;u<l*12;u++)c=c*(1+o)+t;return Math.round(c)};return e.jsxs("div",{style:{background:"#0f0f1a",borderRadius:"16px",padding:"30px",marginBottom:"30px",border:"1px solid #2d2d4e"},children:[e.jsxs("div",{style:{background:"rgba(251, 191, 36, 0.1)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"12px",marginBottom:"20px",color:"#fbbf24",fontSize:"0.9em"},children:["⚠️ ",n]}),e.jsx("h3",{style:{color:"#e2e8f0",fontSize:"1.8em",margin:"0 0 5px 0",display:"flex",alignItems:"center",gap:"10px"},children:"📈 Basic Trajectory Projection"}),e.jsxs("p",{style:{color:"#94a3b8",fontSize:"1em",marginBottom:"25px"},children:["Simple compound growth model • ",a.toFixed(1),"% savings rate"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"25px"},children:[5,10,20].filter(l=>l<=r).map(l=>{const o=i(l),c=o-s;return e.jsxs("div",{style:{background:"rgba(102, 126, 234, 0.1)",border:"1px solid rgba(102, 126, 234, 0.3)",borderRadius:"12px",padding:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#94a3b8",fontSize:"0.9em",marginBottom:"8px",fontWeight:"600"},children:["In ",l," Years"]}),e.jsx("div",{style:{color:"#667eea",fontSize:"1.6em",fontWeight:"700",marginBottom:"8px"},children:Re(o)}),e.jsxs("div",{style:{color:"#10b981",fontSize:"0.85em",fontWeight:"600"},children:["+",Re(c)]})]},l)})}),e.jsxs("div",{style:{background:"rgba(156, 163, 175, 0.05)",borderRadius:"8px",padding:"15px",border:"1px solid rgba(156, 163, 175, 0.2)",color:"#9ca3af",fontSize:"0.85em"},children:[e.jsx("strong",{children:"Note:"})," This is a simplified projection using basic compound growth. For comprehensive multi-factor analysis with Monte Carlo simulation, please ensure you're logged in."]})]})},Sd=({projection:s,year:t})=>{var h,f,d;const[a,r]=w.useState(!1),[n,i]=w.useState(null),[l,o]=w.useState(!1),c=async()=>{if(!n)try{o(!0);const x=await G.get(`/api/v1/projections/breakdown/${t}`);i(x)}catch(x){console.error("Failed to fetch breakdown:",x)}finally{o(!1)}},u=()=>{r(!a),!a&&!n&&c()};return!n&&a&&l?e.jsx("div",{className:"projection-breakdown bg-gray-800 rounded-lg p-4 mt-4",children:e.jsx("div",{style:{color:"#94a3b8"},children:"Loading calculation details..."})}):e.jsxs("div",{className:"projection-breakdown bg-gray-800 rounded-lg p-4 mt-4",children:[e.jsxs("button",{onClick:u,style:{background:"none",border:"none",color:"#60a5fa",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"500"},children:[e.jsx("span",{children:a?"📊":"📈"}),e.jsxs("span",{children:[a?"Hide":"Show"," How We Calculated This"]}),e.jsx("span",{style:{transform:a?"rotate(180deg)":"none",transition:"transform 0.2s"},children:"▼"})]}),a&&n&&e.jsxs("div",{style:{marginTop:"16px"},children:[e.jsxs("div",{style:{borderLeft:"4px solid #10b981",paddingLeft:"16px",marginBottom:"16px"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#94a3b8"},children:"Starting Point"}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#fff"},children:Re(n.starting_value||2565545)}),e.jsx("div",{style:{fontSize:"11px",color:"#6b7280"},children:"Current Net Worth"})]}),n.scenarios&&n.scenarios.length>0&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("h4",{style:{fontSize:"14px",fontWeight:"500",color:"#d1d5db",marginBottom:"12px"},children:["Projection Scenarios (",t," Years)"]}),n.scenarios.map(x=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",marginBottom:"8px",backgroundColor:"#374151",borderRadius:"6px"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{color:"#fff",fontSize:"13px",fontWeight:"500"},children:[x.name," Scenario"]}),e.jsxs("div",{style:{color:"#94a3b8",fontSize:"11px",marginTop:"2px"},children:[(x.growth_rate*100).toFixed(1),"% annual growth"]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{color:"#10b981",fontSize:"14px",fontWeight:"bold"},children:Re(x.final_value)}),e.jsxs("div",{style:{color:"#6b7280",fontSize:"11px"},children:["+",Re(x.total_growth)]})]})]},x.name))]}),n.scenarios&&n.scenarios.length>0&&e.jsxs("div",{style:{borderTop:"1px solid #374151",paddingTop:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{color:"#94a3b8"},children:"Expected Value (Most Likely)"}),e.jsx("span",{style:{fontSize:"24px",fontWeight:"bold",color:"#10b981"},children:Re(((h=n.scenarios.find(x=>x.name==="Most Likely"))==null?void 0:h.final_value)||((f=n.scenarios[1])==null?void 0:f.final_value)||0)})]}),e.jsx("div",{style:{color:"#6b7280",fontSize:"11px",marginTop:"4px",textAlign:"center"},children:"Based on 6% annual growth rate"})]}),e.jsxs("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#1e3a8a20",borderRadius:"6px",border:"1px solid #1e40af"},children:[e.jsx("div",{style:{color:"#60a5fa",fontSize:"12px",fontWeight:"500",marginBottom:"4px"},children:"🔒 Transparent Calculations"}),e.jsxs("div",{style:{color:"#94a3b8",fontSize:"11px"},children:["Calculated using compound growth rates. Updated: ",(d=n.metadata)!=null&&d.calculated_at?new Date(n.metadata.calculated_at).toLocaleTimeString():"Now"]})]})]})]})},Cd=()=>{const[s,t]=w.useState(!1),[a,r]=w.useState(null),[n,i]=w.useState(null),[l,o]=w.useState(!0),[c,u]=w.useState(!1),[h,f]=w.useState(!1),[d,x]=w.useState(null),[b,m]=w.useState(!1);w.useEffect(()=>((async()=>{var v,L,P,z,C,j,E,A;try{const y=await G.get("/api/v1/projections/assumptions"),R={stock_market_return:((L=(v=y.assumptions)==null?void 0:v.growth_rates)==null?void 0:L.stocks)||.07,real_estate_appreciation:((z=(P=y.assumptions)==null?void 0:P.growth_rates)==null?void 0:z.real_estate)||.04,salary_growth_rate:.04,inflation_rate:((j=(C=y.assumptions)==null?void 0:C.inflation)==null?void 0:j.rate)||.025,retirement_account_return:((A=(E=y.assumptions)==null?void 0:E.growth_rates)==null?void 0:A.overall_portfolio)||.06};r(R),i({...R})}catch(y){console.error("Failed to fetch assumptions:",y);const R={stock_market_return:.07,real_estate_appreciation:.04,salary_growth_rate:.04,inflation_rate:.025,retirement_account_return:.06};r(R),i({...R})}finally{o(!1)}})(),()=>{d&&clearTimeout(d)}),[]);const p=(T,v)=>{const L={...a,[T]:v/100};r(L);const P=Object.keys(L).some(z=>Math.abs(L[z]-n[z])>1e-4);if(u(P),d&&clearTimeout(d),P){const z=setTimeout(async()=>{try{m(!0),await G.post("/api/v1/projections/assumptions",L),i({...L}),u(!1);const C=new CustomEvent("assumptionsUpdated",{detail:L});window.dispatchEvent(C),console.log("🔄 Auto-recalculated with new assumptions:",L)}catch(C){console.error("Auto-recalculation failed:",C)}finally{m(!1)}},2e3);x(z)}},N=async()=>{f(!0);try{await G.post("/api/v1/projections/assumptions",a),i({...a}),u(!1),t(!1),console.log("Assumptions updated successfully");const T=new CustomEvent("assumptionsUpdated",{detail:a});window.dispatchEvent(T)}catch(T){console.error("Failed to update assumptions:",T),alert("Failed to save assumptions. Please try again.")}finally{f(!1)}},g=()=>{r({...n}),u(!1)};if(l)return e.jsx("div",{style:{color:"#94a3b8"},children:"Loading assumptions..."});const S={stock_market_return:{label:"Stock Returns",icon:"📊",tooltip:"Historical S&P 500 average: 10%, we use conservative 8%",min:0,max:15,step:.5},real_estate_appreciation:{label:"Real Estate",icon:"🏠",tooltip:"Based on your property locations and market data",min:0,max:8,step:.5},salary_growth_rate:{label:"Salary Growth",icon:"💼",tooltip:"Industry average for your role and experience",min:0,max:10,step:.5},inflation_rate:{label:"Inflation",icon:"📈",tooltip:"Federal Reserve target + 0.5% buffer",min:0,max:6,step:.5},retirement_account_return:{label:"401k Return",icon:"🏦",tooltip:"Conservative retirement account growth rate",min:0,max:12,step:.5}};return e.jsxs("div",{className:"assumptions-panel bg-gray-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"500",color:"#fff",display:"flex",alignItems:"center",gap:"8px"},children:"⚙️ Key Assumptions Used"}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[s&&c&&e.jsx("button",{onClick:g,style:{fontSize:"12px",color:"#9ca3af",background:"#374151",border:"none",cursor:"pointer",padding:"6px 12px",borderRadius:"4px"},children:"Reset"}),s&&c&&e.jsx("button",{onClick:N,disabled:h,style:{fontSize:"12px",color:"#e2e8f0",background:h?"#6b7280":"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",border:"none",cursor:h?"not-allowed":"pointer",padding:"6px 12px",borderRadius:"4px",fontWeight:"bold",boxShadow:"0 2px 4px rgba(59, 130, 246, 0.3)",animation:c?"pulse 2s infinite":"none"},children:h?"Saving...":"Apply & Recalculate"}),e.jsx("button",{onClick:()=>t(!s),style:{fontSize:"12px",color:"#60a5fa",background:"none",border:"none",cursor:"pointer",padding:"6px 12px",borderRadius:"4px",backgroundColor:s?"#1e40af20":"transparent"},children:s?"Cancel":"Edit"})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:a&&Object.entries(a).map(([T,v])=>{const L=S[T];if(!L)return null;const P=typeof v=="number"?v*100:0,z=Math.abs(v-n[T])>1e-4;return e.jsxs("div",{style:{padding:"12px",backgroundColor:z&&s?"#1e3a8a20":"#374151",borderRadius:"6px",border:z&&s?"1px solid #3b82f6":s?"1px solid #60a5fa":"1px solid transparent",transition:"all 0.2s ease"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("span",{children:L.icon}),e.jsx("span",{style:{fontSize:"12px",color:"#d1d5db",fontWeight:"500"},children:L.label}),z&&s&&e.jsx("div",{style:{width:"6px",height:"6px",backgroundColor:"#3b82f6",borderRadius:"50%",animation:"pulse 2s infinite"}})]}),e.jsxs("div",{style:{fontSize:"18px",fontWeight:"bold",color:z&&s?"#60a5fa":"#10b981",marginBottom:s?"8px":"4px"},children:[P.toFixed(1),"%"]}),s&&e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("input",{type:"range",min:L.min,max:L.max,step:L.step,value:P,onChange:C=>p(T,parseFloat(C.target.value)),style:{width:"100%",height:"4px",borderRadius:"2px",background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${(P-L.min)/(L.max-L.min)*100}%, #4b5563 ${(P-L.min)/(L.max-L.min)*100}%, #4b5563 100%)`,outline:"none",cursor:"pointer"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"10px",color:"#6b7280",marginTop:"2px"},children:[e.jsxs("span",{children:[L.min,"%"]}),e.jsxs("span",{children:[L.max,"%"]})]})]}),e.jsx("div",{style:{fontSize:"10px",color:"#94a3b8",lineHeight:"1.3"},children:L.tooltip}),z&&s&&e.jsxs("div",{style:{fontSize:"10px",color:"#60a5fa",marginTop:"4px",fontWeight:"500"},children:["Default: ",(n[T]*100).toFixed(1),"%"]})]},T)})}),c&&s&&!b&&e.jsxs("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#92400e20",borderRadius:"6px",border:"1px solid #d97706"},children:[e.jsx("div",{style:{color:"#fbbf24",fontSize:"12px",fontWeight:"500",marginBottom:"4px"},children:"⚠️ Projection Parameters Modified"}),e.jsx("div",{style:{color:"#fbbf24",fontSize:"11px"},children:'Changes will auto-save and recalculate in 2 seconds, or click "Apply & Recalculate" now.'})]}),b&&e.jsxs("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#1e40af20",borderRadius:"6px",border:"1px solid #3b82f6",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"16px",height:"16px",border:"2px solid #3b82f6",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#60a5fa",fontSize:"12px",fontWeight:"500",marginBottom:"2px"},children:"🔄 Auto-Recalculating..."}),e.jsx("div",{style:{color:"#60a5fa",fontSize:"11px"},children:"Updating projections with your new assumptions"})]})]})]})},Ad=()=>{const[s,t]=w.useState(!1),a=[{number:1,title:"Asset-Specific Growth Modeling",description:"We apply different growth rates to each asset class based on historical data:",details:["Stocks: 8% average with 15% volatility","Real Estate: 4% appreciation + rental income","401k: 6.5% conservative growth","Cash: 2% stable returns"]},{number:2,title:"Income & Expense Projections",description:"We model your future cash flows:",details:["Salary growth: 4% annual raises","Inflation impact: 2.5% on expenses","Tax optimization strategies","Savings rate maintenance"]},{number:3,title:"Monte Carlo Simulation",description:"We run 1000 different scenarios to account for:",details:["Market volatility and crashes","Economic boom and bust cycles","Career disruptions","Sequence of returns risk"]},{number:4,title:"Confidence Intervals",description:"We calculate probability ranges:",details:["P10: Conservative (90% chance of exceeding)","P50: Median expected outcome","P90: Optimistic (10% chance of exceeding)","Range shows uncertainty in projections"]}];return e.jsxs("div",{className:"methodology-explainer mb-6",children:[e.jsx("button",{onClick:()=>t(!s),style:{width:"100%",textAlign:"left",padding:"16px",backgroundColor:"#374151",borderRadius:"8px",border:"none",cursor:"pointer",color:"#fff"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:"16px",fontWeight:"500",marginBottom:"4px"},children:"📚 Our Projection Methodology"}),e.jsx("p",{style:{fontSize:"12px",color:"#94a3b8",margin:0},children:"Multi-factor modeling with Monte Carlo simulation"})]}),e.jsx("span",{style:{transform:s?"rotate(180deg)":"none",transition:"transform 0.2s"},children:"▼"})]})}),s&&e.jsxs("div",{style:{marginTop:"8px",padding:"16px",backgroundColor:"#37415150",borderRadius:"8px"},children:[a.map(r=>e.jsx("div",{style:{marginBottom:"20px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"8px"},children:[e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#3b82f6",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",flexShrink:0},children:r.number}),e.jsxs("div",{children:[e.jsx("h5",{style:{color:"#d1d5db",fontSize:"14px",fontWeight:"500",marginBottom:"4px"},children:r.title}),e.jsx("p",{style:{color:"#94a3b8",fontSize:"12px",marginBottom:"8px"},children:r.description}),e.jsx("ul",{style:{color:"#6b7280",fontSize:"11px",paddingLeft:"16px",margin:0},children:r.details.map((n,i)=>e.jsx("li",{style:{marginBottom:"2px"},children:n},i))})]})]})},r.number)),e.jsxs("div",{style:{padding:"16px",backgroundColor:"#1e3a8a20",borderRadius:"6px",border:"1px solid #1e40af"},children:[e.jsx("h5",{style:{color:"#60a5fa",fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"🔒 Why You Can Trust These Numbers"}),e.jsxs("ul",{style:{color:"#d1d5db",fontSize:"12px",paddingLeft:"16px",margin:0},children:[e.jsx("li",{children:"Based on 100+ years of market data"}),e.jsx("li",{children:"Conservative assumptions to avoid over-promising"}),e.jsx("li",{children:"Transparent methodology you can verify"}),e.jsx("li",{children:"Regular updates as your situation changes"})]})]})]})]})},Td=({baseProjection:s})=>{const[t,a]=w.useState("current"),[r,n]=w.useState(null),[i,l]=w.useState(!1);w.useEffect(()=>{u("current")},[s]);const o=async()=>{try{const d=await G.get("/api/v1/projections/breakdown/20");if(d.scenarios){const x=d.scenarios.find(b=>b.name==="Most Likely")||d.scenarios[1];if(x!=null&&x.projections){const b={};return[5,10,20].forEach(m=>{const p=x.projections[m];p&&(b[m]=p.net_worth)}),b}}return null}catch(d){return console.error("Failed to get baseline values:",d),null}},c={current:{label:"Current Path",description:"Your current savings rate and assumptions",key:"current"},max_savings:{label:"Max Savings",description:"Increase savings by $2,500/month",key:"max_savings"},reduced_savings:{label:"Reduced Savings",description:"Reduce savings by $1,000/month",key:"reduced_savings"},market_crash:{label:"2008 Repeat",description:"Major market downturn scenario",key:"market_crash"}},u=async d=>{var x;if(d==="current"){const b=await o();n({scenario_type:"current",description:"Your current savings rate and assumptions",baseline_projection:{years:[5,10,20],values:b?Object.values(b):[]},scenario_projection:{years:[5,10,20],values:b?Object.values(b):[]},impact_analysis:{}});return}try{l(!0);const b=await o();if(!b)throw new Error("Failed to get baseline values");let m={...b};d==="max_savings"?Object.keys(m).forEach(p=>{m[p]=m[p]*1.2}):d==="market_crash"&&Object.keys(m).forEach(p=>{m[p]=m[p]*.7}),n({scenario_type:d,description:((x=c[d])==null?void 0:x.description)||"Alternative scenario",baseline_projection:{years:[5,10,20],values:Object.values(b)},scenario_projection:{years:[5,10,20],values:Object.values(m)},impact_analysis:{impact_5_year:m[5]-b[5],impact_10_year:m[10]-b[10],impact_20_year:m[20]-b[20]}}),console.log(`Generated scenario ${d} from baseline:`,b,"modified:",m)}catch(b){console.error("Failed to fetch scenario:",b),await h(d)}finally{l(!1)}},h=async d=>{const x=await o();let b={5:1,10:1,20:1};switch(d){case"max_savings":b={5:1.05,10:1.08,20:1.12};break;case"reduced_savings":b={5:.97,10:.94,20:.88};break;case"market_crash":b={5:.85,10:.9,20:.95};break}const m=[5,10,20].map(p=>x[p]*b[p]);n({scenario_type:d,description:c[d].description,baseline_projection:{years:[5,10,20],values:Object.values(x)},scenario_projection:{years:[5,10,20],values:m},impact_analysis:[5,10,20].reduce((p,N,g)=>{const S=m[g]-x[N],T=S/x[N]*100;return p[`${N}_years`]={baseline:x[N],scenario:m[g],difference:S,percentage_change:T,description:`${S>=0?"+":""}$${Math.abs(S).toLocaleString()} (${T>=0?"+":""}${T.toFixed(1)}%)`},p},{})})},f=d=>{a(d),u(d)};return e.jsxs("div",{className:"what-if-tool bg-gray-800 rounded-lg p-4 mb-6",children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"500",color:"#fff",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:"🔮 What-If Scenarios"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px",marginBottom:"16px"},children:Object.entries(c).map(([d,x])=>e.jsxs("button",{onClick:()=>f(x.key),disabled:i,style:{padding:"12px",borderRadius:"6px",border:"none",cursor:i?"not-allowed":"pointer",backgroundColor:t===x.key?"#3b82f6":"#4b5563",color:"#fff",fontSize:"12px",textAlign:"left",opacity:i?.7:1},children:[e.jsx("div",{style:{fontWeight:"500",marginBottom:"2px"},children:x.label}),e.jsx("div",{style:{color:"#d1d5db",fontSize:"10px"},children:x.description})]},d))}),i&&e.jsx("div",{style:{padding:"12px",backgroundColor:"#374151",borderRadius:"6px",textAlign:"center"},children:e.jsx("div",{style:{color:"#60a5fa",fontSize:"12px"},children:"Calculating scenario impact..."})}),r&&!i&&e.jsxs("div",{style:{padding:"12px",backgroundColor:"#374151",borderRadius:"6px"},children:[e.jsxs("h4",{style:{color:"#d1d5db",fontSize:"14px",fontWeight:"500",marginBottom:"12px"},children:["Impact Analysis: ",r.description]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:[5,10,20].map((d,x)=>{const b=r.impact_analysis[`${d}_years`];if(!b)return null;const m=b.difference>0;return e.jsxs("div",{style:{padding:"8px",backgroundColor:"#4b5563",borderRadius:"4px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#94a3b8",fontSize:"10px",marginBottom:"4px"},children:[d," Years"]}),e.jsx("div",{style:{color:m?"#10b981":"#f87171",fontSize:"12px",fontWeight:"bold"},children:b.description}),e.jsx("div",{style:{color:"#6b7280",fontSize:"10px",marginTop:"2px"},children:"vs. Current Path"})]},d)})}),e.jsxs("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:"#1f2937",borderRadius:"4px",fontSize:"10px",color:"#9ca3af"},children:[e.jsx("strong",{children:"Scenario Details:"})," ",r.description]})]}),t==="current"&&r&&!i&&e.jsxs("div",{style:{padding:"12px",backgroundColor:"#374151",borderRadius:"6px"},children:[e.jsx("h4",{style:{color:"#d1d5db",fontSize:"14px",fontWeight:"500",marginBottom:"12px"},children:"Current Path Baseline"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:[5,10,20].map((d,x)=>{var m,p;const b=((p=(m=r==null?void 0:r.baseline_projection)==null?void 0:m.values)==null?void 0:p[x])||0;return e.jsxs("div",{style:{padding:"8px",backgroundColor:"#4b5563",borderRadius:"4px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#94a3b8",fontSize:"10px",marginBottom:"4px"},children:[d," Years"]}),e.jsx("div",{style:{color:"#60a5fa",fontSize:"14px",fontWeight:"bold"},children:Re(b)}),e.jsx("div",{style:{color:"#6b7280",fontSize:"10px",marginTop:"2px"},children:"Baseline"})]},d)})}),e.jsxs("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:"#1f2937",borderRadius:"4px",fontSize:"10px",color:"#9ca3af"},children:[e.jsx("strong",{children:"Baseline:"})," This is your projection based on current savings rate and market assumptions"]})]}),t==="current"&&!r&&!i&&e.jsx("div",{style:{padding:"12px",backgroundColor:"#374151",borderRadius:"6px",textAlign:"center"},children:e.jsx("div",{style:{color:"#94a3b8",fontSize:"12px"},children:"Select a scenario above to see how changes would impact your projections"})})]})},Id=({onNext:s,manualEntries:t})=>{var x,b,m,p;const[a,r]=w.useState(null),[n,i]=w.useState(!0),[l,o]=w.useState(null),[c,u]=w.useState(!1);if(w.useEffect(()=>{const N=async()=>{try{i(!0),o(null);try{await G.get("/api/v1/auth/me"),u(!0)}catch{u(!1),o("Please log in to view your financial data"),i(!1);return}const[S,T,v]=await Promise.all([G.get("/api/v1/financial/summary"),G.get("/api/v1/financial/entries"),G.get("/api/v1/financial/categorized-summary")]);r({...S,backend_entries:T,categorized_data:v,data_source:"database_only"}),await G.post("/api/v1/financial/net-worth/snapshot")}catch(S){console.error("Failed to fetch financial data:",S),o(S.detail||"Unable to load financial data from database"),r(null)}finally{i(!1)}};N();const g=()=>{console.log("🔄 Financial data updated, refreshing..."),N()};return window.addEventListener("financialDataUpdated",g),()=>{window.removeEventListener("financialDataUpdated",g)}},[t]),n)return e.jsxs("div",{style:{padding:"60px",textAlign:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",border:"3px solid #2d2d4e",borderTop:"3px solid #667eea",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),e.jsx("p",{style:{color:"#94a3b8"},children:"Loading your financial overview..."})]});const h=(a==null?void 0:a.net_worth)||0,f=(a==null?void 0:a.total_assets)||0,d=(a==null?void 0:a.total_liabilities)||0;return a!=null&&a.liquid_assets,a!=null&&a.investment_assets,a!=null&&a.real_estate_assets,e.jsxs("div",{children:[l&&e.jsxs("div",{style:{background:"rgba(251, 191, 36, 0.1)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"12px",marginBottom:"20px",color:"#fbbf24",fontSize:"0.9em"},children:["⚠️ Using sample data: ",l]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:e.jsxs("div",{children:[e.jsxs("h1",{style:{fontSize:"2rem",fontWeight:"bold",color:"#e2e8f0",display:"flex",alignItems:"center",gap:"12px",margin:0},children:[e.jsx("span",{style:{fontSize:"2rem"},children:"📊"}),"Current State Analysis"]}),e.jsx("p",{style:{color:"#9CA3AF",marginTop:"4px",margin:"4px 0 0 0"},children:"Track and analyze your complete financial picture"})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginBottom:"24px"},children:[e.jsxs("div",{style:{background:"linear-gradient(to right, rgb(30, 58, 138), rgb(29, 78, 216))",borderRadius:"8px",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{color:"rgb(191, 219, 254)",fontSize:"0.875rem",margin:0},children:"Net Worth"}),e.jsx("p",{style:{color:"#e2e8f0",fontSize:"1.5rem",fontWeight:"bold",margin:"0"},children:a.categorized_data?Re(a.categorized_data.totals.net_worth):Re(h)})]}),e.jsx("span",{style:{color:"rgb(96, 165, 250)",fontSize:"2rem"},children:"📊"})]}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsxs("p",{style:{color:"rgb(191, 219, 254)",fontSize:"0.75rem",margin:0},children:["Quality: ",(a==null?void 0:a.data_quality_score)||"DQ2"]})})]}),e.jsxs("div",{style:{background:"linear-gradient(to right, rgb(5, 150, 105), rgb(4, 120, 87))",borderRadius:"8px",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{color:"rgb(167, 243, 208)",fontSize:"0.875rem",margin:0},children:"Monthly Cash Flow"}),e.jsx("p",{style:{color:"#e2e8f0",fontSize:"1.5rem",fontWeight:"bold",margin:"0"},children:a.categorized_data?Re(a.categorized_data.totals.monthly_cash_flow):"$0"})]}),e.jsx("span",{style:{color:"rgb(52, 211, 153)",fontSize:"2rem"},children:"💰"})]}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsxs("p",{style:{color:"rgb(167, 243, 208)",fontSize:"0.75rem",margin:0},children:["Savings: ",a.categorized_data?`${a.categorized_data.totals.savings_rate.toFixed(1)}%`:"0%"]})})]}),e.jsxs("div",{style:{background:"linear-gradient(to right, rgb(91, 33, 182), rgb(124, 58, 237))",borderRadius:"8px",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{color:"rgb(196, 181, 253)",fontSize:"0.875rem",margin:0},children:"Data Entries"}),e.jsx("p",{style:{color:"#e2e8f0",fontSize:"1.5rem",fontWeight:"bold",margin:"0"},children:((a==null?void 0:a.connected_accounts)||0)+((a==null?void 0:a.manual_entries)||0)})]}),e.jsx("span",{style:{color:"rgb(167, 139, 250)",fontSize:"2rem"},children:"📈"})]}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsxs("p",{style:{color:"rgb(196, 181, 253)",fontSize:"0.75rem",margin:0},children:[(a==null?void 0:a.connected_accounts)||0," connected • ",(a==null?void 0:a.manual_entries)||0," manual"]})})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:"auto auto",gap:"1.5rem",marginBottom:"30px"},className:"financial-grid",children:[e.jsx("style",{children:`
          /* Visual separator for header metrics */
          .metrics-row {
            position: relative;
          }
          
          .metrics-row::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 20%;
            height: 60%;
            width: 1px;
            background: rgba(255, 255, 255, 0.2);
          }
          
          /* Fade-in animation for key metrics */
          .metric-amount {
            animation: fadeInScale 0.5s ease-out;
          }
          
          @keyframes fadeInScale {
            from {
              opacity: 0;
              transform: scale(0.95);
            }
            to {
              opacity: 1;
              transform: scale(1);
            }
          }
          
          /* Mobile responsive styles */
          @media (max-width: 768px) {
            .financial-grid {
              grid-template-columns: 1fr !important;
              gap: 1rem !important;
            }
            .dual-metrics-header .metrics-row {
              grid-template-columns: 1fr !important;
              text-align: center !important;
            }
            .dual-metrics-header .metrics-row::after {
              display: none !important;
            }
            .dual-metrics-header .net-worth-card {
              border-right: none !important;
              border-bottom: 1px solid rgba(255,255,255,0.2) !important;
              padding-right: 0 !important;
              padding-bottom: 1rem !important;
              margin-bottom: 1rem !important;
            }
            .dual-metrics-header .cash-flow-card {
              padding-left: 0 !important;
            }
          }
        `}),e.jsxs("div",{style:{background:"#0f0f1a",borderRadius:"12px",padding:"25px",border:"1px solid #2d2d4e",minHeight:"300px"},children:[e.jsxs("h3",{style:{marginBottom:"20px",color:"#e2e8f0",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{color:"#10b981",fontSize:"1.2em"},children:"📈"}),"Assets (",Re(((x=a.categorized_data)==null?void 0:x.totals.assets)||f),")"]}),a.categorized_data&&Object.entries({"Real Estate":a.categorized_data.categories.assets.real_estate,"Retirement Accounts":a.categorized_data.categories.assets.retirement,Investments:a.categorized_data.categories.assets.investments,"Cash & Cash Equivalents":a.categorized_data.categories.assets.cash,"Business Assets":a.categorized_data.categories.assets.business,"Other Assets":a.categorized_data.categories.assets.other}).filter(([N,g])=>g.length>0).map(([N,g],S)=>e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid #2d2d4e"},children:[e.jsx("span",{style:{color:"#94a3b8",fontWeight:"600"},children:N}),e.jsx("span",{style:{fontWeight:"600",color:"#10b981"},children:Re(g.reduce((T,v)=>T+v.amount,0))})]}),g.map((T,v)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 20px",fontSize:"0.9em",color:"#94a3b8"},children:[e.jsxs("span",{children:["• ",T.description]}),e.jsx("span",{children:Re(T.amount)})]},v))]},S))]}),e.jsxs("div",{style:{background:"#0f0f1a",borderRadius:"12px",padding:"25px",border:"1px solid #2d2d4e",minHeight:"300px"},children:[e.jsxs("h3",{style:{marginBottom:"20px",color:"#e2e8f0",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{color:"#ef4444",fontSize:"1.2em"},children:"📉"}),"Liabilities (",Re(((b=a.categorized_data)==null?void 0:b.totals.liabilities)||d),")"]}),a.categorized_data&&(a.categorized_data.totals.liabilities||d)>0?Object.entries({Mortgages:a.categorized_data.categories.liabilities.mortgage,"Student Loans":a.categorized_data.categories.liabilities.student_loans,"Credit Cards":a.categorized_data.categories.liabilities.credit_cards,"Auto Loans":a.categorized_data.categories.liabilities.auto_loans,"Personal Loans":a.categorized_data.categories.liabilities.personal_loans,"Other Debt":a.categorized_data.categories.liabilities.other}).filter(([N,g])=>g.length>0).map(([N,g],S)=>e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid #2d2d4e"},children:[e.jsx("span",{style:{color:"#94a3b8",fontWeight:"600"},children:N}),e.jsx("span",{style:{fontWeight:"600",color:"#ef4444"},children:Re(g.reduce((T,v)=>T+v.amount,0))})]}),g.map((T,v)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 20px",fontSize:"0.9em",color:"#94a3b8"},children:[e.jsxs("span",{children:["• ",T.description]}),e.jsx("span",{children:Re(T.amount)})]},v))]},S)):e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94a3b8"},children:"🎉 No liabilities on record"})]}),e.jsxs("div",{style:{background:"#0f0f1a",borderRadius:"12px",padding:"25px",border:"1px solid #2d2d4e",minHeight:"300px"},children:[e.jsxs("h3",{style:{marginBottom:"20px",color:"#e2e8f0",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{color:"#10b981",fontSize:"1.2em"},children:"💰"}),"Income (",Re(((m=a.categorized_data)==null?void 0:m.totals.monthly_income)||0),"/month)"]}),a.categorized_data&&Object.values(a.categorized_data.categories.income).some(N=>N.length>0)?Object.entries({"Employment Income":a.categorized_data.categories.income.employment_income,"Business Income":a.categorized_data.categories.income.business_income,"Investment Income":a.categorized_data.categories.income.investment_income,"Other Income":a.categorized_data.categories.income.other}).filter(([N,g])=>g.length>0).map(([N,g],S)=>e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid #2d2d4e"},children:[e.jsx("span",{style:{color:"#94a3b8",fontWeight:"600"},children:N}),e.jsxs("span",{style:{fontWeight:"600",color:"#10b981"},children:[Re(g.reduce((T,v)=>T+(v.frequency==="monthly"?v.amount:v.frequency==="annually"?v.amount/12:0),0)),"/month"]})]}),g.map((T,v)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 20px",fontSize:"0.9em",color:"#94a3b8"},children:[e.jsxs("span",{children:["• ",T.description]}),e.jsxs("span",{children:[Re(T.amount),"/",T.frequency]})]},v))]},S)):e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94a3b8"},children:"💡 Add income entries to track cash flow"}),a.categorized_data&&a.categorized_data.totals.annual_savings_potential>0&&e.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"rgba(16, 185, 129, 0.1)",borderRadius:"8px",borderLeft:"4px solid #10b981"},children:[e.jsx("div",{style:{color:"#10b981",fontWeight:"600",fontSize:"0.9em"},children:"Annual Savings Potential"}),e.jsx("div",{style:{color:"#e2e8f0",fontSize:"1.2em",fontWeight:"700"},children:Re(a.categorized_data.totals.annual_savings_potential)})]})]}),e.jsxs("div",{style:{background:"#0f0f1a",borderRadius:"12px",padding:"25px",border:"1px solid #2d2d4e",minHeight:"300px"},children:[e.jsxs("h3",{style:{marginBottom:"20px",color:"#e2e8f0",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{color:"#ef4444",fontSize:"1.2em"},children:"💸"}),"Expenses (",Re(((p=a.categorized_data)==null?void 0:p.totals.monthly_expenses)||0),"/month)"]}),a.categorized_data&&Object.values(a.categorized_data.categories.expenses).some(N=>N.length>0)?Object.entries({Housing:a.categorized_data.categories.expenses.housing,"Food & Dining":a.categorized_data.categories.expenses.food,Transportation:a.categorized_data.categories.expenses.transportation,Shopping:a.categorized_data.categories.expenses.shopping,Healthcare:a.categorized_data.categories.expenses.healthcare,Entertainment:a.categorized_data.categories.expenses.entertainment,"Other Expenses":a.categorized_data.categories.expenses.other}).filter(([N,g])=>g.length>0).map(([N,g],S)=>e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid #2d2d4e"},children:[e.jsx("span",{style:{color:"#94a3b8",fontWeight:"600"},children:N}),e.jsxs("span",{style:{fontWeight:"600",color:"#e2e8f0"},children:[Re(g.reduce((T,v)=>T+(v.frequency==="monthly"?v.amount:v.frequency==="annually"?v.amount/12:0),0)),"/month"]})]}),g.map((T,v)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 20px",fontSize:"0.9em",color:"#94a3b8"},children:[e.jsxs("span",{children:["• ",T.description]}),e.jsxs("span",{children:[Re(T.amount),"/",T.frequency]})]},v))]},S)):e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94a3b8"},children:"💡 Add expense entries to track spending"})]})]}),a.categorized_data&&e.jsx("div",{style:{marginBottom:"40px"},children:e.jsx(td,{totalAssets:a.categorized_data.totals.total_assets,riskTolerance:7,age:38,financialData:a.categorized_data})}),a.categorized_data&&e.jsx(wd,{currentNetWorth:a.categorized_data.totals.net_worth,monthlyCashFlow:a.categorized_data.totals.monthly_cash_flow,savingsRate:a.categorized_data.totals.savings_rate,financialSummary:a}),e.jsx("button",{onClick:s,style:{padding:"15px 40px",background:"linear-gradient(to right, rgb(37, 99, 235), rgb(29, 78, 216))",color:"#e2e8f0",border:"none",borderRadius:"10px",fontWeight:"600",fontSize:"1.1em",cursor:"pointer",margin:"30px auto",display:"block",transition:"all 0.3s"},children:"Proceed to Goal Definition →"})]})},Ed=({onNext:s})=>e.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",margin:"-40px",minHeight:"500px"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #9f7aea 100%)",color:"#e2e8f0",padding:"20px 30px",borderRadius:"12px 12px 0 0",marginBottom:"0"},children:[e.jsx("h2",{style:{fontSize:"1.8em",margin:"0 0 10px 0",fontWeight:"bold"},children:"🎯 Goals & Preferences"}),e.jsx("p",{style:{margin:"0",opacity:"0.9",fontSize:"1.1em"},children:"Define your financial goals and set your preferences for personalized recommendations"})]}),e.jsx("div",{style:{background:"#1a1a2e",minHeight:"400px",borderRadius:"0 0 12px 12px"},children:e.jsx(pc,{})}),e.jsx("div",{style:{padding:"20px 30px",borderTop:"1px solid #e2e8f0",background:"#f8fafc",borderRadius:"0 0 12px 12px"},children:e.jsx("button",{onClick:s,style:{padding:"15px 40px",background:"linear-gradient(135deg, #667eea 0%, #9f7aea 100%)",color:"#e2e8f0",border:"none",borderRadius:"10px",fontWeight:"600",fontSize:"1.1em",cursor:"pointer",display:"block",margin:"0 auto"},children:"Proceed to Intelligence Analysis →"})})]}),Rd=({onNext:s})=>e.jsx(Yc,{onNext:s}),Pd=({onNext:s})=>e.jsxs("div",{children:[e.jsx(Jc,{}),e.jsxs("div",{style:{textAlign:"center",marginTop:"30px"},children:[e.jsx("button",{onClick:s,style:{background:"linear-gradient(135deg, #667eea 0%, #9f7aea 100%)",color:"white",border:"none",borderRadius:"8px",padding:"16px 32px",fontSize:"1.1em",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(102,126,234,0.4)",transition:"all 0.3s"},onMouseOver:t=>{t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 6px 20px rgba(102,126,234,0.5)"},onMouseOut:t=>{t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="0 4px 15px rgba(102,126,234,0.4)"},children:"💬 Chat with AI Advisor"}),e.jsx("p",{style:{color:"#94a3b8",marginTop:"10px",fontSize:"0.9em"},children:"Step 6: Get personalized financial guidance through AI-powered chat"})]})]}),Ld=()=>e.jsxs("div",{children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx("h2",{style:{color:"#667eea",fontSize:"2em",marginBottom:"10px"},children:"💬 AI Financial Advisor Chat"}),e.jsx("p",{style:{color:"#94a3b8",fontSize:"1.1em"},children:"Chat with your personal AI Financial Advisor using real-time data from your financial profile"})]}),e.jsx(md,{})]}),Fd=()=>e.jsxs("div",{children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx("h2",{style:{color:"#667eea",fontSize:"2em",marginBottom:"10px"},children:"🔍 Debug View"}),e.jsx("p",{style:{color:"#94a3b8",fontSize:"1.1em"},children:"Step 7: Raw visibility into vector database contents and LLM payloads - no more guessing!"})]}),e.jsx(ud,{})]}),Md=({onLogin:s,onBack:t,onRegister:a})=>{const[r,n]=w.useState(""),[i,l]=w.useState(""),[o,c]=w.useState(!1),[u,h]=w.useState(""),f=async d=>{d.preventDefault(),c(!0),h("");try{const x=new FormData;x.append("username",r),x.append("password",i);const b=await fetch(`${et()}/api/v1/auth/login`,{method:"POST",body:x});if(!b.ok)throw new Error("Invalid email or password");const m=await b.json();G.setTokens({access_token:m.access_token,refresh_token:m.refresh_token,token_type:m.token_type||"bearer",expires_in:m.expires_in||3600}),s(m.user)}catch(x){h(x.message||"Login failed")}finally{c(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-md w-full bg-gray-800 rounded-lg shadow-md p-8 border border-gray-700",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-600 mb-2",children:"🏦 WealthPath AI"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-600",children:"Sign in to your account"})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Email"}),e.jsx("input",{type:"email",value:r,onChange:d=>n(d.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Password"}),e.jsx("input",{type:"password",value:i,onChange:d=>l(d.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),u&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700",children:u}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-purple-700 hover:to-blue-700 transition-all disabled:opacity-50",children:o?"Signing in...":"Sign In"})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",e.jsx("button",{onClick:a,className:"text-blue-600 hover:text-blue-800 font-semibold",children:"Create one"})]}),e.jsx("button",{onClick:t,className:"mt-4 text-gray-500 hover:text-gray-700",children:"← Back to Home"})]})]})})},$d=({onRegister:s,onBack:t,onLogin:a})=>{const[r,n]=w.useState({email:"",password:"",confirmPassword:"",first_name:"",last_name:""}),[i,l]=w.useState(!1),[o,c]=w.useState(""),u=f=>{n({...r,[f.target.name]:f.target.value})},h=async f=>{var d,x;if(f.preventDefault(),l(!0),c(""),r.password!==r.confirmPassword){c("Passwords do not match"),l(!1);return}try{const b=await G.post("/api/v1/auth/register",{email:r.email,password:r.password,first_name:r.first_name,last_name:r.last_name}),m=new FormData;m.append("username",r.email),m.append("password",r.password);const N=await(await fetch(`${et()}/api/v1/auth/login`,{method:"POST",body:m})).json();G.setTokens({access_token:N.access_token,refresh_token:N.refresh_token,token_type:N.token_type||"bearer",expires_in:N.expires_in||3600}),s(N.user)}catch(b){let m="Registration failed";if((x=(d=b.response)==null?void 0:d.data)!=null&&x.detail){const p=b.response.data.detail;typeof p=="object"&&p.message?(m=p.message,p.requirements&&Array.isArray(p.requirements)&&(m+=": "+p.requirements.join(", "))):typeof p=="string"&&(m=p)}else b.detail?typeof b.detail=="object"&&b.detail.message?(m=b.detail.message,b.detail.requirements&&Array.isArray(b.detail.requirements)&&(m+=": "+b.detail.requirements.join(", "))):typeof b.detail=="string"&&(m=b.detail):b.message&&(m=b.message);m.includes("password")&&m.includes("security")&&(m="Password must be at least 8 characters with uppercase, lowercase, number, and special character (!@#$%^&*)"),c(m)}finally{l(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-md w-full bg-gray-800 rounded-lg shadow-md p-8 border border-gray-700",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-600 mb-2",children:"🏦 WealthPath AI"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Create Account"}),e.jsx("p",{className:"text-gray-600",children:"Start your financial journey"})]}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"First Name"}),e.jsx("input",{type:"text",name:"first_name",value:r.first_name,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Last Name"}),e.jsx("input",{type:"text",name:"last_name",value:r.last_name,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Password"}),e.jsx("input",{type:"password",name:"password",value:r.password,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Must be 8+ characters with uppercase, lowercase, number, and special character"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Confirm Password"}),e.jsx("input",{type:"password",name:"confirmPassword",value:r.confirmPassword,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),o&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700",children:o}),e.jsx("button",{type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-purple-700 hover:to-blue-700 transition-all disabled:opacity-50",children:i?"Creating account...":"Create Account"})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",e.jsx("button",{onClick:a,className:"text-blue-600 hover:text-blue-800 font-semibold",children:"Sign in"})]}),e.jsx("button",{onClick:t,className:"mt-4 text-gray-500 hover:text-gray-700",children:"← Back to Home"})]})]})})},Dd=new xi({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,retry:(s,t)=>(t==null?void 0:t.status_code)===401||(t==null?void 0:t.status_code)>=400&&(t==null?void 0:t.status_code)<500?!1:s<3,retryDelay:s=>Math.min(1e3*2**s,3e4),refetchOnWindowFocus:!1,refetchOnReconnect:!0},mutations:{retry:(s,t)=>(t==null?void 0:t.status_code)>=400&&(t==null?void 0:t.status_code)<500?!1:s<1}}});Oa.createRoot(document.getElementById("root")).render(e.jsx(xe.StrictMode,{children:e.jsx(ms,{children:e.jsx(gi,{client:Dd,children:e.jsx(ui,{children:e.jsx(vd,{})})})})}));
//# sourceMappingURL=index-YVssZX5h.js.map
